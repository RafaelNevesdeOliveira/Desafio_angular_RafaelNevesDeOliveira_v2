(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"/BFg":function(e,t,i){"use strict";i.d(t,"a",function(){return Ku}),i.d(t,"b",function(){return eg}),i.d(t,"c",function(){return ng}),i.d(t,"d",function(){return rg}),i.d(t,"g",function(){return dg}),i.d(t,"h",function(){return pg}),i.d(t,"i",function(){return vg}),i.d(t,"j",function(){return wg}),i.d(t,"e",function(){return Og}),i.d(t,"f",function(){return Tg});var n=i("8Y7J");let r=0;function s(e,t){let i=t;return i.unshift(void 0),new(Function.prototype.bind.apply(e,i))}function o(e,t){let i=t,n=e.replace(/\[/g,".").replace(/\]/g,"").split(".");for(let r=0;r<n.length&&!p(i);r++)i=i[n[r]];return i}function a(e,t,i){let n,r,s=e.replace(/\[/g,".").replace(/\]/g,"").split("."),o=i||{},a=o,l=s.length;for(n=0;n<l;n++)r=s[n],n+1===l?a[r]=void 0===t?{}:t:d(a[r])&&(a[r]={}),a=a[r];return o}function l(e){return!d(e)&&e.constructor==={}.constructor}function h(e,t){if(!d(t)){let i=e,n=t,r=Object.keys(t),s="deepMerge";for(let e of r)d(i[s])||-1===i[s].indexOf(e)||!l(n[e])&&!Array.isArray(n[e])?i[e]=n[e]:c(i[e],i[e],n[e],!0)}}function c(e,t,i,n){let r=e&&"object"==typeof e?e:{},s=arguments.length;n&&(s-=1);for(let o=1;o<s;o++){if(!arguments[o])continue;let e=arguments[o];Object.keys(e).forEach(t=>{let i,s=r[t],o=e[t];Array.isArray(o)&&Array.isArray(s);n&&(l(o)||Array.isArray(o))?l(o)?(i=s||{},Array.isArray(i)&&i.hasOwnProperty("isComplexArray")?c(i,{},o,n):r[t]=c(i,{},o,n)):(i=s||[],r[t]=c([],i,o,n)):r[t]=o})}return r}function d(e){return null==e}function p(e){return void 0===e}function u(e){return e+"_"+r++}function g(e,t){return e===t||!(e===document||!e)&&g(e.parentNode,t)}function m(e){try{throw new Error(e)}catch(t){throw t.message+"\n"+t.stack}}function f(e){let t=e+"";return t.match(/auto|%|px|vh|vm|vmax|vmin|em/)?t:t+"px"}function y(){return!1}const b={latn:{_digits:"0123456789",_type:"numeric"}},v={decimal:".",group:",",percentSign:"%",plusSign:"+",minusSign:"-",infinity:"\u221e",nan:"NaN",exponential:"E"},w=[0,1,2,3,4,5,6,7,8,9];let x=(()=>{class e{static getMainObject(e,t){return o("main."+t,e)}static getNumberingSystem(e){return o("supplemental.numberingSystems",e)||this.numberingSystems}static reverseObject(e,t){let i=t||Object.keys(e),n={};for(let r of i)n.hasOwnProperty(e[r])||(n[e[r]]=r);return n}static getSymbolRegex(e){let t=e.map(e=>e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")).join("|");return new RegExp(t,"g")}static getSymbolMatch(e){let t=Object.keys(v),i={};for(let n of t)i[e[n]]=v[n];return i}static constructRegex(e){let t=e.length,i="";for(let n=0;n<t;n++)i+=n!==t-1?e[n]+"|":e[n];return i}static convertValueParts(e,t,i){return e.replace(t,e=>i[e])}static getDefaultNumberingSystem(e){let t={};return t.obj=o("numbers",e),t.nSystem=o("defaultNumberingSystem",t.obj),t}static getCurrentNumericOptions(e,t,i,n){let r={},s=this.getDefaultNumberingSystem(e);if(!p(s.nSystem)||n){let e=n?o("obj.mapperDigits",s):o(s.nSystem+"._digits",t);p(e)||(r.numericPair=this.reverseObject(e,w),r.numberParseRegex=new RegExp(this.constructRegex(e),"g"),r.numericRegex="["+e[0]+"-"+e[9]+"]",i&&(r.numericRegex=e[0]+"-"+e[9],r.symbolNumberSystem=o(n?"numberSymbols":"symbols-numberSystem-"+s.nSystem,s.obj),r.symbolMatch=this.getSymbolMatch(r.symbolNumberSystem),r.numberSystem=s.nSystem))}return r}static getNumberMapper(e,t,i){let n={mapper:{}},r=this.getDefaultNumberingSystem(e);if(!p(r.nSystem)){n.numberSystem=r.nSystem,n.numberSymbols=o("symbols-numberSystem-"+r.nSystem,r.obj),n.timeSeparator=o("timeSeparator",n.numberSymbols);let e=o(r.nSystem+"._digits",t);if(!p(e))for(let t of w)n.mapper[t]=e[t]}return n}}return e.nPair="numericPair",e.nRegex="numericRegex",e.numberingSystems=b,e})();const S={DJF:"Fdj",ERN:"Nfk",ETB:"Br",NAD:"$",ZAR:"R",XAF:"FCFA",GHS:"GH\u20b5",XDR:"XDR",AED:"\u062f.\u0625.\u200f",BHD:"\u062f.\u0628.\u200f",DZD:"\u062f.\u062c.\u200f",EGP:"\u062c.\u0645.\u200f",ILS:"\u20aa",IQD:"\u062f.\u0639.\u200f",JOD:"\u062f.\u0627.\u200f",KMF:"CF",KWD:"\u062f.\u0643.\u200f",LBP:"\u0644.\u0644.\u200f",LYD:"\u062f.\u0644.\u200f",MAD:"\u062f.\u0645.\u200f",MRU:"\u0623.\u0645.",OMR:"\u0631.\u0639.\u200f",QAR:"\u0631.\u0642.\u200f",SAR:"\u0631.\u0633.\u200f",SDG:"\u062c.\u0633.",SOS:"S",SSP:"\xa3",SYP:"\u0644.\u0633.\u200f",TND:"\u062f.\u062a.\u200f",YER:"\u0631.\u064a.\u200f",CLP:"$",INR:"\u20b9",TZS:"TSh",EUR:"\u20ac",AZN:"\u20bc",RUB:"\u20bd",BYN:"Br",ZMW:"K",BGN:"\u043b\u0432.",NGN:"\u20a6",XOF:"CFA",BDT:"\u09f3",CNY:"\xa5",BAM:"\u041a\u041c",UGX:"USh",USD:"$",CZK:"K\u010d",GBP:"\xa3",DKK:"kr.",KES:"Ksh",CHF:"CHF",MVR:"\u0783.",BTN:"Nu.",XCD:"EC$",AUD:"$",BBD:"$",BIF:"FBu",BMD:"$",BSD:"$",BWP:"P",BZD:"$",CAD:"$",NZD:"$",FJD:"$",FKP:"\xa3",GIP:"\xa3",GMD:"D",GYD:"$",HKD:"$",IDR:"Rp",JMD:"$",KYD:"$",LRD:"$",MGA:"Ar",MOP:"MOP$",MUR:"Rs",MWK:"MK",MYR:"RM",PGK:"K",PHP:"\u20b1",PKR:"Rs",RWF:"RF",SBD:"$",SCR:"SR",SEK:"kr",SGD:"$",SHP:"\xa3",SLL:"Le",ANG:"NAf.",SZL:"E",TOP:"T$",TTD:"$",VUV:"VT",WST:"WS$",ARS:"$",BOB:"Bs",BRL:"R$",COP:"$",CRC:"\u20a1",CUP:"$",DOP:"$",GTQ:"Q",HNL:"L",MXN:"$",NIO:"C$",PAB:"B/.",PEN:"S/",PYG:"\u20b2",UYU:"$",VES:"Bs.S",IRR:"\u0631\u064a\u0627\u0644",GNF:"FG",CDF:"FC",HTG:"G",XPF:"FCFP",HRK:"kn",HUF:"Ft",AMD:"\u058f",ISK:"kr",JPY:"\xa5",GEL:"\u20be",CVE:"\u200b",KZT:"\u20b8",KHR:"\u17db",KPW:"\u20a9",KRW:"\u20a9",KGS:"\u0441\u043e\u043c",AOA:"Kz",LAK:"\u20ad",MZN:"MTn",MKD:"\u0434\u0435\u043d",MNT:"\u20ae",BND:"$",MMK:"K",NOK:"kr",NPR:"\u0930\u0941",AWG:"Afl.",SRD:"$",PLN:"z\u0142",AFN:"\u060b",STN:"Db",MDL:"L",RON:"lei",UAH:"\u20b4",LKR:"\u0dbb\u0dd4.",ALL:"Lek\xeb",RSD:"\u0434\u0438\u043d.",TJS:"\u0441\u043c\u043d",THB:"\u0e3f",TMT:"m.",TRY:"\u20ba",UZS:"\u0441\u045e\u043c",VND:"\u20ab",TWD:"NT$"};var C;!function(e){const t=[28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990];e.getHijriDate=function(e){let i=e.getDate(),n=e.getMonth(),r=e.getFullYear(),s=n+1,o=r;s<3&&(o-=1,s+=12);let a=Math.floor(o/100),l=a-Math.floor(a/4)-2,h=Math.floor(365.25*(o+4716))+Math.floor(30.6001*(s+1))+i-l-1524;a=Math.floor((h-1867216.25)/36524.25),l=a-Math.floor(a/4)+1;let c=h+l+1524,d=Math.floor((c-122.1)/365.25),p=Math.floor(365.25*d),u=Math.floor((c-p)/30.6001);i=c-p-Math.floor(30.6001*u),n=Math.floor((c-p)/20.6001),n>13&&(d+=1,n-=12),n-=1,r=d-4716;let g=h-24e5,m=10631/30,f=h-1948084,y=Math.floor(f/10631);f-=10631*y;let b=Math.floor((f-.1335)/m),v=30*y+b;f-=Math.floor(b*m+.1335);let w=Math.floor((f+28.5001)/29.5);13===w&&(w=12);let x=f-Math.floor(29.5001*w-29),S=0;for(;S<t.length&&!(t[S]>g);S++);let C=S+16260,P=Math.floor((C-1)/12),O=P+1,T=C-12*P,E=g-t[S-1]+1;return(E+"").length>2&&(E=x,T=w,O=v),{year:O,month:T,date:E}},e.toGregorian=function(e,i,n){let r=Math.floor(n+t[12*(e-1)+1+(i-1)-16260-1]-1+24e5+.5),s=Math.floor((r-1867216.25)/36524.25);s=r+1+s-Math.floor(s/4);let o=s+1524,a=Math.floor((o-122.1)/365.25),l=Math.floor(365.25*a),h=Math.floor((o-l)/30.6001),c=o-l-Math.floor(30.6001*h),d=h-(h>13.5?13:1),p=a-(d>2.5?4716:4715);return p<=0&&d--,new Date(p+"/"+d+"/"+c)}}(C||(C={}));const P=/\/MMMMM|MMMM|MMM|a|LLLL|LLL|EEEEE|EEEE|E|K|cccc|ccc|WW|W|G+|z+/gi,O="stand-alone",T=["sun","mon","tue","wed","thu","fri","sat"],E={m:"getMinutes",h:"getHours",H:"getHours",s:"getSeconds",d:"getDate",f:"getMilliseconds"};class A{static dateFormat(e,t,i){let n=H.getDependables(i,e,t.calendar),r=(o("parserObject.numbers",n),n.dateObject),s={isIslamic:H.islamicRegex.test(t.calendar)},a=t.format||H.getResultantPattern(t.skeleton,n.dateObject,t.type,!1,"");if(s.dateSeperator=H.getDateSeparator(n.dateObject),p(a))m("Format options or type given must be invalid");else{a=H.ConvertDateToWeekFormat(a),s.pattern=a,s.numMapper=x.getNumberMapper(n.parserObject,x.getNumberingSystem(i));let e=a.match(P)||[];for(let t of e){let e=t.length,i=t[0];switch("K"===i&&(i="h"),i){case"E":case"c":s.weekday=n.dateObject[H.days][O][H.monthIndex[e]];break;case"M":case"L":s.month=n.dateObject[H.month][O][H.monthIndex[e]];break;case"a":s.designator=o("dayPeriods.format.wide",r);break;case"G":s.era=o("eras."+(e<=3?"eraAbbr":4===e?"eraNames":"eraNarrow"),n.dateObject);break;case"z":s.timeZone=o("dates.timeZoneNames",n.parserObject)}}}return e=>isNaN(e.getDate())?null:this.intDateFormatter(e,s)}static intDateFormatter(e,t){let i="",n=t.pattern.match(H.dateParseRegex),r=this.getCurrentDateValue(e,t.isIslamic);for(let s of n){let n,o=s.length,a=s[0];"K"===a&&(a="h");let l,h,c="",p="";switch(a){case"M":case"L":n=r.month,o>2?i+=t.month[n]:l=!0;break;case"E":case"c":i+=t.weekday[T[e.getDay()]];break;case"H":case"h":case"m":case"s":case"d":case"f":if(l=!0,"d"===a)n=r.date;else if("f"===a){l=!1,h=!0,c=e[E[a]]().toString(),c=c.substring(0,o);let t=c.length;if(o!==t){if(o>3)continue;for(let e=0;e<o-t;e++)c="0"+c.toString()}p+=c}else n=e[E[a]]();"h"===a&&(n=n%12||12);break;case"y":h=!0,p+=r.year,2===o&&(p=p.substr(p.length-2));break;case"a":let u=e.getHours()<12?"am":"pm";i+=t.designator[u];break;case"G":let g=e.getFullYear()<0?0:1,m=t.era[g];d(m)&&(m=t.era[g?0:1]),i+=m||"";break;case"'":i+="''"===s?"'":s.replace(/\'/g,"");break;case"z":let f=e.getTimezoneOffset(),y=o<4?"+H;-H":t.timeZone.hourFormat;y=y.replace(/:/g,t.numMapper.timeSeparator),0===f?i+=t.timeZone.gmtZeroFormat:(h=!0,p=this.getTimeZoneValue(f,y)),p=t.timeZone.gmtFormat.replace(/\{0\}/,p);break;case":":i+=t.numMapper.numberSymbols.timeSeparator;break;case"/":i+=t.dateSeperator;break;case"W":l=!0,n=H.getWeekOfYear(e);break;default:i+=s}l&&(h=!0,p=this.checkTwodigitNumber(n,o)),h&&(i+=x.convertValueParts(p,H.latnParseRegex,t.numMapper.mapper))}return i}static getCurrentDateValue(e,t){return t?C.getHijriDate(e):{year:e.getFullYear(),month:e.getMonth()+1,date:e.getDate()}}static checkTwodigitNumber(e,t){let i=e+"";return 2===t&&2!==i.length?"0"+i:i}static getTimeZoneValue(e,t){let i=t.split(";")[e>0?1:0],n=Math.abs(e);return i.replace(/HH?|mm/g,e=>{let t=e.length,i=-1!==e.indexOf("H");return this.checkTwodigitNumber(Math.floor(i?n/60:n%60),t)})}}const I={ms:"minimumSignificantDigits",ls:"maximumSignificantDigits",mf:"minimumFractionDigits",lf:"maximumFractionDigits"},D=["infinity","nan","group","decimal","exponential"];class R{static numberFormatter(e,t,i){let n,r=c({},t),s={},o={},a=H.getDependables(i,e,"",!0);o.numberMapper=x.getNumberMapper(a.parserObject,x.getNumberingSystem(i),!0),o.currencySymbol=H.getCurrencySymbol(a.numericObject,r.currency||k,t.altSymbol),o.percentSymbol=o.numberMapper.numberSymbols.percentSign,o.minusSymbol=o.numberMapper.numberSymbols.minusSign;let l=o.numberMapper.numberSymbols;if(t.format&&!H.formatRegex.test(t.format))s=H.customFormat(t.format,o,a.numericObject);else{c(r,H.getProperNumericSkeleton(t.format||"N")),r.isCurrency="currency"===r.type,r.isPercent="percent"===r.type,n=H.getSymbolPattern(r.type,o.numberMapper.numberSystem,a.numericObject,r.isAccount),r.groupOne=this.checkValueRange(r.maximumSignificantDigits,r.minimumSignificantDigits,!0),this.checkValueRange(r.maximumFractionDigits,r.minimumFractionDigits,!1,!0),p(r.fractionDigits)||(r.minimumFractionDigits=r.maximumFractionDigits=r.fractionDigits),p(r.useGrouping)&&(r.useGrouping=!0),r.isCurrency&&(n=n.replace(/\u00A4/g,H.defaultCurrency));{let e=n.split(";");s.nData=H.getFormatData(e[1]||"-"+e[0],!0,o.currencySymbol),s.pData=H.getFormatData(e[0],!1,o.currencySymbol),r.useGrouping&&(r.groupSeparator=l[D[2]],r.groupData=this.getGroupingDetails(e[0]))}if(p(r.minimumFractionDigits)&&(r.minimumFractionDigits=s.nData.minimumFraction),p(r.maximumFractionDigits)){let e=s.nData.maximumFraction;r.maximumFractionDigits=p(e)&&r.isPercent?0:e}let e=r.minimumFractionDigits,i=r.maximumFractionDigits;p(e)||p(i)||e>i&&(r.maximumFractionDigits=e)}return c(s.nData,r),c(s.pData,r),e=>isNaN(e)?l[D[1]]:isFinite(e)?this.intNumberFormatter(e,s,o):l[D[0]]}static getGroupingDetails(e){let t={},i=e.match(H.negativeDataRegex);if(i&&i[4]){let e=i[4],n=e.lastIndexOf(",");if(-1!==n){let i=e.split(".")[0];t.primary=i.length-n-1;let r=e.lastIndexOf(",",n-1);-1!==r&&(t.secondary=n-1-r)}}return t}static checkValueRange(e,t,i,n){let r=n?"f":"s",s=0,o=I["l"+r],a=I["m"+r];if(p(e)||(this.checkRange(e,o,n),s++),p(t)||(this.checkRange(t,a,n),s++),2===s){if(!(e<t))return!0;m(a+"specified must be less than the"+o)}else i&&1===s&&m("Both"+a+"and"+a+"must be present");return!1}static checkRange(e,t,i){let n=i?[0,20]:[1,21];(e<n[0]||e>n[1])&&m(t+"value must be within the range"+n[0]+"to"+n[1])}static intNumberFormatter(e,t,i){let n;if(!p(t.nData.type)){e<0?(e*=-1,n=t.nData):n=0===e&&t.zeroData||t.pData;let r="";return n.isPercent&&(e*=100),n.groupOne?r=this.processSignificantDigits(e,n.minimumSignificantDigits,n.maximumSignificantDigits):(r=this.processFraction(e,n.minimumFractionDigits,n.maximumFractionDigits),n.minimumIntegerDigits&&(r=this.processMinimumIntegers(r,n.minimumIntegerDigits))),"scientific"===n.type&&(r=e.toExponential(n.maximumFractionDigits),r=r.replace("e",i.numberMapper.numberSymbols[D[4]])),r=r.replace(".",i.numberMapper.numberSymbols[D[3]]),n.useGrouping&&(r=this.groupNumbers(r,n.groupData.primary,n.groupSeparator||",",i.numberMapper.numberSymbols[D[3]]||".",n.groupData.secondary)),r=x.convertValueParts(r,H.latnParseRegex,i.numberMapper.mapper),"N/A"===n.nlead?n.nlead:n.nlead+r+n.nend}}static processSignificantDigits(e,t,i){let n,r=e+"";return r.length<t?e.toPrecision(t):(r=e.toPrecision(i),n=+r,n+"")}static groupNumbers(e,t,i,n,r){let s=!d(r)&&0!==r,o=e.split(n),a=o[0],l=a.length,h="";for(;l>t;)h=a.slice(l-t,l)+(h.length?i+h:""),l-=t,s&&(t=r,s=!1);return o[0]=a.slice(0,l)+(h.length?i:"")+h,o.join(n)}static processFraction(e,t,i){let n=(e+"").split(".")[1],r=n?n.length:0;if(t&&r<t){let i="";if(0!==r){i+=e;for(let e=0;e<t-r;e++)i+="0";return i}return i=e.toFixed(t),e.toFixed(t)}return!d(i)&&(r>i||0===i)?e.toFixed(i):e+""}static processMinimumIntegers(e,t){let i=e.split("."),n=i[0],r=n.length;if(r<t){for(let e=0;e<t-r;e++)n="0"+n;i[0]=n}return i.join(".")}}class L{constructor(e){this.ranArray=[],this.boundedEvents={},d(e)||(this.context=e)}on(e,t,i,n){if(d(t))return;let r=i||this.context;this.notExist(e)?this.boundedEvents[e]=[{handler:t,context:r}]:d(n)?this.isHandlerPresent(this.boundedEvents[e],t)||this.boundedEvents[e].push({handler:t,context:r}):-1===this.ranArray.indexOf(n)&&(this.ranArray.push(n),this.boundedEvents[e].push({handler:t,context:r,id:n}))}off(e,t,i){if(this.notExist(e))return;let n=o(e,this.boundedEvents);if(t){for(let r=0;r<n.length;r++)if(i){if(n[r].id===i){n.splice(r,1);let e=this.ranArray.indexOf(i);-1!==e&&this.ranArray.splice(e,1);break}}else if(t===n[r].handler){n.splice(r,1);break}}else delete this.boundedEvents[e]}notify(e,t,i,n){if(this.notExist(e))return void(i&&i.call(this,t));t&&(t.name=e);let r=o(e,this.boundedEvents).slice(0);if(window.Blazor)return this.blazorCallback(r,t,i,n,0);for(let s of r)s.handler.call(s.context,t);i&&i.call(this,t)}blazorCallback(e,t,i,n,r){let s=r===e.length-1;if(r<e.length){let o=e[r],a=o.handler.call(o.context,t);if(a&&"function"==typeof a.then){if(!i)return a;a.then(a=>{if(a="string"==typeof a&&this.isJson(a)?JSON.parse(a,this.dateReviver):a,c(t,t,a,!0),!i||!s)return this.blazorCallback(e,t,i,n,r+1);i.call(o.context,t)}).catch(e=>{n&&n.call(o.context,"string"==typeof e&&this.isJson(e)?JSON.parse(e,this.dateReviver):e)})}else{if(!i||!s)return this.blazorCallback(e,t,i,n,r+1);i.call(o.context,t)}}}dateReviver(e,t){return y&&"string"==typeof t&&null!==t.match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/)?new Date(t):t}isJson(e){try{JSON.parse(e)}catch(t){return!1}return!0}destroy(){this.boundedEvents=this.context=void 0}notExist(e){return!1===this.boundedEvents.hasOwnProperty(e)||this.boundedEvents[e].length<=0}isHandlerPresent(e,t){for(let i of e)if(i.handler===t)return!0;return!1}}let z=new L,M="en-US",k="USD";const j={"en-US":{d:"M/d/y",D:"EEEE, MMMM d, y",f:"EEEE, MMMM d, y h:mm a",F:"EEEE, MMMM d, y h:mm:s a",g:"M/d/y h:mm a",G:"M/d/yyyy h:mm:ss tt",m:"MMMM d",M:"MMMM d",r:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",R:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",s:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",t:"h:mm tt",T:"h:m:s tt",u:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",U:"dddd, MMMM d, yyyy h:mm:ss tt",y:"MMMM yyyy",Y:"MMMM yyyy"}};var H;!function(e){e.negativeDataRegex=/^(('[^']+'|''|[^*#@0,.E])*)(\*.)?((([#,]*[0,]*0+)(\.0*[0-9]*#*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,e.customRegex=/^(('[^']+'|''|[^*#@0,.])*)(\*.)?((([0#,]*[0,]*[0#]*)(\.[0#]*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,e.latnParseRegex=/0|1|2|3|4|5|6|7|8|9/g;const t=/[0-9]/g;e.defaultCurrency="$";const i=["infinity","nan","group","decimal"],n=/G|M|L|H|c|'| a|yy|y|EEEE|E/g,r={G:"",M:"m",L:"m",H:"h",c:"d","'":'"'," a":" AM/PM",yy:"yy",y:"yyyy",EEEE:"dddd",E:"ddd"};e.dateConverterMapper=/dddd|ddd/gi,e.islamicRegex=/^islamic/;const s={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6};e.formatRegex=/(^[ncpae]{1})([0-1]?[0-9]|20)?$/i,e.currencyFormatRegex=/(^[ca]{1})([0-1]?[0-9]|20)?$/i,e.curWithoutNumberRegex=/(c|a)$/gi;const a={$:"isCurrency","%":"isPercent","-":"isNegative",0:"nlead",1:"nend"};function l(t,i,n,r,s){let a,l=n||"date";if(s)a=m({skeleton:t},s).format||m({skeleton:"d"},"en-US").format;else{if(-1!==e.basicPatterns.indexOf(t)){if(a=o(l+"Formats."+t,i),"dateTime"===l){let e=o("dateFormats."+t,i),n=o("timeFormats."+t,i);a=a.replace("{1}",e).replace("{0}",n)}}else a=o("dateTimeFormats.availableFormats."+t,i);p(a)&&"yMd"===t&&(a="M/d/y")}return a}function h(t,i,n,r){let s={},a=n||"gregorian";return s.parserObject=x.getMainObject(t,i)||e.defaultObject,r?s.numericObject=o("numbers",s.parserObject):s.dateObject=o("dates.calendars."+a,s.parserObject),s}function u(e,t,i,n){return o(e+"Formats-numberSystem-"+t+(n?".accounting":".standard"),i)||(n?o(e+"Formats-numberSystem-"+t+".standard",i):"")}function g(t){return t.match(e.dateConverterMapper),t}function m(e,t){let i=e.format||e.skeleton,n=o((t||"en-US")+"."+i,j);return n||(n=o("en-US."+i,j)),n&&(n=g(n),e.format=n.replace(/tt/,"a")),e}function f(t){let i=t.match(e.formatRegex),n={},r=i[1].toUpperCase();return n.isAccount="A"===r,n.type=e.patternMatcher[r],t.length>1&&(n.fractionDigits=parseInt(i[2],10)),n}function y(i,n,r,s){let o=s?{}:{nlead:"",nend:""},a=i.match(e.customRegex);if(a){s||(o.nlead=b(a[1],r),o.nend=b(a[10],r),o.groupPattern=a[4]);let e=a[7];if(e&&n){let i=e.match(t);o.minimumFraction=d(i)?0:i.length,o.maximumFraction=e.length-1}}return o}function b(t,i){return t?t.replace(e.defaultCurrency,i):""}function v(e,t,i){return o("currencies."+t+(i?"."+i:".symbol"),e)||o("currencies."+t+".symbol-alt-narrow",e)||"$"}function w(t,n,r){let s={type:"decimal",minimumFractionDigits:0,maximumFractionDigits:0},o=t.match(e.customRegex);if(d(o)||""===o[5]&&"N/A"!==t)return s.type=void 0,s;s.nlead=o[1],s.nend=o[10];let a=o[6];s.useGrouping=-1!==a.indexOf(","),a=a.replace(/,/g,"");let l=o[7];if(-1!==a.indexOf("0")&&(s.minimumIntegerDigits=a.length-a.indexOf("0")),d(l)||(s.minimumFractionDigits=l.lastIndexOf("0"),s.maximumFractionDigits=l.lastIndexOf("#"),-1===s.minimumFractionDigits&&(s.minimumFractionDigits=0),(-1===s.maximumFractionDigits||s.maximumFractionDigits<s.minimumFractionDigits)&&(s.maximumFractionDigits=s.minimumFractionDigits)),d(n)?c(s,C([s.nlead,s.nend],"%","%")):(c(s,C([s.nlead,s.nend],"$",n.currencySymbol)),s.isCurrency||c(s,C([s.nlead,s.nend],"%",n.percentSymbol))),!d(r)){let e=u(s.type,n.numberMapper.numberSystem,r,!1);s.useGrouping&&(s.groupSeparator=n.numberMapper.numberSymbols[i[2]],s.groupData=R.getGroupingDetails(e.split(";")[0])),s.nlead=s.nlead.replace(/\'/g,""),s.nend=s.nend.replace(/\'/g,"")}return s}function C(e,t,i){let n={nlead:e[0],nend:e[1]};for(let r=0;r<2;r++){let s=e[r],o=s.indexOf(t);if(-1!==o&&(o<s.indexOf("'")||o>s.lastIndexOf("'"))){n[a[r]]=s.substr(0,o)+i+s.substr(o+1),n[a[t]]=!0,n.type=n.isCurrency?"currency":"percent";break}}return n}e.dateParseRegex=/([a-z])\1*|'([^']|'')+'|''|./gi,e.basicPatterns=["short","medium","long","full"],e.defaultObject={dates:{calendars:{gregorian:{months:{"stand-alone":{abbreviated:{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},narrow:{1:"J",2:"F",3:"M",4:"A",5:"M",6:"J",7:"J",8:"A",9:"S",10:"O",11:"N",12:"D"},wide:{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"}}},days:{"stand-alone":{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},narrow:{sun:"S",mon:"M",tue:"T",wed:"W",thu:"T",fri:"F",sat:"S"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}}},dayPeriods:{format:{wide:{am:"AM",pm:"PM"}}},eras:{eraNames:{0:"Before Christ","0-alt-variant":"Before Common Era",1:"Anno Domini","1-alt-variant":"Common Era"},eraAbbr:{0:"BC","0-alt-variant":"BCE",1:"AD","1-alt-variant":"CE"},eraNarrow:{0:"B","0-alt-variant":"BCE",1:"A","1-alt-variant":"CE"}},dateFormats:{full:"EEEE, MMMM d, y",long:"MMMM d, y",medium:"MMM d, y",short:"M/d/yy"},timeFormats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats:{full:"{1} 'at' {0}",long:"{1} 'at' {0}",medium:"{1}, {0}",short:"{1}, {0}",availableFormats:{d:"d",E:"ccc",Ed:"d E",Ehm:"E h:mm a",EHm:"E HH:mm",Ehms:"E h:mm:ss a",EHms:"E HH:mm:ss",Gy:"y G",GyMMM:"MMM y G",GyMMMd:"MMM d, y G",GyMMMEd:"E, MMM d, y G",h:"h a",H:"HH",hm:"h:mm a",Hm:"HH:mm",hms:"h:mm:ss a",Hms:"HH:mm:ss",hmsv:"h:mm:ss a v",Hmsv:"HH:mm:ss v",hmv:"h:mm a v",Hmv:"HH:mm v",M:"L",Md:"M/d",MEd:"E, M/d",MMM:"LLL",MMMd:"MMM d",MMMEd:"E, MMM d",MMMMd:"MMMM d",ms:"mm:ss",y:"y",yM:"M/y",yMd:"M/d/y",yMEd:"E, M/d/y",yMMM:"MMM y",yMMMd:"MMM d, y",yMMMEd:"E, MMM d, y",yMMMM:"MMMM y"}}},islamic:{months:{"stand-alone":{abbreviated:{1:"Muh.",2:"Saf.",3:"Rab. I",4:"Rab. II",5:"Jum. I",6:"Jum. II",7:"Raj.",8:"Sha.",9:"Ram.",10:"Shaw.",11:"Dhu\u02bbl-Q.",12:"Dhu\u02bbl-H."},narrow:{1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12"},wide:{1:"Muharram",2:"Safar",3:"Rabi\u02bb I",4:"Rabi\u02bb II",5:"Jumada I",6:"Jumada II",7:"Rajab",8:"Sha\u02bbban",9:"Ramadan",10:"Shawwal",11:"Dhu\u02bbl-Qi\u02bbdah",12:"Dhu\u02bbl-Hijjah"}}},days:{"stand-alone":{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},narrow:{sun:"S",mon:"M",tue:"T",wed:"W",thu:"T",fri:"F",sat:"S"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}}},dayPeriods:{format:{wide:{am:"AM",pm:"PM"}}},eras:{eraNames:{0:"AH"},eraAbbr:{0:"AH"},eraNarrow:{0:"AH"}},dateFormats:{full:"EEEE, MMMM d, y G",long:"MMMM d, y G",medium:"MMM d, y G",short:"M/d/y GGGGG"},timeFormats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats:{full:"{1} 'at' {0}",long:"{1} 'at' {0}",medium:"{1}, {0}",short:"{1}, {0}",availableFormats:{d:"d",E:"ccc",Ed:"d E",Ehm:"E h:mm a",EHm:"E HH:mm",Ehms:"E h:mm:ss a",EHms:"E HH:mm:ss",Gy:"y G",GyMMM:"MMM y G",GyMMMd:"MMM d, y G",GyMMMEd:"E, MMM d, y G",h:"h a",H:"HH",hm:"h:mm a",Hm:"HH:mm",hms:"h:mm:ss a",Hms:"HH:mm:ss",M:"L",Md:"M/d",MEd:"E, M/d",MMM:"LLL",MMMd:"MMM d",MMMEd:"E, MMM d",MMMMd:"MMMM d",ms:"mm:ss",y:"y G",yyyy:"y G",yyyyM:"M/y GGGGG",yyyyMd:"M/d/y GGGGG",yyyyMEd:"E, M/d/y GGGGG",yyyyMMM:"MMM y G",yyyyMMMd:"MMM d, y G",yyyyMMMEd:"E, MMM d, y G",yyyyMMMM:"MMMM y G",yyyyQQQ:"QQQ y G",yyyyQQQQ:"QQQQ y G"}}}},timeZoneNames:{hourFormat:"+HH:mm;-HH:mm",gmtFormat:"GMT{0}",gmtZeroFormat:"GMT"}},numbers:{currencies:{USD:{displayName:"US Dollar",symbol:"$","symbol-alt-narrow":"$"},EUR:{displayName:"Euro",symbol:"\u20ac","symbol-alt-narrow":"\u20ac"},GBP:{displayName:"British Pound","symbol-alt-narrow":"\xa3"}},defaultNumberingSystem:"latn",minimumGroupingDigits:"1","symbols-numberSystem-latn":{decimal:".",group:",",list:";",percentSign:"%",plusSign:"+",minusSign:"-",exponential:"E",superscriptingExponent:"\xd7",perMille:"\u2030",infinity:"\u221e",nan:"NaN",timeSeparator:":"},"decimalFormats-numberSystem-latn":{standard:"#,##0.###"},"percentFormats-numberSystem-latn":{standard:"#,##0%"},"currencyFormats-numberSystem-latn":{standard:"\xa4#,##0.00",accounting:"\xa4#,##0.00;(\xa4#,##0.00)"},"scientificFormats-numberSystem-latn":{standard:"#E0"}}},e.blazorDefaultObject={numbers:{mapper:{0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9"},mapperDigits:"0123456789",numberSymbols:{decimal:".",group:",",plusSign:"+",minusSign:"-",percentSign:"%",nan:"NaN",timeSeparator:":",infinity:"\u221e"},timeSeparator:":",currencySymbol:"$",currencypData:{nlead:"$",nend:"",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},percentpData:{nlead:"",nend:"%",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},percentnData:{nlead:"-",nend:"%",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},currencynData:{nlead:"($",nend:")",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},decimalnData:{nlead:"-",nend:"",groupData:{primary:3},maximumFraction:2,minimumFraction:2},decimalpData:{nlead:"",nend:"",groupData:{primary:3},maximumFraction:2,minimumFraction:2}},dates:{dayPeriods:{am:"AM",pm:"PM"},dateSeperator:"/",days:{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}},months:{abbreviated:{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},wide:{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"}},eras:{1:"AD"}}},e.monthIndex={3:"abbreviated",4:"wide",5:"narrow",1:"abbreviated"},e.month="months",e.days="days",e.patternMatcher={C:"currency",P:"percent",N:"decimal",A:"currency",E:"scientific"},e.getResultantPattern=l,e.getDependables=h,e.getSymbolPattern=u,e.ConvertDateToWeekFormat=g,e.compareBlazorDateFormats=m,e.getProperNumericSkeleton=f,e.getFormatData=y,e.getCurrencySymbol=v,e.customFormat=function(e,t,i){let n={},r=e.split(";"),s=["pData","nData","zeroData"];for(let o=0;o<r.length;o++)n[s[o]]=w(r[o],t,i);return d(n.nData)&&(n.nData=c({},n.pData),n.nData.nlead=d(t)?"-"+n.nData.nlead:t.minusSymbol+n.nData.nlead),n},e.isCurrencyPercent=C,e.getDateSeparator=function(e){let t=(o("dateFormats.short",e)||"").match(/[d\u200fM\u200f]([^d\u200fM])[d\u200fM\u200f]/i);return t?t[1]:"/"},e.getActualDateTimeFormat=function(e,t,i,s){let a=h(i,e,t.calendar),c=t.format||l(t.skeleton,a.dateObject,t.type);if(s){if(c=c.replace(n,e=>r[e]),-1!==c.indexOf("z")){let e,t=c.match(/z/g).length,n={timeZone:{}};n.numMapper=x.getNumberMapper(a.parserObject,x.getNumberingSystem(i)),n.timeZone=o("dates.timeZoneNames",a.parserObject);let r=(new Date).getTimezoneOffset(),s=t<4?"+H;-H":n.timeZone.hourFormat;s=s.replace(/:/g,n.numMapper.timeSeparator),0===r?e=n.timeZone.gmtZeroFormat:(e=A.getTimeZoneValue(r,s),e=n.timeZone.gmtFormat.replace(/\{0\}/,e)),c=c.replace(/[z]+/,'"'+e+'"')}c=c.replace(/ $/,"")}return c},e.getActualNumberFormat=function(t,i,n,r){let s,a,l=h(n,t,"",!0),d={custom:!0},p={},g=(i.format||"").match(e.currencyFormatRegex),m=(e.formatRegex.test(i.format)&&f(i.format||"N"),{});if(g){m.numberMapper=x.getNumberMapper(l.parserObject,x.getNumberingSystem(n),!0);let e=v(l.numericObject,i.currency||k,i.altSymbol),t=u("currency",m.numberMapper.numberSystem,l.numericObject,/a/i.test(i.format));t=t.replace(/\u00A4/g,e);let r=t.split(";");p.hasNegativePattern=r.length>1,p.nData=y(r[1]||"-"+r[0],!0,e),p.pData=y(r[0],!1,e),g[2]||i.minimumFractionDigits||i.maximumFractionDigits||(s=y(t.split(";")[0],!0,"",!0).minimumFraction)}if(e.formatRegex.test(i.format)||!i.format){if(c(d,f(i.format||"N")),d.custom=!1,a="###0",d.fractionDigits||i.minimumFractionDigits||i.maximumFractionDigits||s){let e=0;d.fractionDigits&&(i.minimumFractionDigits=i.maximumFractionDigits=d.fractionDigits),a=function(e,t,i){e+=".";for(let n=0;n<t;n++)e+="0";if(t<i){let n=i-t;for(let t=0;t<n;t++)e+="#"}return e}(a,s||d.fractionDigits||i.minimumFractionDigits||e,i.maximumFractionDigits||e)}if(i.minimumIntegerDigits&&(a=function(e,t){let i=e.split("."),n="";for(let r=0;r<t;r++)n+="0";return i[1]?n+"."+i[1]:n}(a,i.minimumIntegerDigits)),i.useGrouping&&(a=function(e){let t=e.split("."),i=t[0],n=3-i.length%3;i=(n&&1===n?"#":2===n?"##":"")+i,e="";for(let r=i.length-1;r>0;r-=3)e=","+i[r-2]+i[r-1]+i[r]+e;return e=e.slice(1),t[1]?e+"."+t[1]:e}(a)),"currency"===d.type){let e=a;a=p.pData.nlead+e+p.pData.nend,p.hasNegativePattern&&(a+=";"+p.nData.nlead+e+p.nData.nend)}"percent"!==d.type||(a+=" %")}else a=i.format.replace(/\'/g,'"');return Object.keys(m).length>0&&(a=r?a:function(e,t){if(-1!==e.indexOf(",")){let i=e.split(",");e=i[0]+o("numberMapper.numberSymbols.group",t)+i[1].replace(".",o("numberMapper.numberSymbols.decimal",t))}else e=e.replace(".",o("numberMapper.numberSymbols.decimal",t));return e}(a,m)),a},e.getWeekData=function(e,t){let i="sun",n=o("supplemental.weekData.firstDay",t),r=e;return/en-/.test(r)&&(r=r.slice(3)),r=r.slice(0,2).toUpperCase()+r.substr(2),n&&(i=n[r]||"sun"),s[i]},e.replaceBlazorCurrency=function(e,t,i){let n=o(i||"",S);if(t!==n)for(let r of e)r.nend=r.nend.replace(t,n),r.nlead=r.nlead.replace(t,n)},e.getWeekOfYear=function(e){let t,i=new Date(e.getFullYear(),0,1),n=i.getDay();n=n>=0?n:n+7;let r=Math.floor((e.getTime()-i.getTime()-6e4*(e.getTimezoneOffset()-i.getTimezoneOffset()))/864e5)+1;if(n<4){if(t=Math.floor((r+n-1)/7)+1,t>52){let i=new Date(e.getFullYear()+1,0,1).getDay();i=i>=0?i:i+7,t=i<4?1:53}}else t=Math.floor((r+n-1)/7);return t}}(H||(H={}));const N=/^(.*?):[ \t]*([^\r\n]*)$/gm;class _{constructor(e,t,i,n){this.mode=!0,this.emitError=!0,this.options={},"string"==typeof e?(this.url=e,this.type=t?t.toUpperCase():"GET",this.mode=!!d(i)||i):"object"==typeof e&&(this.options=e,h(this,this.options)),this.type=this.type?this.type.toUpperCase():"GET",this.contentType=void 0!==this.contentType?this.contentType:n}send(e){this.data=d(e)?this.data:e;let t={cancel:!1,httpRequest:null};return new Promise((e,i)=>{this.httpRequest=new XMLHttpRequest,this.httpRequest.onreadystatechange=()=>{this.stateChange(e,i)},d(this.onLoad)||(this.httpRequest.onload=this.onLoad),d(this.onProgress)||(this.httpRequest.onprogress=this.onProgress),d(this.onAbort)||(this.httpRequest.onabort=this.onAbort),d(this.onError)||(this.httpRequest.onerror=this.onError),d(this.onUploadProgress)||(this.httpRequest.upload.onprogress=this.onUploadProgress),this.httpRequest.open(this.type,this.url,this.mode),d(this.data)||null===this.contentType||this.httpRequest.setRequestHeader("Content-Type",this.contentType||"application/json; charset=utf-8"),this.beforeSend&&(t.httpRequest=this.httpRequest,this.beforeSend(t)),t.cancel||this.httpRequest.send(d(this.data)?null:this.data)})}successHandler(e){return this.onSuccess&&this.onSuccess(e,this),e}failureHandler(e){return this.onFailure&&this.onFailure(this.httpRequest),e}stateChange(e,t){let i=this.httpRequest.responseText;if(this.dataType&&"json"===this.dataType.toLowerCase())if(""===i)i=void 0;else try{i=JSON.parse(i)}catch(n){}4===this.httpRequest.readyState&&(this.httpRequest.status>=200&&this.httpRequest.status<=299||304===this.httpRequest.status?e(this.successHandler(i)):this.emitError?t(new Error(this.failureHandler(this.httpRequest.statusText))):e())}getResponseHeader(e){let t,i;t={};let n=N.exec(this.httpRequest.getAllResponseHeaders());for(;n;)t[n[1].toLowerCase()]=n[2],n=N.exec(this.httpRequest.getAllResponseHeaders());return i=t[e.toLowerCase()],d(i)?null:i}}const B=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini|mobile/i,W=/msie|trident/i,U=/Trident\/7\./,F=/(ipad|iphone|ipod touch)/i,V=/(ipad|iphone|ipod touch);.*os 7_\d|(ipad|iphone|ipod touch);.*os 8_\d/i,X=/android/i,Y=/trident|windows phone|edge/i,G=/(version)[ \/]([\w.]+)/i,q={OPERA:/(opera|opr)(?:.*version|)[ \/]([\w.]+)/i,EDGE:/(edge)(?:.*version|)[ \/]([\w.]+)/i,CHROME:/(chrome|crios)[ \/]([\w.]+)/i,PANTHOMEJS:/(phantomjs)[ \/]([\w.]+)/i,SAFARI:/(safari)[ \/]([\w.]+)/i,WEBKIT:/(webkit)[ \/]([\w.]+)/i,MSIE:/(msie|trident) ([\w.]+)/i,MOZILLA:/(mozilla)(?:.*? rv:([\w.]+)|)/i};"undefined"!=typeof window&&(window.browserDetails=window.browserDetails||{});let Z=(()=>{class e{static extractBrowserDetail(){let t={culture:{}},i=Object.keys(q),n=[];for(let r of i)if(n=e.userAgent.match(q[r]),n){if(t.name="opr"===n[1].toLowerCase()?"opera":n[1].toLowerCase(),t.name="crios"===n[1].toLowerCase()?"chrome":t.name,t.version=n[2],t.culture.name=t.culture.language=navigator.language,e.userAgent.match(U)){t.name="msie";break}let i=e.userAgent.match(G);"safari"===t.name&&i&&(t.version=i[2]);break}return t}static getEvent(t){let i={start:{isPointer:"pointerdown",isTouch:"touchstart",isDevice:"mousedown"},move:{isPointer:"pointermove",isTouch:"touchmove",isDevice:"mousemove"},end:{isPointer:"pointerup",isTouch:"touchend",isDevice:"mouseup"},cancel:{isPointer:"pointercancel",isTouch:"touchcancel",isDevice:"mouseleave"}};return e.isPointer&&!e.isWindows?i[t].isPointer:e.isTouch?i[t].isTouch+(e.isDevice?"":" "+i[t].isDevice):i[t].isDevice}static getTouchStartEvent(){return e.getEvent("start")}static getTouchEndEvent(){return e.getEvent("end")}static getTouchMoveEvent(){return e.getEvent("move")}static getTouchCancelEvent(){return e.getEvent("cancel")}static getValue(t,i){let n=window.browserDetails;return void 0===n[t]?n[t]=i.test(e.userAgent):n[t]}static set userAgent(t){e.uA=t,window.browserDetails={}}static get userAgent(){return e.uA}static get info(){return p(window.browserDetails.info)?window.browserDetails.info=e.extractBrowserDetail():window.browserDetails.info}static get isIE(){return e.getValue("isIE",W)}static get isTouch(){return p(window.browserDetails.isTouch)?window.browserDetails.isTouch="ontouchstart"in window.navigator||window&&window.navigator&&window.navigator.maxTouchPoints>0||"ontouchstart"in window:window.browserDetails.isTouch}static get isPointer(){return p(window.browserDetails.isPointer)?window.browserDetails.isPointer="pointerEnabled"in window.navigator:window.browserDetails.isPointer}static get isMSPointer(){return p(window.browserDetails.isMSPointer)?window.browserDetails.isMSPointer="msPointerEnabled"in window.navigator:window.browserDetails.isMSPointer}static get isDevice(){return e.getValue("isDevice",B)}static get isIos(){return e.getValue("isIos",F)}static get isIos7(){return e.getValue("isIos7",V)}static get isAndroid(){return e.getValue("isAndroid",X)}static get isWebView(){return p(window.browserDetails.isWebView)?(window.browserDetails.isWebView=!(p(window.cordova)&&p(window.PhoneGap)&&p(window.phonegap)&&"object"!==window.forge),window.browserDetails.isWebView):window.browserDetails.isWebView}static get isWindows(){return e.getValue("isWindows",Y)}static get touchStartEvent(){return p(window.browserDetails.touchStartEvent)?window.browserDetails.touchStartEvent=e.getTouchStartEvent():window.browserDetails.touchStartEvent}static get touchMoveEvent(){return p(window.browserDetails.touchMoveEvent)?window.browserDetails.touchMoveEvent=e.getTouchMoveEvent():window.browserDetails.touchMoveEvent}static get touchEndEvent(){return p(window.browserDetails.touchEndEvent)?window.browserDetails.touchEndEvent=e.getTouchEndEvent():window.browserDetails.touchEndEvent}static get touchCancelEvent(){return p(window.browserDetails.touchCancelEvent)?window.browserDetails.touchCancelEvent=e.getTouchCancelEvent():window.browserDetails.touchCancelEvent}}return e.uA="undefined"!=typeof navigator?navigator.userAgent:"",e})();class ${static addOrGetEventData(e){return"__eventList"in e?e.__eventList.events:(e.__eventList={},e.__eventList.events=[])}static add(e,t,i,n,r){let s,o=$.addOrGetEventData(e);s=r?function(e,t){let i;return function(){let n=arguments,r=()=>(i=null,e.apply(this,n));clearTimeout(i),i=setTimeout(r,t)}}(i,r):i,n&&(s=s.bind(n));let a=t.split(" ");for(let l=0;l<a.length;l++)o.push({name:a[l],listener:i,debounce:s}),Z.isIE?e.addEventListener(a[l],s):e.addEventListener(a[l],s,{passive:!1});return s}static remove(e,t,i){let n=$.addOrGetEventData(e),r=t.split(" ");for(let s=0;s<r.length;s++){let t,o=-1;n&&0!==n.length&&n.some((e,n)=>e.name===r[s]&&e.listener===i&&(o=n,t=e.debounce,!0)),-1!==o&&n.splice(o,1),t&&e.removeEventListener(r[s],t)}}static clearEvents(e){let t,i;t=$.addOrGetEventData(e),i=c([],i,t);for(let n=0;n<i.length;n++)e.removeEventListener(i[n].name,i[n].debounce),t.shift()}static trigger(e,t,i){let n=$.addOrGetEventData(e);for(let r of n)r.name===t&&r.debounce.call(this,i)}}const Q=new RegExp("\\n|\\r|\\s\\s+","g"),J=new RegExp(/'|"/g),K=new RegExp("if ?\\("),ee=new RegExp("else if ?\\("),te=new RegExp("else"),ie=new RegExp("for ?\\("),ne=new RegExp("(/if|/for)"),re=new RegExp("\\((.*)\\)",""),se=new RegExp("^[0-9]+$","g"),oe=new RegExp("[\\w\"'.\\s+]+","g"),ae=new RegExp('"(.*?)"',"g"),le=new RegExp("[\\w\"'@#$.\\s+]+","g");let he=new RegExp("\\${([^}]*)}","g"),ce=/^\..*/gm,de=/\\/gi,pe=/\\\\/gi;const ue=new RegExp("[\\w\"'@#$.\\s+]+","g"),ge=/\window\./gm;function me(e,t,i,n,r){return!t||se.test(e)||-1!==n.indexOf(e.split(".")[0])||r?e:i+"."+e}function fe(e,t,i,n){return t&&!se.test(e)&&-1===n.indexOf(e.split(".")[0])?i+'["'+e:e}function ye(e){return e.match(pe)?e:e.replace(de,"\\\\")}function be(e,t,i,n){if(e=e.trim(),/\window\./gm.test(e))return e;{let r=/'|"/gm;return/\@|\$|\#/gm.test(e)&&(e=fe(e,-1===i.indexOf(e),t,i)+'"]'),ce.test(e)?function(e,t,i,n){return!t||se.test(e)||-1!==n.indexOf(e.split(".")[0])||/^\..*/gm.test(e)?e:i+"."+e}(e,!r.test(e)&&-1===i.indexOf(e),t,i):me(e,!r.test(e)&&-1===i.indexOf(e),t,i,n)}}const ve=/^[\n\r.]+\<tr|^\<tr/,we=/^[\n\r.]+\<svg|^\<path|^\<g/;function xe(){return"-"+Math.random().toString(36).substr(2,5)}function Se(e,t,i){let n=Pe.compile(e,t,i);return(e,t,i,r,s,o,a)=>{let l=n(e,t,i,a);return"string"==typeof l?we.test(l)?Ue("svg",{innerHTML:l}).childNodes:Ue(ve.test(l)?"table":"div",{innerHTML:l}).childNodes:l}}function Ce(e,t,i){let n=document.getElementById(e);if(n){let e=n.getElementsByClassName("blazor-inner-template");for(let t=0;t<e.length;t++){let n=" ";n=d(i)?e[t].getAttribute("data-templateId"):e[i].getAttribute("data-templateId");let r=document.getElementById(n);if(r){let n=r.childNodes.length;for(let s=0;s<n;s++)d(i)?e[t].appendChild(r.childNodes[0]):(e[i].appendChild(r.childNodes[0]),t=e.length)}}}}let Pe={compile:(new class{compile(e,t={},i){return function(e,t,i){let n="data",r=function(e,t,i,n){let r=0,s=[],o=e.match(/class="([^\"]+|)\s{2}/g),a="";return o&&o.forEach(t=>{a=t.replace(/\s\s+/g," "),e=e.replace(t,a)}),e.replace(Q,"").replace(ae,"'$1'").replace(he,(e,o,a,l)=>{let h=o.match(re);if(h){let e=h[1];if(ee.test(o))o='";} '+o.replace(h[1],e.replace(oe,e=>me(e=e.trim(),!J.test(e)&&-1===s.indexOf(e),t,s,n)))+'{ \n str = str + "';else if(K.test(o))o='"; '+o.replace(h[1],e.replace(le,e=>be(e,t,s,n)))+'{ \n str = str + "';else if(ie.test(o)){let e=h[1].split(" of ");o='"; '+o.replace(h[1],i=>(s.push(e[0]),s.push(e[0]+"Index"),r+=1,"var i"+r+"=0; i"+r+" < "+me(e[1],!0,t,s,n)+".length; i"+r+"++"))+"{ \n "+e[0]+"= "+me(e[1],!0,t,s,n)+"[i"+r+"]; \n var "+e[0]+"Index=i"+r+'; \n str = str + "'}else{let r=o.split("("),a=i&&i.hasOwnProperty(r[0])?"this.":"global";a=/\./.test(r[0])?"":a;let l=h[1].split(",");0===h[1].length||/data/.test(l[0])||/window./.test(l[0])||(h[1]="global"===a?"data."+h[1]:h[1]);let c=/\@|\$|\#/gm,d=/\]\./gm;ge.test(o)&&d.test(o)||c.test(o)?/\@|\$|\#|\]\./gm.test(o)&&(o='"+ '+("global"===a?"":a)+o.replace(h[1],e.replace(ue,e=>be(e,t,s,n)))+'+ "'):o='" + '+("global"===a?"":a)+o.replace(e,me(h[1].replace(/,( |)data.|,/gi,",data.").replace(/,( |)data.window/gi,",window"),"global"!==a,t,s,n))+'+"'}}else te.test(o)?o='"; '+o.replace(te,'} else { \n str = str + "'):o.match(ne)?o=o.replace(ne,'"; \n } \n str = str + "'):/\@|\#|\$/gm.test(o)?(o.match(de)&&(o=ye(o)),o='"+'+fe(o,-1===s.indexOf(o),t,s)+'"]+"'):o=o.match(de)?'"+'+fe(o=ye(o),-1===s.indexOf(o),t,s)+'"]+"':'"+'+me(o.replace(/\,/gi,"+data."),-1===s.indexOf(o),t,s,n)+'+"';return o})}(e,n,t,void 0);return new Function(n,'var str="'+r+"\";var valueRegEx = (/value=\\'([A-Za-z0-9 _]*)((.)([\\w)(!-;?-\u25a0\\s]+)['])/g);\n    var hrefRegex = (/(?:href)([\\s='\"./]+)([\\w-./?=&\\\\#\"]+)((.)([\\w)(!-;/?-\u25a0\\s]+)['])/g);\n    if(str.match(valueRegEx)){\n        var check = str.match(valueRegEx);\n        var str1 = str;\n        for (var i=0; i < check.length; i++) {\n            var check1 = str.match(valueRegEx)[i].split('value=')[1];\n            var change = check1.match(/^'/) !== null ? check1.replace(/^'/, '\"') : check1;\n            change =change.match(/.$/)[0] === '\\'' ? change.replace(/.$/,'\"') : change;\n            str1 = str1.replace(check1, change);\n        }\n        str = str.replace(str, str1);\n    }\n    else if(str.match(hrefRegex)) {\n        var check = str.match(hrefRegex);\n        var str1 = str;\n        for (var i=0; i < check.length; i++) {\n            var check1 = str.match(hrefRegex)[i].split('href=')[1];\n            var change = check1.match(/^'/) !== null ? check1.replace(/^'/, '\"') : check1;\n            change =change.match(/.$/)[0] === '\\'' ? change.replace(/.$/,'\"') : change;\n            str1 = str1.replace(check1, change);\n        }\n        str = str.replace(str, str1);\n    }\n     return str;").bind(t)}(e,t)}}).compile};const Oe=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Te=/(?:#([\w-]+)|(\w+)|\.([\w-]+))/g,Ee=/^(\.|#)/,Ae={".":"className","#":"id"},Ie={className:"attributes.className",id:"attributes.id",tagName:"tagName"},De=["area","base","basefont","br","col","frame","hr","img","input","link","meta","param","embed","command","keygen","source","track","wbr"],Re=["a","address","article","applet","aside","audio","blockquote","button","canvas","center","dd","del","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frameset","h1","h2","h3","h4","h5","h6","header","hgroup","hr","iframe","ins","isindex","li","map","menu","noframes","noscript","object","ol","output","p","pre","section","script","table","tbody","td","tfoot","th","thead","tr","ul","video"],Le=["abbr","acronym","applet","b","basefont","bdo","big","br","button","cite","code","del","dfn","em","font","i","iframe","img","input","ins","kbd","label","map","object","q","s","samp","script","select","small","span","strike","strong","sub","sup","textarea","tt","u","var"],ze=["colgroup","dd","dt","li","options","p","td","tfoot","th","thead","tr"],Me=["checked","compact","declare","defer","disabled","ismap","multiple","nohref","noresize","noshade","nowrap","readonly","selected"],ke=["Script","style"],je={tabindex:"tabIndex"},He=/^<([-A-Za-z0-9_]+)((?:\s+[a-zA-Z_:][-a-zA-Z0-9_:.]*(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,Ne=/^<\/([-A-Za-z0-9_]+)[^>]*>/,_e=/([a-zA-Z_:][-a-zA-Z0-9_:.]*)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g;var Be;!function(e){function t(e,t){t&&e&&e.forEach(e=>(l(e)&&(e.parent&&i(e),e.parent=t),e))}function i(e){let t=e.parent;if(t){let i=t.children.indexOf(e);-1!==i&&t.children.splice(i)}return t}function n(e,t){let i=e.match(Ee),n={};if(i){let r=Ae[i[0]];if("className"===r){let i=t.filter(e=>e.hasOwnProperty("className"))[0],n=!1;i||(n=!0,i={}),i[r]=(i[r]||"")+"(?=.*?\\b{value}\\b)".replace("{value}",e.replace(".","")),n&&t.push(i)}else n[r]=e.replace(i[0],""),t.push(n)}else t.push({tagName:e})}function r(e,t,i,n){if(e.children){let s=e.children.filter(function(e){if("string"!=typeof e){let i=!0;for(let n of t){let t=Object.keys(n)[0],r=n[t],s=o(Ie[t],e);if("className"===t){if(!new RegExp("^"+r+".*$").test(s)){i=!1;break}}else if(s!==r){i=!1;break}}return i}return!1});return n||s.length&&!i||e.children.forEach(e=>{l(e)&&(s=s.concat(r(e,t,i)))}),s}return[]}function s(e){let t,i=[],n=[],r=[];for(;e;){t=!0;let i=a(n);if(i&&h(ke,i))e=e.replace(new RegExp("([\\s\\S]*?)</"+a(r)+"[^>]*>"),(e,t)=>(l(t=t.replace(/<!--([\s\S]*?)-->|<!\[CDATA\[([\s\S]*?)]]>/g,"$1$2")),"")),o(0,a(n));else{if(0===e.indexOf("</")){let i=e.match(Ne);i&&(e=e.substring(i[0].length),i[0].replace(Ne,o)),t=!1}else if(0===e.indexOf("<")){let i=e.match(He);i&&(e=e.substring(i[0].length),i[0].replace(He,s)),t=!1}if(t){let t=e.indexOf("<"),i=t<0?e:e.substring(0,t);e=t<0?"":e.substring(t),l(i)}}}function s(e,t,s){if(t=t.toLowerCase(),h(Re,t))for(;a(n)&&h(Le,a(n));)o(0,a(n));h(ze,t)&&a(n)&&o(0,t);let l=h(De,t);l||n.push(t);let c={};s.replace(_e,function(e,t,...i){let n=i[2]?i[2]:i[3]?i[3]:i[4]?i[4]:h(Me,t)?t:"";if("style"===t){let e=n.split(";"),t={};for(let i=0,n=e.length;i<n;i++){let n=e[i].split(":");t[n[0]]=n[1]}n=t}c[t=je[t]||t]=n}),c["data-id"]=xe();let d={tagName:t,attributes:c};if(l){let e=r[0]||i;void 0===e.children&&(e.children=[]),d.parent=e,e.children.push(d)}else r.unshift(d)}function o(e,t){let s;if(t)for(s=n.length-1;s>=0&&n[s]!==t;s--);else s=0;if(s>=0){for(let e=r.length-1;e>=s;e--){let e=r.shift();if(0===r.length)i.push(e);else{let t=r[0];void 0===t.children&&(t.children=[]),e.parent=t,t.children.push(e)}}n.length=s}}function l(e){if(0===r.length)i.push(e);else{let t=r[0];void 0===t.children&&(t.children=[]),t.children.push(e)}}return i}function a(e){return e[e.length-1]}function h(e,t){return-1!==e.indexOf(t)}e.createElement=function(e,t){let i=[],n=c({},{},t,!0);if(!d(t)&&Object.keys(t).length&&(n.innerHTML&&(i=s(n.innerHTML),delete n.innerHTML),n.attrs&&(c(n,n.attrs),delete n.attrs),n.styles)){let e=n.styles.split(";"),t={};for(let i=0,n=e.length;i<n;i++){let n=e[i].split(":");t[n[0]]=n[1]}delete n.styles,n.style=t}return{tagName:e,attributes:n||{},children:i}},e.assignParent=t,e.append=function(e,i){t(e,i),i.children=i.children?i.children.concat(e):[].concat(e)},e.prepend=function(e,i){if(t(e,i),i.children&&i.children.length)for(let t=e.length-1;t>=0;t--)i.children.unshift(e[t]);else i.children=[],i.children.concat(e)},e.detach=i,e.vDomSelector=function e({ele:t,selector:i,selectAll:s,immediateParent:o}){let a=i.split(" "),l=t;for(let h=0,c=a.length;h<c;h++){let i=!1,c=l,d=a[h],p=[];if(Oe.test(d))n(d,p);else if(-1===d.indexOf(">")){let e=d.match(Te);for(let t of e)n(t,p)}else if(-1!==d.indexOf(">")){i=!0;let n,r=d.split(">"),o=t,a=0;for(let t of r){if(!o)break;if(o.length){let i=[];for(let n of o)i=i.concat(e({ele:n,selector:t,selectAll:s,immediateParent:!!a}));n=i}else n=e({ele:o,selector:t,selectAll:s,immediateParent:!!a});a++,o=n}n&&(l=n)}if(!i)if(c.length){let e=[];for(let t of c)e=e.concat(r(t,p,s,o));l=e}else l=r(c,p,s,o)}return s?l:l[0]||null},e.accessElement=r,e.ConvertHTMLToJSon=s,e.cloneNode=function(e,t){return l(e)?t?c({},{},e,!0):{tagName:e.tagName,attributes:e.attributes}:e.cloneNode(t)},e.setStyleAttribute=function(e,t){e.attributes.style=c(e.attributes.style?{}:e.attributes.style,t)}}(Be||(Be={}));const We=/^svg|^path|^g/;function Ue(e,t){let i=We.test(e)?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return void 0===t||(i.innerHTML=t.innerHTML?t.innerHTML:"",void 0!==t.className&&(i.className=t.className),void 0!==t.id&&(i.id=t.id),void 0!==t.styles&&i.setAttribute("style",t.styles),void 0!==t.attrs&&Je(i,t.attrs)),i}function Fe(e,t){let i=Xe(t);for(let n of e)for(let e of i)if(l(n)){let t=o("attributes.className",n);d(t)?a("attributes.className",e,n):new RegExp("\\b"+e+"\\b","i").test(t)||a("attributes.className",t+" "+e,n)}else n.classList.contains(e)||n.classList.add(e);return e}function Ve(e,t){let i=Xe(t);for(let n of e){let e=l(n);if(e?o("attributes.className",n):""!==n.className)for(let t of i)if(e){let e=o("attributes.className",n).split(" "),i=e.indexOf(t);-1!==i&&e.splice(i,1),a("attributes.className",e.join(" "),n)}else n.classList.remove(t)}return e}function Xe(e){let t=[];return"string"==typeof e?t.push(e):t=e,t}function Ye(e){return""===e.style.visibility&&e.offsetWidth>0}function Ge(e,t,i){if(l(t))Be.prepend(e,t);else{let n=document.createDocumentFragment();for(let t of e)n.appendChild(t);t.insertBefore(n,t.firstElementChild),i&&Ze(t)}return e}function qe(e,t,i){if(l(t))Be.append(e,t);else{let n=document.createDocumentFragment();for(let t of e)n.appendChild(t);t.appendChild(n),i&&Ze(t)}return e}function Ze(e){e.querySelectorAll("script").forEach(e=>{let t=document.createElement("script");t.text=e.innerHTML,document.head.appendChild(t),$e(t)})}function $e(e){if(l(e))return Be.detach(e);{let t=e.parentNode;if(t)return t.removeChild(e)}}function Qe(e){if(l(e))Be.detach(e);else{let t=e.parentNode;$.clearEvents(e),t.removeChild(e)}}function Je(e,t){let i=Object.keys(t),n=e;for(let r of i)if(l(n)){let e=r;"tabindex"===r&&(e="tabIndex"),n.attributes[e]=t[r]}else n.setAttribute(r,t[r]);return n}function Ke(e,t=document,i){return l(t)&&i?Be.vDomSelector({ele:t,selector:e,selectAll:!1}):(e=tt(e),t.querySelector(e))}function et(e,t=document,i){return l(t)&&!i?Be.vDomSelector({ele:t,selector:e,selectAll:!0}):(e=tt(e),t.querySelectorAll(e))}function tt(e){const t=/(!|"|\$|%|&|'|\(|\)|\*|\/|:|;|<|=|\?|@|\]|\^|`|{|}|\||\+|~)/g;if(e.match(/#[0-9]/g)||e.match(t)){let i=e.split(",");for(let e=0;e<i.length;e++){let n=i[e].split(" ");for(let e=0;e<n.length;e++)if(n[e].indexOf("#")>-1&&!n[e].match(/\[.*\]/)){let i=n[e].split("#");if(i[1].match(/^\d/)||i[1].match(t)){let t=n[e].split(".");t[0]=t[0].replace(/#/,"[id='")+"']",n[e]=t.join(".")}}i[e]=n.join(" ")}return i.join(",")}return e}function it(e,t){let i=e;if("function"==typeof i.closest)return i.closest(t);for(;i&&1===i.nodeType;){if(rt(i,t))return i;i=i.parentNode}return null}function nt(e,t){void 0!==t&&(l(e)?Be.setStyleAttribute(e,t):Object.keys(t).forEach(i=>{e.style[i]=t[i]}))}function rt(e,t){let i=e.matches||e.msMatchesSelector||e.webkitMatchesSelector;return i?i.call(e,t):-1!==[].indexOf.call(document.querySelectorAll(t),e)}const st=new RegExp("]");class ot{constructor(e,t){this.isRendered=!1,this.isComplexArraySetter=!1,this.isServerRendered=!1,this.allowServerDataBinding=!0,this.isProtectedOnChange=!0,this.properties={},this.changedProperties={},this.oldProperties={},this.bulkChanges={},this.refreshing=!1,this.ignoreCollectionWatch=!1,this.finalUpdate=()=>{},this.childChangedProperties={},this.modelObserver=new L(this),p(t)||(this.element="string"==typeof t?document.querySelector(t):t,d(this.element)||(this.isProtectedOnChange=!1,this.addInstance())),p(e)||this.setProperties(e,!0),this.isDestroyed=!1}setProperties(e,t){let i=this.isProtectedOnChange;this.isProtectedOnChange=!!t,h(this,e),!0!==t&&(h(this.changedProperties,e),this.dataBind()),this.finalUpdate(),this.changedProperties={},this.oldProperties={},this.isProtectedOnChange=i}static callChildDataBind(e,t){let i=Object.keys(e);for(let n of i)if(t[n]instanceof Array)for(let e of t[n])void 0!==e.dataBind&&e.dataBind();else t[n].dataBind()}clearChanges(){this.finalUpdate(),this.changedProperties={},this.oldProperties={},this.childChangedProperties={}}dataBind(){if(ot.callChildDataBind(this.childChangedProperties,this),Object.getOwnPropertyNames(this.changedProperties).length){let e=this.isProtectedOnChange,t=this.changedProperties,i=this.oldProperties;this.clearChanges(),this.isProtectedOnChange=!0,this.onPropertyChanged(t,i),this.isProtectedOnChange=e}}serverDataBind(e){}saveChanges(e,t,i){this.isProtectedOnChange||(this.oldProperties[e]=i,this.changedProperties[e]=t,this.finalUpdate(),this.finalUpdate=function(e){let t,i=new Uint16Array(5);(window.msCrypto||window.crypto).getRandomValues(i);let n="ej2"+function(e){let t="";for(let i=0;i<5;i++)t+=(i?",":"")+e[i];return t}(i),r=i=>{i.source===window&&"string"==typeof i.data&&i.data.length<=32&&i.data===n&&(e(),t())};return window.addEventListener("message",r,!1),window.postMessage(n,"*"),t=()=>{window.removeEventListener("message",r),e=r=n=void 0}}(this.dataBind.bind(this)))}addEventListener(e,t){this.modelObserver.on(e,t)}removeEventListener(e,t){this.modelObserver.off(e,t)}trigger(e,t,i,n){if(!0!==this.isDestroyed){let r=this.isProtectedOnChange;this.isProtectedOnChange=!1;let s=this.modelObserver.notify(e,t,i,n);if(st.test(e)){let r=o(e,this);if(r)if(window.Blazor){let e=r.call(this,t);e&&"function"==typeof e.then?i?e.then(e=>{i&&(e="string"==typeof e&&this.modelObserver.isJson(e)?JSON.parse(e):e,i.call(this,e))}).catch(e=>{n&&(e="string"==typeof e&&this.modelObserver.isJson(e)?JSON.parse(e):e,n.call(this,e))}):s=e:i&&i.call(this,t)}else r.call(this,t),i&&i.call(this,t);else i&&i.call(this,t)}return this.isProtectedOnChange=r,s}}addInstance(){let e="e-"+this.getModuleName().toLowerCase();Fe([this.element],["e-lib",e]),d(this.element.ej2_instances)?a("ej2_instances",[this],this.element):this.element.ej2_instances.push(this)}destroy(){this.element.ej2_instances=this.element.ej2_instances.filter(e=>e!==this),Ve([this.element],["e-"+this.getModuleName()]),0===this.element.ej2_instances.length&&Ve([this.element],["e-lib"]),this.clearChanges(),this.modelObserver.destroy(),this.isDestroyed=!0}}function at(e,t,i,n){return e.properties.hasOwnProperty(t)&&e.properties[t]instanceof n||(e.properties[t]=s(n,[e,t,i])),e.properties[t]}function lt(e,t,i,n,r,o){let a=[],l=i?i.length:0;for(let h=0;h<l;h++){let l=n;if(o&&(l=n(i[h],e)),r){let n=s(l,[e,t,{},!0]);n.setProperties(i[h],!0),a.push(n)}else a.push(s(l,[e,t,i[h],!1]))}return a}function ht(e,t){return function(){return this.properties.hasOwnProperty(t)||(this.properties[t]=e),this.properties[t]}}function ct(e,t){return function(i){if(this.properties[t]!==i){let n=this.properties.hasOwnProperty(t)?this.properties[t]:e;this.saveChanges(t,i,n),this.properties[t]=i}}}function dt(e,t,i){return function(){return at(this,t,e,i)}}function pt(e,t,i){return function(n){at(this,t,e,i).setProperties(n)}}function ut(e,t,i){return function(){let n=i({});return this.properties.hasOwnProperty(t)?this.properties[t]:at(this,t,e,n)}}function gt(e,t,i){return function(n){let r=i(n,this);at(this,t,e,r).setProperties(n)}}function mt(e,t,i){return function(){if(!this.properties.hasOwnProperty(t)){let n=lt(this,t,e,i,!1);this.properties[t]=n}let n=void 0!==this.controlParent&&this.controlParent.ignoreCollectionWatch||this.ignoreCollectionWatch;return this.properties[t].hasOwnProperty("push")||n||["push","pop"].forEach(e=>{let i={value:vt(e,t,0,this.properties[t]).bind(this),configurable:!0};Object.defineProperty(this.properties[t],e,i)}),this.properties[t].hasOwnProperty("isComplexArray")||Object.defineProperty(this.properties[t],"isComplexArray",{value:!0}),this.properties[t]}}function ft(e,t,i){return function(n){this.isComplexArraySetter=!0;let r=lt(this,t,e,i,!1),s=lt(this,t,n,i,!0);this.isComplexArraySetter=!1,this.saveChanges(t,s,r),this.properties[t]=s}}function yt(e,t,i){return function(n){let r=this.properties.hasOwnProperty(t)?this.properties[t]:e,s=lt(this,t,n,i,!0,!0);this.saveChanges(t,s,r),this.properties[t]=s}}function bt(e,t,i){return function(){let n=i({});if(!this.properties.hasOwnProperty(t)){let i=lt(this,t,e,n,!1);this.properties[t]=i}return this.properties[t]}}function vt(e,t,i,n){return function(...i){let r=this.propName?this.getParentKey()+"."+t+"-":t+"-";switch(e){case"push":for(let s=0;s<i.length;s++){Array.prototype[e].apply(n,[i[s]]);let t=wt(r+(n.length-1),i[s],!this.controlParent,e);this.serverDataBind(t,i[s],!1,e)}break;case"pop":Array.prototype[e].apply(n);let t=wt(r+n.length,null,!this.controlParent,e);this.serverDataBind(t,{ejsAction:"pop"},!1,e)}return n}}function wt(e,t,i,n){let r=e;return i&&(r={},r[e]=t,t&&"object"==typeof t)&&(r[e].ejsAction=n),r}function xt(e){return(t,i)=>{let n={set:ct(e,i),get:ht(e,i),enumerable:!0,configurable:!0};Object.defineProperty(t,i,n),Et(t,i,"prop",e)}}function St(e,t){return(i,n)=>{let r={set:pt(e,n,t),get:dt(e,n,t),enumerable:!0,configurable:!0};Object.defineProperty(i,n,r),Et(i,n,"complexProp",e,t)}}function Ct(e){return(t,i)=>{let n={set:gt({},i,e),get:ut({},i,e),enumerable:!0,configurable:!0};Object.defineProperty(t,i,n),Et(t,i,"complexProp",{},e)}}function Pt(e,t){return(i,n)=>{let r={set:ft(e,n,t),get:mt(e,n,t),enumerable:!0,configurable:!0};Object.defineProperty(i,n,r),Et(i,n,"colProp",e,t)}}function Ot(){return(e,t)=>{let i={set:function(e){let i=this.properties[t];if(i!==e){let n=At(this,t);!1===p(i)&&n.context.removeEventListener(n.prefix,i),n.context.addEventListener(n.prefix,e),this.properties[t]=e}},get:ht(void 0,t),enumerable:!0,configurable:!0};Object.defineProperty(e,t,i),Et(e,t,"event")}}function Tt(e){}function Et(e,t,i,n,r){p(e.propList)&&(e.propList={props:[],complexProps:[],colProps:[],events:[],propNames:[],complexPropNames:[],colPropNames:[],eventNames:[]}),e.propList[i+"s"].push({propertyName:t,defaultValue:n,type:r}),e.propList[i+"Names"].push(t)}function At(e,t){if(!1===e.hasOwnProperty("parentObj"))return{context:e,prefix:t};{let i=o("propName",e);return i&&(t=i+"-"+t),At(o("parentObj",e),t)}}var It,Dt=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Rt=(()=>{let e=It=class extends ot{constructor(e){super(e,void 0),this.easing={ease:"cubic-bezier(0.250, 0.100, 0.250, 1.000)",linear:"cubic-bezier(0.250, 0.250, 0.750, 0.750)",easeIn:"cubic-bezier(0.420, 0.000, 1.000, 1.000)",easeOut:"cubic-bezier(0.000, 0.000, 0.580, 1.000)",easeInOut:"cubic-bezier(0.420, 0.000, 0.580, 1.000)",elasticInOut:"cubic-bezier(0.5,-0.58,0.38,1.81)",elasticIn:"cubic-bezier(0.17,0.67,0.59,1.81)",elasticOut:"cubic-bezier(0.7,-0.75,0.99,1.01)"}}animate(e,t){let i=this.getModel(t=t||{});if("string"==typeof e){let t=Array.prototype.slice.call(et(e,document));for(let e of t)i.element=e,It.delayAnimation(i)}else i.element=e,It.delayAnimation(i)}static stop(e,t){e.style.animation="",e.removeAttribute("e-animate");let i=e.getAttribute("e-animation-id");if(i){let t=parseInt(i,10);cancelAnimationFrame(t),e.removeAttribute("e-animation-id")}t&&t.end&&t.end.call(this,t)}static delayAnimation(e){e.delay?setTimeout(()=>{It.applyAnimation(e)},e.delay):It.applyAnimation(e)}static applyAnimation(e){e.timeStamp=0;let t=0,i=0,n=0,r=0,s=e.duration;e.element.setAttribute("e-animate","true");let o=a=>{try{if(a){r=0===r?a:r,e.timeStamp=a+e.timeStamp-r,r=a,!t&&e.begin&&e.begin.call(this,e),t+=1;let n=e.timeStamp/t;e.timeStamp<s&&e.timeStamp+n<s&&e.element.getAttribute("e-animate")?(e.element.style.animation=e.name+" "+e.duration+"ms "+e.timingFunction,e.progress&&e.progress.call(this,e),requestAnimationFrame(o)):(cancelAnimationFrame(i),e.element.removeAttribute("e-animation-id"),e.element.removeAttribute("e-animate"),e.element.style.animation="",e.end&&e.end.call(this,e))}else n=performance.now(),i=requestAnimationFrame(o),e.element.setAttribute("e-animation-id",i.toString())}catch(l){cancelAnimationFrame(i),e.element.removeAttribute("e-animation-id"),e.fail&&e.fail.call(this,l)}};o()}getModel(e){return{name:e.name||this.name,delay:e.delay||this.delay,duration:void 0!==e.duration?e.duration:this.duration,begin:e.begin||this.begin,end:e.end||this.end,fail:e.fail||this.fail,progress:e.progress||this.progress,timingFunction:this.easing[e.timingFunction]?this.easing[e.timingFunction]:e.timingFunction||this.easing[this.timingFunction]}}onPropertyChanged(e,t){}getModuleName(){return"animation"}destroy(){}};return Dt([xt("FadeIn")],e.prototype,"name",void 0),Dt([xt(400)],e.prototype,"duration",void 0),Dt([xt("ease")],e.prototype,"timingFunction",void 0),Dt([xt(0)],e.prototype,"delay",void 0),Dt([Ot()],e.prototype,"progress",void 0),Dt([Ot()],e.prototype,"begin",void 0),Dt([Ot()],e.prototype,"end",void 0),Dt([Ot()],e.prototype,"fail",void 0),e=It=Dt([Tt],e),e})();function Lt(e){let t=e.target,i=this.rippleOptions.selector,n=i?it(t,i):t;if(!n||this.rippleOptions&&it(t,this.rippleOptions.ignore))return;let r=n.getBoundingClientRect(),s=e.pageX-document.body.scrollLeft,o=e.pageY-(!document.body.scrollTop&&document.documentElement?document.documentElement.scrollTop:document.body.scrollTop),a=Math.max(Math.abs(s-r.left),Math.abs(s-r.right)),l=Math.max(Math.abs(o-r.top),Math.abs(o-r.bottom)),h=Math.sqrt(a*a+l*l),c=2*h+"px",d=s-r.left-h,p=o-r.top-h;this.rippleOptions&&this.rippleOptions.isCenterRipple&&(d=0,p=0,c="100%"),n.classList.add("e-ripple");let u=Ue("div",{className:"e-ripple-element",styles:"width: "+c+";height: "+c+";left: "+d+"px;top: "+p+"px;transition-duration: "+this.rippleOptions.duration.toString()+"ms;"});n.appendChild(u),window.getComputedStyle(u).getPropertyValue("opacity"),u.style.transform="scale(1)",n!==this.parent&&$.add(n,"mouseleave",Mt,{parent:this.parent,rippleOptions:this.rippleOptions})}function zt(e){kt(e,this)}function Mt(e){kt(e,this)}function kt(e,t){let i=t.rippleOptions.duration,n=e.target,r=t.rippleOptions.selector,s=r?it(n,r):n;if(!s||s&&-1===s.className.indexOf("e-ripple"))return;let o=et(".e-ripple-element",s),a=o[o.length-1];a&&(a.style.opacity="0.5"),t.parent!==s&&$.remove(s,"mouseleave",Mt),setTimeout(()=>{a&&a.parentNode&&a.parentNode.removeChild(a),s.getElementsByClassName("e-ripple-element").length||s.classList.remove("e-ripple"),t.done&&t.done(e)},i)}class jt{constructor(e){this.loadedModules=[],this.parent=e}inject(e,t){let i=e.length;if(0!==i){this.loadedModules.length&&this.clearUnusedModule(e);for(let n=0;n<i;n++){let i=e[n];for(let e of t){let t=i.member;if(e.prototype.getModuleName()===i.member&&!this.isModuleLoaded(t)){let n=s(e,i.args),r=this.getMemberName(t);a(r,i.isProperty?e:n,this.parent);let o=i;o.member=r,this.loadedModules.push(o)}}}}else this.clean()}clean(){for(let e of this.loadedModules)e.isProperty||o(e.member,this.parent).destroy();this.loadedModules=[]}clearUnusedModule(e){let t=e.map(e=>this.getMemberName(e.member)),i=this.loadedModules.filter(e=>-1===t.indexOf(e.member));for(let n of i)n.isProperty||o(n.member,this.parent).destroy(),this.loadedModules.splice(this.loadedModules.indexOf(n),1),delete this.parent[n.member]}getMemberName(e){return e[0].toLowerCase()+e.substring(1)+"Module"}isModuleLoaded(e){for(let t of this.loadedModules)if(t.member===this.getMemberName(e))return!0;return!1}}class Ht{constructor(e,t,i,n){this.isComplexArraySetter=!1,this.properties={},this.changedProperties={},this.childChangedProperties={},this.oldProperties={},this.finalUpdate=()=>{},this.callChildDataBind=o("callChildDataBind",ot),this.parentObj=e,this.controlParent=this.parentObj.controlParent||this.parentObj,this.propName=t,this.isParentArray=n,this.setProperties(i,!0)}updateChange(e,t){!0===e?this.parentObj.childChangedProperties[t]=e:delete this.parentObj.childChangedProperties[t],this.parentObj.updateChange&&this.parentObj.updateChange(e,this.parentObj.propName)}updateTimeOut(){if(this.parentObj.updateTimeOut)this.parentObj.finalUpdate(),this.parentObj.updateTimeOut();else{let e=setTimeout(this.parentObj.dataBind.bind(this.parentObj));this.finalUpdate=()=>{clearTimeout(e)}}}clearChanges(){this.finalUpdate(),this.updateChange(!1,this.propName),this.oldProperties={},this.changedProperties={}}setProperties(e,t){!0===t?(h(this,e),this.updateChange(!1,this.propName),this.clearChanges()):h(this,e)}dataBind(){if(this.callChildDataBind(this.childChangedProperties,this),this.isParentArray){let e=this.parentObj[this.propName].indexOf(this);Object.keys(this.changedProperties).length&&(a(this.propName+"."+e,this.changedProperties,this.parentObj.changedProperties),a(this.propName+"."+e,this.oldProperties,this.parentObj.oldProperties))}else this.parentObj.changedProperties[this.propName]=this.changedProperties,this.parentObj.oldProperties[this.propName]=this.oldProperties;this.clearChanges()}saveChanges(e,t,i,n){this.controlParent.isProtectedOnChange||(n||this.serverDataBind(e,t,!0),this.oldProperties[e]=i,this.changedProperties[e]=t,this.updateChange(!0,this.propName),this.finalUpdate(),this.updateTimeOut())}serverDataBind(e,t,i,n){}getParentKey(e){let t="",i=this.propName;if(this.isParentArray){t=this.parentObj[this.propName].indexOf(this);let n=this.parentObj[this.propName].length;n=e?n:n>0?n-1:0,t=-1!==t?"-"+t:"-"+n,i+=t}return this.controlParent!==this.parentObj&&(i=this.parentObj.getParentKey()+"."+this.propName+t),i}}var Nt=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let _t,Bt=0,Wt=0,Ut=(()=>{let e=class extends ot{constructor(e,t){super(e,t),this.randomId=function(){if("undefined"==typeof window)return;let e=new Uint16Array(5);return(window.msCrypto||window.crypto).getRandomValues(e)}(),this.isStringTemplate=!1,this.needsID=!1,this.isReactHybrid=!1,d(this.enableRtl)&&this.setProperties({enableRtl:!1},!0),d(this.locale)&&this.setProperties({locale:M},!0),this.moduleLoader=new jt(this),this.localObserver=new L(this),z.on("notifyExternalChange",this.detectFunction,this,this.randomId),p(t)||this.appendTo()}requiredModules(){return[]}destroy(){this.isDestroyed||(this.enablePersistence&&this.setPersistData(),this.localObserver.destroy(),this.refreshing||(Ve([this.element],["e-control"]),this.trigger("destroyed",{cancel:!1}),super.destroy(),this.moduleLoader.clean(),z.off("notifyExternalChange",this.detectFunction,this.randomId)))}refresh(){this.refreshing=!0,this.moduleLoader.clean(),this.destroy(),this.clearChanges(),this.localObserver=new L(this),this.preRender(),this.injectModules(),this.render(),this.refreshing=!1}accessMount(){this.mount&&!this.isReactHybrid&&this.mount()}getRootElement(){return this.isReactHybrid?this.actualElement:this.element}getLocalData(){let e=this.getModuleName()+this.element.id;return window.localStorage.getItem(e)}appendTo(e){if(d(e)||"string"!=typeof e?d(e)||(this.element=e):this.element=Ke(e,document),!d(this.element)){let e="e-"+this.getModuleName().toLowerCase();Fe([this.element],["e-control",e]),this.isProtectedOnChange=!1,this.needsID&&!this.element.id&&(this.element.id=this.getUniqueID(this.getModuleName())),this.enablePersistence&&(this.mergePersistData(),window.addEventListener("unload",this.setPersistData.bind(this)));let t=o("ej2_instances",this.element);t&&-1!==t.indexOf(this)||super.addInstance(),this.preRender(),this.injectModules(),this.render(),this.mount?this.accessMount():this.trigger("created")}}renderComplete(e){this.isRendered=!0}dataBind(){this.injectModules(),super.dataBind()}on(e,t,i){if("string"==typeof e)this.localObserver.on(e,t,i);else for(let n of e)this.localObserver.on(n.event,n.handler,n.context)}off(e,t){if("string"==typeof e)this.localObserver.off(e,t);else for(let i of e)this.localObserver.off(i.event,i.handler)}notify(e,t){!0!==this.isDestroyed&&this.localObserver.notify(e,t)}getInjectedModules(){return this.injectedModules}static Inject(...e){this.prototype.injectedModules||(this.prototype.injectedModules=[]);for(let t=0;t<e.length;t++)-1===this.prototype.injectedModules.indexOf(e[t])&&this.prototype.injectedModules.push(e[t])}createElement(e,t,i){return i&&this.isReactHybrid?(t&&(t={}),t["data-id"]=xe(),Be.createElement(e,t)):Ue(e,t)}triggerStateChange(e,t){this.isReactHybrid&&(this.setState(),this.currentContext={calls:e,args:t})}injectModules(){this.injectedModules&&this.injectedModules.length&&this.moduleLoader.inject(this.requiredModules(),this.injectedModules)}detectFunction(e){let t=Object.keys(e);t.length&&(this[t[0]]=e[t[0]])}mergePersistData(){let e;e=window.localStorage.getItem(this.getModuleName()+this.element.id),d(e)||""===e||this.setProperties(JSON.parse(e),!0)}setPersistData(){this.isDestroyed||window.localStorage.setItem(this.getModuleName()+this.element.id,this.getPersistData())}renderReactTemplates(){}clearTemplate(e,t){}getUniqueID(e){return this.isHistoryChanged()&&(Bt=0),_t=this.pageID(location.href),Wt=history.length,e+"_"+_t+"_"+Bt++}pageID(e){let t=0;if(0===e.length)return t;for(let i=0;i<e.length;i++)t=(t<<5)-t+e.charCodeAt(i),t&=t;return Math.abs(t)}isHistoryChanged(){return _t!==this.pageID(location.href)||Wt!==history.length}addOnPersist(e){let t={};for(let i of e){let e;e=o(i,this),p(e)||a(i,this.getActualProperties(e),t)}return JSON.stringify(t,(e,t)=>this.getActualProperties(t))}getActualProperties(e){return e instanceof Ht?o("properties",e):e}ignoreOnPersist(e){return JSON.stringify(this.iterateJsonProperties(this.properties,e))}iterateJsonProperties(e,t){let i={};for(let n of Object.keys(e))if(-1===t.indexOf(n)){let r=e[n];if("object"!=typeof r||r instanceof Array)i[n]=r;else{let e=t.filter(e=>new RegExp(n+".").test(e)).map(e=>e.replace(n+".",""));i[n]=this.iterateJsonProperties(this.getActualProperties(r),e)}}return i}};return Nt([xt(!1)],e.prototype,"enablePersistence",void 0),Nt([xt()],e.prototype,"enableRtl",void 0),Nt([xt()],e.prototype,"locale",void 0),e=Nt([Tt],e),e})();"undefined"!=typeof window&&window.addEventListener("popstate",()=>{Bt=0});var Ft,Vt=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};const Xt={left:0,top:0,bottom:0,right:0},Yt={isDragged:!1};let Gt=(()=>{class e extends Ht{}return Vt([xt(0)],e.prototype,"left",void 0),Vt([xt(0)],e.prototype,"top",void 0),e})(),qt=(()=>{let e=Ft=class extends ot{constructor(e,t){super(t,e),this.dragLimit=Ft.getDefaultPosition(),this.borderWidth=Ft.getDefaultPosition(),this.padding=Ft.getDefaultPosition(),this.diffX=0,this.prevLeft=0,this.prevTop=0,this.dragProcessStarted=!1,this.tapHoldTimer=0,this.enableScrollHandler=!1,this.externalInitialize=!1,this.diffY=0,this.parentScrollX=0,this.parentScrollY=0,this.droppables={},this.bind()}bind(){this.toggleEvents(),Z.isIE&&Fe([this.element],"e-block-touch"),this.droppables[this.scope]={}}static getDefaultPosition(){return c({},Xt)}toggleEvents(e){let t;p(this.handle)||(t=Ke(this.handle,this.element));let i=this.enableTapHold&&Z.isDevice&&Z.isTouch?this.mobileInitialize:this.initialize;e?$.remove(t||this.element,Z.touchStartEvent,i):$.add(t||this.element,Z.touchStartEvent,i,this)}mobileInitialize(e){let t=e.currentTarget;this.tapHoldTimer=setTimeout(()=>{this.externalInitialize=!0,this.removeTapholdTimer(),this.initialize(e,t)},this.tapHoldThreshold),$.add(document,Z.touchMoveEvent,this.removeTapholdTimer,this),$.add(document,Z.touchEndEvent,this.removeTapholdTimer,this)}removeTapholdTimer(){clearTimeout(this.tapHoldTimer),$.remove(document,Z.touchMoveEvent,this.removeTapholdTimer),$.remove(document,Z.touchEndEvent,this.removeTapholdTimer)}getScrollableParent(e,t){return d(e)?null:e[{vertical:"scrollHeight",horizontal:"scrollWidth"}[t]]>e[{vertical:"clientHeight",horizontal:"clientWidth"}[t]]&&("vertical"===t?e.scrollTop>0:e.scrollLeft>0)?("vertical"===t?(this.parentScrollY=this.parentScrollY+(0===this.parentScrollY?e.scrollTop:e.scrollTop-this.parentScrollY),this.tempScrollHeight=e.scrollHeight):(this.parentScrollX=this.parentScrollX+(0===this.parentScrollX?e.scrollLeft:e.scrollLeft-this.parentScrollX),this.tempScrollWidth=e.scrollWidth),d(e)?e:this.getScrollableParent(e.parentNode,t)):this.getScrollableParent(e.parentNode,t)}getScrollableValues(){this.parentScrollX=0,this.parentScrollY=0,this.element.classList.contains("e-dialog")&&this.element.classList.contains("e-dlg-modal"),this.getScrollableParent(this.element.parentNode,"vertical"),this.getScrollableParent(this.element.parentNode,"horizontal")}initialize(e,t){if(this.currentStateTarget=e.target,this.isDragStarted())return;if(this.isDragStarted(!0),this.externalInitialize=!1,this.target=e.currentTarget||t,this.dragProcessStarted=!1,this.abort){let t=this.abort;"string"==typeof t&&(t=[t]);for(let i=0;i<t.length;i++)if(!d(it(e.target,t[i])))return void(this.isDragStarted()&&this.isDragStarted(!0))}this.preventDefault&&!p(e.changedTouches)&&"touchstart"!==e.type&&e.preventDefault(),this.element.setAttribute("aria-grabbed","true");let i=this.getCoordinates(e);if(this.initialPosition={x:i.pageX,y:i.pageY},!this.clone){let t=this.element.getBoundingClientRect();this.getScrollableValues(),e.clientX===e.pageX&&(this.parentScrollX=0),e.clientY===e.pageY&&(this.parentScrollY=0),this.relativeXPosition=i.pageX-(t.left+this.parentScrollX),this.relativeYPosition=i.pageY-(t.top+this.parentScrollY)}this.externalInitialize?this.intDragStart(e):($.add(document,Z.touchMoveEvent,this.intDragStart,this),$.add(document,Z.touchEndEvent,this.intDestroy,this)),this.toggleEvents(!0),"touchstart"!==e.type&&this.isPreventSelect&&document.body.classList.add("e-prevent-select"),this.externalInitialize=!1,$.trigger(document.documentElement,Z.touchStartEvent,e)}intDragStart(e){this.removeTapholdTimer();let t=!p(e.changedTouches);if(t&&1!==e.changedTouches.length)return;t&&e.preventDefault();let i,n=this.getCoordinates(e),r=getComputedStyle(this.element);this.margin={left:parseInt(r.marginLeft,10),top:parseInt(r.marginTop,10),right:parseInt(r.marginRight,10),bottom:parseInt(r.marginBottom,10)};let s=this.element;if(this.clone&&this.dragTarget){let t=it(e.target,this.dragTarget);d(t)||(s=t)}this.isReplaceDragEle&&(s=this.currentStateCheck(e.target,s)),this.offset=this.calculateParentPosition(s),this.position=this.getMousePosition(e,this.isDragScroll);let o=this.initialPosition.x-n.pageX,a=this.initialPosition.y-n.pageY;if(Math.sqrt(o*o+a*a)>=this.distance||this.externalInitialize){let t=this.getHelperElement(e);if(!t||d(t))return;let n=this.helperElement=t;if(this.parentClientRect=this.calculateParentPosition(n.offsetParent),this.dragStart){let t={event:e,element:s,target:this.getProperTargetElement(e),bindEvents:null,dragElement:n};this.trigger("dragStart",t)}this.dragArea?this.setDragArea():(this.dragLimit={left:0,right:0,bottom:0,top:0},this.borderWidth={top:0,left:0}),i={left:this.position.left-this.parentClientRect.left,top:this.position.top-this.parentClientRect.top},this.clone&&!this.enableTailMode&&(this.diffX=this.position.left-this.offset.left,this.diffY=this.position.top-this.offset.top),this.getScrollableValues();let r=getComputedStyle(s),o=parseFloat(r.marginTop);this.clone&&0!==o&&(i.top+=o);let a=this.getProcessedPositionValue({top:i.top-this.diffY+"px",left:i.left-this.diffX+"px"});this.dragElePosition={top:i.top,left:i.left},nt(n,this.getDragPosition({position:"absolute",left:a.left,top:a.top})),$.remove(document,Z.touchMoveEvent,this.intDragStart),$.remove(document,Z.touchEndEvent,this.intDestroy),this.bindDragEvents(n)}}bindDragEvents(e){Ye(e)?($.add(document,Z.touchMoveEvent,this.intDrag,this),$.add(document,Z.touchEndEvent,this.intDragStop,this),this.setGlobalDroppables(!1,this.element,e)):(this.toggleEvents(),document.body.classList.remove("e-prevent-select"))}elementInViewport(e){for(this.top=e.offsetTop,this.left=e.offsetLeft,this.width=e.offsetWidth,this.height=e.offsetHeight;e.offsetParent;)this.top+=(e=e.offsetParent).offsetTop,this.left+=e.offsetLeft;return this.top>=window.pageYOffset&&this.left>=window.pageXOffset&&this.top+this.height<=window.pageYOffset+window.innerHeight&&this.left+this.width<=window.pageXOffset+window.innerWidth}getProcessedPositionValue(e){return this.queryPositionInfo?this.queryPositionInfo(e):e}calculateParentPosition(e){if(d(e))return{left:0,top:0};let t=e.getBoundingClientRect(),i=getComputedStyle(e);return{left:t.left+window.pageXOffset-parseInt(i.marginLeft,10),top:t.top+window.pageYOffset-parseInt(i.marginTop,10)}}intDrag(e){if(!p(e.changedTouches)&&1!==e.changedTouches.length)return;let t,i;this.position=this.getMousePosition(e,this.isDragScroll);let n=this.getDocumentWidthHeight("Height");n<this.position.top&&(this.position.top=n);let r=this.getDocumentWidthHeight("Width");if(r<this.position.left&&(this.position.left=r),this.drag){let t=this.getProperTargetElement(e);this.trigger("drag",{event:e,element:this.element,target:t})}let s=this.checkTargetElement(e);if(s.target&&s.instance){let t=!0;this.hoverObject&&(this.hoverObject.instance!==s.instance?this.triggerOutFunction(e,s):t=!1),t&&(s.instance.dragData[this.scope]=this.droppables[this.scope],s.instance.intOver(e,s.target),this.hoverObject=s)}else this.hoverObject&&this.triggerOutFunction(e,s);let o=this.droppables[this.scope].helper;this.parentClientRect=this.calculateParentPosition(this.helperElement.offsetParent);let a=this.parentClientRect.left,l=this.parentClientRect.top,h=this.getCoordinates(e),c=h.pageX,u=h.pageY,g=this.position.left-this.diffX,m=this.position.top-this.diffY,f=getComputedStyle(o),y=parseFloat(f.marginTop);if(this.dragArea){if(this.pageX!==c||this.skipDistanceCheck){let e=o.offsetWidth+(parseFloat(f.marginLeft)+parseFloat(f.marginRight));t=this.dragLimit.left>g&&g>0?this.dragLimit.left:this.dragLimit.right+window.pageXOffset<g+e&&g>0?g-(g-this.dragLimit.right)+window.pageXOffset-e:g<0?this.dragLimit.left:g}if(this.pageY!==u||this.skipDistanceCheck){let e=o.offsetHeight+(parseFloat(f.marginTop)+parseFloat(f.marginBottom));i=this.dragLimit.top>m&&m>0?this.dragLimit.top:this.dragLimit.bottom+window.pageYOffset<m+e&&m>0?m-(m-this.dragLimit.bottom)+window.pageYOffset-e:m<0?this.dragLimit.top:m}}else t=g,i=m;let b,v,w=l+this.borderWidth.top,x=a+this.borderWidth.left;if(this.dragProcessStarted&&(d(i)&&(i=this.prevTop),d(t)&&(t=this.prevLeft)),this.dragArea){if(this.dragLimit.top=this.clone?this.dragLimit.top:0,b=i-w<0?this.dragLimit.top:i-w,v=t-x<0?this.dragElePosition.left:t-x,y>0&&(this.clone&&(b+=this.element.offsetTop,m<0&&(this.element.offsetTop+m>=0?b=this.element.offsetTop+m:b-=this.element.offsetTop),b=this.dragLimit.bottom<b?this.dragLimit.bottom:b),i-w<0))if(m+y+(o.offsetHeight-w)>=0){let e=this.dragLimit.top+m-w;e+y+w<0?b-=y+w:b=e}else b-=y+w}else b=i-w,v=t-x;this.enableScrollHandler&&!this.clone&&(b-=this.parentScrollY,v-=this.parentScrollX);let S=this.getProcessedPositionValue({top:b+"px",left:v+"px"});nt(o,this.getDragPosition(S)),!this.elementInViewport(o)&&this.enableAutoScroll&&this.helperElement.scrollIntoView(),this.dragProcessStarted=!0,this.prevLeft=t,this.prevTop=i,this.position.left=t,this.position.top=i,this.pageX=c,this.pageY=u}triggerOutFunction(e,t){this.hoverObject.instance.intOut(e,t.target),this.hoverObject.instance.dragData[this.scope]=null,this.hoverObject=null}getDragPosition(e){let t=c({},e);return this.axis&&("x"===this.axis?delete t.top:"y"===this.axis&&delete t.left),t}getDocumentWidthHeight(e){let t=document.body,i=document.documentElement;return Math.max(t["scroll"+e],i["scroll"+e],t["offset"+e],i["offset"+e],i["client"+e])}intDragStop(e){if(this.dragProcessStarted=!1,!p(e.changedTouches)&&1!==e.changedTouches.length)return;if(-1!==["touchend","pointerup","mouseup"].indexOf(e.type)){if(this.dragStop){let t=this.getProperTargetElement(e);this.trigger("dragStop",{event:e,element:this.element,target:t,helper:this.helperElement})}this.intDestroy(e)}else this.element.setAttribute("aria-grabbed","false");let t=this.checkTargetElement(e);t.target&&t.instance&&(t.instance.dragStopCalled=!0,t.instance.dragData[this.scope]=this.droppables[this.scope],t.instance.intDrop(e,t.target)),this.setGlobalDroppables(!0),document.body.classList.remove("e-prevent-select")}intDestroy(e){this.dragProcessStarted=!1,this.toggleEvents(),document.body.classList.remove("e-prevent-select"),this.element.setAttribute("aria-grabbed","false"),$.remove(document,Z.touchMoveEvent,this.intDragStart),$.remove(document,Z.touchEndEvent,this.intDragStop),$.remove(document,Z.touchEndEvent,this.intDestroy),$.remove(document,Z.touchMoveEvent,this.intDrag),this.isDragStarted()&&this.isDragStarted(!0)}onPropertyChanged(e,t){}getModuleName(){return"draggable"}isDragStarted(e){return e&&(Yt.isDragged=!Yt.isDragged),Yt.isDragged}setDragArea(){let e,t,i,n=0,r=0;if(i="string"==typeof this.dragArea?Ke(this.dragArea):this.dragArea,i){let s=i.getBoundingClientRect();e=i.scrollWidth?i.scrollWidth:s.right-s.left,t=i.scrollHeight?i.scrollHeight:s.bottom-s.top;let o=["Top","Left","Bottom","Right"],a=getComputedStyle(i);for(let e=0;e<o.length;e++){let t=o[e],i=a["border"+t+"Width"],n=a["padding"+t],r=t.toLowerCase();this.borderWidth[r]=isNaN(parseFloat(i))?0:parseFloat(i),this.padding[r]=isNaN(parseFloat(n))?0:parseFloat(n)}n=s.top,r=s.left,this.dragLimit.left=r+this.borderWidth.left+this.padding.left,this.dragLimit.top=i.offsetTop+this.borderWidth.top+this.padding.top,this.dragLimit.right=r+e-(this.borderWidth.right+this.padding.right),this.dragLimit.bottom=n+t-(this.borderWidth.bottom+this.padding.bottom)}}getProperTargetElement(e){let t,i=this.getCoordinates(e),n=this.helperElement.style.pointerEvents||"";return g(e.target,this.helperElement)||-1!==e.type.indexOf("touch")?(this.helperElement.style.pointerEvents="none",t=document.elementFromPoint(i.clientX,i.clientY),this.helperElement.style.pointerEvents=n):t=e.target,t}currentStateCheck(e,t){let i;return i=d(this.currentStateTarget)||this.currentStateTarget===e?d(t)?e:t:this.currentStateTarget,i}getMousePosition(e,t){let i,n,r=void 0!==e.srcElement?e.srcElement:e.target,s=this.getCoordinates(e),o=d(r.offsetParent);return t?(i=this.clone?s.pageX:s.pageX+(o?0:r.offsetParent.scrollLeft)-this.relativeXPosition,n=this.clone?s.pageY:s.pageY+(o?0:r.offsetParent.scrollTop)-this.relativeYPosition):(i=this.clone?s.pageX:s.pageX+window.pageXOffset-this.relativeXPosition,n=this.clone?s.pageY:s.pageY+window.pageYOffset-this.relativeYPosition),!this.clone&&this.dragArea&&(this.getScrollableValues(),n-=this.tempScrollHeight?this.parentScrollY:0,i-=this.tempScrollWidth?this.parentScrollX:0),{left:i-(this.margin.left+this.cursorAt.left),top:n-(this.margin.top+this.cursorAt.top)}}getCoordinates(e){return e.type.indexOf("touch")>-1?e.changedTouches[0]:e}getHelperElement(e){let t;return this.clone?this.helper?t=this.helper({sender:e,element:this.target}):(t=Ue("div",{className:"e-drag-helper e-block-touch",innerHTML:"Draggable"}),document.body.appendChild(t)):t=this.element,t}setGlobalDroppables(e,t,i){this.droppables[this.scope]=e?null:{draggable:t,helper:i,draggedElement:this.element}}checkTargetElement(e){let t=this.getProperTargetElement(e),i=this.getDropInstance(t);if(!i&&t&&!d(t.parentNode)){let e=it(t.parentNode,".e-droppable")||t.parentElement;e&&(i=this.getDropInstance(e))}return{target:t,instance:i}}getDropInstance(e){let t,i=e&&e.ej2_instances;if(i)for(let n of i)if("droppable"===n.getModuleName()){t=n;break}return t}destroy(){this.toggleEvents(!0),super.destroy()}};return Vt([St({},Gt)],e.prototype,"cursorAt",void 0),Vt([xt(!0)],e.prototype,"clone",void 0),Vt([xt()],e.prototype,"dragArea",void 0),Vt([xt()],e.prototype,"isDragScroll",void 0),Vt([xt()],e.prototype,"isReplaceDragEle",void 0),Vt([xt(!0)],e.prototype,"isPreventSelect",void 0),Vt([Ot()],e.prototype,"drag",void 0),Vt([Ot()],e.prototype,"dragStart",void 0),Vt([Ot()],e.prototype,"dragStop",void 0),Vt([xt(1)],e.prototype,"distance",void 0),Vt([xt()],e.prototype,"handle",void 0),Vt([xt()],e.prototype,"abort",void 0),Vt([xt()],e.prototype,"helper",void 0),Vt([xt("default")],e.prototype,"scope",void 0),Vt([xt("")],e.prototype,"dragTarget",void 0),Vt([xt()],e.prototype,"axis",void 0),Vt([xt()],e.prototype,"queryPositionInfo",void 0),Vt([xt(!1)],e.prototype,"enableTailMode",void 0),Vt([xt(!1)],e.prototype,"skipDistanceCheck",void 0),Vt([xt(!0)],e.prototype,"preventDefault",void 0),Vt([xt(!1)],e.prototype,"enableAutoScroll",void 0),Vt([xt(!1)],e.prototype,"enableTapHold",void 0),Vt([xt(750)],e.prototype,"tapHoldThreshold",void 0),e=Ft=Vt([Tt],e),e})();var Zt=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let $t=(()=>{let e=class extends ot{constructor(e,t){super(t,e),this.mouseOver=!1,this.dragData={},this.dragStopCalled=!1,this.bind()}bind(){this.wireEvents()}wireEvents(){$.add(this.element,Z.touchEndEvent,this.intDrop,this)}onPropertyChanged(e,t){}getModuleName(){return"droppable"}intOver(e,t){this.mouseOver||(this.trigger("over",{event:e,target:t,dragData:this.dragData[this.scope]}),this.mouseOver=!0)}intOut(e,t){this.mouseOver&&(this.trigger("out",{evt:e,target:t}),this.mouseOver=!1)}intDrop(e,t){if(!this.dragStopCalled)return;this.dragStopCalled=!1;let i,n=!0,r=this.dragData[this.scope],s=!!r&&r.helper&&Ye(r.helper);s&&(i=this.isDropArea(e,r.helper,t),this.accept&&(n=rt(r.helper,this.accept))),s&&this.drop&&i.canDrop&&n&&this.trigger("drop",{event:e,target:i.target,droppedElement:r.helper,dragData:r}),this.mouseOver=!1}isDropArea(e,t,i){let n={canDrop:!0,target:i||e.target},r="touchend"===e.type;if(r||n.target===t){t.style.display="none";let i=r?e.changedTouches[0]:e,s=document.elementFromPoint(i.clientX,i.clientY);n.canDrop=!1,n.canDrop=g(s,this.element),n.canDrop&&(n.target=s),t.style.display=""}return n}destroy(){$.remove(this.element,Z.touchEndEvent,this.intDrop),super.destroy()}};return Zt([xt()],e.prototype,"accept",void 0),Zt([xt("default")],e.prototype,"scope",void 0),Zt([Ot()],e.prototype,"drop",void 0),Zt([Ot()],e.prototype,"over",void 0),Zt([Ot()],e.prototype,"out",void 0),e=Zt([Tt],e),e})(),Qt=(()=>{class e{constructor(e,t,i){this.controlName=e,this.localeStrings=t,this.setLocale(i||M)}setLocale(t){let i=this.intGetControlConstant(e.locale,t);this.currentLocale=i||this.localeStrings}static load(e){this.locale=c(this.locale,e,{},!0)}getConstant(e){return d(this.currentLocale[e])?this.localeStrings[e]||"":this.currentLocale[e]}intGetControlConstant(e,t){return e[t]?e[t][this.controlName]:null}}return e.locale={},e})();var Jt=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Kt=(()=>{class e extends Ht{}return Jt([xt(50)],e.prototype,"swipeThresholdDistance",void 0),e})();const ei=/(Up|Down)/;let ti=(()=>{let e=class extends ot{constructor(e,t){super(t,e),this.touchAction=!0,this.tapCount=0,this.startEvent=e=>{if(!0===this.touchAction){let t=this.updateChangeTouches(e);void 0!==e.changedTouches&&(this.touchAction=!1),this.isTouchMoved=!1,this.movedDirection="",this.startPoint=this.lastMovedPoint={clientX:t.clientX,clientY:t.clientY},this.startEventData=t,this.hScrollLocked=this.vScrollLocked=!1,this.tStampStart=Date.now(),this.timeOutTapHold=setTimeout(()=>{this.tapHoldEvent(e)},this.tapHoldThreshold),$.add(this.element,Z.touchMoveEvent,this.moveEvent,this),$.add(this.element,Z.touchEndEvent,this.endEvent,this),$.add(this.element,Z.touchCancelEvent,this.cancelEvent,this)}},this.moveEvent=e=>{let t=this.updateChangeTouches(e);this.movedPoint=t,this.isTouchMoved=!(t.clientX===this.startPoint.clientX&&t.clientY===this.startPoint.clientY);let i={};this.isTouchMoved&&(clearTimeout(this.timeOutTapHold),this.calcScrollPoints(e),i=c(i,{},{startEvents:this.startEventData,originalEvent:e,startX:this.startPoint.clientX,startY:this.startPoint.clientY,distanceX:this.distanceX,distanceY:this.distanceY,scrollDirection:this.scrollDirection,velocity:this.getVelocity(t)}),this.trigger("scroll",i),this.lastMovedPoint={clientX:t.clientX,clientY:t.clientY})},this.cancelEvent=e=>{clearTimeout(this.timeOutTapHold),clearTimeout(this.timeOutTap),this.tapCount=0,this.swipeFn(e),$.remove(this.element,Z.touchCancelEvent,this.cancelEvent)},this.endEvent=e=>{this.swipeFn(e),this.isTouchMoved||"function"==typeof this.tap&&(this.trigger("tap",{originalEvent:e,tapCount:++this.tapCount}),this.timeOutTap=setTimeout(()=>{this.tapCount=0},this.tapThreshold)),this.modeclear()},this.swipeFn=e=>{clearTimeout(this.timeOutTapHold),clearTimeout(this.timeOutTap);let t=this.updateChangeTouches(e),i=t.clientX-this.startPoint.clientX,n=t.clientY-this.startPoint.clientY;i=Math.floor(i<0?-1*i:i),n=Math.floor(n<0?-1*n:i),this.isTouchMoved=i>1||n>1,/Mozilla|Firefox/.test(Z.userAgent)&&0===t.clientX&&0===t.clientY&&"mouseup"===e.type&&(this.isTouchMoved=!1),this.endPoint=t,this.calcPoints(e);let r={originalEvent:e,startEvents:this.startEventData,startX:this.startPoint.clientX,startY:this.startPoint.clientY,distanceX:this.distanceX,distanceY:this.distanceY,swipeDirection:this.movedDirection,velocity:this.getVelocity(t)};if(this.isTouchMoved){let e,t=this.swipeSettings.swipeThresholdDistance;e=c(e,this.defaultArgs,r);let i=!1,n=this.element,s=this.isScrollable(n),o=ei.test(this.movedDirection);(t<this.distanceX&&!o||t<this.distanceY&&o)&&(i=!s||this.checkSwipe(n,o)),i&&this.trigger("swipe",e)}this.modeclear()},this.modeclear=()=>{this.modeClear=setTimeout(()=>{this.touchAction=!0},"function"!=typeof this.tap?0:20),this.lastTapTime=(new Date).getTime(),$.remove(this.element,Z.touchMoveEvent,this.moveEvent),$.remove(this.element,Z.touchEndEvent,this.endEvent),$.remove(this.element,Z.touchCancelEvent,this.cancelEvent)},this.bind()}onPropertyChanged(e,t){}bind(){this.wireEvents(),Z.isIE&&this.element.classList.add("e-block-touch")}destroy(){this.unwireEvents(),super.destroy()}wireEvents(){$.add(this.element,Z.touchStartEvent,this.startEvent,this)}unwireEvents(){$.remove(this.element,Z.touchStartEvent,this.startEvent)}getModuleName(){return"touch"}isScrollable(e){let t=getComputedStyle(e);return!!/(auto|scroll)/.test(t.overflow+t.overflowX+t.overflowY)}tapHoldEvent(e){let t;this.tapCount=0,this.touchAction=!0,$.remove(this.element,Z.touchMoveEvent,this.moveEvent),$.remove(this.element,Z.touchEndEvent,this.endEvent),t={originalEvent:e},this.trigger("tapHold",t),$.remove(this.element,Z.touchCancelEvent,this.cancelEvent)}calcPoints(e){let t=this.updateChangeTouches(e);this.defaultArgs={originalEvent:e},this.distanceX=Math.abs(Math.abs(t.clientX)-Math.abs(this.startPoint.clientX)),this.distanceY=Math.abs(Math.abs(t.clientY)-Math.abs(this.startPoint.clientY)),this.movedDirection=this.distanceX>this.distanceY?t.clientX>this.startPoint.clientX?"Right":"Left":t.clientY<this.startPoint.clientY?"Up":"Down"}calcScrollPoints(e){let t=this.updateChangeTouches(e);this.defaultArgs={originalEvent:e},this.distanceX=Math.abs(Math.abs(t.clientX)-Math.abs(this.lastMovedPoint.clientX)),this.distanceY=Math.abs(Math.abs(t.clientY)-Math.abs(this.lastMovedPoint.clientY)),(this.distanceX>this.distanceY||!0===this.hScrollLocked)&&!1===this.vScrollLocked?(this.scrollDirection=t.clientX>this.lastMovedPoint.clientX?"Right":"Left",this.hScrollLocked=!0):(this.scrollDirection=t.clientY<this.lastMovedPoint.clientY?"Up":"Down",this.vScrollLocked=!0)}getVelocity(e){let t=e.clientX,i=e.clientY,n=Date.now(),r=t-this.startPoint.clientX,s=i-this.startPoint.clientX,o=n-this.tStampStart;return Math.sqrt(r*r+s*s)/o}checkSwipe(e,t){let i=["scroll","offset"],n=t?["Height","Top"]:["Width","Left"];return e[i[0]+n[0]]<=e[i[1]+n[0]]||0===e[i[0]+n[1]]||e[i[1]+n[0]]+e[i[0]+n[1]]>=e[i[0]+n[0]]}updateChangeTouches(e){return e.changedTouches&&0!==e.changedTouches.length?e.changedTouches[0]:e}};return Jt([Ot()],e.prototype,"tap",void 0),Jt([Ot()],e.prototype,"tapHold",void 0),Jt([Ot()],e.prototype,"swipe",void 0),Jt([Ot()],e.prototype,"scroll",void 0),Jt([xt(350)],e.prototype,"tapThreshold",void 0),Jt([xt(750)],e.prototype,"tapHoldThreshold",void 0),Jt([St({},Kt)],e.prototype,"swipeSettings",void 0),e=Jt([Tt],e),e})();const ii=["script","style","iframe[src]",'link[href*="javascript:"]','object[type="text/x-scriptlet"]','object[data^="data:text/html;base64"]','img[src^="data:text/html;base64"]','[src^="javascript:"]','[dynsrc^="javascript:"]','[lowsrc^="javascript:"]','[type^="application/x-shockwave-flash"]'],ni=[{attribute:"href",selector:'[href*="javascript:"]'},{attribute:"background",selector:'[background^="javascript:"]'},{attribute:"style",selector:'[style*="javascript:"]'},{attribute:"style",selector:'[style*="expression("]'},{attribute:"href",selector:'a[href^="data:text/html;base64"]'}],ri=["onchange","onclick","onmouseover","onmouseout","onkeydown","onload","onerror","onblur","onfocus","onbeforeload","onbeforeunload","onkeyup","onsubmit","onafterprint","onbeforeonload","onbeforeprint","onblur","oncanplay","oncanplaythrough","onchange","onclick","oncontextmenu","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onerror","onerror","onfocus","onformchange","onforminput","onhaschange","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onload","onloadeddata","onloadedmetadata","onloadstart","onmessage","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","onmousewheel","onoffline","onoine","ononline","onpagehide","onpageshow","onpause","onplay","onplaying","onpopstate","onprogress","onratechange","onreadystatechange","onredo","onresize","onscroll","onseeked","onseeking","onselect","onstalled","onstorage","onsubmit","onsuspend","ontimeupdate","onundo","onunload","onvolumechange","onwaiting","onmouseenter","onmouseleave","onmousewheel","onstart","onpropertychange"];class si{static beforeSanitize(){return{selectors:{tags:ii,attributes:ni}}}static sanitize(e){let t=this.beforeSanitize();return this.serializeValue(t,e)}static serializeValue(e,t){this.removeAttrs=e.selectors.attributes,this.removeTags=e.selectors.tags,this.wrapElement=document.createElement("div"),this.wrapElement.innerHTML=t,this.removeXssTags(),this.removeJsEvents(),this.removeXssAttrs();let i=this.wrapElement.innerHTML;return this.removeElement(),i}static removeElement(){let e=this.wrapElement.children;for(let t=0;t<e.length;t++){let i=e[t].attributes;for(let e=0;e<i.length;e++)this.wrapElement.children[t].removeAttribute(i[e].localName)}}static removeXssTags(){let e=this.wrapElement.querySelectorAll(this.removeTags.join(","));e.length>0&&e.forEach(e=>{$e(e)})}static removeJsEvents(){let e=this.wrapElement.querySelectorAll("["+ri.join("],[")+"]");e.length>0&&e.forEach(e=>{ri.forEach(t=>{e.hasAttribute(t)&&e.removeAttribute(t)})})}static removeXssAttrs(){this.removeAttrs.forEach((e,t)=>{let i=this.wrapElement.querySelectorAll(e.selector);i.length>0&&i.forEach(t=>{t.removeAttribute(e.attribute)})})}}function oi(e,t,i){var r={};if(e&&e.length){for(var s=0,o=e;s<o.length;s++){var a=o[s];!0===i?(t.propCollection[a]=new n.n(!1),t[a]=t.propCollection[a]):r[a]=new n.n(!1)}!0!==i&&t.setProperties(r,!0)}}function ai(e,t,i){var n=Object.keys(e.registeredTemplate);if(n.length)for(var r=t&&t.filter(function(e){return!/\./g.test(e)}),s=0,o=r&&r||n;s<o.length;s++){var a=o[s];if(i&&i.length)for(var l=0;l<i.length;l++)for(var h=0;h<e.registeredTemplate.template.length;h++)e.registeredTemplate.template[h].rootNodes[0]===i[l]&&(u=e.registeredTemplate[a])[h].destroy();else if(e.registeredTemplate[a])for(var c=0,p=e.registeredTemplate[a];c<p.length;c++){var u;if(!(u=p[c]).destroyed){if(u._view){var g=u._view.renderer.parentNode(u.rootNodes[0]);if(!d(g))for(h=0;h<u.rootNodes.length;h++)g.appendChild(u.rootNodes[h])}u.destroy()}}delete e.registeredTemplate[a]}for(var m=function(e){e.instance&&e.instance.clearTemplate(t&&t.filter(function(t){return!!new RegExp(e.name).test(t)}))},f=0,y=e.tagObjects;f<y.length;f++)m(y[f])}function li(e,t,i){for(var n=e.replace(/\[/g,".").replace(/\]/g,"").split("."),r=i||{},s=0;s<n.length;s++){var o=n[s];s+1===n.length?r[o]=void 0===t?{}:t:void 0===r[o]&&(r[o]={}),r=r[o]}return r}var hi=/Ref$/,ci=function(){function e(){this.hasChanges=!1,this.propCollection={},this.dataSource={},this.tags=[],this.tagObjects=[]}return e.prototype.ngOnInit=function(){this.registeredTemplate={};for(var e=0,t=this.tags;e<t.length;e++){var i=t[e],n=o("child"+i.substring(0,1).toUpperCase()+i.substring(1),this);n&&this.tagObjects.push({instance:n,name:i})}for(var r=Object.keys(this),s=0,l=r=r.filter(function(e){return/Ref$/i.test(e)});s<l.length;s++){var h=l[s].replace("Ref","");a(h.replace("_","."),o(h,this),this.propCollection)}var c=Object.keys(this);if(this.directivePropList){for(var d=0;d<this.directivePropList.length;d++){var p=this.directivePropList[d];-1!==c.indexOf(p)&&a(p,o(p,this),this.propCollection)}this.hasChanges=!0}this.isInitChanges=!0},e.prototype.registerEvents=function(e){oi(e,this,!0)},e.prototype.ngOnChanges=function(e){for(var t=0,i=Object.keys(e);t<i.length;t++){var n=i[t];this.propCollection[n]=e[n].currentValue}this.isUpdated=!1,this.hasChanges=!0},e.prototype.clearTemplate=function(e){ai(this,e)},e.prototype.getProperties=function(){for(var e=0,t=this.tagObjects;e<t.length;e++){var i=t[e];this.propCollection[i.name]=i.instance.getProperties()}return this.propCollection},e.prototype.isChanged=function(){var e=this.hasChanges;if(!d(this.propCollection[this.property]))for(var t=Object.keys(this.propCollection[this.property][0]),i=0;i<t.length;i++)if(!d(this.propCollection[t[i]])){var n=o(t[i],this),r=this.propCollection[this.property][0][t[i]];d(n)||this.propCollection[t[i]]===n||r===n||(a(t[i],n,this.propCollection[this.property][0]),a(t[i],n,this.propCollection),this.hasChanges=!0,this.isUpdated=!1)}for(var s=0,l=this.tagObjects;s<l.length;s++)e=e||l[s].instance.hasChanges;return e||this.hasChanges},e.prototype.ngAfterContentChecked=function(){if(this.hasChanges=this.isChanged(),this.isInitChanges||this.hasChanges)for(var e=Object.keys(this),t=0,i=e=e.filter(function(e){return hi.test(e)});t<i.length;t++){var n=i[t].replace("Ref","");a(n.replace("_","."),o(n,this),this.propCollection)}},e.prototype.ngAfterViewChecked=function(){this.isUpdated&&(this.hasChanges=!1)},e.prototype.ngAfterViewInit=function(){this.isInitChanges=!1},e.prototype.ngOnDestroy=function(){this.directivePropList=[]},e}(),di=function(){function e(e){this.list=[],this.hasChanges=!1,this.propertyName=e}return e.prototype.ngOnInit=function(){this.isInitChanges=!0},e.prototype.ngAfterContentInit=function(){var e=this,t=0;this.list=this.children.map(function(i){return i.dirIndex=t++,i.property=e.propertyName,i}),this.hasChanges=!0},e.prototype.getProperties=function(){for(var e=[],t=0,i=this.list;t<i.length;t++)e.push(i[t].getProperties());return e},e.prototype.isChanged=function(){var e=this,t=!1,i=0,n=!1,r=this.children.map(function(e){return e});if(this.list.length===this.children.length)for(var s=0;s<this.list.length;s++)this.list[s].propCollection.dataSource&&(this.list[s].dataSource&&this.list[s].propCollection.dataSource!==this.list[s].dataSource&&(this.list[s].propCollection.dataSource=this.list[s].dataSource,this.list[s].hasChanges=!0),n=JSON.stringify(this.list[s].propCollection.dataSource)!==JSON.stringify(r[s].propCollection.dataSource)),n=this.list[s].hasChanges!==r[s].hasChanges;this.hasNewChildren=!(this.list.length===this.children.length&&!n)||null,this.hasNewChildren&&(this.list=this.children.map(function(t){return t.dirIndex=i++,t.property=e.propertyName,t}));for(var o=0,a=this.list;o<a.length;o++)t=t||a[o].hasChanges;return!!this.list.length&&t},e.prototype.clearTemplate=function(e){for(var t=this,i=0,n=this.list;i<n.length;i++)n[i].clearTemplate(e&&e.map(function(e){return new RegExp(t.propertyName).test(e)?e.replace(t.propertyName+".",""):e}))},e.prototype.ngAfterContentChecked=function(){this.hasChanges=this.isChanged();for(var e=0;e<this.list.length;e++)this.list[e].isUpdated=!0},e.prototype.ngAfterViewInit=function(){this.isInitChanges=!1},e.prototype.ngOnDestroy=function(){this.list=[]},e}(),pi=function(){function e(){this.isProtectedOnChange=!0,this.isFormInit=!0}return e.prototype.saveChanges=function(e,t,i){if(!this.isProtectedOnChange){this.oldProperties[e]=i,this.changedProperties[e]=t,this.finalUpdate();var n=setTimeout(this.dataBind.bind(this));this.finalUpdate=function(){clearTimeout(n)}}},e.prototype.ngOnInit=function(e){var t=e||this;t.registeredTemplate={},t.ngBoundedEvents={},t.isAngular=!0,t.isFormInit=!0,e&&(this.tags=e.tags),t.tags=this.tags||[],t.complexTemplate=this.complexTemplate||[],t.tagObjects=[],t.ngAttr=this.getAngularAttr(t.element),t.createElement=function(e,i){var n=t.srenderer?t.srenderer.createElement(e):Ue(e);return void 0===i||(n.innerHTML=i.innerHTML?i.innerHTML:"",void 0!==i.className&&(n.className=i.className),void 0!==i.id&&(n.id=i.id),void 0!==i.styles&&n.setAttribute("style",i.styles),void 0!==t.ngAttr&&n.setAttribute(t.ngAttr,""),void 0!==i.attrs&&Je(n,i.attrs)),n};for(var i=0,n=t.tags;i<n.length;i++){var r=n[i],s={instance:o("child"+r.substring(0,1).toUpperCase()+r.substring(1),t),name:r};t.tagObjects.push(s)}for(var l=Object.keys(t),h=0,c=l=l.filter(function(e){return/Ref$/i.test(e)&&/\_/i.test(e)});h<c.length;h++){var d=c[h].replace("Ref",""),p={};a(d.replace("_","."),o(d,t),p),t.setProperties(p,!0)}},e.prototype.getAngularAttr=function(e){for(var t,i=e.attributes,n=i.length,r=0;r<n;r++)/_ngcontent/g.test(i[r].name)&&(t=i[r].name);return t},e.prototype.ngAfterViewInit=function(e){var t=e||this;/ejs-tab|ejs-accordion/g.test(t.ngEle.nativeElement.outerHTML)&&(t.ngEle.nativeElement.style.visibility="hidden");for(var i=Object.keys(t),n=0,r=i=i.filter(function(e){return/Ref$/i.test(e)});n<r.length;n++){var s=r[n].replace("Ref","");a(s.replace("_","."),o(s+"Ref",t),t)}setTimeout(function(){"undefined"!=typeof window&&(t.appendTo(t.element),t.ngEle.nativeElement.style.visibility="")})},e.prototype.ngOnDestroy=function(e){var t=e||this;setTimeout(function(){"undefined"!=typeof window&&(t.element.classList.contains("e-control")||t.element)&&(t.destroy(),t.clearTemplate(null),t.ngBoundedEvents={},t.tagObjects={},t.ngEle=null)})},e.prototype.clearTemplate=function(e,t){ai(this,e,t)},e.prototype.ngAfterContentChecked=function(e){for(var t=e||this,i=0,n=t.tagObjects;i<n.length;i++){var r=n[i];if(!p(r.instance)&&(r.instance.isInitChanges||r.instance.hasChanges||r.instance.hasNewChildren))if(r.instance.isInitChanges){var s={},a=void 0;(C=o("instance.list",r))&&C.length&&(a=C[0].directivePropList);var l=!0;if(t.getModuleName&&"gantt"===t.getModuleName()&&(l=!1),a&&l&&-1===a.indexOf(r.instance.propertyName))for(var h=Object.keys(r.instance.list[0].propCollection),c=0;c<r.instance.list.length;c++){r.instance.list[c].propCollection[r.instance.propertyName]=[];for(var d={},u=0;u<h.length;u++)d[I=h[u]]=r.instance.list[c].propCollection[I];for(var g=0;g<r.instance.list[c].tags.length;g++){var m=r.instance.list[c].tags[g],f=o("child"+m.substring(0,1).toUpperCase()+m.substring(1),r.instance.list[c]);if(f){var y=r.instance.list[c]["child"+m.substring(0,1).toUpperCase()+m.substring(1)];if(y)for(var b=0;b<y.list.length;b++){var v=y.list[0].tags[0];if(v){var w=o("child"+v.substring(0,1).toUpperCase()+v.substring(1),y.list[b]);w&&y.list[b].tagObjects.push({instance:w,name:v})}}r.instance.list[c].tagObjects.push({instance:f,name:m})}}r.instance.list[c].propCollection[r.instance.propertyName].push(d)}s[r.name]=r.instance.getProperties(),t.setProperties(s,r.instance.isInitChanges)}else{(t[r.name].length!==r.instance.list.length||/diagram|DashboardLayout/.test(t.getModuleName()))&&(t[r.name]=r.instance.list);for(var x=0,S=r.instance.list;x<S.length;x++){var C,P=r.instance.list.indexOf(C=S[x]),O=o(r.name,t)[P],T=Object.keys(O);if(T=T.filter(function(e){return/Ref$/i.test(e)}),O.properties&&0!==Object.keys(O.properties).length&&/chart|kanban/.test(t.getModuleName()))for(var E=0,A=T;E<A.length;E++){var I;I=(I=A[E]).replace(/Ref/,""),O.properties[I]=O.properties[I]?O.properties[I]:O.propCollection[I]}p(O)||p(O.setProperties)||(/diagram|DashboardLayout/.test(t.getModuleName())?O.setProperties(C.getProperties(),!0):O.setProperties(C.getProperties())),C.isUpdated=!0}}}},e.prototype.registerEvents=function(e){oi(e,this)},e.prototype.twoWaySetter=function(e,t){var i=o(t,this.properties);i!==e&&(this.saveChanges(t,e,i),a(t,d(e)?null:e,this.properties),o(t+"Change",this).emit(e))},e.prototype.addTwoWay=function(e){for(var t=this,i=function(e){o(e,r),Object.defineProperty(r,e,{get:function(){return o(e,t.properties)},set:function(i){return t.twoWaySetter(i,e)}}),a(e+"Change",new n.n,r)},r=this,s=0,l=e;s<l.length;s++)i(l[s])},e.prototype.addEventListener=function(e,t){var i=o(e,this);p(i)||(this.ngBoundedEvents[e]||(this.ngBoundedEvents[e]=new Map),this.ngBoundedEvents[e].set(t,i.subscribe(t)))},e.prototype.removeEventListener=function(e,t){p(o(e,this))||this.ngBoundedEvents[e].get(t).unsubscribe()},e.prototype.trigger=function(e,t,i){var n=o(e,this),r=this.isProtectedOnChange;this.isProtectedOnChange=!1,t&&(t.name=e),p(n)||n.next(t);var s=o("local"+e.charAt(0).toUpperCase()+e.slice(1),this);p(s)||s.call(this,t),this.isProtectedOnChange=r,i&&(this.preventChange=this.isPreventChange,i.call(this,t)),this.isPreventChange=!1},e}(),ui=Pe.compile;function gi(e){return function(t,i){var n={set:mi(i),get:fi(i,e),enumerable:!0,configurable:!0};Object.defineProperty(t,i,n)}}function mi(e){return function(t){void 0!==t&&(a(e+"Ref",t,this),"string"!=typeof t?(t.elementRef.nativeElement._viewContainerRef=this.viewContainerRef,t.elementRef.nativeElement.propName=e):this.saveChanges&&(this.saveChanges(e,t,void 0),this.dataBind()))}}function fi(e,t){return function(){return o(e+"Ref",this)||t}}function yi(e){let t;const i=e.childNodes;for(let n=0;n<i.length;n++)if(t=i[n],3===t.nodeType)return t;return null}Pe.compile=function(e,t){if("string"==typeof e)return ui(e,t);var i=e.elementRef.nativeElement._viewContainerRef,n=e.elementRef.nativeElement.propName;return function(t,r,s){var a=i||r.viewContainerRef,l=a.createEmbeddedView(e,{$implicit:t});l.markForCheck();var h=r&&r.registeredTemplate?r.registeredTemplate:o("currentInstance.registeredTemplate",a);return void 0===h[s=s&&r.registeredTemplate?s:n]&&(h[s]=[]),h[s].push(l),l.rootNodes}};var bi=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};new L;const vi="e-rtl",wi="e-primary",xi="e-icon-btn";let Si,Ci,Pi,Oi,Ti,Ei,Ai=(()=>{let e=class extends Ut{constructor(e,t){super(e,t)}preRender(){}render(){this.initialize(),this.removeRippleEffect=function(e,t,i){let n=function(e){return{selector:e&&e.selector?e.selector:null,ignore:e&&e.ignore?e.ignore:null,rippleFlag:e&&e.rippleFlag,isCenterRipple:e&&e.isCenterRipple,duration:e&&e.duration?e.duration:350}}({selector:".e-btn"});return!1===n.rippleFlag||void 0===n.rippleFlag?()=>{}:(e.setAttribute("data-ripple","true"),$.add(e,"mousedown",Lt,{parent:e,rippleOptions:n}),$.add(e,"mouseup",zt,{parent:e,rippleOptions:n,done:void 0}),$.add(e,"mouseleave",Mt,{parent:e,rippleOptions:n}),Z.isPointer&&$.add(e,"transitionend",Mt,{parent:e,rippleOptions:n}),()=>{e.removeAttribute("data-ripple"),$.remove(e,"mousedown",Lt),$.remove(e,"mouseup",zt),$.remove(e,"mouseleave",Mt),$.remove(e,"transitionend",Mt)})}(this.element),this.renderComplete()}initialize(){if(this.cssClass&&Fe([this.element],this.cssClass.split(" ")),this.isPrimary&&this.element.classList.add(wi),this.content){const e=this.enableHtmlSanitizer?si.sanitize(this.content):this.content;this.element.innerHTML=e}this.setIconCss(),this.enableRtl&&this.element.classList.add(vi),this.disabled?this.controlStatus(this.disabled):this.wireEvents()}controlStatus(e){this.element.disabled=e}setIconCss(){if(this.iconCss){const e=this.createElement("span",{className:"e-btn-icon "+this.iconCss});this.element.textContent.trim()?(e.classList.add("e-icon-"+this.iconPosition.toLowerCase()),"Top"!==this.iconPosition&&"Bottom"!==this.iconPosition||this.element.classList.add("e-"+this.iconPosition.toLowerCase()+"-icon-btn")):this.element.classList.add(xi);const t=this.element.childNodes[0];!t||"Left"!==this.iconPosition&&"Top"!==this.iconPosition?this.element.appendChild(e):this.element.insertBefore(e,t)}}wireEvents(){this.isToggle&&$.add(this.element,"click",this.btnClickHandler,this)}unWireEvents(){this.isToggle&&$.remove(this.element,"click",this.btnClickHandler)}btnClickHandler(){this.element.classList.contains("e-active")?this.element.classList.remove("e-active"):this.element.classList.add("e-active")}destroy(){let e=[wi,vi,xi,"e-success","e-info","e-danger","e-warning","e-flat","e-outline","e-small","e-bigger","e-active","e-round","e-top-icon-btn","e-bottom-icon-btn"];this.cssClass&&(e=e.concat(this.cssClass.split(" "))),super.destroy(),Ve([this.element],e),this.element.getAttribute("class")||this.element.removeAttribute("class"),this.disabled&&this.element.removeAttribute("disabled"),this.content&&(this.element.innerHTML=this.element.innerHTML.replace(this.content,""));const t=this.element.querySelector("span.e-btn-icon");t&&$e(t),this.unWireEvents()}getModuleName(){return"btn"}getPersistData(){return this.addOnPersist([])}static Inject(){}onPropertyChanged(e,t){let i=this.element.querySelector("span.e-btn-icon");for(const n of Object.keys(e))switch(n){case"isPrimary":e.isPrimary?this.element.classList.add(wi):this.element.classList.remove(wi);break;case"disabled":this.controlStatus(e.disabled);break;case"iconCss":i?e.iconCss?(i.className="e-btn-icon "+e.iconCss,this.element.textContent.trim()&&i.classList.add("Left"===this.iconPosition?"e-icon-left":"e-icon-right")):$e(i):this.setIconCss();break;case"iconPosition":Ve([this.element],["e-top-icon-btn","e-bottom-icon-btn"]),i=this.element.querySelector("span.e-btn-icon"),i&&$e(i),this.setIconCss();break;case"cssClass":t.cssClass&&Ve([this.element],t.cssClass.split(" ")),e.cssClass&&Fe([this.element],e.cssClass.split(" "));break;case"enableRtl":e.enableRtl?this.element.classList.add(vi):this.element.classList.remove(vi);break;case"content":yi(this.element)||this.element.classList.remove(xi),this.enableHtmlSanitizer&&(e.content=si.sanitize(e.content)),this.element.innerHTML=e.content,this.setIconCss();break;case"isToggle":e.isToggle?$.add(this.element,"click",this.btnClickHandler,this):($.remove(this.element,"click",this.btnClickHandler),Ve([this.element],["e-active"]))}}click(){this.element.click()}focusIn(){this.element.focus()}};return bi([xt("Left")],e.prototype,"iconPosition",void 0),bi([xt("")],e.prototype,"iconCss",void 0),bi([xt(!1)],e.prototype,"disabled",void 0),bi([xt(!1)],e.prototype,"isPrimary",void 0),bi([xt("")],e.prototype,"cssClass",void 0),bi([xt("")],e.prototype,"content",void 0),bi([xt(!1)],e.prototype,"isToggle",void 0),bi([xt()],e.prototype,"locale",void 0),bi([xt(!1)],e.prototype,"enableHtmlSanitizer",void 0),bi([Ot()],e.prototype,"created",void 0),e=bi([Tt],e),e})(),Ii=!1;function Di(e,t,i,n,r){return Ci=void 0,Ci=r,Ii=!!n,e?(t||(t="left"),i||(i="top"),Oi=e.ownerDocument,Pi=e,function(e,t,i){switch(Si=Pi.getBoundingClientRect(),t+e){case"topcenter":Ri(Bi(),i),Li(Hi(),i);break;case"topright":Ri(_i(),i),Li(Hi(),i);break;case"centercenter":Ri(Bi(),i),Li(ji(),i);break;case"centerright":Ri(_i(),i),Li(ji(),i);break;case"centerleft":Ri(Ni(),i),Li(ji(),i);break;case"bottomcenter":Ri(Bi(),i),Li(ki(),i);break;case"bottomright":Ri(_i(),i),Li(ki(),i);break;case"bottomleft":Ri(Ni(),i),Li(ki(),i);break;default:case"topleft":Ri(Ni(),i),Li(Hi(),i)}return i}(t.toLowerCase(),i.toLowerCase(),{left:0,top:0})):{left:0,top:0}}function Ri(e,t){t.left=e}function Li(e,t){t.top=e}function zi(){return Oi.documentElement.scrollTop||Oi.body.scrollTop}function Mi(){return Oi.documentElement.scrollLeft||Oi.body.scrollLeft}function ki(){return Ii?Si.bottom:Si.bottom+zi()}function ji(){return Hi()+Si.height/2}function Hi(){return Ii?Si.top:Si.top+zi()}function Ni(){return Si.left+Mi()}function _i(){const e=Pi&&Pi.classList.contains("e-date-range-wrapper")?Ci?Ci.width:0:Ci&&Si.width>=Ci.width?Ci.width:0;return Si.right+Mi()-e}function Bi(){return Ni()+Si.width/2}function Wi(e,t=null,i={X:!1,Y:!1},n){if(!i.Y&&!i.X)return{left:0,top:0};const r=e.getBoundingClientRect();if(Ei=t,Ti=e.ownerDocument,n||(n=Di(e,"left","top")),i.X){const e=Ei?Zi():an(),t=en(),i=tn(),s=t-n.left,o=n.left+r.width-i;r.width>e?n.left=s>0&&o<=0?i-r.width:o>0&&s<=0?t:s>o?i-r.width:t:s>0?n.left+=s:o>0&&(n.left-=o)}if(i.Y){const e=Ei?$i():on(),t=Ki(),i=nn(),s=t-n.top,o=n.top+r.height-i;r.height>e?n.top=s>0&&o<=0?i-r.height:o>0&&s<=0?t:s>o?i-r.height:t:s>0?n.top+=s:o>0&&(n.top-=o)}return n}function Ui(e,t=null,i,n){const r=Di(e,"left","top");i&&(r.left=i),n&&(r.top=n);const s=[];Ei=t,Ti=e.ownerDocument;const o=e.getBoundingClientRect(),a=r.left,l=r.left+o.width,h=qi(r.top,r.top+o.height),c=Xi(a,l);return h.topSide&&s.push("top"),c.rightSide&&s.push("right"),c.leftSide&&s.push("left"),h.bottomSide&&s.push("bottom"),s}function Fi(e,t,i,n,r,s,o=null,a={X:!0,Y:!0},l){if(!(t&&e&&r&&s&&(a.X||a.Y)))return;const h={TL:null,TR:null,BL:null,BR:null},c={TL:null,TR:null,BL:null,BR:null};let d;if("none"===window.getComputedStyle(e).display){const t=e.style.visibility;e.style.visibility="hidden",e.style.display="block",d=e.getBoundingClientRect(),e.style.removeProperty("display"),e.style.visibility=t}else d=e.getBoundingClientRect();const p={posX:r,posY:s,offsetX:i,offsetY:n,position:{left:0,top:0}};Ei=o,Ti=t.ownerDocument,function(e,t,i,n,r){i.position=Di(e,i.posX,i.posY,n,r),t.TL=Di(e,"left","top",n,r),t.TR=Di(e,"right","top",n,r),t.BR=Di(e,"left","bottom",n,r),t.BL=Di(e,"right","bottom",n,r)}(t,h,p,l,d),Vi(c,p,d),a.X&&Yi(t,c,h,p,d,!0),a.Y&&h.TL.top>-1&&Gi(t,c,h,p,d,!0),function(e,t,i){let n=0,r=0;if(null!=e.offsetParent&&("absolute"===getComputedStyle(e.offsetParent).position||"relative"===getComputedStyle(e.offsetParent).position)){const t=Di(e.offsetParent,"left","top",!1,i);n=t.left,r=t.top}e.style.top=t.position.top+t.offsetY-r+"px",e.style.left=t.position.left+t.offsetX-n+"px"}(e,p,d)}function Vi(e,t,i){e.TL={top:t.position.top+t.offsetY,left:t.position.left+t.offsetX},e.TR={top:e.TL.top,left:e.TL.left+i.width},e.BL={top:e.TL.top+i.height,left:e.TL.left},e.BR={top:e.TL.top+i.height,left:e.TL.left+i.width}}function Xi(e,t){let i=!1,n=!1;return e-sn()<en()&&(i=!0),t>tn()&&(n=!0),{leftSide:i,rightSide:n}}function Yi(e,t,i,n,r,s){const o=Xi(t.TL.left,t.TR.left);i.TL.left-sn()<=en()&&(o.leftSide=!1),i.TR.left>tn()&&(o.rightSide=!1),(o.leftSide&&!o.rightSide||!o.leftSide&&o.rightSide)&&(n.posX="right"===n.posX?"left":"right",n.offsetX=n.offsetX+r.width,n.offsetX=-1*n.offsetX,n.position=Di(e,n.posX,n.posY,!1),Vi(t,n,r),s&&Yi(e,t,i,n,r,!1))}function Gi(e,t,i,n,r,s){const o=qi(t.TL.top,t.BL.top);i.TL.top-rn()<=Ki()&&(o.topSide=!1),i.BL.top>=nn()&&e.getBoundingClientRect().bottom<window.innerHeight&&(o.bottomSide=!1),(o.topSide&&!o.bottomSide||!o.topSide&&o.bottomSide)&&(n.posY="top"===n.posY?"bottom":"top",n.offsetY=n.offsetY+r.height,n.offsetY=-1*n.offsetY,n.position=Di(e,n.posX,n.posY,!1,r),Vi(t,n,r),s&&Gi(e,t,i,n,r,!1))}function qi(e,t){let i=!1,n=!1;return e-rn()<Ki()&&(i=!0),t>nn()&&(n=!0),{topSide:i,bottomSide:n}}function Zi(){return Ei.getBoundingClientRect().width}function $i(){return Ei.getBoundingClientRect().height}function Qi(){return Ei.getBoundingClientRect().left}function Ji(){return Ei.getBoundingClientRect().top}function Ki(){return Ei?Ji():0}function en(){return Ei?Qi():0}function tn(){return Ei?sn()+Qi()+Zi():sn()+an()}function nn(){return Ei?rn()+Ji()+$i():rn()+on()}function rn(){return Ti.documentElement.scrollTop||Ti.body.scrollTop}function sn(){return Ti.documentElement.scrollLeft||Ti.body.scrollLeft}function on(){return window.innerHeight}function an(){const e=window.innerWidth;let t=document.documentElement.getBoundingClientRect();return e-(e-(d(document.documentElement)?0:t.width))}var ln=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let hn=(()=>{class e extends Ht{}return ln([xt("left")],e.prototype,"X",void 0),ln([xt("top")],e.prototype,"Y",void 0),e})();const cn="e-popup",dn="e-rtl",pn="e-popup-open",un="e-popup-close";let gn=(()=>{let e=class extends Ut{constructor(e,t){super(t,e)}onPropertyChanged(e,t){for(const i of Object.keys(e))switch(i){case"width":nt(this.element,{width:f(e.width)});break;case"height":nt(this.element,{height:f(e.height)});break;case"zIndex":nt(this.element,{zIndex:e.zIndex});break;case"enableRtl":this.setEnableRtl();break;case"position":case"relateTo":this.refreshPosition();break;case"offsetX":let i=e.offsetX-t.offsetX;this.element.style.left=(parseInt(this.element.style.left,10)+i).toString()+"px";break;case"offsetY":let n=e.offsetY-t.offsetY;this.element.style.top=(parseInt(this.element.style.top,10)+n).toString()+"px";break;case"content":this.setContent();break;case"actionOnScroll":"none"!==e.actionOnScroll?this.wireScrollEvents():this.unwireScrollEvents()}}getModuleName(){return"popup"}resolveCollision(){this.checkCollision()}getPersistData(){return this.addOnPersist([])}destroy(){this.element.classList.remove(cn,dn,pn,un),this.unwireEvents(),super.destroy()}render(){this.element.classList.add(cn);const e={};1e3!==this.zIndex&&(e.zIndex=this.zIndex),"auto"!==this.width&&(e.width=f(this.width)),"auto"!==this.height&&(e.height=f(this.height)),nt(this.element,e),this.fixedParent=!1,this.setEnableRtl(),this.setContent()}wireEvents(){Z.isDevice&&$.add(window,"orientationchange",this.orientationOnChange,this),"none"!==this.actionOnScroll&&this.wireScrollEvents()}wireScrollEvents(){if(this.getRelateToElement())for(const e of this.getScrollableParent(this.getRelateToElement()))$.add(e,"scroll",this.scrollRefresh,this)}unwireEvents(){Z.isDevice&&$.remove(window,"orientationchange",this.orientationOnChange),"none"!==this.actionOnScroll&&this.unwireScrollEvents()}unwireScrollEvents(){if(this.getRelateToElement())for(const e of this.getScrollableParent(this.getRelateToElement()))$.remove(e,"scroll",this.scrollRefresh)}getRelateToElement(){const e=""===this.relateTo||d(this.relateTo)?document.body:this.relateTo;return this.setProperties({relateTo:e},!0),"string"==typeof this.relateTo?document.querySelector(this.relateTo):this.relateTo}scrollRefresh(e){if("reposition"===this.actionOnScroll?d(this.element)||this.element.offsetParent===e.target||this.element.offsetParent&&"BODY"===this.element.offsetParent.tagName&&null==e.target.parentElement||this.refreshPosition():"hide"===this.actionOnScroll&&this.hide(),"none"!==this.actionOnScroll&&this.getRelateToElement()){const t=this.isElementOnViewport(this.getRelateToElement(),e.target);t||this.targetInvisibleStatus?t&&(this.targetInvisibleStatus=!1):(this.trigger("targetExitViewport"),this.targetInvisibleStatus=!0)}}isElementOnViewport(e,t){const i=this.getScrollableParent(e);for(let n=0;n<i.length;n++)if(!this.isElementVisible(e,i[n]))return!1;return!0}isElementVisible(e,t){const i=this.checkGetBoundingClientRect(e);if(!i.height||!i.width)return!1;if(d(this.checkGetBoundingClientRect(t))){const t=window,n={top:t.scrollY,left:t.scrollX,right:t.scrollX+t.outerWidth,bottom:t.scrollY+t.outerHeight},r=Di(e),s={top:r.top,left:r.left,right:r.left+i.width,bottom:r.top+i.height},o={top:n.bottom-s.top,left:n.right-s.left,bottom:s.bottom-n.top,right:s.right-n.left};return o.top>0&&o.left>0&&o.right>0&&o.bottom>0}{const e=t.getBoundingClientRect();return!(i.bottom<e.top||i.bottom>e.bottom||i.right>e.right||i.left<e.left)}}preRender(){}setEnableRtl(){this.reposition(),this.enableRtl?this.element.classList.add(dn):this.element.classList.remove(dn)}setContent(){d(this.content)||(this.element.innerHTML="","string"==typeof this.content?this.element.textContent=this.content:this.element.appendChild(this.content))}orientationOnChange(){setTimeout(()=>{this.refreshPosition()},200)}refreshPosition(e,t){d(e)||this.checkFixedParent(e),this.reposition(),t||this.checkCollision()}reposition(){let e,t;const i=this.getRelateToElement();if("number"==typeof this.position.X&&"number"==typeof this.position.Y)e={left:this.position.X,top:this.position.Y};else if("string"==typeof this.position.X&&"number"==typeof this.position.Y||"number"==typeof this.position.X&&"string"==typeof this.position.Y){let n;const r=this.element.style.display;this.element.style.display="block",this.element.classList.contains("e-dlg-modal")&&(n=this.element.parentElement.style.display,this.element.parentElement.style.display="block"),t=this.getAnchorPosition(i,this.element,this.position,this.offsetX,this.offsetY),e="string"==typeof this.position.X?{left:t.left,top:this.position.Y}:{left:this.position.X,top:t.top},this.element.style.display=r,this.element.classList.contains("e-dlg-modal")&&(this.element.parentElement.style.display=n)}else if(i){const t=this.element.style.display;this.element.style.display="block",e=this.getAnchorPosition(i,this.element,this.position,this.offsetX,this.offsetY),this.element.style.display=t}else e={left:0,top:0};d(e)||(this.element.style.left=e.left+"px",this.element.style.top=e.top+"px")}checkGetBoundingClientRect(e){let t;try{return t=e.getBoundingClientRect(),t}catch(i){return null}}getAnchorPosition(e,t,i,n,r){const s=this.checkGetBoundingClientRect(t),o=this.checkGetBoundingClientRect(e);if(d(s)||d(o))return null;const a=e;let l={left:0,top:0};switch(t.offsetParent&&"BODY"===t.offsetParent.tagName&&"BODY"===e.tagName?l=Di(e):(t.classList.contains("e-dlg-modal")&&"BODY"!==a.tagName&&(t=t.parentElement),l=function(e,t){let i=!1;const n={left:0,top:0},r=e;if(!e||!t)return n;for(d(t.offsetParent)&&"fixed"===t.style.position&&(i=!0);(t.offsetParent||i)&&e&&t.offsetParent!==e;)n.left+=e.offsetLeft,n.top+=e.offsetTop,e=e.offsetParent;for(e=r;(t.offsetParent||i)&&e&&t.offsetParent!==e;)n.left-=e.scrollLeft,n.top-=e.scrollTop,e=e.parentElement;return n}(a,t)),i.X){default:case"left":break;case"center":t.classList.contains("e-dlg-modal")&&"BODY"===a.tagName&&"container"===this.targetType?l.left+=window.innerWidth/2-s.width/2:l.left+="container"===this.targetType?o.width/2-s.width/2:o.width/2;break;case"right":t.classList.contains("e-dlg-modal")&&"BODY"===a.tagName&&"container"===this.targetType?l.left+=window.innerWidth-s.width:l.left+="container"===this.targetType?o.width-s.width:o.width}switch(i.Y){default:case"top":break;case"center":t.classList.contains("e-dlg-modal")&&"BODY"===a.tagName&&"container"===this.targetType?l.top+=window.innerHeight/2-s.height/2:l.top+="container"===this.targetType?o.height/2-s.height/2:o.height/2;break;case"bottom":t.classList.contains("e-dlg-modal")&&"BODY"===a.tagName&&"container"===this.targetType?l.top+=window.innerHeight-s.height:l.top+="container"===this.targetType?o.height-s.height:o.height}return l.left+=n,l.top+=r,l}callFlip(e){const t=this.getRelateToElement();Fi(this.element,t,this.offsetX,this.offsetY,this.position.X,this.position.Y,this.viewPortElement,e,this.fixedParent)}callFit(e){if(0!==Ui(this.element,this.viewPortElement).length)if(d(this.viewPortElement)){const t=Wi(this.element,this.viewPortElement,e);e.X&&(this.element.style.left=t.left+"px"),e.Y&&(this.element.style.top=t.top+"px")}else{const t=this.checkGetBoundingClientRect(this.element),i=this.checkGetBoundingClientRect(this.viewPortElement);if(d(t)||d(i))return null;e&&!0===e.Y&&(i.top>t.top?this.element.style.top="0px":i.bottom<t.bottom&&(this.element.style.top=parseInt(this.element.style.top,10)-(t.bottom-i.bottom)+"px")),e&&!0===e.X&&(i.right<t.right?this.element.style.left=parseInt(this.element.style.left,10)-(t.right-i.right)+"px":i.left>t.left&&(this.element.style.left=parseInt(this.element.style.left,10)+(i.left-t.left)+"px"))}}checkCollision(){const e=this.collision.X,t=this.collision.Y;"none"===e&&"none"===t||("flip"===e&&"flip"===t?this.callFlip({X:!0,Y:!0}):"fit"===e&&"fit"===t?this.callFit({X:!0,Y:!0}):("flip"===e?this.callFlip({X:!0,Y:!1}):"flip"===t&&this.callFlip({Y:!0,X:!1}),"fit"===e?this.callFit({X:!0,Y:!1}):"fit"===t&&this.callFit({X:!1,Y:!0})))}show(e,t){if(this.wireEvents(),1e3===this.zIndex||!d(t)){const e=d(t)?this.element:t;this.zIndex=mn(e),nt(this.element,{zIndex:this.zIndex})}e=d(e)||"object"!=typeof e?this.showAnimation:e,"none"===this.collision.X&&"none"===this.collision.Y||(Ve([this.element],un),Fe([this.element],pn),this.checkCollision(),Ve([this.element],pn),Fe([this.element],un)),d(e)?(Ve([this.element],un),Fe([this.element],pn),this.trigger("open")):(e.begin=()=>{this.isDestroyed||(Ve([this.element],un),Fe([this.element],pn))},e.end=()=>{this.isDestroyed||this.trigger("open")},new Rt(e).animate(this.element))}hide(e){e=d(e)||"object"!=typeof e?this.hideAnimation:e,d(e)?(Ve([this.element],pn),Fe([this.element],un),this.trigger("close")):(e.end=()=>{this.isDestroyed||(Ve([this.element],pn),Fe([this.element],un),this.trigger("close"))},new Rt(e).animate(this.element)),this.unwireEvents()}getScrollableParent(e){return this.checkFixedParent(e),function(e,t){const i=getComputedStyle(e),n=[],r=/(auto|scroll)/;let s=e.parentElement;for(;s&&"HTML"!==s.tagName;){const e=getComputedStyle(s);"absolute"===i.position&&"static"===e.position||!r.test(e.overflow+e.overflowY+e.overflowX)||n.push(s),s=s.parentElement}return t||n.push(document),n}(e,this.fixedParent)}checkFixedParent(e){let t=e.parentElement;for(;t&&"HTML"!==t.tagName;){const e=getComputedStyle(t);"fixed"===e.position&&!d(this.element)&&this.element.offsetParent&&"BODY"===this.element.offsetParent.tagName&&(this.element.style.top=window.scrollY>parseInt(this.element.style.top)?f(window.scrollY-parseInt(this.element.style.top)):f(parseInt(this.element.style.top)-window.scrollY),this.element.style.position="fixed",this.fixedParent=!0),t=t.parentElement,!d(this.element)&&d(this.element.offsetParent)&&"fixed"===e.position&&"fixed"===this.element.style.position&&(this.fixedParent=!0)}}};return ln([xt("auto")],e.prototype,"height",void 0),ln([xt("auto")],e.prototype,"width",void 0),ln([xt(null)],e.prototype,"content",void 0),ln([xt("container")],e.prototype,"targetType",void 0),ln([xt(null)],e.prototype,"viewPortElement",void 0),ln([xt({X:"none",Y:"none"})],e.prototype,"collision",void 0),ln([xt("")],e.prototype,"relateTo",void 0),ln([St({},hn)],e.prototype,"position",void 0),ln([xt(0)],e.prototype,"offsetX",void 0),ln([xt(0)],e.prototype,"offsetY",void 0),ln([xt(1e3)],e.prototype,"zIndex",void 0),ln([xt(!1)],e.prototype,"enableRtl",void 0),ln([xt("reposition")],e.prototype,"actionOnScroll",void 0),ln([xt(null)],e.prototype,"showAnimation",void 0),ln([xt(null)],e.prototype,"hideAnimation",void 0),ln([Ot()],e.prototype,"open",void 0),ln([Ot()],e.prototype,"close",void 0),ln([Ot()],e.prototype,"targetExitViewport",void 0),e=ln([Tt],e),e})();function mn(e){let t=e.parentElement;const i=[];for(;t&&"BODY"!==t.tagName;){const e=document.defaultView.getComputedStyle(t,null).getPropertyValue("z-index"),n=document.defaultView.getComputedStyle(t,null).getPropertyValue("position");"auto"!==e&&"static"!==n&&i.push(e),t=t.parentElement}const n=[];for(let a=0;a<document.body.children.length;a++)if(!e.isEqualNode(document.body.children[a])){const e=document.defaultView.getComputedStyle(document.body.children[a],null).getPropertyValue("z-index"),t=document.defaultView.getComputedStyle(document.body.children[a],null).getPropertyValue("position");"auto"!==e&&"static"!==t&&n.push(e)}n.push("999");const r=[];if(!d(e.parentElement)&&"BODY"!==e.parentElement.tagName){const t=[].slice.call(e.parentElement.children);for(let i=0;i<t.length;i++)if(!e.isEqualNode(t[i])){const e=document.defaultView.getComputedStyle(t[i],null).getPropertyValue("z-index"),n=document.defaultView.getComputedStyle(t[i],null).getPropertyValue("position");"auto"!==e&&"static"!==n&&r.push(e)}}const s=i.concat(n,r),o=Math.max.apply(Math,s)+1;return o>2147483647?2147483647:o}const fn=["north-west","north","north-east","west","east","south-west","south","south-east"],yn="e-focused-handle",bn=["e-restrict-left"],vn="e-resize-viewport",wn=["north","west","east","south"];let xn,Sn,Cn,Pn,On,Tn,En,An,In,Dn=0,Rn=0,Ln=0,zn=0,Mn=0,kn=0,jn=null,Hn=null,Nn=null,_n=!0,Bn=0,Wn=!0;function Un(e){qn();const t=Ue("span",{attrs:{unselectable:"on",contenteditable:"false"}});t.setAttribute("class","e-dialog-border-resize e-"+e),"south"===e&&(t.style.height="2px",t.style.width="100%",t.style.bottom="0px",t.style.left="0px"),"north"===e&&(t.style.height="2px",t.style.width="100%",t.style.top="0px",t.style.left="0px"),"east"===e&&(t.style.height="100%",t.style.width="2px",t.style.right="0px",t.style.top="0px"),"west"===e&&(t.style.height="100%",t.style.width="2px",t.style.left="0px",t.style.top="0px"),xn.appendChild(t)}function Fn(e){let t;return d(e)||(t="string"==typeof e?document.querySelector(e):e),t}function Vn(e){d(e)&&(e=this);const t=xn.querySelectorAll(".e-resize-handle");for(let n=0;n<t.length;n++)Sn=t[n],$.add(Sn,"mousedown",Yn,e),$.add(Sn,"msie"===Z.info.name?"pointerdown":"touchstart",Zn,e);const i=xn.querySelectorAll(".e-dialog-border-resize");if(!d(i))for(let n=0;n<i.length;n++)Sn=i[n],$.add(Sn,"mousedown",Yn,e),$.add(Sn,"msie"===Z.info.name?"pointerdown":"touchstart",Zn,e)}function Xn(e){return e.indexOf("mouse")>-1?"mouse":"touch"}function Yn(e){if(e.preventDefault(),xn=e.target.parentElement,qn(),Mn=e.pageX,kn=e.pageY,e.target.classList.add(yn),!d(jn)&&(In=this,!0===jn(e,In)))return;const t=d(En)?document:En;$.add(t,"mousemove",$n,this),$.add(document,"mouseup",Gn,this);for(let i=0;i<bn.length;i++)_n=!xn.classList.contains(bn[i])}function Gn(e){const t="msie"===Z.info.name?"pointermove":"touchmove",i="msie"===Z.info.name?"pointerup":"touchend",n=d(En)?document:En,r="msie"===Z.info.name?"pointerdown":"touchstart";$.remove(n,"mousemove",$n),$.remove(n,t,$n),$.remove(n,r,$n),d(document.body.querySelector(".e-focused-handle"))||document.body.querySelector(".e-focused-handle").classList.remove(yn),d(Nn)||(In=this,Nn(e,In)),$.remove(document,"mouseup",Gn),$.remove(document,i,Gn)}function qn(){Dn=parseFloat(getComputedStyle(xn,null).getPropertyValue("width").replace("px","")),Rn=parseFloat(getComputedStyle(xn,null).getPropertyValue("height").replace("px","")),Ln=xn.getBoundingClientRect().left,zn=xn.getBoundingClientRect().top}function Zn(e){xn=e.target.parentElement,qn();const t=e.touches?e.changedTouches[0]:e;if(Mn=t.pageX,kn=t.pageY,!d(jn)&&(In=this,!0===jn(e,In)))return;const i="msie"===Z.info.name?"pointermove":"touchmove",n="msie"===Z.info.name?"pointerup":"touchend",r=d(En)?document:En;$.add(r,i,$n,this),$.add(document,n,Gn)}function $n(e){if(e.target.classList.contains("e-resize-handle")&&e.target.classList.contains(yn)?Sn=e.target:d(document.body.querySelector(".e-focused-handle"))||(Sn=document.body.querySelector(".e-focused-handle")),!d(Sn)){let t="";for(let e=0;e<fn.length;e++)Sn.classList.contains("e-"+fn[e])&&(t=fn[e]);switch(d(Hn)||(In=this,Hn(e,In)),t){case"south":Jn(e);break;case"north":Kn(e);break;case"west":er(e);break;case"east":tr(e);break;case"south-east":Jn(e),tr(e);break;case"south-west":Jn(e),er(e);break;case"north-east":Kn(e),tr(e);break;case"north-west":Kn(e),er(e)}}}function Qn(e){return e.getBoundingClientRect()}function Jn(e){const t=document.documentElement.clientHeight;let i=!1;const n=(e.touches?e.changedTouches[0]:e).pageY,r=Qn(xn);let s;d(En)||(s=Qn(En)),d(En)?d(En)&&(t-n>=0||r.top<0)&&(i=!0):i=!0;let o=Rn+(n-kn);o=o>Cn?o:Cn;let a=0;d(En)||(a=s.top);const l=d(En)?0:En.offsetHeight-En.clientHeight;let h=r.top-a-l/2;if(h=h<0?0:h,r.top>0&&h+o>Pn){if(i=!1,xn.classList.contains(vn))return;return void(xn.style.height=Pn-parseInt(h.toString(),10)+"px")}let c=0;if(i){r.top<0&&t+(r.height+r.top)>0&&(c=r.top,o+c<=30&&(o=r.height-(r.height+r.top)+30)),o+r.top>=Pn&&(xn.style.height=r.height+(t-(r.height+r.top))+"px");const e=d(En)?c:h;o>=Cn&&o+e<=Pn&&(xn.style.height=o+"px")}}function Kn(e){let t,i=!1;const n="mouse"===Xn(e.type)?e.pageY:e.touches[0].pageY,r=Qn(xn);d(En)||(t=Qn(En)),(!d(En)&&r.top-t.top>0||d(En)&&n>0)&&(i=!0);const s=Rn-(n-kn);if(i&&s>=Cn&&s<=Pn){let e=0;d(En)||(e=t.top);let i=zn-e+(n-kn);i=i>0?i:1,xn.style.height=s+"px",xn.style.top=i+"px"}}function er(e){const t=document.documentElement.clientWidth;let i,n=!1;d(En)||(i=Qn(En));const r="mouse"===Xn(e.type)?e.pageX:e.touches[0].pageX,s=Qn(xn),o=d(En)?0:En.offsetWidth-En.clientWidth;let a=d(En)?0:i.left,l=d(En)?0:i.width;d(An)&&(d(En)?An=t:(An=s.left-a-o/2+s.width,An+=l-o-An)),(!d(En)&&Math.floor(s.left-i.left+s.width+(i.right-s.right))-o<=Tn||d(En)&&r>=0)&&(n=!0);let h=Dn-(r-Mn);if(_n&&(h=h>An?An:h),n&&h>=On&&h<=Tn){let e=0;d(En)||(e=i.left);let t=Ln-e+(r-Mn);t=t>0?t:1,h!==Bn&&Wn&&(xn.style.width=h+"px"),_n&&(xn.style.left=t+"px",Wn=1!==t)}Bn=h}function tr(e){const t=document.documentElement.clientWidth;let i,n=!1;d(En)||(i=Qn(En));const r=(e.touches?e.changedTouches[0]:e).pageX,s=Qn(xn);(!d(En)&&(s.left-i.left+s.width<=Tn||s.right-i.left>=s.width)||d(En)&&t-r>0)&&(n=!0);const o=Dn+(r-Mn);let a=0;if(d(En)||(a=i.left),s.left-a+o>Tn){if(n=!1,xn.classList.contains(vn))return;xn.style.width=Tn-(s.left-a)+"px"}n&&o>=On&&o<=Tn&&(xn.style.width=o+"px")}function ir(){const e=xn.querySelectorAll(".e-resize-handle");for(let i=0;i<e.length;i++)$e(e[i]);const t=xn.querySelectorAll(".e-dialog-border-resize");if(!d(t))for(let i=0;i<t.length;i++)$e(t[i])}var nr=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let rr=(()=>{class e extends Ht{}return nr([xt(!0)],e.prototype,"isFlat",void 0),nr([xt()],e.prototype,"buttonModel",void 0),nr([xt("Button")],e.prototype,"type",void 0),nr([Ot()],e.prototype,"click",void 0),e})(),sr=(()=>{class e extends Ht{}return nr([xt("Fade")],e.prototype,"effect",void 0),nr([xt(400)],e.prototype,"duration",void 0),nr([xt(0)],e.prototype,"delay",void 0),e})();const or="e-dialog",ar="e-rtl",lr="e-dlg-header-content",hr="e-dlg-header",cr="e-footer-content",dr="e-dlg-modal",pr="e-icon-dlg-close",ur="e-dlg-target",gr="e-scroll-disabled",mr="e-device",fr="e-dlg-fullscreen",yr="e-popup-open",br="Information",vr="e-scroll-disabled",wr="e-alert-dialog",xr="e-confirm-dialog",Sr="e-dlg-resizable",Cr="e-restrict-left",Pr="e-resize-viewport",Or="user action";let Tr=(()=>{let e=class extends Ut{constructor(e,t){super(e,t),this.dlgClosedBy=Or}render(){this.initialize(),this.initRender(),this.wireEvents(),"100%"===this.width&&(this.element.style.width=""),""!==this.minHeight&&(this.element.style.minHeight=f(this.minHeight)),this.enableResize&&(this.setResize(),"None"===this.animationSettings.effect&&this.getMinHeight()),this.renderComplete()}preRender(){if(this.headerContent=null,this.allowMaxHeight=!0,this.preventVisibility=!0,this.clonedEle=this.element.cloneNode(!0),this.closeIconClickEventHandler=e=>{this.dlgClosedBy="close icon",this.hide(e)},this.dlgOverlayClickEventHandler=e=>{this.dlgClosedBy="overlayClick",e.preventFocus=!1,this.trigger("overlayClick",e,e=>{e.preventFocus||this.focusContent(),this.dlgClosedBy=Or})},this.l10n=new Qt("dialog",{close:"Close"},this.locale),this.checkPositionData(),d(this.target)){const e=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.target=document.body,this.isProtectedOnChange=e}}isNumberValue(e){return/^[-+]?\d*\.?\d+$/.test(e)}checkPositionData(){if(!d(this.position)){if(!d(this.position.X)&&"number"!=typeof this.position.X&&this.isNumberValue(this.position.X)){const e=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.position.X=parseFloat(this.position.X),this.isProtectedOnChange=e}if(!d(this.position.Y)&&"number"!=typeof this.position.Y&&this.isNumberValue(this.position.Y)){const e=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.position.Y=parseFloat(this.position.Y),this.isProtectedOnChange=e}}}getEle(e,t){let i;for(let n=0;n<e.length;n++)if(e[n].classList.contains(t)){i=e[n];break}return i}getMinHeight(){let e="0px",t="0px";d(this.element.querySelector("."+lr))||(e=getComputedStyle(this.headerContent).height);const i=this.getEle(this.element.children,cr);d(i)||(t=getComputedStyle(i).height);const n=parseInt(e.slice(0,e.indexOf("p")),10),r=parseInt(t.slice(0,t.indexOf("p")),10);var s;return s=n+30+(isNaN(r)?0:r),Cn=s,n+30+r}onResizeStart(e,t){return t.trigger("resizeStart",e),e.cancel}onResizing(e,t){t.trigger("resizing",e)}onResizeComplete(e,t){t.trigger("resizeStop",e)}setResize(){if(this.enableResize){if(this.isBlazorServerRender()&&!d(this.element.querySelector(".e-icons.e-resize-handle")))return;this.element.classList.add(Sr);const e=getComputedStyle(this.element).minHeight,t=getComputedStyle(this.element).minWidth;let i="";for(let n=0;n<this.resizeHandles.length;n++){if("All"===this.resizeHandles[n]){i="south north east west north-east north-west south-east south-west";break}{let e="";switch(this.resizeHandles[n].toString()){case"SouthEast":e="south-east";break;case"SouthWest":e="south-west";break;case"NorthEast":e="north-east";break;case"NorthWest":e="north-west";break;default:e=this.resizeHandles[n].toString()}i+=e.toLocaleLowerCase()+" "}}this.enableRtl&&"south-east"===i.trim()?i="south-west":this.enableRtl&&"south-west"===i.trim()&&(i="south-east"),this.isModal&&this.enableRtl?this.element.classList.add(Cr):this.isModal&&this.target===document.body&&this.element.classList.add(Pr),function(e){jn=e.resizeBegin,Hn=e.resizing,Nn=e.resizeComplete,xn=Fn(e.element),En=Fn(e.boundary);const t=e.direction.split(" ");for(let i=0;i<t.length;i++)if(wn.indexOf(t[i])>=0&&t[i])Un(t[i]);else if(""!==t[i].trim()){const e=Ue("div",{className:"e-icons e-resize-handle e-"+t[i]});xn.appendChild(e)}Cn=e.minHeight,On=e.minWidth,Tn=e.maxWidth,Pn=e.maxHeight,e.proxy&&e.proxy.element&&e.proxy.element.classList.contains("e-dialog")?Vn(e.proxy):Vn()}({element:this.element,direction:i,minHeight:parseInt(e.slice(0,t.indexOf("p")),10),maxHeight:this.targetEle.clientHeight,minWidth:parseInt(t.slice(0,t.indexOf("p")),10),maxWidth:this.targetEle.clientWidth,boundary:this.target===document.body?null:this.targetEle,resizeBegin:this.onResizeStart.bind(this),resizeComplete:this.onResizeComplete.bind(this),resizing:this.onResizing.bind(this),proxy:this}),this.wireWindowResizeEvent()}else ir(),this.unWireWindowResizeEvent(),this.element.classList.remove(this.isModal?Cr:Pr),this.element.classList.remove(Sr)}getFocusElement(e){const t=e.querySelectorAll('input,select,textarea,button:enabled,a,[contenteditable="true"],[tabindex]');return{element:t[t.length-1]}}keyDown(e){if(9===e.keyCode&&this.isModal){let t;d(this.btnObj)||(t=this.btnObj[this.btnObj.length-1]),d(this.btnObj)&&!d(this.ftrTemplateContent)&&(t=this.getFocusElement(this.ftrTemplateContent)),d(this.btnObj)&&d(this.ftrTemplateContent)&&!d(this.contentEle)&&(t=this.getFocusElement(this.contentEle)),d(t)||document.activeElement!==t.element||e.shiftKey||(e.preventDefault(),this.focusableElements(this.element).focus()),document.activeElement===this.focusableElements(this.element)&&e.shiftKey&&(e.preventDefault(),d(t)||t.element.focus())}const t=document.activeElement,i=["input","textarea"].indexOf(t.tagName.toLowerCase())>-1;let n=!1;if(i||(n=t.hasAttribute("contenteditable")&&"true"===t.getAttribute("contenteditable")),27===e.keyCode&&this.closeOnEscape&&(this.dlgClosedBy="escape",this.hide(e)),13===e.keyCode&&!e.ctrlKey&&"textarea"!==t.tagName.toLowerCase()&&i&&!d(this.primaryButtonEle)||13===e.keyCode&&e.ctrlKey&&("textarea"===t.tagName.toLowerCase()||n)&&!d(this.primaryButtonEle)){let t;this.buttons.some((e,i)=>{t=i;let n=e.buttonModel;return!d(n)&&!0===n.isPrimary})&&"function"==typeof this.buttons[t].click&&setTimeout(()=>{this.buttons[t].click.call(this,e)})}}initialize(){d(this.target)||(this.targetEle="string"==typeof this.target?document.querySelector(this.target):this.target),this.isBlazorServerRender()||Fe([this.element],or),Z.isDevice&&Fe([this.element],mr),this.isBlazorServerRender()||this.setCSSClass(),this.setMaxHeight()}initRender(){if(this.initialRender=!0,this.isBlazorServerRender()||Je(this.element,{role:"dialog"}),1e3===this.zIndex?(this.setzIndex(this.element,!1),this.calculatezIndex=!0):this.calculatezIndex=!1,this.isBlazorServerRender()&&d(this.headerContent)&&(this.headerContent=this.element.getElementsByClassName("e-dlg-header-content")[0]),this.isBlazorServerRender()&&d(this.contentEle)&&(this.contentEle=this.element.querySelector("#"+this.element.id+"_dialog-content")),this.isBlazorServerRender()||(this.setTargetContent(),""===this.header||d(this.header)||this.setHeader(),this.showCloseIcon&&this.renderCloseIcon(),this.setContent(),""===this.footerTemplate||d(this.footerTemplate)?d(this.buttons[0].buttonModel)||this.setButton():this.setFooterTemplate()),this.isBlazorServerRender()&&(d(this.buttons[0].buttonModel)||""!==this.footerTemplate||this.setButton()),this.allowDragging&&!d(this.headerContent)&&this.setAllowDragging(),this.isBlazorServerRender()||(Je(this.element,{"aria-modal":this.isModal?"true":"false"}),this.isModal&&this.setIsModal()),this.isBlazorServerRender()&&d(this.dlgContainer)){this.dlgContainer=this.element.parentElement;for(let e=0,t=this.dlgContainer.children;e<t.length;e++)t[e].classList.contains("e-dlg-overlay")&&(this.dlgOverlay=t[e])}if(!0!==this.element.classList.contains(wr)&&!0!==this.element.classList.contains(xr)&&!d(this.element.parentElement)){const e=this.isModal?this.dlgContainer.parentElement:this.element.parentElement;this.refElement=this.createElement("div",{className:"e-dlg-ref-element"}),e.insertBefore(this.refElement,this.isModal?this.dlgContainer:this.element)}d(this.targetEle)||this.targetEle.appendChild(this.isModal?this.dlgContainer:this.element),this.popupObj=new gn(this.element,{height:this.height,width:this.width,zIndex:this.zIndex,relateTo:this.target,actionOnScroll:"none",enableRtl:this.enableRtl,open:e=>{const t={container:this.isModal?this.dlgContainer:this.element,element:this.element,target:this.target,preventFocus:!1};this.enableResize&&this.resetResizeIcon(),this.trigger("open",t,e=>{e.preventFocus||this.focusContent()})},close:e=>{this.isModal&&Fe([this.dlgOverlay],"e-fade"),this.unBindEvent(this.element),this.isModal&&(this.dlgContainer.style.display="none"),this.trigger("close",this.closeArgs);const t=document.activeElement;d(t)||d(t.blur)||t.blur(),d(this.storeActiveElement)||d(this.storeActiveElement.focus)||this.storeActiveElement.focus()}}),this.positionChange(),this.setEnableRTL(),this.isBlazorServerRender()||(Fe([this.element],"e-popup-close"),this.isModal&&this.setOverlayZindex()),this.visible?this.show():this.isModal&&(this.dlgOverlay.style.display="none"),this.initialRender=!1}resetResizeIcon(){const e=this.getMinHeight();if(this.targetEle.offsetHeight<e){const t=this.element.querySelector("."+(this.enableRtl?"e-south-west":"e-south-east"));d(t)||(t.style.bottom="-"+e.toString()+"px")}}setOverlayZindex(e){let t;t=d(e)?parseInt(this.element.style.zIndex,10)?parseInt(this.element.style.zIndex,10):this.zIndex:e,this.dlgOverlay.style.zIndex=(t-1).toString(),this.dlgContainer.style.zIndex=t.toString()}positionChange(){this.isModal&&(isNaN(parseFloat(this.position.X))||isNaN(parseFloat(this.position.Y)))?!isNaN(parseFloat(this.position.X))&&isNaN(parseFloat(this.position.Y))||isNaN(parseFloat(this.position.X))&&!isNaN(parseFloat(this.position.Y))?this.setPopupPosition():(this.element.style.top="0px",this.element.style.left="0px",this.dlgContainer.classList.add("e-dlg-"+this.position.X+"-"+this.position.Y)):this.setPopupPosition()}setPopupPosition(){this.popupObj.setProperties({position:{X:this.position.X,Y:this.position.Y}})}setAllowDragging(){this.dragObj=new qt(this.element,{clone:!1,isDragScroll:!0,abort:".e-dlg-closeicon-btn",handle:".e-dlg-header-content",dragStart:e=>{this.trigger("dragStart",e,e=>{})},dragStop:e=>{this.isModal&&(d(this.position)||this.dlgContainer.classList.remove("e-dlg-"+this.position.X+"-"+this.position.Y),this.element.style.position="relative"),this.trigger("dragStop",e),this.element.classList.remove(Cr)},drag:e=>{this.trigger("drag",e)}}),d(this.targetEle)||(this.dragObj.dragArea=this.targetEle)}setButton(){if(!this.isBlazorServerRender()){this.buttonContent=[],this.btnObj=[];for(let e=0;e<this.buttons.length;e++){const t=d(this.buttons[e].type)?"button":this.buttons[e].type.toLowerCase(),i=this.createElement("button",{attrs:{type:t}});this.buttonContent.push(i.outerHTML)}this.setFooterTemplate()}let e;for(let t=0,i=this.element.children;t<i.length;t++)i[t].classList.contains(cr)&&(e=i[t].querySelectorAll("button"));for(let t=0;t<this.buttons.length;t++)this.isBlazorServerRender()||(this.btnObj[t]=new Ai(this.buttons[t].buttonModel)),this.isBlazorServerRender()&&(this.ftrTemplateContent=this.element.querySelector(".e-footer-content")),!d(this.ftrTemplateContent)&&e.length>0&&("function"==typeof this.buttons[t].click&&$.add(e[t],"click",this.buttons[t].click,this),"object"==typeof this.buttons[t].click&&$.add(e[t],"click",this.buttonClickHandler.bind(this,t),this)),this.isBlazorServerRender()||d(this.ftrTemplateContent)||(this.btnObj[t].appendTo(this.ftrTemplateContent.children[t]),this.buttons[t].isFlat&&this.btnObj[t].element.classList.add("e-flat"),this.primaryButtonEle=this.element.getElementsByClassName("e-primary")[0])}buttonClickHandler(e){this.trigger("buttons["+e+"].click",{})}setContent(){Je(this.element,{"aria-describedby":this.element.id+"_dialog-content"}),this.contentEle=this.createElement("div",{className:"e-dlg-content",id:this.element.id+"_dialog-content"}),this.innerContentElement?this.contentEle.appendChild(this.innerContentElement):(d(this.content)||""===this.content)&&this.initialRender||("string"!=typeof this.content?this.content instanceof HTMLElement?this.contentEle.appendChild(this.content):this.setTemplate(this.content,this.contentEle,"content"):this.contentEle.innerHTML=this.sanitizeHelper(this.content)),d(this.headerContent)?this.element.insertBefore(this.contentEle,this.element.children[0]):this.element.insertBefore(this.contentEle,this.element.children[1]),"auto"===this.height&&(this.isBlazorServerRender()||!Z.isIE||""!==this.element.style.width||d(this.width)||(this.element.style.width=f(this.width)),this.setMaxHeight())}setTemplate(e,t,i){let n,r,s;r=t.classList.contains(hr)?this.element.id+"header":t.classList.contains(cr)?this.element.id+"footerTemplate":this.element.id+"content",d(e.outerHTML)?"string"!=typeof e?(n=Se(e),s=e):t.innerHTML=this.sanitizeHelper(e):t.appendChild(e);const o=[];if(!d(n)){const e=!0;for(const t of n({},this,i,r,e))o.push(t);qe([].slice.call(o),t)}}sanitizeHelper(e){if(this.enableHtmlSanitizer){const t=si.beforeSanitize();c(t,t,{cancel:!1,helper:null}),this.trigger("beforeSanitizeHtml",t),t.cancel&&!d(t.helper)?e=t.helper(e):t.cancel||(e=si.serializeValue(t,e))}return e}setMaxHeight(){if(!this.allowMaxHeight)return;const e=this.element.style.display;this.element.style.display="none",this.element.style.maxHeight=!d(this.target)&&this.targetEle.offsetHeight<window.innerHeight?this.targetEle.offsetHeight-20+"px":window.innerHeight-20+"px",this.element.style.display=e,Z.isIE&&"auto"===this.height&&!d(this.contentEle)&&this.element.offsetHeight<this.contentEle.offsetHeight&&(this.element.style.height="inherit")}setEnableRTL(){this.isBlazorServerRender()||(this.enableRtl?Fe([this.element],ar):Ve([this.element],ar)),d(this.element.querySelector(".e-resize-handle"))||(ir(),this.setResize())}setTargetContent(){if(d(this.content)||""===this.content){const e=""!==this.element.innerHTML.replace(/\s|<(\/?|\/?)(!--!--)>/g,"");(this.element.children.length>0||e)&&(this.innerContentElement=document.createDocumentFragment(),[].slice.call(this.element.childNodes).forEach(e=>{8!==e.nodeType&&this.innerContentElement.appendChild(e)}))}}setHeader(){this.headerEle?this.headerEle.innerHTML="":this.headerEle=this.createElement("div",{id:this.element.id+"_title",className:hr}),this.createHeaderContent(),this.headerContent.appendChild(this.headerEle),this.setTemplate(this.header,this.headerEle,"header"),Je(this.element,{"aria-labelledby":this.element.id+"_title"}),this.element.insertBefore(this.headerContent,this.element.children[0])}setFooterTemplate(){this.ftrTemplateContent?this.ftrTemplateContent.innerHTML="":this.ftrTemplateContent=this.createElement("div",{className:cr}),""===this.footerTemplate||d(this.footerTemplate)?this.ftrTemplateContent.innerHTML=this.buttonContent.join(""):this.setTemplate(this.footerTemplate,this.ftrTemplateContent,"footerTemplate"),this.element.appendChild(this.ftrTemplateContent)}createHeaderContent(){d(this.headerContent)&&(this.headerContent=this.createElement("div",{id:this.element.id+"_dialog-header",className:lr}))}renderCloseIcon(){this.closeIcon=this.createElement("button",{className:"e-dlg-closeicon-btn",attrs:{type:"button"}}),this.closeIconBtnObj=new Ai({cssClass:"e-flat",iconCss:pr+" e-icons"}),this.closeIconTitle(),d(this.headerContent)?(this.createHeaderContent(),Ge([this.closeIcon],this.headerContent),this.element.insertBefore(this.headerContent,this.element.children[0])):Ge([this.closeIcon],this.headerContent),this.closeIconBtnObj.appendTo(this.closeIcon)}closeIconTitle(){this.l10n.setLocale(this.locale);const e=this.l10n.getConstant("close");this.closeIcon.setAttribute("title",e),this.closeIcon.setAttribute("aria-label",e)}setCSSClass(e){this.cssClass&&Fe([this.element],this.cssClass.split(" ")),e&&Ve([this.element],e.split(" "))}setIsModal(){this.dlgContainer=this.createElement("div",{className:"e-dlg-container"}),this.element.classList.remove(yr),this.element.parentNode.insertBefore(this.dlgContainer,this.element),this.dlgContainer.appendChild(this.element),Fe([this.element],dr),this.dlgOverlay=this.createElement("div",{className:"e-dlg-overlay"}),this.dlgOverlay.style.zIndex=(this.zIndex-1).toString(),this.dlgContainer.appendChild(this.dlgOverlay)}getValidFocusNode(e){let t;for(let i=0;i<e.length;i++){if(t=e[i],(t.clientHeight>0||"a"===t.tagName.toLowerCase()&&t.hasAttribute("href"))&&t.tabIndex>-1&&!t.disabled&&!this.disableElement(t,'[disabled],[aria-disabled="true"],[type="hidden"]'))return t;t=null}return t}focusableElements(e){if(!d(e)){const t=e.querySelectorAll('input,select,textarea,button,a,[contenteditable="true"],[tabindex]');return this.getValidFocusNode(t)}return null}getAutoFocusNode(e){let t=e.querySelector(".e-dlg-closeicon-btn");const i=e.querySelectorAll("[autofocus]");let n=this.getValidFocusNode(i);if(d(n)){if(n=this.focusableElements(this.contentEle),!d(n))return n;if(!d(this.primaryButtonEle))return this.element.querySelector(".e-primary")}else t=n;return t}disableElement(e,t){const i=e?e.matches||e.webkitMatchesSelector||e.msGetRegionContent:null;if(i)for(;e;e=e.parentNode)if(e instanceof Element&&i.call(e,t))return e;return null}focusContent(){const e=this.getAutoFocusNode(this.element),t=d(e)?this.element:e,i=Z.userAgent;(i.indexOf("MSIE ")>0||i.indexOf("Trident/")>0)&&this.element.focus(),t.focus(),this.bindEvent(this.element)}bindEvent(e){$.add(e,"keydown",this.keyDown,this)}unBindEvent(e){$.remove(e,"keydown",this.keyDown)}updateSanitizeContent(){this.isBlazorServerRender()||(this.contentEle.innerHTML=this.sanitizeHelper(this.content))}isBlazorServerRender(){return!1}getModuleName(){return"dialog"}onPropertyChanged(e,t){if(this.element.classList.contains(or))for(const i of Object.keys(e))switch(i){case"content":d(this.content)||""===this.content?d(this.contentEle)||($e(this.contentEle),this.contentEle=null):(this.isBlazorServerRender()&&(this.contentEle=this.element.querySelector(".e-dlg-content")),d(this.contentEle)||"dialog"===this.contentEle.getAttribute("role")?this.isBlazorServerRender()&&!d(this.element.querySelector(".e-dlg-content"))||this.setContent():(this.isBlazorServerRender()||(this.contentEle.innerHTML=""),"function"==typeof this.content?(this.clearTemplate(["content"]),$e(this.contentEle),this.contentEle=null,this.setContent()):"string"==typeof this.content?this.isBlazorServerRender()&&""===this.contentEle.innerText?this.contentEle.insertAdjacentHTML("beforeend",this.sanitizeHelper(this.content)):this.updateSanitizeContent():this.contentEle.appendChild(this.content),this.setMaxHeight()));break;case"header":""===this.header||d(this.header)?this.headerEle&&($e(this.headerEle),this.headerEle=null):this.isBlazorServerRender()&&!d(this.element.querySelector(".e-dlg-header-content"))||this.setHeader();break;case"footerTemplate":if(""===this.footerTemplate||d(this.footerTemplate)){if(!this.ftrTemplateContent)return;$e(this.ftrTemplateContent),this.ftrTemplateContent=null,this.buttons=[{}]}else this.isBlazorServerRender()&&!d(this.element.querySelector(".e-footer-content"))||this.setFooterTemplate(),this.buttons=[{}];break;case"showCloseIcon":this.element.getElementsByClassName(pr).length>0?this.showCloseIcon||""!==this.header&&!d(this.header)?this.showCloseIcon?this.isBlazorServerRender()&&this.wireEvents():$e(this.closeIcon):($e(this.headerContent),this.headerContent=null):(this.isBlazorServerRender()||this.renderCloseIcon(),this.wireEvents());break;case"locale":this.showCloseIcon&&this.closeIconTitle();break;case"visible":this.visible?this.show():this.hide();break;case"isModal":this.updateIsModal();break;case"height":nt(this.element,{height:f(e.height)});break;case"width":nt(this.element,{width:f(e.width)});break;case"zIndex":this.popupObj.zIndex=this.zIndex,this.isModal&&this.setOverlayZindex(this.zIndex),this.element.style.zIndex!==this.zIndex.toString()&&(this.calculatezIndex=!1);break;case"cssClass":this.setCSSClass(t.cssClass);break;case"buttons":{const e=this.buttons.length;d(this.ftrTemplateContent)||this.isBlazorServerRender()||($e(this.ftrTemplateContent),this.ftrTemplateContent=null);for(let t=0;t<e;t++)d(this.buttons[t].buttonModel)||(this.footerTemplate="",this.setButton());break}case"allowDragging":this.allowDragging&&!d(this.headerContent)?this.setAllowDragging():this.dragObj.destroy();break;case"target":this.setTarget(e.target);break;case"position":if(this.checkPositionData(),this.isModal){const e=d(t.position.X)?this.position.X:t.position.X,i=d(t.position.Y)?this.position.Y:t.position.Y;this.dlgContainer.classList.contains("e-dlg-"+e+"-"+i)&&this.dlgContainer.classList.remove("e-dlg-"+e+"-"+i)}this.positionChange();break;case"enableRtl":this.setEnableRTL();break;case"enableResize":this.setResize()}}setTarget(e){this.popupObj.relateTo=e,this.target=e,this.targetEle="string"==typeof this.target?document.querySelector(this.target):this.target,this.dragObj&&(this.dragObj.dragArea=this.targetEle),this.setMaxHeight(),this.isModal&&this.updateIsModal(),this.enableResize&&this.setResize()}updateIsModal(){if(this.element.setAttribute("aria-modal",this.isModal?"true":"false"),this.isModal)this.setIsModal(),this.element.style.top="0px",this.element.style.left="0px",d(this.targetEle)||this.targetEle.appendChild(this.dlgContainer);else{for(Ve([this.element],dr),Ve([document.body],[ur,gr]),$e(this.dlgOverlay);this.dlgContainer.firstChild;)this.dlgContainer.parentElement.insertBefore(this.dlgContainer.firstChild,this.dlgContainer);this.dlgContainer.parentElement.removeChild(this.dlgContainer)}this.visible&&this.show(),this.positionChange(),this.isModal&&this.dlgOverlay&&$.add(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler,this)}setzIndex(e,t){const i=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.zIndex=mn(e),this.isProtectedOnChange=i,t&&(this.popupObj.zIndex=this.zIndex)}windowResizeHandler(){Tn=this.targetEle.clientWidth,Pn=this.targetEle.clientHeight,this.setMaxHeight()}getPersistData(){return this.addOnPersist([])}destroy(){if(this.isDestroyed)return;const e=[ar,dr,Sr,Cr,fr,mr],t=["role","aria-modal","aria-labelledby","aria-describedby","aria-grabbed","tabindex","style"];if(Ve([this.targetEle],[ur,gr]),!d(this.element)&&this.element.classList.contains(fr)&&Ve([document.body],[ur,gr]),this.isModal&&Ve([d(this.targetEle)?document.body:this.targetEle],gr),this.unWireEvents(),!d(this.btnObj))for(let i=0;i<this.btnObj.length;i++)this.btnObj[i].destroy();if(d(this.dragObj)||this.dragObj.destroy(),!d(this.popupObj.element)&&this.popupObj.element.classList.contains("e-popup")&&this.popupObj.destroy(),Ve([this.element],e),d(this.cssClass)||""===this.cssClass||Ve([this.element],this.cssClass.split(" ")),d(this.refElement)||d(this.refElement.parentElement)||(this.refElement.parentElement.insertBefore(this.isModal?this.dlgContainer:this.element,this.refElement),$e(this.refElement),this.refElement=void 0),this.isModal&&!this.isBlazorServerRender()&&($e(this.dlgOverlay),this.dlgContainer.parentNode.insertBefore(this.element,this.dlgContainer),$e(this.dlgContainer)),this.isBlazorServerRender()||(this.element.innerHTML=this.clonedEle.innerHTML),this.isBlazorServerRender()&&!d(this.element.children))for(let i=0;i<=this.element.children.length;i++)i-=i,$e(this.element.children[i]);for(let i=0;i<t.length;i++)this.element.removeAttribute(t[i]);this.isBlazorServerRender()?this.isDestroyed=!0:super.destroy(),this.isReact&&this.clearTemplate()}wireWindowResizeEvent(){window.addEventListener("resize",this.windowResizeHandler.bind(this))}unWireWindowResizeEvent(){window.removeEventListener("resize",this.windowResizeHandler.bind(this))}wireEvents(){this.isBlazorServerRender()&&this.showCloseIcon&&(this.closeIcon=this.element.getElementsByClassName("e-dlg-closeicon-btn")[0]),this.showCloseIcon&&$.add(this.closeIcon,"click",this.closeIconClickEventHandler,this),this.isModal&&this.dlgOverlay&&$.add(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler,this)}unWireEvents(){if(this.showCloseIcon&&$.remove(this.closeIcon,"click",this.closeIconClickEventHandler),this.isModal&&$.remove(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler),this.buttons.length>0&&!d(this.buttons[0].buttonModel)&&""===this.footerTemplate)for(let e=0;e<this.buttons.length;e++)"function"==typeof this.buttons[e].click&&$.remove(this.ftrTemplateContent.children[e],"click",this.buttons[e].click)}refreshPosition(){this.popupObj.refreshPosition()}show(e){if(this.element.classList.contains(or)){if(!this.element.classList.contains(yr)||!d(e)){d(e)||this.fullScreen(e);const t={cancel:!1,element:this.element,container:this.isModal?this.dlgContainer:this.element,target:this.target,maxHeight:this.element.style.maxHeight};this.trigger("beforeOpen",t,e=>{if(!e.cancel){this.element.style.maxHeight!==t.maxHeight&&(this.allowMaxHeight=!1,this.element.style.maxHeight=t.maxHeight),this.storeActiveElement=document.activeElement,this.element.tabIndex=-1,this.isModal&&!d(this.dlgOverlay)&&(this.dlgOverlay.style.display="block",this.dlgContainer.style.display="flex",Ve([this.dlgOverlay],"e-fade"),d(this.targetEle)?Fe([document.body],[ur,gr]):(this.dlgContainer.style.position=this.targetEle===document.body?"fixed":"absolute",this.dlgOverlay.style.position="absolute",this.element.style.position="relative",Fe([this.targetEle],[ur,gr])));const e={name:this.animationSettings.effect+"In",duration:this.animationSettings.duration,delay:this.animationSettings.delay},i=this.isModal?this.element.parentElement:this.element;this.calculatezIndex&&(this.setzIndex(i,!0),nt(this.element,{zIndex:this.zIndex}),this.isModal&&this.setOverlayZindex(this.zIndex)),"None"===this.animationSettings.effect?this.popupObj.show():this.popupObj.show(e),this.dialogOpen=!0;const n=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.visible=!0,this.preventVisibility=!0,this.isProtectedOnChange=n}})}this.isReact&&this.renderReactTemplates()}}hide(e){if(this.element.classList.contains(or)&&this.preventVisibility){const t={cancel:!1,isInteracted:!!e,element:this.element,target:this.target,container:this.isModal?this.dlgContainer:this.element,event:e,closedBy:this.dlgClosedBy};this.closeArgs=t,this.trigger("beforeClose",t,e=>{if(!e.cancel){this.isModal&&(d(this.targetEle)||Ve([this.targetEle],[ur,gr]),document.body.classList.contains(ur)&&document.body.classList.contains(gr)&&Ve([document.body],[ur,gr]));const e={name:this.animationSettings.effect+"Out",duration:this.animationSettings.duration,delay:this.animationSettings.delay};"None"===this.animationSettings.effect?this.popupObj.hide():this.popupObj.hide(e),this.dialogOpen=!1;const t=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.visible=!1,this.preventVisibility=!1,this.isProtectedOnChange=t}this.dlgClosedBy=Or})}}fullScreen(e){if(e){Fe([this.element],fr);const e=this.element.style.display;this.element.style.display="none",this.element.style.maxHeight=d(this.target)?window.innerHeight+"px":this.targetEle.offsetHeight+"px",this.element.style.display=e,Fe([document.body],[ur,gr]),this.allowDragging&&!d(this.dragObj)&&this.dragObj.destroy()}else Ve([this.element],fr),Ve([document.body],[ur,gr]),this.allowDragging&&!d(this.headerContent)&&this.setAllowDragging();return e}getButtons(e){return d(e)?this.btnObj:this.btnObj[e]}};return nr([xt("")],e.prototype,"content",void 0),nr([xt(!0)],e.prototype,"enableHtmlSanitizer",void 0),nr([xt(!1)],e.prototype,"showCloseIcon",void 0),nr([xt(!1)],e.prototype,"isModal",void 0),nr([xt("")],e.prototype,"header",void 0),nr([xt(!0)],e.prototype,"visible",void 0),nr([xt(!1)],e.prototype,"enableResize",void 0),nr([xt(["South-East"])],e.prototype,"resizeHandles",void 0),nr([xt("auto")],e.prototype,"height",void 0),nr([xt("")],e.prototype,"minHeight",void 0),nr([xt("100%")],e.prototype,"width",void 0),nr([xt("")],e.prototype,"cssClass",void 0),nr([xt(1e3)],e.prototype,"zIndex",void 0),nr([xt(null)],e.prototype,"target",void 0),nr([xt("")],e.prototype,"footerTemplate",void 0),nr([xt(!1)],e.prototype,"allowDragging",void 0),nr([Pt([{}],rr)],e.prototype,"buttons",void 0),nr([xt(!0)],e.prototype,"closeOnEscape",void 0),nr([St({},sr)],e.prototype,"animationSettings",void 0),nr([St({X:"center",Y:"center"},hn)],e.prototype,"position",void 0),nr([Ot()],e.prototype,"created",void 0),nr([Ot()],e.prototype,"open",void 0),nr([Ot()],e.prototype,"beforeSanitizeHtml",void 0),nr([Ot()],e.prototype,"beforeOpen",void 0),nr([Ot()],e.prototype,"close",void 0),nr([Ot()],e.prototype,"beforeClose",void 0),nr([Ot()],e.prototype,"dragStart",void 0),nr([Ot()],e.prototype,"dragStop",void 0),nr([Ot()],e.prototype,"drag",void 0),nr([Ot()],e.prototype,"overlayClick",void 0),nr([Ot()],e.prototype,"resizeStart",void 0),nr([Ot()],e.prototype,"resizing",void 0),nr([Ot()],e.prototype,"resizeStop",void 0),nr([Ot()],e.prototype,"destroyed",void 0),e=nr([Tt],e),e})();var Er;!function(e){function t(e,t){const i=new Tr(e);return i.appendTo(t),i}function i(e,t){return e.header=d(t.title)?br:t.title,e.content=d(t.content)?"":t.content,e.isModal=!!d(t.isModal)||t.isModal,e.showCloseIcon=!d(t.showCloseIcon)&&t.showCloseIcon,e.allowDragging=!d(t.isDraggable)&&t.isDraggable,e.closeOnEscape=!d(t.closeOnEscape)&&t.closeOnEscape,e.position=d(t.position)?{X:"center",Y:"top"}:t.position,e.animationSettings=d(t.animationSettings)?{effect:"Fade",duration:400,delay:0}:t.animationSettings,e.cssClass=d(t.cssClass)?"":t.cssClass,e.zIndex=d(t.zIndex)?1e3:t.zIndex,e.open=d(t.open)?null:t.open,e}function n(e,t,i){const n=i;return d(t.text)||(n.buttonModel.content=t.text),d(t.icon)||(n.buttonModel.iconCss=t.icon),d(t.cssClass)||(n.buttonModel.cssClass=t.cssClass),d(t.click)||(n.click=t.click),n}e.alert=function(e){const r=Ue("div",{className:wr});let s;return document.body.appendChild(r),s=t("string"==typeof e?{content:e,position:{X:"center",Y:"top"},isModal:!0,header:br,buttons:[{buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}}]}:function(e){let t={buttons:[]};return t=i(t,e),t=function(e,t){const i=[{buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}}];return d(t.okButton)?e.buttons=i:e.buttons[0]=n(0,t.okButton,i[0]),e}(t,e),t}(e),r),s.close=()=>{e&&e.close&&e.close.apply(s),s.destroy(),s.element.classList.contains("e-dlg-modal")?(s.element.parentElement.remove(),s.target.classList.remove(vr)):s.element.remove()},s},e.confirm=function(e){const r=Ue("div",{className:xr});let s;return document.body.appendChild(r),s=t("string"==typeof e?{position:{X:"center",Y:"top"},content:e,isModal:!0,header:br,buttons:[{buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}},{buttonModel:{content:"Cancel"},click:function(){this.hide()}}]}:function(e){let t={buttons:[]};return t=i(t,e),t=function(e,t){const i={buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}},r={buttonModel:{content:"Cancel"},click:function(){this.hide()}};return e.buttons[0]=d(t.okButton)?i:n(0,t.okButton,i),e.buttons[1]=d(t.cancelButton)?r:n(0,t.cancelButton,r),e}(t,e),t}(e),r),s.close=()=>{e&&e.close&&e.close.apply(s),s.destroy(),s.element.classList.contains("e-dlg-modal")?(s.element.parentElement.remove(),s.target.classList.remove(vr)):s.element.remove()},s}}(Er||(Er={}));var Ar=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};const Ir="e-tooltip",Dr="e-rtl",Rr="e-tip-content",Lr="e-arrow-tip",zr="e-arrow-tip-inner",Mr="e-tip-bottom",kr="e-tip-top",jr="e-tip-left",Hr="e-tip-right",Nr="e-popup-open",_r="e-popup-close";let Br=(()=>{class e extends Ht{}return Ar([xt({effect:"FadeIn",duration:150,delay:0})],e.prototype,"open",void 0),Ar([xt({effect:"FadeOut",duration:150,delay:0})],e.prototype,"close",void 0),e})(),Wr=(()=>{let e=class extends Ut{constructor(e,t){super(e,t),this.mouseMoveEvent=null,this.mouseMoveTarget=null}initialize(){this.formatPosition(),Fe([this.element],Ir)}formatPosition(){0===this.position.indexOf("Top")||0===this.position.indexOf("Bottom")?[this.tooltipPositionY,this.tooltipPositionX]=this.position.split(/(?=[A-Z])/):[this.tooltipPositionX,this.tooltipPositionY]=this.position.split(/(?=[A-Z])/)}renderArrow(){this.setTipClass(this.position);const e=this.createElement("div",{className:Lr+" "+this.tipClass});e.appendChild(this.createElement("div",{className:"e-arrow-tip-outer "+this.tipClass})),e.appendChild(this.createElement("div",{className:zr+" "+this.tipClass})),this.tooltipEle.appendChild(e)}setTipClass(e){this.tipClass=0===e.indexOf("Right")?jr:0===e.indexOf("Bottom")?kr:0===e.indexOf("Left")?Hr:Mr}renderPopup(e){const t=this.mouseTrail?{top:0,left:0}:this.getTooltipPosition(e);this.tooltipEle.classList.remove("e-lib"),this.popupObj=new gn(this.tooltipEle,{height:this.height,width:this.width,position:{X:t.left,Y:t.top},enableRtl:this.enableRtl,open:this.openPopupHandler.bind(this),close:this.closePopupHandler.bind(this)})}getTooltipPosition(e){this.tooltipEle.style.display="block";const t=Di(e,this.tooltipPositionX,this.tooltipPositionY),i=this.calculateTooltipOffset(this.position),n=this.collisionFlipFit(e,t.left+i.left,t.top+i.top);return this.tooltipEle.style.display="",n}reposition(e){const t=this.getTooltipPosition(e);this.popupObj.position={X:t.left,Y:t.top},this.popupObj.dataBind()}openPopupHandler(){!this.mouseTrail&&this.needTemplateReposition()&&this.reposition(this.findTarget()),this.trigger("afterOpen",this.tooltipEventArgs)}closePopupHandler(){this.clearTemplate(["content"]),this.clear(),this.trigger("afterClose",this.tooltipEventArgs)}calculateTooltipOffset(e){const t={top:0,left:0},i=this.tooltipEle.offsetWidth,n=this.tooltipEle.offsetHeight,r=Ke("."+Lr,this.tooltipEle),s=r?r.offsetWidth:0,o=r?r.offsetHeight:0;let a=this.showTipPointer?0:8;const l=o/2+2+(this.tooltipEle.offsetHeight-this.tooltipEle.clientHeight),h=s/2+2+(this.tooltipEle.offsetWidth-this.tooltipEle.clientWidth);switch(this.mouseTrail&&(a+=2),e){case"RightTop":t.left+=s+a,t.top-=n-l;break;case"RightCenter":t.left+=s+a,t.top-=n/2;break;case"RightBottom":t.left+=s+a,t.top-=l;break;case"BottomRight":t.top+=o+a,t.left-=h;break;case"BottomCenter":t.top+=o+a,t.left-=i/2;break;case"BottomLeft":t.top+=o+a,t.left-=i-h;break;case"LeftBottom":t.left-=s+i+a,t.top-=l;break;case"LeftCenter":t.left-=s+i+a,t.top-=n/2;break;case"LeftTop":t.left-=s+i+a,t.top-=n-l;break;case"TopLeft":t.top-=n+o+a,t.left-=i-h;break;case"TopRight":t.top-=n+o+a,t.left-=h;break;default:t.top-=n+o+a,t.left-=i/2}return t.left+=this.offsetX,t.top+=this.offsetY,t}updateTipPosition(e){const t=et(".e-arrow-tip,.e-arrow-tip-outer,."+zr,this.tooltipEle);Ve(t,[Mr,kr,jr,Hr]),this.setTipClass(e),Fe(t,this.tipClass)}adjustArrow(e,t,i,n){if(!1===this.showTipPointer)return;let r,s;this.updateTipPosition(t),this.tooltipEle.style.display="block";const o=this.tooltipEle.clientWidth,a=this.tooltipEle.clientHeight,l=Ke("."+Lr,this.tooltipEle),h=Ke("."+zr,this.tooltipEle),c=l.offsetWidth,d=l.offsetHeight;if(this.tooltipEle.style.display="",this.tipClass===Mr||this.tipClass===kr){if(this.tipClass===Mr?(s="99.9%",h.style.top="-"+(d-2)+"px"):(s=-(d-1)+"px",h.style.top="-"+(d-6)+"px"),e){const t="Center"!==i||o>e.offsetWidth||this.mouseTrail;r=t&&"Left"===i||!t&&"End"===this.tipPointerPosition?o-c-2+"px":t&&"Right"===i||!t&&"Start"===this.tipPointerPosition?"2px":o/2-c/2+"px"}}else{this.tipClass===Hr?(r="99.9%",h.style.left="-"+(c-2)+"px"):(r=-(c-1)+"px",h.style.left=c-2-c+"px");const t="Center"!==n||a>e.offsetHeight||this.mouseTrail;s=t&&"Top"===n||!t&&"End"===this.tipPointerPosition?a-d-2+"px":t&&"Bottom"===n||!t&&"Start"===this.tipPointerPosition?"2px":a/2-d/2+"px"}l.style.top=s,l.style.left=r}renderContent(e){const t=Ke("."+Rr,this.tooltipEle);if(this.cssClass&&Fe([this.tooltipEle],this.cssClass.split(" ")),e&&!d(e.getAttribute("title"))&&(e.setAttribute("data-content",e.getAttribute("title")),e.removeAttribute("title")),d(this.content))e&&!d(e.getAttribute("data-content"))&&(t.innerHTML=e.getAttribute("data-content"));else if(t.innerHTML="",this.content instanceof HTMLElement)t.appendChild(this.content);else if("string"==typeof this.content)this.enableHtmlSanitizer&&this.setProperties({content:si.sanitize(this.content)},!0),t[this.enableHtmlParse?"innerHTML":"textContent"]=this.content;else{const e=Se(this.content)({},this,"content",this.element.id+"content",void 0,void 0,t);e&&qe(e,t),this.renderReactTemplates()}}renderCloseIcon(){if(!this.isSticky)return;const e=this.createElement("div",{className:"e-icons e-tooltip-close"});this.tooltipEle.appendChild(e),$.add(e,Z.touchStartEvent,this.onStickyClose,this)}addDescribedBy(e,t){const i=(e.getAttribute("aria-describedby")||"").split(/\s+/);i.indexOf(t)<0&&i.push(t),Je(e,{"aria-describedby":i.join(" ").trim(),"data-tooltip-id":t})}removeDescribedBy(e){const t=e.getAttribute("data-tooltip-id"),i=(e.getAttribute("aria-describedby")||"").split(/\s+/),n=i.indexOf(t);-1!==n&&i.splice(n,1),e.removeAttribute("data-tooltip-id");const r=i.join(" ").trim();r?e.setAttribute("aria-describedby",r):e.removeAttribute("aria-describedby")}tapHoldHandler(e){clearTimeout(this.autoCloseTimer),this.targetHover(e.originalEvent)}touchEndHandler(e){this.isSticky||(this.autoCloseTimer=setTimeout(()=>{this.close()},1500))}targetClick(e){let t;t=this.target?it(e.target,this.target):this.element,d(t)||(null===t.getAttribute("data-tooltip-id")?this.targetHover(e):this.isSticky||this.hideTooltip(this.animation.close,e,t))}targetHover(e){let t;if(t=this.target?it(e.target,this.target):this.element,d(t)||null!==t.getAttribute("data-tooltip-id")&&0===this.closeDelay)return;const i=[].slice.call(et('[data-tooltip-id= "'+this.ctrlId+'_content"]',document));for(const n of i)this.restoreElement(n);this.showTooltip(t,this.animation.open,e)}mouseMoveBeforeOpen(e){this.mouseMoveEvent=e}mouseMoveBeforeRemove(){this.mouseMoveTarget&&$.remove(this.mouseMoveTarget,"mousemove touchstart",this.mouseMoveBeforeOpen)}showTooltip(e,t,i){clearTimeout(this.showTimer),clearTimeout(this.hideTimer),this.openDelay&&this.mouseTrail&&(this.mouseMoveBeforeRemove(),this.mouseMoveTarget=e,$.add(this.mouseMoveTarget,"mousemove touchstart",this.mouseMoveBeforeOpen,this)),this.tooltipEventArgs={type:i?i.type:null,cancel:!1,target:e,event:i||null,element:this.tooltipEle,isInteracted:!d(i)},this.trigger("beforeRender",this.tooltipEventArgs,(n=>{this.beforeRenderCallback(n,e,i,t)}).bind(this))}beforeRenderCallback(e,t,i,n){e.cancel?(this.isHidden=!0,this.clear(),this.mouseMoveBeforeRemove()):(this.isHidden=!1,d(this.tooltipEle)?(this.ctrlId=this.element.getAttribute("id")?u(this.element.getAttribute("id")):u("tooltip"),this.tooltipEle=this.createElement("div",{className:"e-tooltip-wrap e-popup e-lib",attrs:{role:"tooltip","aria-hidden":"false",id:this.ctrlId+"_content"},styles:"width:"+f(this.width)+";height:"+f(this.height)+";position:absolute;"}),this.tooltipBeforeRender(t,this),this.tooltipAfterRender(t,i,n,this)):t&&(this.adjustArrow(t,this.position,this.tooltipPositionX,this.tooltipPositionY),this.addDescribedBy(t,this.ctrlId+"_content"),this.renderContent(t),Rt.stop(this.tooltipEle),this.reposition(t),this.tooltipAfterRender(t,i,n,this)))}tooltipBeforeRender(e,t){e&&(Z.isDevice&&Fe([t.tooltipEle],"e-bigger"),"auto"!==t.width&&(t.tooltipEle.style.maxWidth=f(t.width)),t.tooltipEle.appendChild(t.createElement("div",{className:Rr})),document.body.appendChild(t.tooltipEle),Ve([t.tooltipEle],"e-hidden"),t.addDescribedBy(e,t.ctrlId+"_content"),t.renderContent(e),Fe([t.tooltipEle],Nr),t.showTipPointer&&t.renderArrow(),t.renderCloseIcon(),t.renderPopup(e),t.adjustArrow(e,t.position,t.tooltipPositionX,t.tooltipPositionY),Rt.stop(t.tooltipEle),t.reposition(e))}tooltipAfterRender(e,t,i,n){if(e){Ve([n.tooltipEle],Nr),Fe([n.tooltipEle],_r),n.tooltipEventArgs={type:t?t.type:null,cancel:!1,target:e,event:t||null,element:n.tooltipEle,isInteracted:!d(t)},n.needTemplateReposition()&&!n.mouseTrail&&(n.tooltipEle.style.display="none");const r=r=>{n.beforeOpenCallback(r,e,i,t)};n.trigger("beforeOpen",n.tooltipEventArgs,r.bind(n))}}beforeOpenCallback(e,t,i,n){if(e.cancel)this.isHidden=!0,this.clear(),this.mouseMoveBeforeRemove(),this.restoreElement(t);else{let e={name:i.effect,duration:i.duration,delay:i.delay,timingFunction:"easeOut"};"None"===i.effect&&(e=void 0),this.openDelay>0?this.showTimer=setTimeout(()=>{this.mouseTrail&&$.add(t,"mousemove touchstart mouseenter",this.onMouseMove,this),this.popupObj&&(this.popupObj.show(e,t),this.mouseMoveEvent&&this.mouseTrail&&this.onMouseMove(this.mouseMoveEvent))},this.openDelay):this.popupObj&&this.popupObj.show(e,t)}n&&this.wireMouseEvents(n,t)}needTemplateReposition(){return!d(this.viewContainerRef)&&"string"!=typeof this.viewContainerRef}checkCollision(e,t,i){const n={left:t,top:i,position:this.position,horizontal:this.tooltipPositionX,vertical:this.tooltipPositionY},r=Ui(this.tooltipEle,this.checkCollideTarget(),t,i);return r.length>0&&(n.horizontal=r.indexOf("left")>=0?"Right":r.indexOf("right")>=0?"Left":this.tooltipPositionX,n.vertical=r.indexOf("top")>=0?"Bottom":r.indexOf("bottom")>=0?"Top":this.tooltipPositionY),n}collisionFlipFit(e,t,i){const n=this.checkCollision(e,t,i);let r=n.position;if(this.tooltipPositionY!==n.vertical&&(r=0===this.position.indexOf("Bottom")||0===this.position.indexOf("Top")?n.vertical+this.tooltipPositionX:this.tooltipPositionX+n.vertical),this.tooltipPositionX!==n.horizontal&&(0===r.indexOf("Left")&&(n.vertical="LeftTop"===r||"LeftCenter"===r?"Top":"Bottom",r=n.vertical+"Left"),0===r.indexOf("Right")&&(n.vertical="RightTop"===r||"RightCenter"===r?"Top":"Bottom",r=n.vertical+"Right"),n.horizontal=this.tooltipPositionX),this.tooltipEventArgs={type:null,cancel:!1,target:e,event:null,element:this.tooltipEle,collidedPosition:r},this.trigger("beforeCollision",this.tooltipEventArgs),n.position!==r){const t=Di(e,n.horizontal,n.vertical);this.adjustArrow(e,r,n.horizontal,n.vertical);const i=this.calculateTooltipOffset(r);i.top-=-1!=="TopBottom".indexOf(this.position.split(/(?=[A-Z])/)[0])&&-1!=="TopBottom".indexOf(r.split(/(?=[A-Z])/)[0])?2*this.offsetY:0,i.left-=-1!=="RightLeft".indexOf(this.position.split(/(?=[A-Z])/)[0])&&-1!=="RightLeft".indexOf(r.split(/(?=[A-Z])/)[0])?2*this.offsetX:0,n.position=r,n.left=t.left+i.left,n.top=t.top+i.top}else this.adjustArrow(e,r,n.horizontal,n.vertical);const s={left:n.left,top:n.top},o=Wi(this.tooltipEle,this.checkCollideTarget(),{X:!0,Y:!1},s).left;if(this.tooltipEle.style.display="block",this.showTipPointer&&(0===r.indexOf("Bottom")||0===r.indexOf("Top"))){const e=Ke("."+Lr,this.tooltipEle);let t=parseInt(e.style.left,10)-(o-n.left);t<0?t=0:t+e.offsetWidth>this.tooltipEle.clientWidth&&(t=this.tooltipEle.clientWidth-e.offsetWidth),e.style.left=t.toString()+"px"}return this.tooltipEle.style.display="",s.left=o,s}checkCollideTarget(){return!this.windowCollision&&this.target?this.element:null}hideTooltip(e,t,i){this.closeDelay>0?(clearTimeout(this.hideTimer),clearTimeout(this.showTimer),this.hideTimer=setTimeout(()=>{this.closeDelay&&this.tooltipEle&&this.isTooltipOpen||this.tooltipHide(e,t,i)},this.closeDelay)):this.tooltipHide(e,t,i)}tooltipHide(e,t,i){let n;n=t?this.target?i||t.target:this.element:Ke('[data-tooltip-id= "'+this.ctrlId+'_content"]',document),this.tooltipEventArgs={type:t?t.type:null,cancel:!1,target:n,event:t||null,element:this.tooltipEle,isInteracted:!d(t)},this.trigger("beforeClose",this.tooltipEventArgs,t=>{t.cancel?this.isHidden=!1:(this.mouseMoveBeforeRemove(),this.popupHide(e,n))})}popupHide(e,t){t&&this.restoreElement(t),this.isHidden=!0;let i={name:e.effect,duration:e.duration,delay:e.delay,timingFunction:"easeIn"};"None"===e.effect&&(i=void 0),this.popupObj&&this.popupObj.hide(i)}restoreElement(e){this.unwireMouseEvents(e),d(e.getAttribute("data-content"))||(e.setAttribute("title",e.getAttribute("data-content")),e.removeAttribute("data-content")),this.removeDescribedBy(e)}clear(){this.tooltipEle&&(Ve([this.tooltipEle],_r),Fe([this.tooltipEle],Nr)),this.isHidden&&(this.popupObj&&this.popupObj.destroy(),this.tooltipEle&&Qe(this.tooltipEle),this.tooltipEle=null,this.popupObj=null)}tooltipHover(e){this.tooltipEle&&(this.isTooltipOpen=!0)}tooltipMouseOut(e){this.isTooltipOpen=!1,this.hideTooltip(this.animation.close,e,this.findTarget())}onMouseOut(e){const t=e.relatedTarget;if(t&&!this.mouseTrail){const i=it(t,".e-tooltip-wrap.e-lib.e-popup");i?$.add(i,"mouseleave",this.tooltipElementMouseOut,this):(this.hideTooltip(this.animation.close,e,this.findTarget()),0===this.closeDelay&&this.clear())}else this.hideTooltip(this.animation.close,e,this.findTarget()),this.clear()}tooltipElementMouseOut(e){this.hideTooltip(this.animation.close,e,this.findTarget()),$.remove(this.element,"mouseleave",this.tooltipElementMouseOut),this.clear()}onStickyClose(e){this.close()}onMouseMove(e){let t=0,i=0;e.type.indexOf("touch")>-1?(e.preventDefault(),t=e.touches[0].pageX,i=e.touches[0].pageY):(t=e.pageX,i=e.pageY),Rt.stop(this.tooltipEle),Ve([this.tooltipEle],_r),Fe([this.tooltipEle],Nr),this.adjustArrow(e.target,this.position,this.tooltipPositionX,this.tooltipPositionY);const n=this.calculateTooltipOffset(this.position),r=this.checkCollision(e.target,t+n.left+this.offsetX,i+n.top+this.offsetY);if(this.tooltipPositionX!==r.horizontal||this.tooltipPositionY!==r.vertical){const n=0===this.position.indexOf("Bottom")||0===this.position.indexOf("Top")?r.vertical+r.horizontal:r.horizontal+r.vertical;r.position=n,this.adjustArrow(e.target,r.position,r.horizontal,r.vertical);const s=this.calculateTooltipOffset(r.position);r.left=t+s.left-this.offsetX,r.top=i+s.top-this.offsetY}this.tooltipEle.style.left=r.left+"px",this.tooltipEle.style.top=r.top+"px"}keyDown(e){this.tooltipEle&&27===e.keyCode&&this.close()}touchEnd(e){this.tooltipEle&&null===it(e.target,"."+Ir)&&!this.isSticky&&this.close()}scrollHandler(e){this.tooltipEle&&(it(e.target,".e-tooltip-wrap.e-lib.e-popup")||this.close())}render(){this.initialize(),this.wireEvents(this.opensOn),this.renderComplete()}preRender(){this.tipClass=Mr,this.tooltipPositionX="Center",this.tooltipPositionY="Top",this.isHidden=!0}wireEvents(e){const t=this.getTriggerList(e);for(const i of t){if("Custom"===i)return;"Focus"===i&&this.wireFocusEvents(),"Click"===i&&$.add(this.element,Z.touchStartEvent,this.targetClick,this),"Hover"===i&&(Z.isDevice?(this.touchModule=new ti(this.element,{tapHoldThreshold:500,tapHold:this.tapHoldHandler.bind(this)}),$.add(this.element,Z.touchEndEvent,this.touchEndHandler,this)):$.add(this.element,"mouseover",this.targetHover,this))}$.add(document,"touchend",this.touchEnd,this),$.add(document,"scroll wheel",this.scrollHandler,this),$.add(document,"keydown",this.keyDown,this)}getTriggerList(e){return"Auto"===e&&(e=Z.isDevice?"Hover":"Hover Focus"),e.split(" ")}wireFocusEvents(){if(d(this.target))$.add(this.element,"focus",this.targetHover,this);else{const e=[].slice.call(et(this.target,this.element));for(const t of e)$.add(t,"focus",this.targetHover,this)}}wireMouseEvents(e,t){this.tooltipEle&&(this.isSticky||("focus"===e.type&&$.add(t,"blur",this.onMouseOut,this),"mouseover"===e.type&&$.add(t,"mouseleave",this.onMouseOut,this),this.closeDelay&&($.add(this.tooltipEle,"mouseenter",this.tooltipHover,this),$.add(this.tooltipEle,"mouseleave",this.tooltipMouseOut,this))),this.mouseTrail&&0===this.openDelay&&$.add(t,"mousemove touchstart mouseenter",this.onMouseMove,this))}unwireEvents(e){const t=this.getTriggerList(e);for(const i of t){if("Custom"===i)return;"Focus"===i&&this.unwireFocusEvents(),"Click"===i&&$.remove(this.element,Z.touchStartEvent,this.targetClick),"Hover"===i&&(Z.isDevice?(this.touchModule&&this.touchModule.destroy(),$.remove(this.element,Z.touchEndEvent,this.touchEndHandler)):$.remove(this.element,"mouseover",this.targetHover))}$.remove(document,"touchend",this.touchEnd),$.remove(document,"scroll wheel",this.scrollHandler),$.remove(document,"keydown",this.keyDown)}unwireFocusEvents(){if(d(this.target))$.remove(this.element,"focus",this.targetHover);else{const e=[].slice.call(et(this.target,this.element));for(const t of e)$.remove(t,"focus",this.targetHover)}}unwireMouseEvents(e){if(!this.isSticky){const t=this.getTriggerList(this.opensOn);for(const i of t)"Focus"===i&&$.remove(e,"blur",this.onMouseOut),"Hover"!==i||Z.isDevice||$.remove(e,"mouseleave",this.onMouseOut);this.closeDelay&&($.remove(e,"mouseenter",this.tooltipHover),$.remove(e,"mouseleave",this.tooltipMouseOut))}this.mouseTrail&&$.remove(e,"mousemove touchstart mouseenter",this.onMouseMove)}findTarget(){return Ke('[data-tooltip-id= "'+this.ctrlId+'_content"]',document)}getModuleName(){return"tooltip"}getPersistData(){return this.addOnPersist([])}onPropertyChanged(e,t){const i=this.findTarget();for(const n of Object.keys(e))switch(n){case"width":this.tooltipEle&&i&&(this.tooltipEle.style.width=this.tooltipEle.style.maxWidth=f(e.width),this.reposition(i));break;case"height":this.tooltipEle&&i&&(this.tooltipEle.style.height=f(e.height),this.reposition(i));break;case"content":this.tooltipEle&&this.renderContent();break;case"opensOn":this.unwireEvents(t.opensOn),this.wireEvents(e.opensOn);break;case"position":if(this.formatPosition(),this.tooltipEle&&i){const e=Ke("."+zr,this.tooltipEle);e.style.top=e.style.left=null,this.reposition(i)}break;case"tipPointerPosition":this.tooltipEle&&i&&this.reposition(i);break;case"offsetX":if(this.tooltipEle){const i=e.offsetX-t.offsetX;this.tooltipEle.style.left=(parseInt(this.tooltipEle.style.left,10)+i).toString()+"px"}break;case"offsetY":if(this.tooltipEle){const i=e.offsetY-t.offsetY;this.tooltipEle.style.top=(parseInt(this.tooltipEle.style.top,10)+i).toString()+"px"}break;case"cssClass":this.tooltipEle&&(t.cssClass&&Ve([this.tooltipEle],t.cssClass.split(" ")),e.cssClass&&Fe([this.tooltipEle],e.cssClass.split(" ")));break;case"enableRtl":this.tooltipEle&&(this.enableRtl?Fe([this.tooltipEle],Dr):Ve([this.tooltipEle],Dr))}}open(e,t){d(t)&&(t=this.animation.open),d(e)&&(e=this.element),"none"!==e.style.display&&this.showTooltip(e,t)}close(e){e||(e=this.animation.close),this.hideTooltip(e)}refresh(e){this.tooltipEle&&this.renderContent(e),this.popupObj&&e&&this.reposition(e)}destroy(){super.destroy(),this.tooltipEle&&Qe(this.tooltipEle),this.popupObj&&this.popupObj.destroy(),Ve([this.element],Ir),this.unwireEvents(this.opensOn),this.unwireMouseEvents(this.element),this.tooltipEle=null,this.popupObj=null}};return Ar([xt("auto")],e.prototype,"width",void 0),Ar([xt("auto")],e.prototype,"height",void 0),Ar([xt()],e.prototype,"content",void 0),Ar([xt()],e.prototype,"target",void 0),Ar([xt("TopCenter")],e.prototype,"position",void 0),Ar([xt(0)],e.prototype,"offsetX",void 0),Ar([xt(0)],e.prototype,"offsetY",void 0),Ar([xt(!0)],e.prototype,"showTipPointer",void 0),Ar([xt(!0)],e.prototype,"enableHtmlParse",void 0),Ar([xt(!1)],e.prototype,"windowCollision",void 0),Ar([xt("Auto")],e.prototype,"tipPointerPosition",void 0),Ar([xt("Auto")],e.prototype,"opensOn",void 0),Ar([xt(!1)],e.prototype,"mouseTrail",void 0),Ar([xt(!1)],e.prototype,"isSticky",void 0),Ar([St({},Br)],e.prototype,"animation",void 0),Ar([xt(0)],e.prototype,"openDelay",void 0),Ar([xt(0)],e.prototype,"closeDelay",void 0),Ar([xt()],e.prototype,"cssClass",void 0),Ar([xt(!1)],e.prototype,"enableHtmlSanitizer",void 0),Ar([Ot()],e.prototype,"beforeRender",void 0),Ar([Ot()],e.prototype,"beforeOpen",void 0),Ar([Ot()],e.prototype,"afterOpen",void 0),Ar([Ot()],e.prototype,"beforeClose",void 0),Ar([Ot()],e.prototype,"afterClose",void 0),Ar([Ot()],e.prototype,"beforeCollision",void 0),Ar([Ot()],e.prototype,"created",void 0),Ar([Ot()],e.prototype,"destroyed",void 0),e=Ar([Tt],e),e})();class Ur{constructor(e){return this.subQuery=null,this.isChild=!1,this.distincts=[],this.queries=[],this.key="",this.fKey="","string"==typeof e?this.fromTable=e:e&&e instanceof Array&&(this.lookups=e),this.expands=[],this.sortedColumns=[],this.groupedColumns=[],this.subQuery=null,this.isChild=!1,this.params=[],this.lazyLoad=[],this}setKey(e){return this.key=e,this}using(e){return this.dataManager=e,this}execute(e,t,i,n){return(e=e||this.dataManager)?e.executeQuery(this,t,i,n):Xr.throwError('Query - execute() : dataManager needs to be is set using "using" function or should be passed as argument')}executeLocal(e){return(e=e||this.dataManager)?e.executeLocal(this):Xr.throwError('Query - executeLocal() : dataManager needs to be is set using "using" function or should be passed as argument')}clone(){let e=new Ur;return e.queries=this.queries.slice(0),e.key=this.key,e.isChild=this.isChild,e.dataManager=this.dataManager,e.fromTable=this.fromTable,e.params=this.params.slice(0),e.expands=this.expands.slice(0),e.sortedColumns=this.sortedColumns.slice(0),e.groupedColumns=this.groupedColumns.slice(0),e.subQuerySelector=this.subQuerySelector,e.subQuery=this.subQuery,e.fKey=this.fKey,e.isCountRequired=this.isCountRequired,e.distincts=this.distincts.slice(0),e.lazyLoad=this.lazyLoad.slice(0),e}from(e){return this.fromTable=e,this}addParams(e,t){return this.params.push("function"==typeof t?{key:e,fn:t}:{key:e,value:t}),this}distinct(e){return this.distincts="string"==typeof e?[].slice.call([e],0):e.slice(0),this}expand(e){return this.expands="string"==typeof e?[].slice.call([e],0):e.slice(0),this}where(e,t,i,n,r){t=t?t.toLowerCase():null;let s=null;return"string"==typeof e?s=new Fr(e,t,i,n,r):e instanceof Fr&&(s=e),this.queries.push({fn:"onWhere",e:s}),this}search(e,t,i,n,r){return"string"==typeof t&&(t=[t]),i&&"none"!==i||(i="contains"),this.queries.push({fn:"onSearch",e:{fieldNames:t,operator:i,searchKey:e,ignoreCase:n,ignoreAccent:r,comparer:Xr.fnOperators[i]}}),this}sortBy(e,t,i){return this.sortByForeignKey(e,t,i)}sortByForeignKey(e,t,i,n){let r,s,o=d(n)?"ascending":n;if("string"==typeof e&&Xr.endsWith(e.toLowerCase()," desc")&&(e=e.replace(/ desc$/i,""),t="descending"),t&&"string"!=typeof t||(o=t?t.toLowerCase():"ascending",t=Xr.fnSort(t)),i){r=Ur.filterQueries(this.queries,"onSortBy");for(let t=0;t<r.length;t++)if(s=r[t].e.fieldName,"string"==typeof s){if(s===e)return this}else if(s instanceof Array)for(let i=0;i<s.length;i++)if(s[i]===e||e.toLowerCase()===s[i]+" desc")return this}return this.queries.push({fn:"onSortBy",e:{fieldName:e,comparer:t,direction:o}}),this}sortByDesc(e){return this.sortBy(e,"descending")}group(e,t,i){return this.sortBy(e,null,!0),this.queries.push({fn:"onGroup",e:{fieldName:e,comparer:t||null,format:i||null}}),this}page(e,t){return this.queries.push({fn:"onPage",e:{pageIndex:e,pageSize:t}}),this}range(e,t){return this.queries.push({fn:"onRange",e:{start:e,end:t}}),this}take(e){return this.queries.push({fn:"onTake",e:{nos:e}}),this}skip(e){return this.queries.push({fn:"onSkip",e:{nos:e}}),this}select(e){return"string"==typeof e&&(e=[].slice.call([e],0)),this.queries.push({fn:"onSelect",e:{fieldNames:e}}),this}hierarchy(e,t){return this.subQuerySelector=t,this.subQuery=e,this}foreignKey(e){return this.fKey=e,this}requiresCount(){return this.isCountRequired=!0,this}aggregate(e,t){return this.queries.push({fn:"onAggregates",e:{field:t,type:e}}),this}static filterQueries(e,t){return e.filter(e=>e.fn===t)}static filterQueryLists(e,t){let i=e.filter(e=>-1!==t.indexOf(e.fn)),n={};for(let r=0;r<i.length;r++)n[i[r].fn]||(n[i[r].fn]=i[r].e);return n}}class Fr{constructor(e,t,i,n=!1,r){return this.ignoreAccent=!1,this.isComplex=!1,"string"==typeof e?(this.field=e,this.operator=t.toLowerCase(),this.value=i,this.ignoreCase=n,this.ignoreAccent=r,this.isComplex=!1,this.comparer=Xr.fnOperators.processOperator(this.operator)):(e instanceof Fr&&i instanceof Fr||i instanceof Array)&&(this.isComplex=!0,this.condition=t.toLowerCase(),this.predicates=[e],i instanceof Array?[].push.apply(this.predicates,i):this.predicates.push(i)),this}static and(...e){return Fr.combinePredicates([].slice.call(e,0),"and")}and(e,t,i,n,r){return Fr.combine(this,e,t,i,"and",n,r)}static or(...e){return Fr.combinePredicates([].slice.call(e,0),"or")}or(e,t,i,n,r){return Fr.combine(this,e,t,i,"or",n,r)}static fromJson(e){if(e instanceof Array){let t=[];for(let i=0,n=e.length;i<n;i++)t.push(this.fromJSONData(e[i]));return t}return this.fromJSONData(e)}validate(e){let t,i,n=this.predicates?this.predicates:[];if(!this.isComplex&&this.comparer)return this.comparer.call(this,Xr.getObject(this.field,e),this.value,this.ignoreCase,this.ignoreAccent);t="and"===this.condition;for(let r=0;r<n.length;r++)if(i=n[r].validate(e),t){if(!i)return!1}else if(i)return!0;return t}toJson(){let e,t;if(this.isComplex){e=[],t=this.predicates;for(let i=0;i<t.length;i++)e.push(t[i].toJson())}return{isComplex:this.isComplex,field:this.field,operator:this.operator,value:this.value,ignoreCase:this.ignoreCase,ignoreAccent:this.ignoreAccent,condition:this.condition,predicates:e}}static combinePredicates(e,t){if(1===e.length){if(!(e[0]instanceof Array))return e[0];e=e[0]}return new Fr(e[0],t,e.slice(1))}static combine(e,t,i,n,r,s,o){return t instanceof Fr?Fr[r](e,t):"string"==typeof t?Fr[r](e,new Fr(t,i,n,s,o)):Xr.throwError("Predicate - "+r+" : invalid arguments")}static fromJSONData(e){let t,i=e.predicates||[],n=i.length,r=[];for(let s=0;s<n;s++)r.push(this.fromJSONData(i[s]));return t=e.isComplex?new Fr(r[0],e.condition,r.slice(1)):new Fr(e.field,e.operator,e.value,e.ignoreCase,e.ignoreAccent),t}}const Vr={GroupGuid:"{271bbba0-1ee7}"};let Xr=(()=>{class e{static getValue(e,t){return"function"==typeof e?e.call(t||{}):e}static endsWith(e,t){return e.slice&&e.slice(-t.length)===t}static startsWith(e,t){return e.slice(0,t.length)===t}static fnSort(t){return"ascending"===(t=t?e.toLowerCase(t):"ascending")?this.fnAscending:this.fnDescending}static fnAscending(e,t){return d(e)&&d(t)||null==t?-1:"string"==typeof e?e.localeCompare(t):null==e?1:e-t}static fnDescending(e,t){return d(e)&&d(t)?-1:null==t?1:"string"==typeof e?-1*e.localeCompare(t):null==e?-1:t-e}static extractFields(e,t){let i={};for(let n=0;n<t.length;n++)i=this.setValue(t[n],this.getObject(t[n],e),i);return i}static select(e,t){let i=[];for(let n=0;n<e.length;n++)i.push(this.extractFields(e[n],t));return i}static group(t,i,n,r,s,o,a){r=r||1;let l=t,h="GroupGuid";if(l.GroupGuid===Vr[h]){for(let e=0;e<l.length;e++)if(d(s))l[e].items=this.group(l[e].items,i,n,l.level+1,null,o,a),l[e].count=l[e].items.length;else{let t=-1,r=s.filter(t=>t.key===l[e].key);t=s.indexOf(r[0]),l[e].items=this.group(l[e].items,i,n,l.level+1,s[t].items,o,a),l[e].count=s[t].count}return l.childLevels+=1,l}let c={},p=[];p.GroupGuid=Vr[h],p.level=r,p.childLevels=0,p.records=l;for(let e=0;e<l.length;e++){let t=this.getVal(l,e,i);if(d(o)||(t=o(t,i)),!c[t]&&(c[t]={key:t,count:0,items:[],aggregates:{},field:i},p.push(c[t]),!d(s))){let e=s.filter(e=>e.key===c[t].key);c[t].count=e[0].count}c[t].count=d(s)?c[t].count+=1:c[t].count,(!a||a&&n.length)&&c[t].items.push(l[e])}if(n&&n.length)for(let u=0;u<p.length;u++){let t,i={},r=n;for(let o=0;o<n.length;o++)if(t=e.aggregates[n[o].type],d(s))t&&(i[r[o].field+" - "+r[o].type]=t(p[u].items,r[o].field));else{let e=s.filter(e=>e.key===p[u].key);t&&(i[r[o].field+" - "+r[o].type]=t(e[0].items,r[o].field))}p[u].aggregates=i}if(a&&p.length&&n.length)for(let e=0;e<p.length;e++)p[e].items=[];return l.length&&p||l}static buildHierarchy(e,t,i,n,r){let s,o,a={};for(n.result&&(n=n.result),n.GroupGuid&&this.throwError("DataManager: Do not have support Grouping in hierarchy"),s=0;s<n.length;s++){let t=this.getObject(e,n[s]);o=a[t]||(a[t]=[]),o.push(n[s])}for(s=0;s<i.length;s++){let n=this.getObject(r||e,i[s]);i[s][t]=a[n]}}static getFieldList(e,t,i){if(void 0===i&&(i=""),null==t)return this.getFieldList(e,[],i);let n=e,r=Object.keys(e);for(let s of r)"object"!=typeof n[s]||n[s]instanceof Array?t.push(i+s):this.getFieldList(n[s],t,i+s+".");return t}static getObject(e,t){if(!e)return t;if(!t)return;if(-1===e.indexOf("."))return t[e];let i=t,n=e.split(".");for(let r=0;r<n.length&&null!=i;r++)i=i[n[r]];return i}static setValue(e,t,i){let n,r,s=e.toString().split("."),o=i||{},a=o,l=s.length;for(n=0;n<l;n++)r=s[n],n+1===l?a[r]=void 0===t?void 0:t:d(a[r])&&(a[r]={}),a=a[r];return o}static sort(e,t,i){if(e.length<=1)return e;let n=parseInt((e.length/2).toString(),10),r=e.slice(0,n),s=e.slice(n);return r=this.sort(r,t,i),s=this.sort(s,t,i),this.merge(r,s,t,i)}static ignoreDiacritics(t){return"string"!=typeof t?t:t.split("").map(t=>t in e.diacritics?e.diacritics[t]:t).join("")}static merge(e,t,i,n){let r,s=[];for(;e.length>0||t.length>0;)r=e.length>0&&t.length>0?n?n(this.getVal(e,0,i),this.getVal(t,0,i),e[0],t[0])<=0?e:t:e[0][i]<e[0][i]?e:t:e.length>0?e:t,s.push(r.shift());return s}static getVal(e,t,i){return i?this.getObject(i,e[t]):e[t]}static toLowerCase(e){return e?"string"==typeof e?e.toLowerCase():e.toString():0===e||!1===e?e.toString():""}static callAdaptorFunction(e,t,i,n){if(t in e){let r=e[t](i,n);d(r)||(i=r)}return i}static getAddParams(t,i,n){let r={};return e.callAdaptorFunction(t,"addParams",{dm:i,query:n,params:n.params,reqParams:r}),r}static isPlainObject(e){return!!e&&e.constructor===Object}static isCors(){let e=null;try{e=new window.XMLHttpRequest}catch(t){}return!!e&&"withCredentials"in e}static getGuid(e){let t;return(e||"")+"00000000-0000-4000-0000-000000000000".replace(/0/g,(e,i)=>{if("crypto"in window&&"getRandomValues"in crypto){let e=new Uint8Array(1);window.crypto.getRandomValues(e),t=e[0]%16|0}else t=16*Math.random()|0;return"0123456789abcdef"[19===i?3&t|8:t]})}static isNull(e){return null==e}static getItemFromComparer(t,i,n){let r,s,o,a=0,l="string"==typeof e.getVal(t,0,i);if(t.length)for(;d(r)&&a<t.length;)r=e.getVal(t,a,i),o=t[a++];for(;a<t.length;a++)s=e.getVal(t,a,i),d(s)||(l&&(r=+r,s=+s),n(r,s)>0&&(r=s,o=t[a]));return o}static distinct(t,i,n){n=!d(n)&&n;let r,s=[],o={};return t.forEach((a,l)=>{r="object"==typeof t[l]?e.getVal(t,l,i):t[l],r in o||(s.push(n?t[l]:r),o[r]=1)}),s}}return e.serverTimezoneOffset=null,e.timeZoneHandling=!0,e.throwError=e=>{try{throw new Error(e)}catch(t){throw t.message+"\n"+t.stack}},e.aggregates={sum:(t,i)=>{let n,r=0,s="number"!=typeof e.getVal(t,0,i);for(let o=0;o<t.length;o++)n=e.getVal(t,o,i),isNaN(n)||null===n||(s&&(n=+n),r+=n);return r},average:(t,i)=>e.aggregates.sum(t,i)/t.length,min:(t,i)=>{let n;return"function"==typeof i&&(n=i,i=null),e.getObject(i,e.getItemFromComparer(t,i,n||e.fnAscending))},max:(t,i)=>{let n;return"function"==typeof i&&(n=i,i=null),e.getObject(i,e.getItemFromComparer(t,i,n||e.fnDescending))},truecount:(e,t)=>new es(e).executeLocal((new Ur).where(t,"equal",!0,!0)).length,falsecount:(e,t)=>new es(e).executeLocal((new Ur).where(t,"equal",!1,!0)).length,count:(e,t)=>e.length},e.operatorSymbols={"<":"lessthan",">":"greaterthan","<=":"lessthanorequal",">=":"greaterthanorequal","==":"equal","!=":"notequal","*=":"contains","$=":"endswith","^=":"startswith"},e.odBiOperator={"<":" lt ",">":" gt ","<=":" le ",">=":" ge ","==":" eq ","!=":" ne ",lessthan:" lt ",lessthanorequal:" le ",greaterthan:" gt ",greaterthanorequal:" ge ",equal:" eq ",notequal:" ne "},e.odUniOperator={"$=":"endswith","^=":"startswith","*=":"substringof",endswith:"endswith",startswith:"startswith",contains:"substringof"},e.odv4UniOperator={"$=":"endswith","^=":"startswith","*=":"contains",endswith:"endswith",startswith:"startswith",contains:"contains"},e.diacritics={"\u24b6":"A","\uff21":"A","\xc0":"A","\xc1":"A","\xc2":"A","\u1ea6":"A","\u1ea4":"A","\u1eaa":"A","\u1ea8":"A","\xc3":"A","\u0100":"A","\u0102":"A","\u1eb0":"A","\u1eae":"A","\u1eb4":"A","\u1eb2":"A","\u0226":"A","\u01e0":"A","\xc4":"A","\u01de":"A","\u1ea2":"A","\xc5":"A","\u01fa":"A","\u01cd":"A","\u0200":"A","\u0202":"A","\u1ea0":"A","\u1eac":"A","\u1eb6":"A","\u1e00":"A","\u0104":"A","\u023a":"A","\u2c6f":"A","\ua732":"AA","\xc6":"AE","\u01fc":"AE","\u01e2":"AE","\ua734":"AO","\ua736":"AU","\ua738":"AV","\ua73a":"AV","\ua73c":"AY","\u24b7":"B","\uff22":"B","\u1e02":"B","\u1e04":"B","\u1e06":"B","\u0243":"B","\u0182":"B","\u0181":"B","\u24b8":"C","\uff23":"C","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\xc7":"C","\u1e08":"C","\u0187":"C","\u023b":"C","\ua73e":"C","\u24b9":"D","\uff24":"D","\u1e0a":"D","\u010e":"D","\u1e0c":"D","\u1e10":"D","\u1e12":"D","\u1e0e":"D","\u0110":"D","\u018b":"D","\u018a":"D","\u0189":"D","\ua779":"D","\u01f1":"DZ","\u01c4":"DZ","\u01f2":"Dz","\u01c5":"Dz","\u24ba":"E","\uff25":"E","\xc8":"E","\xc9":"E","\xca":"E","\u1ec0":"E","\u1ebe":"E","\u1ec4":"E","\u1ec2":"E","\u1ebc":"E","\u0112":"E","\u1e14":"E","\u1e16":"E","\u0114":"E","\u0116":"E","\xcb":"E","\u1eba":"E","\u011a":"E","\u0204":"E","\u0206":"E","\u1eb8":"E","\u1ec6":"E","\u0228":"E","\u1e1c":"E","\u0118":"E","\u1e18":"E","\u1e1a":"E","\u0190":"E","\u018e":"E","\u24bb":"F","\uff26":"F","\u1e1e":"F","\u0191":"F","\ua77b":"F","\u24bc":"G","\uff27":"G","\u01f4":"G","\u011c":"G","\u1e20":"G","\u011e":"G","\u0120":"G","\u01e6":"G","\u0122":"G","\u01e4":"G","\u0193":"G","\ua7a0":"G","\ua77d":"G","\ua77e":"G","\u24bd":"H","\uff28":"H","\u0124":"H","\u1e22":"H","\u1e26":"H","\u021e":"H","\u1e24":"H","\u1e28":"H","\u1e2a":"H","\u0126":"H","\u2c67":"H","\u2c75":"H","\ua78d":"H","\u24be":"I","\uff29":"I","\xcc":"I","\xcd":"I","\xce":"I","\u0128":"I","\u012a":"I","\u012c":"I","\u0130":"I","\xcf":"I","\u1e2e":"I","\u1ec8":"I","\u01cf":"I","\u0208":"I","\u020a":"I","\u1eca":"I","\u012e":"I","\u1e2c":"I","\u0197":"I","\u24bf":"J","\uff2a":"J","\u0134":"J","\u0248":"J","\u24c0":"K","\uff2b":"K","\u1e30":"K","\u01e8":"K","\u1e32":"K","\u0136":"K","\u1e34":"K","\u0198":"K","\u2c69":"K","\ua740":"K","\ua742":"K","\ua744":"K","\ua7a2":"K","\u24c1":"L","\uff2c":"L","\u013f":"L","\u0139":"L","\u013d":"L","\u1e36":"L","\u1e38":"L","\u013b":"L","\u1e3c":"L","\u1e3a":"L","\u0141":"L","\u023d":"L","\u2c62":"L","\u2c60":"L","\ua748":"L","\ua746":"L","\ua780":"L","\u01c7":"LJ","\u01c8":"Lj","\u24c2":"M","\uff2d":"M","\u1e3e":"M","\u1e40":"M","\u1e42":"M","\u2c6e":"M","\u019c":"M","\u24c3":"N","\uff2e":"N","\u01f8":"N","\u0143":"N","\xd1":"N","\u1e44":"N","\u0147":"N","\u1e46":"N","\u0145":"N","\u1e4a":"N","\u1e48":"N","\u0220":"N","\u019d":"N","\ua790":"N","\ua7a4":"N","\u01ca":"NJ","\u01cb":"Nj","\u24c4":"O","\uff2f":"O","\xd2":"O","\xd3":"O","\xd4":"O","\u1ed2":"O","\u1ed0":"O","\u1ed6":"O","\u1ed4":"O","\xd5":"O","\u1e4c":"O","\u022c":"O","\u1e4e":"O","\u014c":"O","\u1e50":"O","\u1e52":"O","\u014e":"O","\u022e":"O","\u0230":"O","\xd6":"O","\u022a":"O","\u1ece":"O","\u0150":"O","\u01d1":"O","\u020c":"O","\u020e":"O","\u01a0":"O","\u1edc":"O","\u1eda":"O","\u1ee0":"O","\u1ede":"O","\u1ee2":"O","\u1ecc":"O","\u1ed8":"O","\u01ea":"O","\u01ec":"O","\xd8":"O","\u01fe":"O","\u0186":"O","\u019f":"O","\ua74a":"O","\ua74c":"O","\u01a2":"OI","\ua74e":"OO","\u0222":"OU","\u24c5":"P","\uff30":"P","\u1e54":"P","\u1e56":"P","\u01a4":"P","\u2c63":"P","\ua750":"P","\ua752":"P","\ua754":"P","\u24c6":"Q","\uff31":"Q","\ua756":"Q","\ua758":"Q","\u024a":"Q","\u24c7":"R","\uff32":"R","\u0154":"R","\u1e58":"R","\u0158":"R","\u0210":"R","\u0212":"R","\u1e5a":"R","\u1e5c":"R","\u0156":"R","\u1e5e":"R","\u024c":"R","\u2c64":"R","\ua75a":"R","\ua7a6":"R","\ua782":"R","\u24c8":"S","\uff33":"S","\u1e9e":"S","\u015a":"S","\u1e64":"S","\u015c":"S","\u1e60":"S","\u0160":"S","\u1e66":"S","\u1e62":"S","\u1e68":"S","\u0218":"S","\u015e":"S","\u2c7e":"S","\ua7a8":"S","\ua784":"S","\u24c9":"T","\uff34":"T","\u1e6a":"T","\u0164":"T","\u1e6c":"T","\u021a":"T","\u0162":"T","\u1e70":"T","\u1e6e":"T","\u0166":"T","\u01ac":"T","\u01ae":"T","\u023e":"T","\ua786":"T","\ua728":"TZ","\u24ca":"U","\uff35":"U","\xd9":"U","\xda":"U","\xdb":"U","\u0168":"U","\u1e78":"U","\u016a":"U","\u1e7a":"U","\u016c":"U","\xdc":"U","\u01db":"U","\u01d7":"U","\u01d5":"U","\u01d9":"U","\u1ee6":"U","\u016e":"U","\u0170":"U","\u01d3":"U","\u0214":"U","\u0216":"U","\u01af":"U","\u1eea":"U","\u1ee8":"U","\u1eee":"U","\u1eec":"U","\u1ef0":"U","\u1ee4":"U","\u1e72":"U","\u0172":"U","\u1e76":"U","\u1e74":"U","\u0244":"U","\u24cb":"V","\uff36":"V","\u1e7c":"V","\u1e7e":"V","\u01b2":"V","\ua75e":"V","\u0245":"V","\ua760":"VY","\u24cc":"W","\uff37":"W","\u1e80":"W","\u1e82":"W","\u0174":"W","\u1e86":"W","\u1e84":"W","\u1e88":"W","\u2c72":"W","\u24cd":"X","\uff38":"X","\u1e8a":"X","\u1e8c":"X","\u24ce":"Y","\uff39":"Y","\u1ef2":"Y","\xdd":"Y","\u0176":"Y","\u1ef8":"Y","\u0232":"Y","\u1e8e":"Y","\u0178":"Y","\u1ef6":"Y","\u1ef4":"Y","\u01b3":"Y","\u024e":"Y","\u1efe":"Y","\u24cf":"Z","\uff3a":"Z","\u0179":"Z","\u1e90":"Z","\u017b":"Z","\u017d":"Z","\u1e92":"Z","\u1e94":"Z","\u01b5":"Z","\u0224":"Z","\u2c7f":"Z","\u2c6b":"Z","\ua762":"Z","\u24d0":"a","\uff41":"a","\u1e9a":"a","\xe0":"a","\xe1":"a","\xe2":"a","\u1ea7":"a","\u1ea5":"a","\u1eab":"a","\u1ea9":"a","\xe3":"a","\u0101":"a","\u0103":"a","\u1eb1":"a","\u1eaf":"a","\u1eb5":"a","\u1eb3":"a","\u0227":"a","\u01e1":"a","\xe4":"a","\u01df":"a","\u1ea3":"a","\xe5":"a","\u01fb":"a","\u01ce":"a","\u0201":"a","\u0203":"a","\u1ea1":"a","\u1ead":"a","\u1eb7":"a","\u1e01":"a","\u0105":"a","\u2c65":"a","\u0250":"a","\ua733":"aa","\xe6":"ae","\u01fd":"ae","\u01e3":"ae","\ua735":"ao","\ua737":"au","\ua739":"av","\ua73b":"av","\ua73d":"ay","\u24d1":"b","\uff42":"b","\u1e03":"b","\u1e05":"b","\u1e07":"b","\u0180":"b","\u0183":"b","\u0253":"b","\u24d2":"c","\uff43":"c","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\xe7":"c","\u1e09":"c","\u0188":"c","\u023c":"c","\ua73f":"c","\u2184":"c","\u24d3":"d","\uff44":"d","\u1e0b":"d","\u010f":"d","\u1e0d":"d","\u1e11":"d","\u1e13":"d","\u1e0f":"d","\u0111":"d","\u018c":"d","\u0256":"d","\u0257":"d","\ua77a":"d","\u01f3":"dz","\u01c6":"dz","\u24d4":"e","\uff45":"e","\xe8":"e","\xe9":"e","\xea":"e","\u1ec1":"e","\u1ebf":"e","\u1ec5":"e","\u1ec3":"e","\u1ebd":"e","\u0113":"e","\u1e15":"e","\u1e17":"e","\u0115":"e","\u0117":"e","\xeb":"e","\u1ebb":"e","\u011b":"e","\u0205":"e","\u0207":"e","\u1eb9":"e","\u1ec7":"e","\u0229":"e","\u1e1d":"e","\u0119":"e","\u1e19":"e","\u1e1b":"e","\u0247":"e","\u025b":"e","\u01dd":"e","\u24d5":"f","\uff46":"f","\u1e1f":"f","\u0192":"f","\ua77c":"f","\u24d6":"g","\uff47":"g","\u01f5":"g","\u011d":"g","\u1e21":"g","\u011f":"g","\u0121":"g","\u01e7":"g","\u0123":"g","\u01e5":"g","\u0260":"g","\ua7a1":"g","\u1d79":"g","\ua77f":"g","\u24d7":"h","\uff48":"h","\u0125":"h","\u1e23":"h","\u1e27":"h","\u021f":"h","\u1e25":"h","\u1e29":"h","\u1e2b":"h","\u1e96":"h","\u0127":"h","\u2c68":"h","\u2c76":"h","\u0265":"h","\u0195":"hv","\u24d8":"i","\uff49":"i","\xec":"i","\xed":"i","\xee":"i","\u0129":"i","\u012b":"i","\u012d":"i","\xef":"i","\u1e2f":"i","\u1ec9":"i","\u01d0":"i","\u0209":"i","\u020b":"i","\u1ecb":"i","\u012f":"i","\u1e2d":"i","\u0268":"i","\u0131":"i","\u24d9":"j","\uff4a":"j","\u0135":"j","\u01f0":"j","\u0249":"j","\u24da":"k","\uff4b":"k","\u1e31":"k","\u01e9":"k","\u1e33":"k","\u0137":"k","\u1e35":"k","\u0199":"k","\u2c6a":"k","\ua741":"k","\ua743":"k","\ua745":"k","\ua7a3":"k","\u24db":"l","\uff4c":"l","\u0140":"l","\u013a":"l","\u013e":"l","\u1e37":"l","\u1e39":"l","\u013c":"l","\u1e3d":"l","\u1e3b":"l","\u017f":"l","\u0142":"l","\u019a":"l","\u026b":"l","\u2c61":"l","\ua749":"l","\ua781":"l","\ua747":"l","\u01c9":"lj","\u24dc":"m","\uff4d":"m","\u1e3f":"m","\u1e41":"m","\u1e43":"m","\u0271":"m","\u026f":"m","\u24dd":"n","\uff4e":"n","\u01f9":"n","\u0144":"n","\xf1":"n","\u1e45":"n","\u0148":"n","\u1e47":"n","\u0146":"n","\u1e4b":"n","\u1e49":"n","\u019e":"n","\u0272":"n","\u0149":"n","\ua791":"n","\ua7a5":"n","\u01cc":"nj","\u24de":"o","\uff4f":"o","\xf2":"o","\xf3":"o","\xf4":"o","\u1ed3":"o","\u1ed1":"o","\u1ed7":"o","\u1ed5":"o","\xf5":"o","\u1e4d":"o","\u022d":"o","\u1e4f":"o","\u014d":"o","\u1e51":"o","\u1e53":"o","\u014f":"o","\u022f":"o","\u0231":"o","\xf6":"o","\u022b":"o","\u1ecf":"o","\u0151":"o","\u01d2":"o","\u020d":"o","\u020f":"o","\u01a1":"o","\u1edd":"o","\u1edb":"o","\u1ee1":"o","\u1edf":"o","\u1ee3":"o","\u1ecd":"o","\u1ed9":"o","\u01eb":"o","\u01ed":"o","\xf8":"o","\u01ff":"o","\u0254":"o","\ua74b":"o","\ua74d":"o","\u0275":"o","\u01a3":"oi","\u0223":"ou","\ua74f":"oo","\u24df":"p","\uff50":"p","\u1e55":"p","\u1e57":"p","\u01a5":"p","\u1d7d":"p","\ua751":"p","\ua753":"p","\ua755":"p","\u24e0":"q","\uff51":"q","\u024b":"q","\ua757":"q","\ua759":"q","\u24e1":"r","\uff52":"r","\u0155":"r","\u1e59":"r","\u0159":"r","\u0211":"r","\u0213":"r","\u1e5b":"r","\u1e5d":"r","\u0157":"r","\u1e5f":"r","\u024d":"r","\u027d":"r","\ua75b":"r","\ua7a7":"r","\ua783":"r","\u24e2":"s","\uff53":"s","\xdf":"s","\u015b":"s","\u1e65":"s","\u015d":"s","\u1e61":"s","\u0161":"s","\u1e67":"s","\u1e63":"s","\u1e69":"s","\u0219":"s","\u015f":"s","\u023f":"s","\ua7a9":"s","\ua785":"s","\u1e9b":"s","\u24e3":"t","\uff54":"t","\u1e6b":"t","\u1e97":"t","\u0165":"t","\u1e6d":"t","\u021b":"t","\u0163":"t","\u1e71":"t","\u1e6f":"t","\u0167":"t","\u01ad":"t","\u0288":"t","\u2c66":"t","\ua787":"t","\ua729":"tz","\u24e4":"u","\uff55":"u","\xf9":"u","\xfa":"u","\xfb":"u","\u0169":"u","\u1e79":"u","\u016b":"u","\u1e7b":"u","\u016d":"u","\xfc":"u","\u01dc":"u","\u01d8":"u","\u01d6":"u","\u01da":"u","\u1ee7":"u","\u016f":"u","\u0171":"u","\u01d4":"u","\u0215":"u","\u0217":"u","\u01b0":"u","\u1eeb":"u","\u1ee9":"u","\u1eef":"u","\u1eed":"u","\u1ef1":"u","\u1ee5":"u","\u1e73":"u","\u0173":"u","\u1e77":"u","\u1e75":"u","\u0289":"u","\u24e5":"v","\uff56":"v","\u1e7d":"v","\u1e7f":"v","\u028b":"v","\ua75f":"v","\u028c":"v","\ua761":"vy","\u24e6":"w","\uff57":"w","\u1e81":"w","\u1e83":"w","\u0175":"w","\u1e87":"w","\u1e85":"w","\u1e98":"w","\u1e89":"w","\u2c73":"w","\u24e7":"x","\uff58":"x","\u1e8b":"x","\u1e8d":"x","\u24e8":"y","\uff59":"y","\u1ef3":"y","\xfd":"y","\u0177":"y","\u1ef9":"y","\u0233":"y","\u1e8f":"y","\xff":"y","\u1ef7":"y","\u1e99":"y","\u1ef5":"y","\u01b4":"y","\u024f":"y","\u1eff":"y","\u24e9":"z","\uff5a":"z","\u017a":"z","\u1e91":"z","\u017c":"z","\u017e":"z","\u1e93":"z","\u1e95":"z","\u01b6":"z","\u0225":"z","\u0240":"z","\u2c6c":"z","\ua763":"z","\u0386":"\u0391","\u0388":"\u0395","\u0389":"\u0397","\u038a":"\u0399","\u03aa":"\u0399","\u038c":"\u039f","\u038e":"\u03a5","\u03ab":"\u03a5","\u038f":"\u03a9","\u03ac":"\u03b1","\u03ad":"\u03b5","\u03ae":"\u03b7","\u03af":"\u03b9","\u03ca":"\u03b9","\u0390":"\u03b9","\u03cc":"\u03bf","\u03cd":"\u03c5","\u03cb":"\u03c5","\u03b0":"\u03c5","\u03c9":"\u03c9","\u03c2":"\u03c3"},e.fnOperators={equal:(t,i,n,r)=>(r&&(t=e.ignoreDiacritics(t),i=e.ignoreDiacritics(i)),n?e.toLowerCase(t)===e.toLowerCase(i):t===i),notequal:(t,i,n,r)=>(r&&(t=e.ignoreDiacritics(t),i=e.ignoreDiacritics(i)),!e.fnOperators.equal(t,i,n)),lessthan:(t,i,n)=>n?e.toLowerCase(t)<e.toLowerCase(i):(d(t)&&(t=void 0),t<i),greaterthan:(t,i,n)=>n?e.toLowerCase(t)>e.toLowerCase(i):t>i,lessthanorequal:(t,i,n)=>n?e.toLowerCase(t)<=e.toLowerCase(i):t<=i,greaterthanorequal:(t,i,n)=>n?e.toLowerCase(t)>=e.toLowerCase(i):t>=i,contains:(t,i,n,r)=>(r&&(t=e.ignoreDiacritics(t),i=e.ignoreDiacritics(i)),n?!d(t)&&!d(i)&&-1!==e.toLowerCase(t).indexOf(e.toLowerCase(i)):!d(t)&&!d(i)&&-1!==t.toString().indexOf(i)),notnull:e=>null!==e,isnull:e=>null===e,startswith:(t,i,n,r)=>(r&&(t=e.ignoreDiacritics(t),i=e.ignoreDiacritics(i)),n?t&&i&&e.startsWith(e.toLowerCase(t),e.toLowerCase(i)):t&&i&&e.startsWith(t,i)),endswith:(t,i,n,r)=>(r&&(t=e.ignoreDiacritics(t),i=e.ignoreDiacritics(i)),n?t&&i&&e.endsWith(e.toLowerCase(t),e.toLowerCase(i)):t&&i&&e.endsWith(t,i)),processSymbols:t=>{let i=e.operatorSymbols[t];return i?e.fnOperators[i]:e.throwError("Query - Process Operator : Invalid operator")},processOperator:t=>e.fnOperators[t]||e.fnOperators.processSymbols(t)},e.parse={parseJson:t=>("string"==typeof t?t=JSON.parse(t,e.parse.jsonReviver):t instanceof Array?e.parse.iterateAndReviveArray(t):"object"==typeof t&&null!==t&&e.parse.iterateAndReviveJson(t),t),iterateAndReviveArray:t=>{for(let i=0;i<t.length;i++)"object"==typeof t[i]&&null!==t[i]?e.parse.iterateAndReviveJson(t[i]):t[i]="string"!=typeof t[i]||/^[\s]*\[|^[\s]*\{(.)+:|\"/g.test(t[i])?e.parse.parseJson(t[i]):e.parse.jsonReviver("",t[i])},iterateAndReviveJson:t=>{let i,n=Object.keys(t);for(let r of n)e.startsWith(r,"__")||(i=t[r],"object"==typeof i?i instanceof Array?e.parse.iterateAndReviveArray(i):i&&e.parse.iterateAndReviveJson(i):t[r]=e.parse.jsonReviver(t[r],i))},jsonReviver:(t,i)=>{if("string"==typeof i){let t=/^\/Date\(([+-]?[0-9]+)([+-][0-9]{4})?\)\/$/.exec(i),n=e.timeZoneHandling?e.serverTimezoneOffset:null;if(t)return e.dateParse.toTimeZone(new Date(parseInt(t[1],10)),n,!0);if(/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*){1})([zZ]|([+\-])(\d\d):?(\d\d))?$/.test(i)){let t=i.indexOf("Z")>-1||i.indexOf("z")>-1,n=i.split(/[^0-9.]/);if(t)i=e.dateParse.toTimeZone(new Date(parseInt(n[0],10),parseInt(n[1],10)-1,parseInt(n[2],10),parseInt(n[3],10),parseInt(n[4],10),parseInt(n[5],10)),e.serverTimezoneOffset,!1);else{let t=new Date(parseInt(n[0],10),parseInt(n[1],10)-1,parseInt(n[2],10),parseInt(n[3],10),parseInt(n[4],10),parseInt(n[5],10)),r=parseInt(n[6],10),s=parseInt(n[7],10);if(isNaN(r)&&isNaN(s))return t;i.indexOf("+")>-1?t.setHours(t.getHours()-r,t.getMinutes()-s):t.setHours(t.getHours()+r,t.getMinutes()+s),i=e.dateParse.toTimeZone(t,e.serverTimezoneOffset,!1)}null==e.serverTimezoneOffset&&(i=e.dateParse.addSelfOffset(i))}}return i},isJson:t=>"string"==typeof t[0]?t:e.parse.parseJson(t),isGuid:e=>null!=/[A-Fa-f0-9]{8}(?:-[A-Fa-f0-9]{4}){3}-[A-Fa-f0-9]{12}/i.exec(e),replacer:(t,i)=>e.isPlainObject(t)?e.parse.jsonReplacer(t,i):t instanceof Array?e.parse.arrayReplacer(t):t instanceof Date?e.parse.jsonReplacer({val:t},i).val:t,jsonReplacer:(t,i)=>{let n,r=Object.keys(t);for(let s of r){if(n=t[s],!(n instanceof Date))continue;let i=n;null==e.serverTimezoneOffset?t[s]=e.dateParse.toTimeZone(i,null).toJSON():(i=new Date(+i+36e5*e.serverTimezoneOffset),t[s]=e.dateParse.toTimeZone(e.dateParse.addSelfOffset(i),null).toJSON())}return t},arrayReplacer:t=>{for(let i=0;i<t.length;i++)e.isPlainObject(t[i])?t[i]=e.parse.jsonReplacer(t[i]):t[i]instanceof Date&&(t[i]=e.parse.jsonReplacer({date:t[i]}).date);return t},jsonDateReplacer:(t,i)=>{if("value"===t&&i){if("string"==typeof i){let t=/^\/Date\(([+-]?[0-9]+)([+-][0-9]{4})?\)\/$/.exec(i);if(t)i=e.dateParse.toTimeZone(new Date(parseInt(t[1],10)),null,!0);else if(/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*){1})([zZ]|([+\-])(\d\d):?(\d\d))?$/.test(i)){let t=i.split(/[^0-9]/);i=e.dateParse.toTimeZone(new Date(parseInt(t[0],10),parseInt(t[1],10)-1,parseInt(t[2],10),parseInt(t[3],10),parseInt(t[4],10),parseInt(t[5],10)),null,!0)}}if(i instanceof Date)return i=e.dateParse.addSelfOffset(i),null===e.serverTimezoneOffset?e.dateParse.toTimeZone(e.dateParse.addSelfOffset(i),null).toJSON():(i=e.dateParse.toTimeZone(i,i.getTimezoneOffset()/60*2-e.serverTimezoneOffset,!1)).toJSON()}return i}},e.dateParse={addSelfOffset:e=>new Date(+e-6e4*e.getTimezoneOffset()),toUTC:e=>new Date(+e+6e4*e.getTimezoneOffset()),toTimeZone:(t,i,n)=>{if(null===i)return t;let r=n?e.dateParse.toUTC(t):t;return new Date(+r-36e5*i)},toLocalTime:e=>{let t=e,i=-t.getTimezoneOffset(),n=i>=0?"+":"-",r=e=>{let t=Math.floor(Math.abs(e));return(t<10?"0":"")+t};return t.getFullYear()+"-"+r(t.getMonth()+1)+"-"+r(t.getDate())+"T"+r(t.getHours())+":"+r(t.getMinutes())+":"+r(t.getSeconds())+n+r(i/60)+":"+r(i%60)}},e})();const Yr={GroupGuid:"{271bbba0-1ee7}"};class Gr{constructor(e){this.options={from:"table",requestType:"json",sortBy:"sorted",select:"select",skip:"skip",group:"group",take:"take",search:"search",count:"requiresCounts",where:"where",aggregates:"aggregates",expand:"expand"},this.type=Gr,this.dataSource=e,this.pvt={}}processResponse(e,t,i,n){return e}}class qr extends Gr{processQuery(e,t){let i,n,r,s=e.dataSource.json.slice(0),o=s.length,a=!0,l={},h=0,c=[];for(let p=0;p<t.lazyLoad.length;p++)h++,l[t.lazyLoad[p].key]=t.lazyLoad[p].value;let d={};for(let p=0;p<t.queries.length;p++)n=t.queries[p],"onPage"!==n.fn&&"onGroup"!==n.fn||!t.lazyLoad.length?(i=this[n.fn].call(this,s,n.e,t),"onAggregates"===n.fn?d[n.e.field+" - "+n.e.type]=i:s=void 0!==i?i:s,"onPage"!==n.fn&&"onSkip"!==n.fn&&"onTake"!==n.fn&&"onRange"!==n.fn||(a=!1),a&&(o=s.length)):("onGroup"===n.fn&&c.push(n.e),"onPage"===n.fn&&(r=n.e));if(h){let e=this.lazyLoadGroup({query:t,lazyLoad:l,result:s,group:c,page:r});s=e.result,o=e.count}return t.isCountRequired&&(s={result:s,count:o,aggregates:d}),s}lazyLoadGroup(e){let t=0,i=this.getAggregate(e.query),n=e.result;if(d(e.lazyLoad.onDemandGroupInfo)){n=Xr.group(n,e.group[0].fieldName,i,null,null,e.group[0].comparer,!0),t=n.length;let r=n;e.page&&(n=this.onPage(n,e.page,e.query)),this.formGroupResult(n,r)}else{let r=e.lazyLoad.onDemandGroupInfo;for(let e=r.where.length-1;e>=0;e--)n=this.onWhere(n,r.where[e]);e.group.length!==r.level&&(n=Xr.group(n,e.group[r.level].fieldName,i,null,null,e.group[0].comparer,!0)),t=n.length;let s=n;n=n.slice(r.skip),n=n.slice(0,r.take),e.group.length!==r.level&&this.formGroupResult(n,s)}return{result:n,count:t}}formGroupResult(e,t){if(e.length&&t.length){let i="GroupGuid",n="childLevels",r="level",s="records";e[i]=t[i],e[n]=t[n],e[r]=t[r],e[s]=t[s]}return e}getAggregate(e){let t=Ur.filterQueries(e.queries,"onAggregates"),i=[];if(t.length){let n;for(let r=0;r<t.length;r++)n=t[r].e,i.push({type:n.type,field:Xr.getValue(n.field,e)})}return i}batchRequest(e,t,i){let n,r=t.deletedRecords.length;for(n=0;n<t.addedRecords.length;n++)this.insert(e,t.addedRecords[n]);for(n=0;n<t.changedRecords.length;n++)this.update(e,i.key,t.changedRecords[n]);for(n=0;n<r;n++)this.remove(e,i.key,t.deletedRecords[n]);return t}onWhere(e,t){return e&&e.length?e.filter(e=>{if(t)return t.validate(e)}):e}onAggregates(e,t){let i=Xr.aggregates[t.type];return e&&i&&0!==e.length?i(e,t.field):null}onSearch(e,t){return e&&e.length?(0===t.fieldNames.length&&Xr.getFieldList(e[0],t.fieldNames),e.filter(e=>{for(let i=0;i<t.fieldNames.length;i++)if(t.comparer.call(e,Xr.getObject(t.fieldNames[i],e),t.searchKey,t.ignoreCase,t.ignoreAccent))return!0;return!1})):e}onSortBy(e,t,i){if(!e||!e.length)return e;let n,r=Xr.getValue(t.fieldName,i);if(!r)return e.sort(t.comparer);if(r instanceof Array){r=r.slice(0);for(let i=r.length-1;i>=0;i--)r[i]&&(n=t.comparer,Xr.endsWith(r[i]," desc")&&(n=Xr.fnSort("descending"),r[i]=r[i].replace(" desc","")),e=Xr.sort(e,r[i],n));return e}return Xr.sort(e,r,t.comparer)}onGroup(e,t,i){if(!e||!e.length)return e;let n=this.getAggregate(i);return Xr.group(e,Xr.getValue(t.fieldName,i),n,null,null,t.comparer)}onPage(e,t,i){let n=Xr.getValue(t.pageSize,i),r=(Xr.getValue(t.pageIndex,i)-1)*n;return e&&e.length?e.slice(r,r+n):e}onRange(e,t){return e&&e.length?e.slice(Xr.getValue(t.start),Xr.getValue(t.end)):e}onTake(e,t){return e&&e.length?e.slice(0,Xr.getValue(t.nos)):e}onSkip(e,t){return e&&e.length?e.slice(Xr.getValue(t.nos)):e}onSelect(e,t){return e&&e.length?Xr.select(e,Xr.getValue(t.fieldNames)):e}insert(e,t,i,n,r){return d(r)?e.dataSource.json.push(t):e.dataSource.json.splice(r,0,t)}remove(e,t,i,n){let r,s=e.dataSource.json;for("object"!=typeof i||i instanceof Date||(i=Xr.getObject(t,i)),r=0;r<s.length&&Xr.getObject(t,s[r])!==i;r++);return r!==s.length?s.splice(r,1):null}update(e,t,i,n){let r,s,a=e.dataSource.json;for(d(t)||(s=o(t,i)),r=0;r<a.length&&(d(t)||o(t,a[r])!==s);r++);return r<a.length?h(a[r],i):null}}class Zr extends Gr{processQuery(e,t,i){let n,r,s=this.getQueryRequest(t),o=Ur.filterQueryLists(t.queries,["onSelect","onPage","onSkip","onTake","onRange"]),a=t.params,l=e.dataSource.url,h=null,c=this.options,p={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};"onPage"in o?(n=o.onPage,r=Xr.getValue(n.pageIndex,t),h=Xr.getValue(n.pageSize,t),r=(r-1)*h):"onRange"in o&&(n=o.onRange,r=n.start,h=n.end-n.start);for(let d=0;d<s.sorts.length;d++)n=Xr.getValue(s.sorts[d].e.fieldName,t),p.sorts.push(Xr.callAdaptorFunction(this,"onEachSort",{name:n,direction:s.sorts[d].e.direction},t));i&&(n=this.getFiltersFrom(i,t),n&&p.filters.push(Xr.callAdaptorFunction(this,"onEachWhere",n.toJson(),t)));for(let f=0;f<s.filters.length;f++){let e=Xr.callAdaptorFunction(this,"onEachWhere",s.filters[f].e.toJson(),t);this.getModuleName&&"ODataV4Adaptor"===this.getModuleName()&&!d(s.filters[f].e.key)&&s.filters.length>1&&(e="("+e+")"),p.filters.push(e);let i="object"==typeof p.filters[f]?Object.keys(p.filters[f]):[];for(let t of i)Xr.isNull(p[t])&&delete p[t]}for(let d=0;d<s.searches.length;d++)n=s.searches[d].e,p.searches.push(Xr.callAdaptorFunction(this,"onEachSearch",{fields:n.fieldNames,operator:n.operator,key:n.searchKey,ignoreCase:n.ignoreCase},t));for(let d=0;d<s.groups.length;d++)p.groups.push(Xr.getValue(s.groups[d].e.fieldName,t));for(let d=0;d<s.aggregates.length;d++)n=s.aggregates[d].e,p.aggregates.push({type:n.type,field:Xr.getValue(n.field,t)});let u={};if(this.getRequestQuery(c,t,o,p,u),Xr.callAdaptorFunction(this,"addParams",{dm:e,query:t,params:a,reqParams:u}),t.lazyLoad.length)for(let d=0;d<t.lazyLoad.length;d++)u[t.lazyLoad[d].key]=t.lazyLoad[d].value;let g=Object.keys(u);for(let d of g)(Xr.isNull(u[d])||""===u[d]||0===u[d].length)&&delete u[d];c.skip in u&&c.take in u||null===h||(u[c.skip]=Xr.callAdaptorFunction(this,"onSkip",r,t),u[c.take]=Xr.callAdaptorFunction(this,"onTake",h,t));let m=this.pvt;return this.pvt={},"json"===this.options.requestType?{data:JSON.stringify(u,Xr.parse.jsonDateReplacer),url:l,pvtData:m,type:"POST",contentType:"application/json; charset=utf-8"}:(n=this.convertToQueryString(u,t,e),n=(-1!==e.dataSource.url.indexOf("?")?"&":"/")+n,{type:"GET",url:n.length?l.replace(/\/*$/,n):l,pvtData:m})}getRequestQuery(e,t,i,n,r){let s=r;s[e.from]=t.fromTable,e.apply&&t.distincts.length&&(s[e.apply]="onDistinct"in this?Xr.callAdaptorFunction(this,"onDistinct",t.distincts):""),!t.distincts.length&&e.expand&&(s[e.expand]="onExpand"in this&&"onSelect"in i?Xr.callAdaptorFunction(this,"onExpand",{selects:Xr.getValue(i.onSelect.fieldNames,t),expands:t.expands},t):t.expands),s[e.select]="onSelect"in i&&!t.distincts.length?Xr.callAdaptorFunction(this,"onSelect",Xr.getValue(i.onSelect.fieldNames,t),t):"",s[e.count]=t.isCountRequired?Xr.callAdaptorFunction(this,"onCount",t.isCountRequired,t):"",s[e.search]=n.searches.length?Xr.callAdaptorFunction(this,"onSearch",n.searches,t):"",s[e.skip]="onSkip"in i?Xr.callAdaptorFunction(this,"onSkip",Xr.getValue(i.onSkip.nos,t),t):"",s[e.take]="onTake"in i?Xr.callAdaptorFunction(this,"onTake",Xr.getValue(i.onTake.nos,t),t):"",s[e.where]=n.filters.length||n.searches.length?Xr.callAdaptorFunction(this,"onWhere",n.filters,t):"",s[e.sortBy]=n.sorts.length?Xr.callAdaptorFunction(this,"onSortBy",n.sorts,t):"",s[e.group]=n.groups.length?Xr.callAdaptorFunction(this,"onGroup",n.groups,t):"",s[e.aggregates]=n.aggregates.length?Xr.callAdaptorFunction(this,"onAggregates",n.aggregates,t):"",s.param=[]}convertToQueryString(e,t,i){return""}processResponse(e,t,i,n,r,s){if(n&&n.getResponseHeader("Content-Type")&&-1!==n.getResponseHeader("Content-Type").indexOf("application/json")){let i=Xr.timeZoneHandling;t&&!t.timeZoneHandling&&(Xr.timeZoneHandling=!1),e=Xr.parse.parseJson(e),Xr.timeZoneHandling=i}let o=r,a=o.pvtData||{},l=e?e.groupDs:[];if(n&&n.getResponseHeader("Content-Type")&&-1!==n.getResponseHeader("Content-Type").indexOf("xml"))return i.isCountRequired?{result:[],count:0}:[];let h=JSON.parse(o.data);if(h&&"batch"===h.action&&e&&e.addedRecords)return s.addedRecords=e.addedRecords,s;e&&e.d&&(e=e.d);let c={};e&&"count"in e&&(c.count=e.count),c.result=e&&e.result?e.result:e;let p=!1;if(Array.isArray(e.result)&&e.result.length){let t="key",n="value",r="level";if(d(e.result[0][t])||(c.result=this.formRemoteGroupedData(c.result,1,a.groups.length-1)),i&&i.lazyLoad.length&&a.groups.length)for(let e=0;e<i.lazyLoad.length;e++)"onDemandGroupInfo"===i.lazyLoad[e][t]&&a.groups.length===i.lazyLoad[e][n][r]&&(p=!0)}return p||this.getAggregateResult(a,e,c,l,i),Xr.isNull(c.count)?c.result:{result:c.result,count:c.count,aggregates:c.aggregates}}formRemoteGroupedData(e,t,i){for(let r=0;r<e.length;r++)e[r].items.length&&Object.keys(e[r].items[0]).indexOf("key")>-1&&this.formRemoteGroupedData(e[r].items,t+1,i-1);let n="GroupGuid";return e[n]=Yr[n],e.level=t,e.childLevels=i,e.records=e[0].items.length?this.getGroupedRecords(e,!d(e[0].items.records)):[],e}getGroupedRecords(e,t){let i=[];for(let n=0;n<e.length;n++)if(t)i=i.concat(e[n].items.records);else for(let t=0;t<e[n].items.length;t++)i.push(e[n].items[t]);return i}onGroup(e){return this.pvt.groups=e,e}onAggregates(e){this.pvt.aggregates=e}batchRequest(e,t,i,n,r){return{type:"POST",url:e.dataSource.batchUrl||e.dataSource.crudUrl||e.dataSource.removeUrl||e.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(c({},{changed:t.changedRecords,added:t.addedRecords,deleted:t.deletedRecords,action:"batch",table:i[void 0],key:i[void 0]},Xr.getAddParams(this,e,n)))}}beforeSend(e,t){}insert(e,t,i,n){return{url:e.dataSource.insertUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(c({},{value:t,table:i,action:"insert"},Xr.getAddParams(this,e,n)))}}remove(e,t,i,n,r){return{type:"POST",url:e.dataSource.removeUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(c({},{key:i,keyColumn:t,table:n,action:"remove"},Xr.getAddParams(this,e,r)))}}update(e,t,i,n,r){return{type:"POST",url:e.dataSource.updateUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(c({},{value:i,action:"update",keyColumn:t,key:Xr.getObject(t,i),table:n},Xr.getAddParams(this,e,r)))}}getFiltersFrom(e,t){let i,n=t.fKey,r=n,s=t.key,o=[];"object"!=typeof e[0]&&(r=null);for(let a=0;a<e.length;a++)i="object"==typeof e[0]?Xr.getObject(s||r,e[a]):e[a],o.push(new Fr(n,"equal",i));return Fr.or(o)}getAggregateResult(e,t,i,n,r){let s=t;if(t&&t.result&&(s=t.result),e&&e.aggregates&&e.aggregates.length){let n,r=e.aggregates,o=s,a={};t.aggregate&&(o=t.aggregate);for(let e=0;e<r.length;e++)n=Xr.aggregates[r[e].type],n&&(a[r[e].field+" - "+r[e].type]=n(o,r[e].field));i.aggregates=a}let o=Array.isArray(t.result)&&t.result.length&&!d(t.result[0].key);if(e&&e.groups&&e.groups.length&&!o){let t=e.groups;for(let i=0;i<t.length;i++){let o=null;d(n)||(n=Xr.group(n,t[i]));let a=Ur.filterQueries(r.queries,"onGroup")[i].e;s=Xr.group(s,t[i],e.aggregates,o,n,a.comparer)}i.result=s}return i}getQueryRequest(e){let t={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};return t.sorts=Ur.filterQueries(e.queries,"onSortBy"),t.groups=Ur.filterQueries(e.queries,"onGroup"),t.filters=Ur.filterQueries(e.queries,"onWhere"),t.searches=Ur.filterQueries(e.queries,"onSearch"),t.aggregates=Ur.filterQueries(e.queries,"onAggregates"),t}addParams(e){let t=e.reqParams;e.params.length&&(t.params={});for(let i of e.params){if(t[i.key])throw new Error("Query() - addParams: Custom Param is conflicting other request arguments");t[i.key]=i.value,i.fn&&(t[i.key]=i.fn.call(e.query,i.key,e.query,e.dm)),t.params[i.key]=t[i.key]}}}class $r extends Zr{constructor(e){super(),this.options=c({},this.options,{requestType:"get",accept:"application/json;odata=light;q=1,application/json;odata=verbose;q=0.5",multipartAccept:"multipart/mixed",sortBy:"$orderby",select:"$select",skip:"$skip",take:"$top",count:"$inlinecount",where:"$filter",expand:"$expand",batch:"$batch",changeSet:"--changeset_",batchPre:"batch_",contentId:"Content-Id: ",batchContent:"Content-Type: multipart/mixed; boundary=",changeSetContent:"Content-Type: application/http\nContent-Transfer-Encoding: binary ",batchChangeSetContentType:"Content-Type: application/json; charset=utf-8 ",updateType:"PUT"}),c(this.options,e||{})}getModuleName(){return"ODataAdaptor"}onPredicate(e,t,i){let n,r,s="",o=e.value,a=typeof o,l=e.field?$r.getField(e.field):null;if(o instanceof Date&&(o="datetime'"+Xr.parse.replacer(o)+"'"),"string"===a&&(o=encodeURIComponent(o),o="'"+o+"'",i&&(l="cast("+l+", 'Edm.String')"),Xr.parse.isGuid(o)&&(r="guid"),e.ignoreCase&&(r||(l="tolower("+l+")"),o=o.toLowerCase())),n=Xr.odBiOperator[e.operator],n)return s+=l,s+=n,r&&(s+=r),s+o;if(n=d(this.getModuleName)||"ODataV4Adaptor"!==this.getModuleName()?Xr.odUniOperator[e.operator]:Xr.odv4UniOperator[e.operator],"substringof"===n){let e=o;o=l,l=e}return s+=n+"(",s+=l+",",r&&(s+=r),s+=o+")",s}addParams(e){super.addParams(e),delete e.reqParams.params}onComplexPredicate(e,t,i){let n=[];for(let r=0;r<e.predicates.length;r++)n.push("("+this.onEachWhere(e.predicates[r],t,i)+")");return n.join(" "+e.condition+" ")}onEachWhere(e,t,i){return e.isComplex?this.onComplexPredicate(e,t,i):this.onPredicate(e,t,i)}onWhere(e){return this.pvt.search&&e.push(this.onEachWhere(this.pvt.search,null,!0)),e.join(" and ")}onEachSearch(e){e.fields&&0===e.fields.length&&Xr.throwError("Query() - Search : oData search requires list of field names to search");let t=this.pvt.search||[];for(let i=0;i<e.fields.length;i++)t.push(new Fr(e.fields[i],e.operator,e.key,e.ignoreCase));this.pvt.search=t}onSearch(e){return this.pvt.search=Fr.or(this.pvt.search),""}onEachSort(e){let t=[];if(e.name instanceof Array)for(let i=0;i<e.name.length;i++)t.push($r.getField(e.name[i])+("descending"===e.direction?" desc":""));else t.push($r.getField(e.name)+("descending"===e.direction?" desc":""));return t.join(",")}onSortBy(e){return e.reverse().join(",")}onGroup(e){return this.pvt.groups=e,[]}onSelect(e){for(let t=0;t<e.length;t++)e[t]=$r.getField(e[t]);return e.join(",")}onAggregates(e){return this.pvt.aggregates=e,""}onCount(e){return!0===e?"allpages":""}beforeSend(e,t,i){Xr.endsWith(i.url,this.options.batch)&&"post"===i.type.toLowerCase()?(t.setRequestHeader("Accept",this.options.multipartAccept),t.setRequestHeader("DataServiceVersion","2.0"),t.overrideMimeType("text/plain; charset=x-user-defined")):t.setRequestHeader("Accept",this.options.accept),t.setRequestHeader("DataServiceVersion","2.0"),t.setRequestHeader("MaxDataServiceVersion","2.0")}processResponse(e,t,i,n,r,s){let o="odata.metadata";if(r&&"GET"===r.type&&!this.rootUrl&&e[o]){let t=e[o].split("/$metadata#");this.rootUrl=t[0],this.resourceTableName=t[1]}if(!d(e.d)){let t=i&&i.isCountRequired?e.d.results:e.d,n="__metadata";if(!d(t))for(let e=0;e<t.length;e++)d(t[e][n])||delete t[e][n]}let a=r&&r.pvtData,l=this.processBatchResponse(e,i,n,r,s);if(l)return l;let h=n&&r.getResponseHeader("DataServiceVersion"),c=null,p=h&&parseInt(h,10)||2;if(i&&i.isCountRequired){let t="__count";(e[t]||e["odata.count"])&&(c=e[t]||e["odata.count"]),e.d&&(e=e.d),(e[t]||e["odata.count"])&&(c=e[t]||e["odata.count"])}3===p&&e.value&&(e=e.value),e.d&&(e=e.d),p<3&&e.results&&(e=e.results);let u={};return u.count=c,u.result=e,this.getAggregateResult(a,e,u,null,i),Xr.isNull(c)?u.result:{result:u.result,count:u.count,aggregates:u.aggregates}}convertToQueryString(e,t,i){let n=[],r=e.table||"";delete e.table,i.dataSource.requiresFormat&&(e.$format="json");let s=Object.keys(e);for(let o of s)n.push(o+"="+e[o]);return n=n.join("&"),i.dataSource.url&&-1!==i.dataSource.url.indexOf("?")&&!r?n:n.length?r+"?"+n:r||""}localTimeReplacer(e,t){for(let i of d(t)?[]:Object.keys(t))t[i]instanceof Date&&(t[i]=Xr.dateParse.toLocalTime(t[i]));return t}insert(e,t,i){return{url:(e.dataSource.insertUrl||e.dataSource.url).replace(/\/*$/,i?"/"+i:""),data:JSON.stringify(t,this.options.localTime?this.localTimeReplacer:null)}}remove(e,t,i,n){let r;return r="string"!=typeof i||Xr.parse.isGuid(i)?`(${i})`:`('${i}')`,{type:"DELETE",url:(e.dataSource.removeUrl||e.dataSource.url).replace(/\/*$/,n?"/"+n:"")+r}}update(e,t,i,n,r,s){let o;return"PATCH"!==this.options.updateType||d(s)||(i=this.compareAndRemove(i,s,t)),o="string"!=typeof i[t]||Xr.parse.isGuid(i[t])?`(${i[t]})`:`('${i[t]}')`,{type:this.options.updateType,url:(e.dataSource.updateUrl||e.dataSource.url).replace(/\/*$/,n?"/"+n:"")+o,data:JSON.stringify(i,this.options.localTime?this.localTimeReplacer:null),accept:this.options.accept}}batchRequest(e,t,i,n,r){let s=i.guid=Xr.getGuid(this.options.batchPre),o=this.rootUrl?this.rootUrl+"/"+this.options.batch:e.dataSource.url.replace(/\/*$/,"/"+this.options.batch);i.url=this.resourceTableName?this.resourceTableName:i.url;let a={url:i.url,key:i.key,cid:1,cSet:Xr.getGuid(this.options.changeSet)},l="--"+s+"\n";return l+="Content-Type: multipart/mixed; boundary="+a.cSet.replace("--","")+"\n",this.pvt.changeSet=0,l+=this.generateInsertRequest(t.addedRecords,a,e),l+=this.generateUpdateRequest(t.changedRecords,a,e,r?r.changedRecords:[]),l+=this.generateDeleteRequest(t.deletedRecords,a,e),l+=a.cSet+"--\n",l+="--"+s+"--",{type:"POST",url:o,dataType:"json",contentType:"multipart/mixed; charset=UTF-8;boundary="+s,data:l}}generateDeleteRequest(e,t,i){if(!e)return"";let n="";return n=this.generateBodyContent(e,t,{method:"DELETE ",url:(e,t,i)=>{let n=Xr.getObject(i,e[t]);return"number"==typeof n||Xr.parse.isGuid(n)?"("+n+")":n instanceof Date?"("+e[t][i].toJSON()+")":`('${n}')`},data:(e,t)=>""},i),n+"\n"}generateInsertRequest(e,t,i){if(!e)return"";let n="";return n=this.generateBodyContent(e,t,{method:"POST ",url:(e,t,i)=>"",data:(e,t)=>JSON.stringify(e[t])+"\n\n"},i),n}generateUpdateRequest(e,t,i,n){if(!e)return"";let r="";return e.forEach(e=>e=this.compareAndRemove(e,n.filter(i=>Xr.getObject(t.key,i)===Xr.getObject(t.key,e))[0],t.key)),r=this.generateBodyContent(e,t,{method:this.options.updateType+" ",url:(e,t,i)=>"number"==typeof e[t][i]||Xr.parse.isGuid(e[t][i])?"("+e[t][i]+")":e[t][i]instanceof Date?"("+e[t][i].toJSON()+")":`('${e[t][i]}')`,data:(e,t)=>JSON.stringify(e[t])+"\n\n"},i),r}static getField(e){return e.replace(/\./g,"/")}generateBodyContent(e,t,i,n){let r="";for(let s=0;s<e.length;s++)r+="\n"+t.cSet+"\n",r+=this.options.changeSetContent+"\n\n",r+=i.method,"POST "===i.method?r+=(n.dataSource.insertUrl||n.dataSource.crudUrl||t.url)+i.url(e,s,t.key)+" HTTP/1.1\n":"PUT "===i.method||"PATCH "===i.method?r+=(n.dataSource.updateUrl||n.dataSource.crudUrl||t.url)+i.url(e,s,t.key)+" HTTP/1.1\n":"DELETE "===i.method&&(r+=(n.dataSource.removeUrl||n.dataSource.crudUrl||t.url)+i.url(e,s,t.key)+" HTTP/1.1\n"),r+="Accept: "+this.options.accept+"\n",r+="Content-Id: "+this.pvt.changeSet+++"\n",r+=this.options.batchChangeSetContentType+"\n",d(e[s]["@odata.etag"])?r+="\n":(r+="If-Match: "+e[s]["@odata.etag"]+"\n\n",delete e[s]["@odata.etag"]),r+=i.data(e,s);return r}processBatchResponse(e,t,i,n,r){if(i&&i.getResponseHeader("Content-Type")&&-1!==i.getResponseHeader("Content-Type").indexOf("xml"))return t.isCountRequired?{result:[],count:0}:[];if(n&&this.options.batch&&Xr.endsWith(n.url,this.options.batch)&&"post"===n.type.toLowerCase()){let t,n,s=i.getResponseHeader("Content-Type"),o=e+"";if(s=s.substring(s.indexOf("=batchresponse")+1),o=o.split(s),o.length<2)return{};o=o[1];let a=/(?:\bContent-Type.+boundary=)(changesetresponse.+)/i.exec(o);a&&o.replace(a[0],""),o=o.split(a?a[1]:"");for(let e=o.length;e>-1;e--)/\bContent-ID:/i.test(o[e])&&/\bHTTP.+201/.test(o[e])&&(t=parseInt(/\bContent-ID: (\d+)/i.exec(o[e])[1],10),r.addedRecords[t]&&(n=Xr.parse.parseJson(/^\{.+\}/m.exec(o[e])[0]),c({},r.addedRecords[t],this.processResponse(n))));return r}return null}compareAndRemove(e,t,i){return d(t)||Object.keys(e).forEach(n=>{n!==i&&"@odata.etag"!==n&&(Xr.isPlainObject(e[n])?(this.compareAndRemove(e[n],t[n]),0===Object.keys(e[n]).filter(e=>"@odata.etag"!==e).length&&delete e[n]):(e[n]===t[n]||e[n]&&t[n]&&e[n].valueOf()===t[n].valueOf())&&delete e[n])}),e}}class Qr extends qr{constructor(){super(),a("beforeSend",Zr.prototype.beforeSend,this)}insert(e,t,i,n,r){return this.pvt.position=r,this.updateType="add",{url:e.dataSource.insertUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(c({},{value:t,table:i,action:"insert"},Xr.getAddParams(this,e,n)))}}remove(e,t,i,n,r){return super.remove(e,t,i),{type:"POST",url:e.dataSource.removeUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(c({},{key:i,keyColumn:t,table:n,action:"remove"},Xr.getAddParams(this,e,r)))}}update(e,t,i,n,r){return this.updateType="update",this.updateKey=t,{type:"POST",url:e.dataSource.updateUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(c({},{value:i,action:"update",keyColumn:t,key:i[t],table:n},Xr.getAddParams(this,e,r)))}}processResponse(e,t,i,n,r,s,o){let a;if(e="batch"===(r?JSON.parse(r.data):e).action?Xr.parse.parseJson(e):e,"add"===this.updateType&&super.insert(t,e,null,null,this.pvt.position),"update"===this.updateType&&super.update(t,this.updateKey,e),this.updateType=void 0,e.added)for(a=0;a<e.added.length;a++)super.insert(t,e.added[a]);if(e.changed)for(a=0;a<e.changed.length;a++)super.update(t,o.key,e.changed[a]);if(e.deleted)for(a=0;a<e.deleted.length;a++)super.remove(t,o.key,e.deleted[a]);return e}batchRequest(e,t,i,n,r){return{type:"POST",url:e.dataSource.batchUrl||e.dataSource.crudUrl||e.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(c({},{changed:t.changedRecords,added:t.addedRecords,deleted:t.deletedRecords,action:"batch",table:i.url,key:i.key},Xr.getAddParams(this,e,n)))}}addParams(e){(new Zr).addParams(e)}}class Jr extends Zr{constructor(e){super(),this.options=c({},this.options,{getData:new Function,addRecord:new Function,updateRecord:new Function,deleteRecord:new Function,batchUpdate:new Function}),c(this.options,e||{})}getModuleName(){return"CustomDataAdaptor"}}class Kr extends Zr{constructor(e,t,i){super(),this.isCrudAction=!1,this.isInsertAction=!1,d(e)||(this.cacheAdaptor=e),this.pageSize=i,this.guidId=Xr.getGuid("cacheAdaptor"),window.localStorage.setItem(this.guidId,JSON.stringify({keys:[],results:[]}));let n=this.guidId;d(t)||setInterval(()=>{let e;e=Xr.parse.parseJson(window.localStorage.getItem(n));let i=[];for(let n=0;n<e.results.length;n++){let r=+new Date,s=+new Date(e.results[n].timeStamp);e.results[n].timeStamp=r-s,r-s>t&&i.push(n)}for(let t=0;t<i.length;t++)e.results.splice(i[t],1),e.keys.splice(i[t],1);window.localStorage.removeItem(n),window.localStorage.setItem(n,JSON.stringify(e))},t)}generateKey(e,t){let i=this.getQueryRequest(t),n=Ur.filterQueryLists(t.queries,["onSelect","onPage","onSkip","onTake","onRange"]),r=e,s="onPage";s in n&&(r+=n[s].pageIndex),i.sorts.forEach(e=>{r+=e.e.direction+e.e.fieldName}),i.groups.forEach(e=>{r+=e.e.fieldName}),i.searches.forEach(e=>{r+=e.e.searchKey});for(let o=0;o<i.filters.length;o++){let n=i.filters[o];if(n.e.isComplex){let i=t.clone();i.queries=[];for(let e=0;e<n.e.predicates.length;e++)i.queries.push({fn:"onWhere",e:n.e.predicates[e],filter:t.queries.filter});r+=n.e.condition+this.generateKey(e,i)}else r+=n.e.field+n.e.operator+n.e.value}return r}processQuery(e,t,i){let n,r=this.generateKey(e.dataSource.url,t);n=Xr.parse.parseJson(window.localStorage.getItem(this.guidId));let s=n?n.results[n.keys.indexOf(r)]:null;return null==s||this.isCrudAction||this.isInsertAction?(this.isCrudAction=null,this.isInsertAction=null,this.cacheAdaptor.processQuery.apply(this.cacheAdaptor,[].slice.call(arguments,0))):s}processResponse(e,t,i,n,r,s){if(this.isInsertAction||r&&this.cacheAdaptor.options.batch&&Xr.endsWith(r.url,this.cacheAdaptor.options.batch)&&"post"===r.type.toLowerCase())return this.cacheAdaptor.processResponse(e,t,i,n,r,s);e=this.cacheAdaptor.processResponse.apply(this.cacheAdaptor,[].slice.call(arguments,0));let o=i?this.generateKey(t.dataSource.url,i):t.dataSource.url,a={};a=Xr.parse.parseJson(window.localStorage.getItem(this.guidId));let l=a.keys.indexOf(o);for(-1!==l&&(a.results.splice(l,1),a.keys.splice(l,1)),a.results[a.keys.push(o)-1]={keys:o,result:e.result,timeStamp:new Date,count:e.count};a.results.length>this.pageSize;)a.results.splice(0,1),a.keys.splice(0,1);return window.localStorage.setItem(this.guidId,JSON.stringify(a)),e}beforeSend(e,t,i){!d(this.cacheAdaptor.options.batch)&&Xr.endsWith(i.url,this.cacheAdaptor.options.batch)&&"post"===i.type.toLowerCase()&&t.setRequestHeader("Accept",this.cacheAdaptor.options.multipartAccept),e.dataSource.crossDomain||t.setRequestHeader("Accept",this.cacheAdaptor.options.accept)}update(e,t,i,n){return this.isCrudAction=!0,this.cacheAdaptor.update(e,t,i,n)}insert(e,t,i){return this.isInsertAction=!0,this.cacheAdaptor.insert(e,t,i)}remove(e,t,i,n){return this.isCrudAction=!0,this.cacheAdaptor.remove(e,t,i,n)}batchRequest(e,t,i){return this.cacheAdaptor.batchRequest(e,t,i)}}class es{constructor(e,t,i){let n;return this.dateParse=!0,this.timeZoneHandling=!0,this.requests=[],e||this.dataSource||(e=[]),i=i||e.adaptor,e&&!1===e.timeZoneHandling&&(this.timeZoneHandling=e.timeZoneHandling),e instanceof Array?n={json:e,offline:!0}:"object"==typeof e?(e.json||(e.json=[]),n={url:e.url,insertUrl:e.insertUrl,removeUrl:e.removeUrl,updateUrl:e.updateUrl,crudUrl:e.crudUrl,batchUrl:e.batchUrl,json:e.json,headers:e.headers,accept:e.accept,data:e.data,timeTillExpiration:e.timeTillExpiration,cachingPageSize:e.cachingPageSize,enableCaching:e.enableCaching,requestType:e.requestType,key:e.key,crossDomain:e.crossDomain,jsonp:e.jsonp,dataType:e.dataType,offline:void 0!==e.offline?e.offline:!(e.adaptor instanceof Qr||e.adaptor instanceof Jr||e.url),requiresFormat:e.requiresFormat}):Xr.throwError("DataManager: Invalid arguments"),void 0!==n.requiresFormat||Xr.isCors()||(n.requiresFormat=!!d(n.crossDomain)||n.crossDomain),void 0===n.dataType&&(n.dataType="json"),this.dataSource=n,this.defaultQuery=t,n.url&&n.offline&&!n.json.length?(this.isDataAvailable=!1,this.adaptor=i||new $r,this.dataSource.offline=!1,this.ready=this.executeQuery(t||new Ur),this.ready.then(e=>{this.dataSource.offline=!0,this.isDataAvailable=!0,n.json=e.result,this.adaptor=new qr})):this.adaptor=n.offline?new qr:new $r,!n.jsonp&&this.adaptor instanceof $r&&(n.jsonp="callback"),this.adaptor=i||this.adaptor,n.enableCaching&&(this.adaptor=new Kr(this.adaptor,n.timeTillExpiration,n.cachingPageSize)),this}setDefaultQuery(e){return this.defaultQuery=e,this}executeLocal(e){this.defaultQuery||e instanceof Ur||Xr.throwError("DataManager - executeLocal() : A query is required to execute"),this.dataSource.json||Xr.throwError("DataManager - executeLocal() : Json data is required to execute");let t=this.adaptor.processQuery(this,e=e||this.defaultQuery);if(e.subQuery){let i=e.subQuery.fromTable,n=e.subQuery.lookups,r=e.isCountRequired?t.result:t;n&&n instanceof Array&&Xr.buildHierarchy(e.subQuery.fKey,i,r,n,e.subQuery.key);for(let t=0;t<r.length;t++)r[t][i]instanceof Array&&(r[t]=c({},{},r[t]),r[t][i]=this.adaptor.processResponse(e.subQuery.using(new es(r[t][i].slice(0))).executeLocal(),this,e))}return this.adaptor.processResponse(t,this,e)}executeQuery(e,t,i,n){"function"==typeof e&&(n=i,i=t,t=e,e=null),e||(e=this.defaultQuery),e instanceof Ur||Xr.throwError("DataManager - executeQuery() : A query is required to execute");let r=new ts,s={query:e};if(!this.dataSource.offline&&void 0!==this.dataSource.url&&""!==this.dataSource.url||!d(this.adaptor.makeRequest)||this.isCustomDataAdaptor(this.adaptor)){let t=this.adaptor.processQuery(this,e);d(this.adaptor.makeRequest)?!d(t.url)||this.isCustomDataAdaptor(this.adaptor)?this.makeRequest(t,r,s,e):(s=es.getDeferedArgs(e,t,s),r.resolve(s)):this.adaptor.makeRequest(t,r,s,e)}else es.nextTick(()=>{let t=this.executeLocal(e);s=es.getDeferedArgs(e,t,s),r.resolve(s)});return(t||i)&&r.promise.then(t,i),n&&r.promise.then(n,n),r.promise}static getDeferedArgs(e,t,i){return e.isCountRequired?(i.result=t.result,i.count=t.count,i.aggregates=t.aggregates):i.result=t,i}static nextTick(e){(window.setImmediate||window.setTimeout)(e,0)}extendRequest(e,t,i){return c({},{type:"GET",dataType:this.dataSource.dataType,crossDomain:this.dataSource.crossDomain,jsonp:this.dataSource.jsonp,cache:!0,processData:!1,onSuccess:t,onFailure:i},e)}makeRequest(e,t,i,n){let r=!!n.subQuerySelector,s=e=>{i.error=e,t.reject(i)},o=(e,n,r,s,o,a,l)=>{i.xhr=r,i.count=n?parseInt(n.toString(),10):0,i.result=e,i.request=s,i.aggregates=a,i.actual=o,i.virtualSelectRecords=l,t.resolve(i)},a=(e,t)=>{let a=new ts,l={parent:i};n.subQuery.isChild=!0;let h=this.adaptor.processQuery(this,n.subQuery,e?this.adaptor.processResponse(e):t),c=this.makeRequest(h,a,l,n.subQuery);return r||a.then(t=>{e&&(Xr.buildHierarchy(n.subQuery.fKey,n.subQuery.fromTable,e,t,n.subQuery.key),o(e,t.count,t.xhr))},s),c},l=this.extendRequest(e,(e,t)=>{this.isCustomDataAdaptor(this.adaptor)&&(t=c({},this.ajaxReqOption,t)),-1===t.httpRequest.getResponseHeader("Content-Type").indexOf("xml")&&this.dateParse&&(e=Xr.parse.parseJson(e));let i=this.adaptor.processResponse(e,this,n,t.httpRequest,t),s=0,l=null,h=e.virtualSelectRecords;n.isCountRequired&&(s=i.count,l=i.aggregates,i=i.result),n.subQuery?r||a(i,t):o(i,s,t.httpRequest,t.type,e,l,h)},s);if(this.isCustomDataAdaptor(this.adaptor))this.ajaxReqOption=l,this.adaptor.options.getData({data:l.data,onSuccess:l.onSuccess,onFailure:l.onFailure});else{let e=new _(l);e.beforeSend=()=>{this.beforeSend(e.httpRequest,e)},l=e.send(),l.catch(e=>!0),this.requests.push(e)}if(r){let e,t=n.subQuerySelector.call(this,{query:n.subQuery,parent:n});t&&t.length?(e=Promise.all([l,a(null,t)]),e.then((...e)=>{let t=e[0],i=this.adaptor.processResponse(t[0],this,n,this.requests[0].httpRequest,this.requests[0]),s=0;n.isCountRequired&&(s=i.count,i=i.result);let a=this.adaptor.processResponse(t[1],this,n.subQuery,this.requests[1].httpRequest,this.requests[1]);s=0,n.subQuery.isCountRequired&&(s=a.count,a=a.result),Xr.buildHierarchy(n.subQuery.fKey,n.subQuery.fromTable,i,a,n.subQuery.key),r=!1,o(i,s,this.requests[0].httpRequest)})):r=!1}return l}beforeSend(e,t){this.adaptor.beforeSend(this,e,t);let i,n=this.dataSource.headers;for(let r=0;n&&r<n.length;r++){i=[];let t=Object.keys(n[r]);for(let s of t)i.push(s),e.setRequestHeader(s,n[r][s])}}saveChanges(e,t,i,n,r){i instanceof Ur&&(n=i,i=null);let s={url:i,key:t||this.dataSource.key},o=this.adaptor.batchRequest(this,e,s,n||new Ur,r);if(this.dataSource.offline)return o;if(d(this.adaptor.doAjaxRequest)){if(this.isCustomDataAdaptor(this.adaptor))return this.doAjaxRequest(o,this.adaptor.options.batchUpdate);{let t=new ts,i=new _(o);return i.beforeSend=()=>{this.beforeSend(i.httpRequest,i)},i.onSuccess=(i,n)=>{t.resolve(this.adaptor.processResponse(i,this,null,n.httpRequest,n,e,s))},i.onFailure=e=>{t.reject([{error:e}])},i.send().catch(e=>!0),t.promise}}return this.adaptor.doAjaxRequest(o)}insert(e,t,i,n){t instanceof Ur&&(i=t,t=null);let r=this.adaptor.insert(this,e,t,i,n);return this.dataSource.offline?r:d(this.adaptor.doAjaxRequest)?this.doAjaxRequest(r,this.adaptor.options.addRecord):this.adaptor.doAjaxRequest(r)}remove(e,t,i,n){"object"==typeof t&&(t=Xr.getObject(e,t)),i instanceof Ur&&(n=i,i=null);let r=this.adaptor.remove(this,e,t,i,n);return this.dataSource.offline?r:d(this.adaptor.doAjaxRequest)?this.doAjaxRequest(r,this.adaptor.options.deleteRecord):this.adaptor.doAjaxRequest(r)}update(e,t,i,n,r){i instanceof Ur&&(n=i,i=null);let s=this.adaptor.update(this,e,t,i,n,r);return this.dataSource.offline?s:d(this.adaptor.doAjaxRequest)?this.doAjaxRequest(s,this.adaptor.options.updateRecord):this.adaptor.doAjaxRequest(s)}isCustomDataAdaptor(e){return this.adaptor.getModuleName&&"CustomDataAdaptor"===this.adaptor.getModuleName()}successFunc(e,t){this.isCustomDataAdaptor(this.adaptor)&&(t=c({},this.ajaxReqOption,t));try{Xr.parse.parseJson(e)}catch(i){e=[]}e=this.adaptor.processResponse(Xr.parse.parseJson(e),this,null,t.httpRequest,t),this.ajaxDeffered.resolve(e)}failureFunc(e){this.ajaxDeffered.reject([{error:e}])}doAjaxRequest(e,t){if(e=c({},{type:"POST",contentType:"application/json; charset=utf-8",processData:!1},e),this.ajaxDeffered=new ts,this.isCustomDataAdaptor(this.adaptor))this.ajaxReqOption=e,t.call(this,{data:e.data,onSuccess:this.successFunc.bind(this),onFailure:this.failureFunc.bind(this)});else{let t=new _(e);t.beforeSend=()=>{this.beforeSend(t.httpRequest,t)},t.onSuccess=this.successFunc.bind(this),t.onFailure=this.failureFunc.bind(this),t.send().catch(e=>!0)}return this.ajaxDeffered.promise}}class ts{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t}),this.then=this.promise.then.bind(this.promise),this.catch=this.promise.catch.bind(this.promise)}}let is={li:"e-list-item",ul:"e-list-parent e-ul",group:"e-list-group-item",icon:"e-list-icon",text:"e-list-text",check:"e-list-check",checked:"e-checked",selected:"e-selected",expanded:"e-expanded",textContent:"e-text-content",hasChild:"e-has-child",level:"e-level",url:"e-list-url",collapsible:"e-icon-collapsible",disabled:"e-disabled",image:"e-list-img",iconWrapper:"e-icon-wrapper",anchorWrap:"e-anchor-wrap",navigable:"e-navigable"};var ns;function rs(e,t){const i={};if(d(e)||"string"==typeof e||"number"==typeof e||!d(e.isHeader))return e;for(const n of Object.keys(t)){const r=t[n],s=d(r)||"string"!=typeof r?void 0:o(r,e);d(s)||(i[r]=s)}return i}!function(e){e.defaultMappedFields={id:"id",text:"text",url:"url",value:"value",isChecked:"isChecked",enabled:"enabled",expanded:"expanded",selected:"selected",iconCss:"iconCss",child:"child",isVisible:"isVisible",hasChildren:"hasChildren",tooltip:"tooltip",htmlAttributes:"htmlAttributes",urlAttributes:"urlAttributes",imageAttributes:"imageAttributes",imageUrl:"imageUrl",groupBy:null};const t={level:1,listRole:"presentation",itemRole:"presentation",groupItemRole:"group",itemText:"list-item",wrapperRole:"presentation"},i={showCheckBox:!1,showIcon:!1,enableHtmlSanitizer:!1,expandCollapse:!1,fields:e.defaultMappedFields,ariaAttributes:t,listClass:"",itemClass:"",processSubChild:!1,sortOrder:"None",template:null,groupTemplate:null,headerTemplate:null,expandIconClass:"e-icon-collapsible",moduleName:"list",expandIconPosition:"Right",itemNavigable:!1};function n(e,t,i,n,s){return S(e,r(e,t,i,n,s),null,n)}function r(e,t,n,r,s){const o=[],a=c({},i,r);is=v(a.moduleName);const l=f();for(let i=0;i<t.length;i++){if(d(t[i]))continue;let h;a.itemCreating&&"function"==typeof a.itemCreating&&a.itemCreating({dataSource:t,curData:t[i],text:t[i],options:a}),h=n?b(e,t[i],void 0,null,null,[],null,l,i,r):x(e,t[i],void 0,null,null,r,s),a.itemCreated&&"function"==typeof a.itemCreated&&a.itemCreated({dataSource:t,curData:t[i],text:t[i],item:h,options:a}),o.push(h)}return o}function s(n,r,s,o,a,l){const p=c({},i,s);is=v(p.moduleName);const m=c({},e.defaultMappedFields,p.fields),w=c({},t,p.ariaAttributes);let S,C=[];o&&(w.level=o);const P=[];let O,T;r&&r.length&&!d(u(r).item)&&!u(r).item.hasOwnProperty(m.id)&&(S=f());for(let e=0;e<r.length;e++){let t=rs(r[e],m);if(d(r[e]))continue;p.itemCreating&&"function"==typeof p.itemCreating&&p.itemCreating({dataSource:r,curData:r[e],text:t[m.text],options:p,fields:m});const i=r[e];p.itemCreating&&"function"==typeof p.itemCreating&&(t=rs(r[e],m)),t.hasOwnProperty(m.id)&&!d(t[m.id])&&(S=t[m.id]);const o=[];if(p.showCheckBox&&(p.itemNavigable&&(t[m.url]||t[m.urlAttributes])?C.push(n("input",{className:is.check,attrs:{type:"checkbox"}})):o.push(n("input",{className:is.check,attrs:{type:"checkbox"}}))),!0===a)p.showIcon&&t.hasOwnProperty(m.iconCss)&&!d(t[m.iconCss])&&o.push(n("span",{className:is.icon+" "+t[m.iconCss]})),O=b(n,i,t,m,p.itemClass,o,!(!i.hasOwnProperty("isHeader")||!i.isHeader),S,e,s),T=O.querySelector("."+is.anchorWrap),p.itemNavigable&&C.length&&Ge(C,O.firstElementChild);else{if(O=x(n,i,t,m,p.itemClass,s,l),O.classList.add(is.level+"-"+w.level),O.setAttribute("aria-level",w.level.toString()),T=O.querySelector("."+is.anchorWrap),t.hasOwnProperty(m.tooltip)&&O.setAttribute("title",t[m.tooltip]),t.hasOwnProperty(m.htmlAttributes)&&t[m.htmlAttributes]&&g(O,t[m.htmlAttributes]),t.hasOwnProperty(m.enabled)&&!1===t[m.enabled]&&O.classList.add(is.disabled),t.hasOwnProperty(m.isVisible)&&!1===t[m.isVisible]&&(O.style.display="none"),t.hasOwnProperty(m.imageUrl)&&!d(t[m.imageUrl])&&!p.template){const e={src:t[m.imageUrl]};h(e,t[m.imageAttributes]);const i=n("img",{className:is.image,attrs:e});T?T.insertAdjacentElement("afterbegin",i):Ge([i],O.firstElementChild)}if(p.showIcon&&t.hasOwnProperty(m.iconCss)&&!d(t[m.iconCss])&&!p.template){const e=n("div",{className:is.icon+" "+t[m.iconCss]});T?T.insertAdjacentElement("afterbegin",e):Ge([e],O.firstElementChild)}o.length&&Ge(o,O.firstElementChild),p.itemNavigable&&C.length&&Ge(C,O.firstElementChild),y(n,t,m,0,p,O,w.level)}T&&Fe([O],[is.navigable]),p.itemCreated&&"function"==typeof p.itemCreated&&p.itemCreated({dataSource:r,curData:r[e],text:t[m.text],item:O,options:p,fields:m}),C=[],P.push(O)}return P}function o(e,t,n,r,o,a){const l=c({},i,n);return S(e,s(e,t,n,r,o,a),l.listClass,n)}function a(e,t){if(t&&e){let i=t;return i=Array.prototype.slice.call(t),i.indexOf(e)}}function l(e,t,i=new Ur){if("Ascending"===e)i.sortBy(t,"ascending",!0);else if("Descending"===e)i.sortBy(t,"descending",!0);else for(let n=0;n<i.queries.length;n++)"onSortBy"===i.queries[n].fn&&i.queries.splice(n,1);return i}function p(e,t){return new es(e).executeLocal(t)}function u(e){for(let t=0;t<e.length;t++)if(!d(e[t]))return{typeof:typeof e[t],item:e[t]};return{typeof:null,item:null}}function g(e,t){const i={};h(i,t),i.class&&(Fe([e],i.class.split(" ")),delete i.class),Je(e,i)}function m(e){const t={},i=e.attributes;for(let n=0;n<i.length;n++)t[i[n].nodeName]=i[n].nodeValue;return t}function f(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function y(e,t,i,n,r,s,a){const l=t[i.child]||[];let h=t[i.hasChildren];if(l.length&&(h=!0,s.classList.add(is.hasChild),r.processSubChild)){const t=o(e,l,r,++a);s.appendChild(t)}r.expandCollapse&&h&&!r.template&&(s.firstElementChild.classList.add(is.iconWrapper),("Left"===r.expandIconPosition?Ge:qe)([e("div",{className:"e-icons "+r.expandIconClass})],s.querySelector("."+is.textContent)))}function b(e,n,r,s,o,a,l,h,p,u){const m=c({},i,u),f=c({},t,m.ariaAttributes);let y,b,v=n,x=n;"string"!=typeof n&&"number"!=typeof n&&"boolean"!=typeof n&&(y=n,v="boolean"==typeof r[s.text]||"number"==typeof r[s.text]?r[s.text]:r[s.text]||"",x=r[s.value]),b=d(y)||d(r[s.id])||""===r[s.id]?h+"-"+p:h;const S=e("li",{className:(!0===l?is.group:is.li)+" "+(d(o)?"":o),id:b,attrs:""!==f.groupItemRole&&""!==f.itemRole?{role:!0===l?f.groupItemRole:f.itemRole}:{}});return y&&r.hasOwnProperty(s.enabled)&&"false"===r[s.enabled].toString()&&S.classList.add(is.disabled),l?S.innerText=v:(S.setAttribute("data-value",d(x)?"null":x),S.setAttribute("role","option"),y&&r.hasOwnProperty(s.htmlAttributes)&&r[s.htmlAttributes]&&g(S,r[s.htmlAttributes]),a.length&&!m.itemNavigable&&qe(a,S),y&&(r[s.url]||r[s.urlAttributes]&&r[s.urlAttributes].href)?S.appendChild(w(e,y,s,v,a,m.itemNavigable)):(a.length&&m.itemNavigable&&qe(a,S),S.appendChild(document.createTextNode(v)))),S}function v(e){return{li:`e-${e}-item`,ul:`e-${e}-parent e-ul`,group:`e-${e}-group-item`,icon:`e-${e}-icon`,text:`e-${e}-text`,check:`e-${e}-check`,checked:"e-checked",selected:"e-selected",expanded:"e-expanded",textContent:"e-text-content",hasChild:"e-has-child",level:"e-level",url:`e-${e}-url`,collapsible:"e-icon-collapsible",disabled:"e-disabled",image:`e-${e}-img`,iconWrapper:"e-icon-wrapper",anchorWrap:"e-anchor-wrap",navigable:"e-navigable"}}function w(e,t,i,n,r,s){const o=rs(t,i),a={href:o[i.url]};let l;if(o.hasOwnProperty(i.urlAttributes)&&o[i.urlAttributes]&&(h(a,o[i.urlAttributes]),a.href=o[i.url]?o[i.url]:o[i.urlAttributes].href),s){l=e("a",{className:is.text+" "+is.url});const t=e("div",{className:is.anchorWrap});r&&r.length&&qe(r,t),t.appendChild(document.createTextNode(n)),qe([t],l)}else l=e("a",{className:is.text+" "+is.url,innerHTML:n});return g(l,a),l}function x(e,n,r,s,o,a,l){const h=c({},i,a),p=c({},t,h.ariaAttributes);let u,g,m,y=n;"string"!=typeof n&&"number"!=typeof n&&(m=n,y=r[s.text]||"",u=d(r._id)?r[s.id]:r._id,g=!(!n.hasOwnProperty("isHeader")||!n.isHeader)),a&&a.enableHtmlSanitizer&&(y=y);const b=e("li",{className:(!0===g?is.group:is.li)+" "+(d(o)?"":o),attrs:""!==p.groupItemRole&&""!==p.itemRole?{role:!0===g?p.groupItemRole:p.itemRole}:{}});if(1==!d(u)?b.setAttribute("data-uid",u):b.setAttribute("data-uid",f()),g&&a&&a.groupTemplate){const e=Se(a.groupTemplate)(n,l,"groupTemplate",h.groupTemplateID,!!h.isStringTemplate,null,b);e&&qe(e,b)}else if(!g&&a&&a.template){const e=Se(a.template)(n,l,"template",h.templateID,!!h.isStringTemplate,null,b);e&&qe(e,b)}else{const t=e("div",{className:is.textContent,attrs:""!==p.wrapperRole?{role:p.wrapperRole}:{}});if(m&&(r[s.url]||r[s.urlAttributes]&&r[s.urlAttributes].href))t.appendChild(w(e,m,s,y,null,h.itemNavigable));else{const i=e("span",{className:is.text,attrs:""!==p.itemText?{role:p.itemText}:{}});a&&a.enableHtmlSanitizer?i.innerText=y:i.innerHTML=y,t.appendChild(i)}b.appendChild(t)}return b}function S(e,n,r,s){const o=c({},i,s),a=c({},t,o.ariaAttributes);is=v(o.moduleName);const l=e("ul",{className:is.ul+" "+(d(r)?"":r),attrs:""!==a.listRole?{role:a.listRole}:{}});return qe(n,l),l}e.createList=function(e,r,s,a,l){const h=c({},i,s),d=c({},t,h.ariaAttributes),p=u(r).typeof;return"string"===p||"number"===p?n(e,r,a,s,l):o(e,r,s,d.level,a,l)},e.createListFromArray=n,e.createListItemFromArray=r,e.createListItemFromJson=s,e.createListFromJson=o,e.getSiblingLI=function(e,t,n){if(is=v(i.moduleName),!e||!e.length)return;let r,s;const o=Array.prototype.slice.call(e);for(s=t?a(t,o):!0===n?o.length:-1,r=o[s+(!0===n?-1:1)];r&&(!Ye(r)||r.classList.contains(is.disabled));)s+=!0===n?-1:1,r=o[s];return r},e.indexOf=a,e.groupDataSource=function(t,i,n="None"){const r=c({},e.defaultMappedFields,i);let s=(new Ur).group(r.groupBy);s=l(n,"key",s);const o=p(t,s);t=[];for(let e=0;e<o.length;e++){const i=o[e].items,n={},s="isHeader";n[r.text]=o[e].key,n[s]=!0;let a=r.text;"id"===a&&(a="text",n[a]=o[e].key),n._id="group-list-item-"+(o[e].key?o[e].key.toString().trim():"undefined"),n.items=i,t.push(n);for(let e=0;e<i.length;e++)t.push(i[e])}return t},e.addSorting=l,e.getDataSource=p,e.createJsonFromElement=function t(n,r){const s=c({},i,r),o=c({},e.defaultMappedFields,s.fields),a=n.cloneNode(!0),l=[];a.classList.add("json-parent");const h=a.querySelectorAll(".json-parent>li");a.classList.remove("json-parent");for(let e=0;e<h.length;e++){const i=h[e],n=i.querySelector("a"),s=i.querySelector("ul"),a={},c=n?n.childNodes:i.childNodes,d=Object.keys(c);for(let e=0;e<c.length;e++)c[Number(d[e])].hasChildNodes()||(a[o.text]=c[Number(d[e])].textContent);let p=m(i);p.id?(a[o.id]=p.id,delete p.id):a[o.id]=f(),Object.keys(p).length&&(a[o.htmlAttributes]=p),n&&(p=m(n),Object.keys(p).length&&(a[o.urlAttributes]=p)),s&&(a[o.child]=t(s,r)),l.push(a)}return l},e.renderContentTemplate=function(t,n,r,s,o,a){is=v(i.moduleName);const l=t("ul",{className:is.ul,attrs:{role:"presentation"}}),h=c({},i,o),p=c({},e.defaultMappedFields,s),u=Se(n),g=[];let m;const y=f();for(let e=0;e<r.length;e++){let i=rs(r[e],p);const n=r[e],s=n.isHeader;m="string"==typeof r[e]||"number"==typeof r[e]?n:i[p.value],h.itemCreating&&"function"==typeof h.itemCreating&&h.itemCreating({dataSource:r,curData:n,text:m,options:h,fields:p}),h.itemCreating&&"function"==typeof h.itemCreating&&(i=rs(r[e],p),m="string"==typeof r[e]||"number"==typeof r[e]?n:i[p.value]);const o=t("li",{id:y+"-"+e,className:s?is.group:is.li,attrs:{role:"presentation"}});if(s)o.innerText="string"==typeof r[e]||"number"==typeof r[e]?n:i[p.text];else{const e=s?h.groupTemplateID:h.templateID;if(s){const t=u(n,a,"headerTemplate",e,!!h.isStringTemplate,null,o);t&&qe(t,o)}else{const t=u(n,a,"template",e,!!h.isStringTemplate,null,o);t&&qe(t,o)}o.setAttribute("data-value",d(m)?"null":m),o.setAttribute("role","option")}h.itemCreated&&"function"==typeof h.itemCreated&&h.itemCreated({dataSource:r,curData:n,text:m,item:o,options:h,fields:p}),g.push(o)}return qe(g,l),l},e.renderGroupTemplate=function(t,n,r,s,o,a){const l=Se(t),h=c({},e.defaultMappedFields,r),d=c({},i,o),p=h.groupBy;for(const e of s){const t={};t[p]=e.textContent,e.innerHTML="";const i=l(t,a,"groupTemplate",d.groupTemplateID,!!d.isStringTemplate,null,e);i&&qe(i,e)}return s},e.generateId=f,e.generateUL=S,e.generateIcon=function(e,t,n,r){const s=c({},i,r);return is=v(s.moduleName),("Left"===s.expandIconPosition?Ge:qe)([e("div",{className:"e-icons "+s.expandIconClass+" "+(d(n)?"":n)})],t.querySelector("."+is.textContent)),t}}(ns||(ns={}));const ss="e-rtl",os="e-disabled",as="e-input",ls="e-input-group",hs="e-float-input",cs="e-float-text",ds="e-clear-icon",ps="e-clear-icon-hide",us="e-label-top",gs="e-label-bottom",ms="e-no-float-label",fs="e-float-custom-tag";var ys;!function(e){let t,i=!0;function n(e){r(e.floatLabelType,e.element),e.element.addEventListener("focus",function(){const e=u(this);(e.classList.contains("e-input-group")||e.classList.contains("e-outline")||e.classList.contains("e-filled"))&&e.classList.add("e-input-focus")}),e.element.addEventListener("blur",function(){const e=u(this);(e.classList.contains("e-input-group")||e.classList.contains("e-outline")||e.classList.contains("e-filled"))&&e.classList.remove("e-input-focus")}),e.element.addEventListener("input",()=>{r(t,e.element)})}function r(e,t){const i=t.value;""!==i&&!d(i)&&t.parentElement?t.parentElement.classList.add("e-valid-input"):"Always"!==e&&t.parentElement&&t.parentElement.classList.remove("e-valid-input")}function s(){const e=u(this).getElementsByClassName("e-float-text")[0];d(e)||(Fe([e],us),e.classList.contains(gs)&&Ve([e],gs))}function o(){const e=u(this);if(e.getElementsByTagName("textarea")[0]?""===e.getElementsByTagName("textarea")[0].value:""===e.getElementsByTagName("input")[0].value){const t=e.getElementsByClassName("e-float-text")[0];d(t)||(t.classList.contains(us)&&Ve([t],us),Fe([t],gs))}}function a(e){e.addEventListener("focus",s),e.addEventListener("blur",o)}function l(e,t,i){const n=d(i)?Ue:i;"Auto"===e.floatLabelType&&a(e.element),d(t.container)?(t.container=y(e,hs,fs,"div",n),e.element.parentNode.insertBefore(t.container,e.element)):(d(e.customTag)||t.container.classList.add(fs),t.container.classList.add(hs));const r=n("span",{className:"e-float-line"}),s=n("label",{className:cs});if(d(e.element.id)||""===e.element.id||(s.id="label_"+e.element.id.replace(/ /g,"_"),Je(e.element,{"aria-labelledby":s.id})),d(e.element.placeholder)||""===e.element.placeholder||(s.innerText=b(e.element.placeholder),e.element.removeAttribute("placeholder")),d(e.properties)||d(e.properties.placeholder)||""===e.properties.placeholder||(s.innerText=b(e.properties.placeholder)),s.innerText||t.container.classList.add(ms),t.container.classList.contains("e-float-icon-left")){const i=t.container.querySelector(".e-input-in-wrap");i.appendChild(e.element),i.appendChild(r),i.appendChild(s)}else t.container.appendChild(e.element),t.container.appendChild(r),t.container.appendChild(s);p(e.element.value,s),"Always"===e.floatLabelType&&(s.classList.contains(gs)&&Ve([s],gs),Fe([s],us)),"Auto"===e.floatLabelType&&(e.element.addEventListener("input",t=>{p(e.element.value,s)}),e.element.addEventListener("blur",t=>{p(e.element.value,s)})),d(e.element.getAttribute("id"))||s.setAttribute("for",e.element.getAttribute("id"))}function h(e,t){"Always"===e&&t.classList.contains("e-outline")&&t.classList.add("e-valid-input")}function c(e,t){e?Ve([t],ps):Fe([t],ps)}function p(e,t){e?(Fe([t],us),t.classList.contains(gs)&&Ve([t],gs)):(t.classList.contains(us)&&Ve([t],us),Fe([t],gs))}function u(e){let t=d(e.parentNode)?e:e.parentNode;return t&&t.classList.contains("e-input-in-wrap")&&(t=t.parentNode),t}function g(e,t,n){(null==i||i)&&t.addEventListener("click",i=>{e.classList.contains(os)||e.readOnly||(i.preventDefault(),e!==document.activeElement&&e.focus(),e.value="",Fe([t],ps))}),e.addEventListener("input",i=>{c(e.value,t)}),e.addEventListener("focus",i=>{c(e.value,t)}),e.addEventListener("blur",e=>{setTimeout(()=>{Fe([t],ps)},200)})}function m(e,t){if(u(e).classList.contains(hs)&&"Auto"===t){const t=u(e).getElementsByClassName("e-float-text")[0];p(e.value,t)}}function y(e,t,i,n,r){const s=d(r)?Ue:r;let o;return d(e.customTag)?o=s(n,{className:t}):(o=s(e.customTag,{className:t}),o.classList.add(i)),o.classList.add("e-control-wrapper"),o}function b(e){let t="";if(!d(e)&&""!==e){const i=document.createElement("span");i.innerHTML='<input  placeholder="'+e+'"/>',t=i.children[0].placeholder}return t}function v(e,t,i){d(i)||""===i||Ve(t,i.split(" ")),d(e)||""===e||Fe(t,e.split(" "))}function w(e,t){e=b(e);const i=u(t);i.classList.contains(hs)?d(e)||""===e?(i.classList.add(ms),i.getElementsByClassName(cs)[0].textContent=""):(i.getElementsByClassName(cs)[0].textContent=e,i.classList.remove(ms),t.removeAttribute("placeholder")):d(e)||""===e?(t.removeAttribute("placeholder"),t.removeAttribute("aria-placeholder")):Je(t,{placeholder:e,"aria-placeholder":e})}function x(e,t,i){e?Je(t,{readonly:""}):t.removeAttribute("readonly"),d(i)||m(t,i)}function S(e,t){e?Fe(t,ss):Ve(t,ss)}function C(e,t,i,n){const r={disabled:"disabled","aria-disabled":"true"},s=!d(n);e?(t.classList.remove(os),O(r,t),s&&Ve([n],os)):(t.classList.add(os),T(r,t),s&&Fe([n],os)),d(i)||m(t,i)}function P(e,t,i,n,r){const s=d(r)?Ue:r;e?i.clearButton=function(e,t,i,n){const r=(d(n)?Ue:n)("span",{className:ds}),s=t.container;return d(i)?(t.container.classList.contains(hs)?t.container.querySelector(".e-float-text"):e).insertAdjacentElement("afterend",r):s.appendChild(r),!d(s)&&s.classList.contains(hs)&&Fe([s],ls),Fe([r],ps),g(e,r),r.setAttribute("aria-label","close"),r}(t,i,n,s):(Qe(i.clearButton),i.clearButton=null)}function O(e,t){for(const i of Object.keys(e)){const e=u(t);"disabled"===i&&t.classList.remove(os),"disabled"===i&&e.classList.contains(ls)&&e.classList.remove(os),"placeholder"===i&&e.classList.contains(hs)?e.getElementsByClassName(cs)[0].textContent="":t.removeAttribute(i)}}function T(e,t){for(const i of Object.keys(e)){const n=u(t);"disabled"===i&&t.classList.add(os),"disabled"===i&&n.classList.contains(ls)&&n.classList.add(os),"placeholder"===i&&n.classList.contains(hs)?n.getElementsByClassName(cs)[0].textContent=e[i]:t.setAttribute(i,e[i])}}function E(e,t,i){const n=[];n.push(i);const r=d(i)?t.querySelectorAll(".e-input-group-icon"):n;if(e&&r.length>0)for(let s=0;s<r.length;s++)r[s].addEventListener("mousedown",A,!1),r[s].addEventListener("mouseup",I,!1);else if(r.length>0)for(let s=0;s<r.length;s++)r[s].removeEventListener("mousedown",A,this),r[s].removeEventListener("mouseup",I,this)}function A(){let e=this.parentElement;for(;!e.classList.contains("e-input-group");)e=e.parentElement;var t;(t=e).classList.contains("e-disabled")||t.querySelector("input").readOnly||this.classList.add("e-input-btn-ripple")}function I(){const e=this;setTimeout(()=>{e.classList.remove("e-input-btn-ripple")},500)}function D(e,t){const i=t("span",{className:e});return i.classList.add("e-input-group-icon"),i}function R(e,t,i,n){const r=d(n)?Ue:n,s=D(e,r);t.classList.add("e-float-icon-left");let o=t.querySelector(".e-input-in-wrap");if(d(o)){o=r("span",{className:"e-input-in-wrap"}),i.parentNode.insertBefore(o,i);const e=t.querySelectorAll(i.tagName+" ~ *");o.appendChild(i);for(let t=0;t<e.length;t++)o.appendChild(e[t])}return o.parentNode.insertBefore(s,o),t.classList.contains(ls)||t.classList.add(ls),E(!0,t,s),s}function L(e,t,i){const n=D(e,d(i)?Ue:i);return t.classList.contains(ls)||t.classList.add(ls),(t.classList.contains("e-float-icon-left")?t.querySelector(".e-input-in-wrap"):t).appendChild(n),E(!0,t,n),n}function z(e,t){"hidden"===t.type?e.classList.add("e-hidden"):e.classList.contains("e-hidden")&&e.classList.remove("e-hidden")}e.createInput=function(e,r){const s=d(r)?Ue:r;let o={container:null,buttons:[],clearButton:null};if(t=e.floatLabelType,i=e.bindClearAction,d(e.floatLabelType)||"Never"===e.floatLabelType?(o.container=y(e,ls,"e-input-custom-tag","span",s),e.element.parentNode.insertBefore(o.container,e.element),Fe([e.element],as),o.container.appendChild(e.element)):l(e,o,s),n(e),d(e.properties)||d(e.properties.showClearButton)||!e.properties.showClearButton||"TEXTAREA"===e.element.tagName||(P(e.properties.showClearButton,e.element,o,!0,s),o.clearButton.setAttribute("role","button"),o.container.classList.contains(hs)&&Fe([o.container],ls)),!d(e.buttons)&&"TEXTAREA"!==e.element.tagName)for(let t=0;t<e.buttons.length;t++)o.buttons.push(L(e.buttons[t],o.container,s));return d(e.element)||"TEXTAREA"!==e.element.tagName||Fe([o.container],"e-multi-line-input"),z(o.container,e.element),o=function(e,t){if(!d(e.properties))for(const i of Object.keys(e.properties))switch(i){case"cssClass":v(e.properties.cssClass,[t.container]),h(e.floatLabelType,t.container);break;case"enabled":C(e.properties.enabled,e.element,e.floatLabelType,t.container);break;case"enableRtl":S(e.properties.enableRtl,[t.container]);break;case"placeholder":w(e.properties.placeholder,e.element);break;case"readonly":x(e.properties.readonly,e.element)}return t}(e,o),o},e.bindInitialEvent=n,e.wireFloatingEvents=a,e.wireClearBtnEvents=g,e.setValue=function(e,t,i,n){if(t.value=e,d(i)||"Auto"!==i||m(t,i),!d(n)&&n){const e=u(t);if(!d(e)){const i=e.getElementsByClassName(ds)[0];d(i)||(t.value&&e.classList.contains("e-input-focus")?Ve([i],ps):Fe([i],ps))}}r(i,t)},e.setCssClass=v,e.setWidth=function(e,t){"number"==typeof e?t.style.width=f(e):"string"==typeof e&&(t.style.width=e.match(/px|%|em/)?e:f(e))},e.setPlaceholder=w,e.setReadonly=x,e.setEnableRtl=S,e.setEnabled=C,e.setClearButton=P,e.removeAttributes=O,e.addAttributes=T,e.removeFloating=function(e){const t=e.container;if(!d(t)&&t.classList.contains(hs)){const e=t.querySelector("textarea")?t.querySelector("textarea"):t.querySelector("input"),n=t.querySelector(".e-float-text").textContent,r=null!==t.querySelector(".e-clear-icon");$e(t.querySelector(".e-float-line")),$e(t.querySelector(".e-float-text")),function(e,t,i){Fe([e],t),Ve([e],i)}(t,[ls],[hs]),(i=e).removeEventListener("focus",s),i.removeEventListener("blur",o),Je(e,{placeholder:n}),e.classList.add(as),r||"INPUT"!==e.tagName||e.removeAttribute("required")}var i},e.addFloating=function(e,i,n,r){const s=d(r)?Ue:r,o=it(e,".e-input-group");if(t=i,"Never"!==i){let t=o.tagName;t="DIV"!==t&&"SPAN"!==t?t:null;const r={element:e,floatLabelType:i,customTag:t,properties:{placeholder:n}};let a=o.querySelector(".e-clear-icon");const h={container:o};e.classList.remove(as),l(r,h,s);const c=o.classList.contains("e-float-icon-left");if(d(a)&&(a=c?o.querySelector(".e-input-in-wrap").querySelector(".e-input-group-icon"):o.querySelector(".e-input-group-icon")),d(a))c&&(a=o.querySelector(".e-input-group-icon")),d(a)&&o.classList.remove(ls);else{const t=o.querySelector(".e-float-line"),i=o.querySelector(".e-float-text"),n=c?o.querySelector(".e-input-in-wrap"):o;n.insertBefore(e,a),n.insertBefore(t,a),n.insertBefore(i,a)}}h(i,e.parentElement)},e.setRipple=function(e,t){for(let i=0;i<t.length;i++)E(e,t[i].container)},e.addIcon=function(e,t,i,n,r){const s="string"==typeof t?t.split(","):t;if("append"===e.toLowerCase())for(const o of s)L(o,i,r);else for(const o of s)R(o,i,n,r)},e.prependSpan=R,e.appendSpan=L,e.validateInputType=z}(ys||(ys={})),new RegExp("^(-)?(\\d*)$"),new RegExp("^[A-Za-z0-9._%+-]{1,}@[A-Za-z0-9._%+-]{1,}([.]{1}[a-zA-Z0-9]{2,}|[.]{1}[a-zA-Z0-9]{2,4}[.]{1}[a-zA-Z0-9]{2,4})$"),new RegExp("^([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$"),new RegExp("^[0-9]*$"),new RegExp("^[+]?[0-9]{9,13}$"),new RegExp("^\\d{13,16}$");class bs{constructor(e,t){this.width=e,this.height=t}isEmpty(){return 0===this.height&&0===this.width}clone(){return new bs(this.width,this.height)}}var vs=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let ws=(()=>{class e extends Ht{static equals(e,t){return e===t||!(!e||!t)&&(!e||!t||e.x===t.x&&e.y===t.y)}static isEmptyPoint(e){return!e.x||!e.y}static transform(e,t,i){const n={x:0,y:0};return n.x=Math.round(100*(e.x+i*Math.cos(t*Math.PI/180)))/100,n.y=Math.round(100*(e.y+i*Math.sin(t*Math.PI/180)))/100,n}static findLength(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}static findAngle(e,t){let i=Math.atan2(t.y-e.y,t.x-e.x);return i=180*i/Math.PI,i%=360,i<0&&(i+=360),i}static distancePoints(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}static getLengthFromListOfPoints(e){let t=0;for(let i=0;i<e.length-1;i++)t+=this.distancePoints(e[i],e[i+1]);return t}static adjustPoint(e,t,i,n){let r,s=i?{x:e.x,y:e.y}:{x:t.x,y:t.y};return e.x===t.x?e.y<t.y&&i||e.y>t.y&&!i?s.y+=n:s.y-=n:e.y===t.y?e.x<t.x&&i||e.x>t.x&&!i?s.x+=n:s.x-=n:i?(r=this.findAngle(e,t),s=this.transform(e,r,n)):(r=this.findAngle(t,e),s=this.transform(t,r,n)),s}static direction(e,t){return Math.abs(t.x-e.x)>Math.abs(t.y-e.y)?e.x<t.x?"Right":"Left":e.y<t.y?"Bottom":"Top"}getClassName(){return"Point"}}return vs([xt(0)],e.prototype,"x",void 0),vs([xt(0)],e.prototype,"y",void 0),e})();function xs(e){const t=[];let i;const n=function(e){const t=/([a-z]+)|([+-]?(?:\d+\.?\d*|\.\d+))/gi;let i=[];const n=[];let r={};t.lastIndex=0;let s=!1;for(r=t.exec(e);r;)"e"===r[1]?s=!0:r[1]?("zm"===r[1].toLowerCase()?(i.length&&n.push(i),n.push(["Z"]),i=[r[1].substring(1,2)]):(i.length&&n.push(i),i=[r[1]]),s=!1):(i.length||(i=[]),s||i.push(Number(r[2])),s=!1),r=t.exec(e);return i.length&&n.push(i),n}(e);if(n.length>0)for(let r=0;r<n.length;r++){const e=n[r];let s="";switch(s=e[0],s.toLowerCase()){case"m":for(i=1;i<e.length;i++)t.push({command:s,x:e[i],y:e[i+1]}),i+=1,"m"===s?s="l":"M"===s&&(s="L");break;case"l":case"t":for(i=1;i<e.length;i++)t.push({command:s,x:e[i],y:e[i+1]}),i+=1;break;case"h":for(i=1;i<e.length;i++)t.push({command:s,x:e[i]});break;case"v":for(i=1;i<e.length;i++)t.push({command:s,y:e[i]});break;case"z":t.push({command:s});break;case"c":for(i=1;i<e.length;i++)t.push({command:s,x1:e[i],y1:e[i+1],x2:e[i+2],y2:e[i+3],x:e[i+4],y:e[i+5]}),i+=5;break;case"s":for(i=1;i<e.length;i++)t.push({command:s,x2:e[i],y2:e[i+1],x:e[i+2],y:e[i+3]}),i+=3;break;case"q":for(i=1;i<e.length;i++)t.push({command:s,x1:e[i],y1:e[i+1],x:e[i+2],y:e[i+3]}),i+=3;break;case"a":for(i=1;i<e.length;i++)t.push({command:s,r1:e[i],r2:e[i+1],angle:e[i+2],largeArc:e[i+3],sweep:e[i+4],x:e[i+5],y:e[i+6]}),i+=6}}return t}function Ss(e){let t,i,n="";for(n="M"+e[0].x+" "+e[0].y,i=1;i<e.length;i++)t=e[i],n+="L"+t.x+" "+t.y;return n+="Z",n}function Cs(e){let t,i,n,r,s,o,a,l,h,c;const d=[];for(a=0,l=0,c=0,h=e.length;c<h;++c){const h=e[c];let p="";p=h.command,"y1"in h&&(r=h.y1),"y2"in h&&(o=h.y2),"x1"in h&&(n=h.x1),"x2"in h&&(s=h.x2),"x"in h&&(a=h.x),"y"in h&&(l=h.y);const u=d[d.length-1];switch(p){case"M":d.push({command:"M",x:a,y:l});break;case"L":d.push({command:"L",x0:t,y0:i,x:a,y:l});break;case"H":d.push({command:"L",x0:t,y0:i,x:a,y:i});break;case"V":d.push({command:"L",x0:t,y0:i,x:t,y:l});break;case"C":d.push({command:"C",x0:t,y0:i,x1:n,y1:r,x2:s,y2:o,x:a,y:l});break;case"S":if(u){let e;e="C"===u.command||"S"===u.command?{x:u.x2,y:u.y2}:{x:t,y:i};const n={x:2*t-e.x,y:2*i-e.y};d.push({command:"C",x0:t,y0:i,x1:n.x,y1:n.y,x2:s,y2:o,x:a,y:l})}break;case"Q":d.push({command:"Q",x0:t,y0:i,x1:n,y1:r,x:a,y:l});break;case"T":if(u){let e;e="Q"===u.command?{x:u.x1,y:u.y1}:{x:t,y:i};const n={x:2*t-e.x,y:2*i-e.y};d.push({command:"Q",x0:t,y0:i,x1:n.x,y1:n.y,x:a,y:l})}break;case"A":const e=h;e.command="A",d.push(e);break;case"Z":case"z":d.push({command:"Z"}),a=t,l=i}t=a,i=l}return d}function Ps(e,t,i,n,r,s,o,a){let l,h,c,d,p,u,g,m,f;for(p=0,u=0,m=0,g=e.length;m<g;++m){const g=e[m],y=g.command;"x"in g&&(p=g.x),"y"in g&&(u=g.y),"y1"in g&&(h=g.y1),"y2"in g&&(d=g.y2),"x1"in g&&(l=g.x1),"x2"in g&&(c=g.x2),n?(void 0!==p&&(p=Ts(p,t,r,o)),void 0!==u&&(u=Ts(u,i,s,a)),void 0!==l&&(l=Ts(l,t,r,o)),void 0!==h&&(h=Ts(h,i,s,a)),void 0!==c&&(c=Ts(c,t,r,o)),void 0!==d&&(d=Ts(d,i,s,a))):(void 0!==p&&(p=Number((p+t).toFixed(2))),void 0!==u&&(u=Number((u+i).toFixed(2))),void 0!==l&&(l=Number((l+t).toFixed(2))),void 0!==h&&(h=Number((h+i).toFixed(2))),void 0!==c&&(c=Number((c+t).toFixed(2))),void 0!==d&&(d=Number((d+i).toFixed(2)))),f=Os(g,y,{x:p,y:u,x1:l,y1:h,x2:c,y2:d,r1:g.r1,r2:g.r2},n,t,i),f&&(e[m]=f)}return As(e)}function Os(e,t,i,n,r,s){switch(t){case"M":case"L":e.x=i.x,e.y=i.y;break;case"H":e.x=i.x;break;case"V":e.y=i.y;break;case"C":e.x=i.x,e.y=i.y,e.x1=i.x1,e.y1=i.y1,e.x2=i.x2,e.y2=i.y2;break;case"S":e.x=i.x,e.y=i.y,e.x2=i.x2,e.y2=i.y2;break;case"Q":e.x=i.x,e.y=i.y,e.x1=i.x1,e.y1=i.y1;break;case"T":e.x=i.x,e.y=i.y;break;case"A":let t=i.r1,o=i.r2;n&&(i.r1=t*=r,i.r2=o*=s),e.x=i.x,e.y=i.y,e.r1=i.r1,e.r2=i.r2;break;case"z":case"Z":e={command:"Z"}}return e}function Ts(e,t,i,n){return e!==i?e=n!==i?e*t-(Number(i)*t-Number(i))+(n-Number(i)):Number(e)*t-(Number(i)*t-Number(i)):n!==i&&(e=n),Number(e.toFixed(2))}function Es(e){let t,i,n,r,s,o,a,l,h,c;for(a=0,l=0,c=0,h=e.length;c<h;++c){const h=e[c],d=h.command;if(/[MLHVCSQTA]/.test(d))"x"in h&&(h.x=a=h.x),"y"in h&&(h.y=l=h.y);else{let p;switch("x1"in h&&(h.x1=n=a+h.x1),"x2"in h&&(h.x2=s=a+h.x2),"y1"in h&&(h.y1=r=l+h.y1),"y2"in h&&(h.y2=o=l+h.y2),"x"in h&&(h.x=a+=h.x),"y"in h&&(h.y=l+=h.y),d){case"m":case"M":p={command:"M",x:a,y:l};break;case"l":case"L":p={command:"L",x:a,y:l};break;case"h":case"H":p={command:"H",x:a};break;case"v":case"V":p={command:"V",y:l};break;case"c":case"C":p={command:"C",x:a,y:l,x1:n,y1:r,x2:s,y2:o};break;case"s":case"S":p={command:"S",x:a,y:l,x2:s,y2:o};break;case"q":case"Q":p={command:"Q",x:a,y:l,x1:n,y1:r};break;case"t":case"T":p={command:"T",x:a,y:l};break;case"a":case"A":p={command:"A",x:a,y:l},p.r1=h.r1,p.r2=h.r2,p.angle=h.angle,p.largeArc=h.largeArc,p.sweep=h.sweep;break;case"z":case"Z":p={command:"Z"},a=t,l=i,p=e[c]}p&&(e[c]=p)}"M"!==d&&"m"!==d||(t=a,i=l)}return e}function As(e){let t,i="";for(t=0;t<e.length;t++)i+=0===t?Is(e[t]):" "+Is(e[t]);return i}function Is(e){let t="";switch(e.command){case"Z":case"z":t=e.command;break;case"M":case"m":case"L":case"l":t=e.command+" "+e.x+" "+e.y;break;case"C":case"c":t=e.command+" "+e.x1+" "+e.y1+" "+e.x2+" "+e.y2+" "+e.x+" "+e.y;break;case"Q":case"q":t=e.command+" "+e.x1+" "+e.y1+" "+e.x+" "+e.y;break;case"A":case"a":t=e.command+" "+e.r1+" "+e.r2+" "+e.angle+" "+(e.largeArc?"1":"0")+" "+(e.sweep?"1":"0")+" "+e.x+" "+e.y;break;case"H":case"h":t=e.command+" "+e.x;break;case"V":case"v":t=e.command+" "+e.y;break;case"S":case"s":t=e.command+" "+e.x2+" "+e.y2+" "+e.x+" "+e.y;break;case"T":case"t":t=e.command+" "+e.x+" "+e.y}return t}let Ds=(()=>{class e{constructor(e,t,i,n){this.x=Number.MAX_VALUE,this.y=Number.MAX_VALUE,this.width=0,this.height=0,void 0===e||void 0===t?(e=t=Number.MAX_VALUE,i=n=0):(void 0===i&&(i=0),void 0===n&&(n=0)),this.x=e,this.y=t,this.width=i,this.height=n}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}get topLeft(){return{x:this.left,y:this.top}}get topRight(){return{x:this.right,y:this.top}}get bottomLeft(){return{x:this.left,y:this.bottom}}get bottomRight(){return{x:this.right,y:this.bottom}}get middleLeft(){return{x:this.left,y:this.y+this.height/2}}get middleRight(){return{x:this.right,y:this.y+this.height/2}}get topCenter(){return{x:this.x+this.width/2,y:this.top}}get bottomCenter(){return{x:this.x+this.width/2,y:this.bottom}}get center(){return{x:this.x+this.width/2,y:this.y+this.height/2}}equals(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}uniteRect(e){const t=Math.max(Number.NaN===this.right||this.x===Number.MAX_VALUE?e.right:this.right,e.right),i=Math.max(Number.NaN===this.bottom||this.y===Number.MAX_VALUE?e.bottom:this.bottom,e.bottom);return this.x=Math.min(this.left,e.left),this.y=Math.min(this.top,e.top),this.width=t-this.x,this.height=i-this.y,this}unitePoint(e){if(this.x===Number.MAX_VALUE)return this.x=e.x,void(this.y=e.y);const t=Math.min(this.left,e.x),i=Math.min(this.top,e.y),n=Math.max(this.right,e.x),r=Math.max(this.bottom,e.y);this.x=t,this.y=i,this.width=n-this.x,this.height=r-this.y}Inflate(e){return this.x-=e,this.y-=e,this.width+=2*e,this.height+=2*e,this}intersects(e){return!(this.right<e.left||this.left>e.right||this.top>e.bottom||this.bottom<e.top)}containsRect(e){return this.left<=e.left&&this.right>=e.right&&this.top<=e.top&&this.bottom>=e.bottom}containsPoint(e,t=0){return this.left-t<=e.x&&this.right+t>=e.x&&this.top-t<=e.y&&this.bottom+t>=e.y}static toBounds(t){const i=new e;for(const e of t)i.unitePoint(e);return i}}return e.empty=new e(Number.MAX_VALUE,Number.MIN_VALUE,0,0),e})();var Rs=function(e){return e[e.Identity=0]="Identity",e[e.Translation=1]="Translation",e[e.Scaling=2]="Scaling",e[e.Unknown=4]="Unknown",e}({});class Ls{constructor(e,t,i,n,r,s,o){this.m11=e,this.m12=t,this.m21=i,this.m22=n,this.offsetX=r,this.offsetY=s,this.type=o}}function zs(){return new Ls(1,0,0,1,0,0,Rs.Identity)}function Ms(e,t){const i=function(e,t,i){switch(e.type){case Rs.Identity:break;case Rs.Translation:t+=e.offsetX,i+=e.offsetY;break;case Rs.Scaling:t*=e.m11,i*=e.m22;break;case Rs.Translation|Rs.Scaling:t*=e.m11,t+=e.offsetX,i*=e.m22,i+=e.offsetY;break;default:const n=t*e.m12+e.offsetY;t*=e.m11,t+=i*e.m21+e.offsetX,i*=e.m22,i+=n}return{x:t,y:i}}(e,t.x,t.y);return{x:Math.round(100*i.x)/100,y:Math.round(100*i.y)/100}}function ks(e,t,i,n){Ns(e,function(e,t,i){const n=zs(),r=Math.sin(e),s=Math.cos(e),o=t*(1-s)+i*r,a=i*(1-s)-t*r;return n.type=Rs.Unknown,_s(n,s,r,-r,s,o,a),n}(.017453292519943295*(t%=360),i||0,n||0))}function js(e,t,i,n=0,r=0){Ns(e,function(e,t,i,n){const r=zs();return r.type=i||n?Rs.Scaling|Rs.Translation:Rs.Scaling,_s(r,e,0,0,t,i-e*i,n-t*n),r}(t,i,n,r))}function Hs(e,t,i){return e.type&Rs.Identity?(e.type=Rs.Translation,void _s(e,1,0,0,1,t,i)):e.type&Rs.Unknown?(e.offsetX+=t,void(e.offsetY+=i)):(e.offsetX+=t,e.offsetY+=i,void(e.type|=Rs.Translation))}function Ns(e,t){const i=e.type,n=t.type;if(n===Rs.Identity)return;if(i===Rs.Identity)return Bs(e,t),void(e.type=t.type);if(n===Rs.Translation)return e.offsetX+=t.offsetX,e.offsetY+=t.offsetY,void(i!==Rs.Unknown&&(e.type|=Rs.Translation));if(i!==Rs.Translation){const r=i<<4|n;switch(r){case 34:return e.m11*=t.m11,void(e.m22*=t.m22);case 35:return e.m11*=t.m11,e.m22*=t.m22,e.offsetX=t.offsetX,e.offsetY=t.offsetY,void(e.type=Rs.Translation|Rs.Scaling);case 36:break;default:switch(r){case 50:return e.m11*=t.m11,e.m22*=t.m22,e.offsetX*=t.m11,void(e.offsetY*=t.m22);case 51:return e.m11*=t.m11,e.m22*=t.m22,e.offsetX=t.m11*e.offsetX+t.offsetX,void(e.offsetY=t.m22*e.offsetY+t.offsetY);case 52:break;default:switch(r){case 66:case 67:case 68:break;default:return}}}const s=zs();return _s(s,e.m11*t.m11+e.m12*t.m21,e.m11*t.m12+e.m12*t.m22,e.m21*t.m11+e.m22*t.m21,e.m21*t.m12+e.m22*t.m22,e.offsetX*t.m11+e.offsetY*t.m21+t.offsetX,e.offsetX*t.m12+e.offsetY*t.m22+t.offsetY),s.m21||s.m12?s.type=Rs.Unknown:((s.m11&&1!==s.m11||s.m22&&1!==s.m22)&&(s.type=Rs.Scaling),(s.offsetX||s.offsetY)&&(s.type|=Rs.Translation),(s.type&(Rs.Translation|Rs.Scaling))===Rs.Identity&&(s.type=Rs.Identity),s.type=Rs.Scaling|Rs.Translation),Bs(e,s),void(e.type=s.type)}const r=e.offsetX,s=e.offsetY;e.offsetX=r*t.m11+s*t.m21+t.offsetX,e.offsetY=r*t.m12+s*t.m22+t.offsetY,e.type=n!==Rs.Unknown?Rs.Translation|Rs.Scaling:Rs.Unknown}function _s(e,t,i,n,r,s,o){e.m11=t,e.m12=i,e.m21=n,e.m22=r,e.offsetX=s,e.offsetY=o}function Bs(e,t){e.m11=t.m11,e.m12=t.m12,e.m21=t.m21,e.m22=t.m22,e.offsetX=t.offsetX,e.offsetY=t.offsetY,e.type=t.type}var Ws=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Us=e=>{if(e)switch(e.type){case"Linear":return qs;case"Radial":return Zs;default:return qs}return qs};class Fs{constructor(e,t,i,n){this.left=e,this.right=t,this.top=i,this.bottom=n}}let Vs=(()=>{class e extends Ht{}return Ws([xt(0)],e.prototype,"left",void 0),Ws([xt(0)],e.prototype,"right",void 0),Ws([xt(0)],e.prototype,"top",void 0),Ws([xt(0)],e.prototype,"bottom",void 0),e})(),Xs=(()=>{class e extends Ht{}return Ws([xt(45)],e.prototype,"angle",void 0),Ws([xt(5)],e.prototype,"distance",void 0),Ws([xt(.7)],e.prototype,"opacity",void 0),Ws([xt("lightgrey")],e.prototype,"color",void 0),e})(),Ys=(()=>{class e extends Ht{getClassName(){return"Stop"}}return Ws([xt("")],e.prototype,"color",void 0),Ws([xt(0)],e.prototype,"offset",void 0),Ws([xt(1)],e.prototype,"opacity",void 0),e})(),Gs=(()=>{class e extends Ht{}return Ws([Pt([],Ys)],e.prototype,"stops",void 0),Ws([xt("None")],e.prototype,"type",void 0),Ws([xt("")],e.prototype,"id",void 0),e})(),qs=(()=>{class e extends Gs{}return Ws([xt(0)],e.prototype,"x1",void 0),Ws([xt(0)],e.prototype,"x2",void 0),Ws([xt(0)],e.prototype,"y1",void 0),Ws([xt(0)],e.prototype,"y2",void 0),e})(),Zs=(()=>{class e extends Gs{}return Ws([xt(0)],e.prototype,"cx",void 0),Ws([xt(0)],e.prototype,"cy",void 0),Ws([xt(0)],e.prototype,"fx",void 0),Ws([xt(0)],e.prototype,"fy",void 0),Ws([xt(50)],e.prototype,"r",void 0),e})(),$s=(()=>{class e extends Ht{}return Ws([xt("white")],e.prototype,"fill",void 0),Ws([xt("black")],e.prototype,"strokeColor",void 0),Ws([xt("")],e.prototype,"strokeDashArray",void 0),Ws([xt(1)],e.prototype,"strokeWidth",void 0),Ws([xt(1)],e.prototype,"opacity",void 0),Ws([Ct(Us)],e.prototype,"gradient",void 0),e})(),Qs=(()=>{class e extends $s{}return Ws([xt("transparent")],e.prototype,"fill",void 0),e})(),Js=(()=>{class e extends $s{}return Ws([xt("black")],e.prototype,"color",void 0),Ws([xt("Arial")],e.prototype,"fontFamily",void 0),Ws([xt(12)],e.prototype,"fontSize",void 0),Ws([xt(!1)],e.prototype,"italic",void 0),Ws([xt(!1)],e.prototype,"bold",void 0),Ws([xt("CollapseSpace")],e.prototype,"whiteSpace",void 0),Ws([xt("WrapWithOverflow")],e.prototype,"textWrapping",void 0),Ws([xt("Center")],e.prototype,"textAlign",void 0),Ws([xt("None")],e.prototype,"textDecoration",void 0),Ws([xt("Wrap")],e.prototype,"textOverflow",void 0),Ws([xt("transparent")],e.prototype,"fill",void 0),e})();var Ks=function(e){return e[e.Default=0]="Default",e[e.expandNode=2]="expandNode",e[e.interaction=4]="interaction",e[e.GroupingInProgress=8]="GroupingInProgress",e[e.GroupClipboardInProcess=16]="GroupClipboardInProcess",e[e.ClearObject=32]="ClearObject",e}({}),eo=function(e){return e[e.Visible=1]="Visible",e[e.Hidden=2]="Hidden",e[e.Hover=4]="Hover",e[e.Connect=8]="Connect",e}({}),to=function(e){return e[e.None=0]="None",e[e.ShowHorizontalLines=1]="ShowHorizontalLines",e[e.ShowVerticalLines=2]="ShowVerticalLines",e[e.ShowLines=3]="ShowLines",e[e.SnapToHorizontalLines=4]="SnapToHorizontalLines",e[e.SnapToVerticalLines=8]="SnapToVerticalLines",e[e.SnapToLines=12]="SnapToLines",e[e.SnapToObject=16]="SnapToObject",e[e.All=31]="All",e}({}),io=function(e){return e[e.None=1]="None",e[e.ConnectorSourceThumb=2]="ConnectorSourceThumb",e[e.ConnectorTargetThumb=4]="ConnectorTargetThumb",e[e.ResizeSouthEast=8]="ResizeSouthEast",e[e.ResizeSouthWest=16]="ResizeSouthWest",e[e.ResizeNorthEast=32]="ResizeNorthEast",e[e.ResizeNorthWest=64]="ResizeNorthWest",e[e.ResizeEast=128]="ResizeEast",e[e.ResizeWest=256]="ResizeWest",e[e.ResizeSouth=512]="ResizeSouth",e[e.ResizeNorth=1024]="ResizeNorth",e[e.Rotate=2048]="Rotate",e[e.UserHandle=4096]="UserHandle",e[e.ToolTip=8192]="ToolTip",e[e.ResizeAll=2046]="ResizeAll",e[e.All=16382]="All",e}({}),no=function(e){return e[e.None=1]="None",e[e.Select=2]="Select",e[e.Delete=4]="Delete",e[e.Drag=8]="Drag",e[e.DragSourceEnd=16]="DragSourceEnd",e[e.DragTargetEnd=32]="DragTargetEnd",e[e.DragSegmentThumb=64]="DragSegmentThumb",e[e.AllowDrop=128]="AllowDrop",e[e.Bridging=256]="Bridging",e[e.BridgeObstacle=512]="BridgeObstacle",e[e.InheritBridging=1024]="InheritBridging",e[e.PointerEvents=2048]="PointerEvents",e[e.Tooltip=4096]="Tooltip",e[e.InheritTooltip=8192]="InheritTooltip",e[e.Interaction=4218]="Interaction",e[e.ReadOnly=16384]="ReadOnly",e[e.LineRouting=32768]="LineRouting",e[e.InheritLineRouting=65536]="InheritLineRouting",e[e.ConnectToNearByNode=131072]="ConnectToNearByNode",e[e.ConnectToNearByPort=262144]="ConnectToNearByPort",e[e.ConnectToNearByElement=393216]="ConnectToNearByElement",e[e.Default=470590]="Default",e}({}),ro=function(e){return e[e.ReadOnly=2]="ReadOnly",e[e.InheritReadOnly=4]="InheritReadOnly",e[e.Select=8]="Select",e[e.Drag=16]="Drag",e[e.Resize=32]="Resize",e[e.Rotate=64]="Rotate",e[e.Interaction=120]="Interaction",e[e.None=0]="None",e}({}),so=function(e){return e[e.None=0]="None",e[e.Select=2]="Select",e[e.Drag=4]="Drag",e[e.Rotate=8]="Rotate",e[e.Shadow=16]="Shadow",e[e.PointerEvents=32]="PointerEvents",e[e.Delete=64]="Delete",e[e.InConnect=128]="InConnect",e[e.OutConnect=256]="OutConnect",e[e.Individual=512]="Individual",e[e.Expandable=1024]="Expandable",e[e.AllowDrop=2048]="AllowDrop",e[e.Inherit=78]="Inherit",e[e.ResizeNorthEast=4096]="ResizeNorthEast",e[e.ResizeEast=8192]="ResizeEast",e[e.ResizeSouthEast=16384]="ResizeSouthEast",e[e.ResizeSouth=32768]="ResizeSouth",e[e.ResizeSouthWest=65536]="ResizeSouthWest",e[e.ResizeWest=131072]="ResizeWest",e[e.ResizeNorthWest=262144]="ResizeNorthWest",e[e.ResizeNorth=524288]="ResizeNorth",e[e.Resize=1044480]="Resize",e[e.AspectRatio=1048576]="AspectRatio",e[e.Tooltip=2097152]="Tooltip",e[e.InheritTooltip=4194304]="InheritTooltip",e[e.ReadOnly=8388608]="ReadOnly",e[e.HideThumbs=16777216]="HideThumbs",e[e.AllowMovingOutsideLane=33554432]="AllowMovingOutsideLane",e[e.Default=5240814]="Default",e}({}),oo=function(e){return e[e.None=0]="None",e[e.ElementIsPort=2]="ElementIsPort",e[e.ElementIsGroup=4]="ElementIsGroup",e[e.HorizontalLaneHeader=8]="HorizontalLaneHeader",e}({}),ao=function(e){return e[e.Rotate=2]="Rotate",e[e.ConnectorSource=4]="ConnectorSource",e[e.ConnectorTarget=8]="ConnectorTarget",e[e.ResizeNorthEast=16]="ResizeNorthEast",e[e.ResizeEast=32]="ResizeEast",e[e.ResizeSouthEast=64]="ResizeSouthEast",e[e.ResizeSouth=128]="ResizeSouth",e[e.ResizeSouthWest=256]="ResizeSouthWest",e[e.ResizeWest=512]="ResizeWest",e[e.ResizeNorthWest=1024]="ResizeNorthWest",e[e.ResizeNorth=2048]="ResizeNorth",e[e.Default=4094]="Default",e}({}),lo=function(e){return e[e.None=1]="None",e[e.Bridging=2]="Bridging",e[e.UndoRedo=4]="UndoRedo",e[e.Tooltip=8]="Tooltip",e[e.UserInteraction=16]="UserInteraction",e[e.ApiUpdate=32]="ApiUpdate",e[e.PageEditable=48]="PageEditable",e[e.Zoom=64]="Zoom",e[e.PanX=128]="PanX",e[e.PanY=256]="PanY",e[e.Pan=384]="Pan",e[e.ZoomTextEdit=512]="ZoomTextEdit",e[e.Virtualization=1024]="Virtualization",e[e.LineRouting=2048]="LineRouting",e[e.Default=500]="Default",e}({}),ho=function(e){return e[e.None=0]="None",e[e.SingleSelect=1]="SingleSelect",e[e.MultipleSelect=2]="MultipleSelect",e[e.ZoomPan=4]="ZoomPan",e[e.DrawOnce=8]="DrawOnce",e[e.ContinuousDraw=16]="ContinuousDraw",e[e.Default=3]="Default",e}({}),co=function(e){return e[e.Self=1]="Self",e[e.Parent=2]="Parent",e}({}),po=function(e){return e[e.None=0]="None",e[e.Control=1]="Control",e[e.Meta=1]="Meta",e[e.Alt=2]="Alt",e[e.Shift=4]="Shift",e}({}),uo=function(e){return e[e.None=null]="None",e[e.Number0=0]="Number0",e[e.Number1=1]="Number1",e[e.Number2=2]="Number2",e[e.Number3=3]="Number3",e[e.Number4=4]="Number4",e[e.Number5=5]="Number5",e[e.Number6=6]="Number6",e[e.Number7=7]="Number7",e[e.Number8=8]="Number8",e[e.Number9=9]="Number9",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.Left=37]="Left",e[e.Up=38]="Up",e[e.Right=39]="Right",e[e.Down=40]="Down",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.PageUp=33]="PageUp",e[e.PageDown=34]="PageDown",e[e.End=35]="End",e[e.Home=36]="Home",e[e.Delete=46]="Delete",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.BackSpace=8]="BackSpace",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.Star=56]="Star",e[e.Plus=187]="Plus",e[e.Minus=189]="Minus",e}({}),go=function(e){return e[e.Render=2]="Render",e[e.PublicMethod=4]="PublicMethod",e[e.ToolAction=8]="ToolAction",e[e.UndoRedo=16]="UndoRedo",e[e.TextEdit=32]="TextEdit",e[e.Group=64]="Group",e[e.Clear=128]="Clear",e[e.PreventClearSelection=256]="PreventClearSelection",e[e.Interactions=512]="Interactions",e[e.PreventHistory=1024]="PreventHistory",e[e.PreventIconsUpdate=2048]="PreventIconsUpdate",e[e.PreventCollectionChangeOnDragOver=4096]="PreventCollectionChangeOnDragOver",e[e.PreventZIndexOnDragging=8192]="PreventZIndexOnDragging",e[e.isGroupDragging=16384]="isGroupDragging",e[e.DragUsingMouse=32768]="DragUsingMouse",e[e.DecoratorPropertyChange=65536]="DecoratorPropertyChange",e[e.PreventLaneContainerUpdate=131072]="PreventLaneContainerUpdate",e}({}),mo=function(e){return e[e.None=2]="None",e[e.DrawSelectorBorder=4]="DrawSelectorBorder",e[e.PreventRenderSelector=8]="PreventRenderSelector",e}({}),fo=function(e){return e[e.None=0]="None",e[e.PreventDrag=2]="PreventDrag",e[e.PreventScale=4]="PreventScale",e[e.PreventDataInit=8]="PreventDataInit",e[e.hScrollbarMoved=16]="hScrollbarMoved",e[e.vScrollbarMoved=32]="vScrollbarMoved",e[e.AnimationClick=64]="AnimationClick",e[e.EnableGroupAction=128]="EnableGroupAction",e[e.PanInProgress=256]="PanInProgress",e[e.OverViewAction=512]="OverViewAction",e}({}),yo=function(e){return e[e.None=0]="None",e[e.PropertyChange=1024]="PropertyChange",e[e.Interaction=2048]="Interaction",e}({}),bo=function(e){return e[e.Zero=0]="Zero",e[e.One=1]="One",e[e.Two=2]="Two",e[e.Three=3]="Three",e[e.Four=4]="Four",e[e.Five=5]="Five",e}({}),vo=function(e){return e[e.collectionChange=0]="collectionChange",e[e.rotateChange=1]="rotateChange",e[e.positionChange=2]="positionChange",e[e.propertyChange=3]="propertyChange",e[e.selectionChange=4]="selectionChange",e[e.sizeChange=5]="sizeChange",e[e.drop=6]="drop",e[e.sourcePointChange=7]="sourcePointChange",e[e.targetPointChange=8]="targetPointChange",e[e.connectionChange=9]="connectionChange",e[e.animationComplete=10]="animationComplete",e[e.click=11]="click",e[e.doubleClick=12]="doubleClick",e[e.scrollChange=13]="scrollChange",e[e.dragEnter=14]="dragEnter",e[e.dragLeave=15]="dragLeave",e[e.dragOver=16]="dragOver",e[e.textEdit=17]="textEdit",e[e.paletteSelectionChange=18]="paletteSelectionChange",e[e.historyChange=19]="historyChange",e[e.mouseEnter=20]="mouseEnter",e[e.mouseLeave=21]="mouseLeave",e[e.mouseOver=22]="mouseOver",e[e.expandStateChange=23]="expandStateChange",e[e.segmentCollectionChange=24]="segmentCollectionChange",e[e.commandExecute=25]="commandExecute",e[e.historyStateChange=26]="historyStateChange",e[e.onUserHandleMouseDown=27]="onUserHandleMouseDown",e[e.onUserHandleMouseUp=28]="onUserHandleMouseUp",e[e.onUserHandleMouseEnter=29]="onUserHandleMouseEnter",e[e.onUserHandleMouseLeave=30]="onUserHandleMouseLeave",e[e.onImageLoad=31]="onImageLoad",e[e.onDoBindingInit=32]="onDoBindingInit",e[e.keyUp=33]="keyUp",e[e.keyDown=34]="keyDown",e[e.fixedUserHandleClick=35]="fixedUserHandleClick",e}({}),wo=function(e){return e[e.None=1]="None",e[e.Drag=2]="Drag",e[e.Draw=4]="Draw",e[e.InConnect=8]="InConnect",e[e.OutConnect=16]="OutConnect",e[e.Default=24]="Default",e}({});class xo{constructor(){this.pivot={x:.5,y:.5},this.isDirt=!0,this.isExport=!1,this.exportScaleValue={x:0,y:0},this.exportScaleOffset={x:0,y:0},this.canApplyStyle=!0,this.visible=!0,this.offsetX=0,this.offsetY=0,this.cornerRadius=0,this.minHeight=void 0,this.minWidth=void 0,this.maxWidth=void 0,this.maxHeight=void 0,this.width=void 0,this.height=void 0,this.rotateAngle=0,this.margin={left:0,right:0,top:0,bottom:0},this.horizontalAlignment="Auto",this.verticalAlignment="Auto",this.flip="None",this.relativeMode="Point",this.transform=co.Self|co.Parent,this.style={fill:"white",strokeColor:"black",opacity:1,strokeWidth:1},this.desiredSize=new bs,this.actualSize=new bs,this.parentTransform=0,this.preventContainer=!1,this.isSvgRender=!1,this.bounds=new Ds(0,0,0,0),this.shadow=null,this.description="",this.staticSize=!1,this.isRectElement=!1,this.isCalculateDesiredSize=!0,this.flipOffset={x:0,y:0},this.elementActions=oo.None,this.inversedAlignment=!0,this.position=void 0,this.unitMode=void 0,this.float=!1,this.floatingBounds=void 0}setOffsetWithRespectToBounds(e,t,i){this.unitMode=i,this.position={x:e,y:t}}getAbsolutePosition(e){if(void 0!==this.position)return"Absolute"===this.unitMode?this.position:{x:this.position.x*e.width,y:this.position.y*e.height}}get outerBounds(){return this.floatingBounds||this.bounds}set outerBounds(e){this.floatingBounds=e}measure(e,t,i){let n=void 0!==this.height?this.height:(e.height||0)-this.margin.top-this.margin.bottom;return this.id&&0===n&&this.elementActions&oo.HorizontalLaneHeader&&(n=this.actualSize.height),this.desiredSize=new bs(void 0!==this.width?this.width:(e.width||0)-this.margin.left-this.margin.right,n),this.isCalculateDesiredSize&&(this.desiredSize=this.validateDesiredSize(this.desiredSize,e)),this.desiredSize}arrange(e){return this.actualSize=e,this.updateBounds(),this.actualSize}updateBounds(){this.bounds=cp(this)}validateDesiredSize(e,t){return!this.isRectElement||this.width||this.minWidth||this.maxWidth||(e.width=50),!this.isRectElement||this.height||this.minHeight||this.maxHeight||(e.height=50),(void 0===e||void 0!==this.width&&void 0!==this.height)&&((e=e||new bs).width=void 0===this.width?(t.width||0)-this.margin.left-this.margin.right:this.width,e.height=void 0===this.height?(t.height||0)-this.margin.top-this.margin.bottom:this.height),void 0!==this.minWidth&&(e.width=Math.max(e.width,this.minWidth)),void 0!==this.minHeight&&(e.height=Math.max(e.height,this.minHeight)),void 0!==this.maxWidth&&0!==this.maxWidth&&(e.width=Math.min(e.width,this.maxWidth)),void 0!==this.maxHeight&&0!==this.maxHeight&&(e.height=Math.min(e.height,this.maxHeight)),e}}class So extends xo{constructor(){super(...arguments),this.padding=new Fs(0,0,0,0),this.desiredBounds=void 0,this.measureChildren=!0,this.prevRotateAngle=0}hasChildren(){return void 0!==this.children&&this.children.length>0}measure(e,t,i){let n,r,s;if(this.desiredBounds=void 0,this.hasChildren()){for(let n=0;n<this.children.length;n++){r=this.children[n],"Stretch"!==r.horizontalAlignment||e.width||(e.width=r.bounds.width),"Stretch"!==r.verticalAlignment||e.height||(e.height=r.bounds.height);const o="Stretch"===r.horizontalAlignment||"Stretch"===r.verticalAlignment;(this.measureChildren||o||r instanceof So&&void 0!==r.measureChildren)&&r.measure(e,t,i),s=this.GetChildrenBounds(r),"Stretch"!==r.horizontalAlignment&&"Stretch"!==r.verticalAlignment?void 0===this.desiredBounds?this.desiredBounds=s:this.desiredBounds.uniteRect(s):!this.actualSize||this.actualSize.width||this.actualSize.height||r.preventContainer||"Stretch"!==r.horizontalAlignment||"Stretch"!==r.verticalAlignment||(void 0===this.desiredBounds?this.desiredBounds=r.bounds:this.desiredBounds.uniteRect(r.bounds))}if(void 0!==this.desiredBounds&&0!==this.rotateAngle){const e=Sp(this.rotateAngle,void 0,void 0,{x:this.desiredBounds.x+this.desiredBounds.width*this.pivot.x,y:this.desiredBounds.y+this.desiredBounds.height*this.pivot.y});this.desiredBounds.x=e.x-this.desiredBounds.width*this.pivot.x,this.desiredBounds.y=e.y-this.desiredBounds.height*this.pivot.y}this.desiredBounds&&(n=new bs(this.desiredBounds.width,this.desiredBounds.height))}return n=this.validateDesiredSize(n,e),this.stretchChildren(n),this.desiredSize=n,n}arrange(e){let t;const i=this.desiredBounds;if(i&&(this.offsetX=i.x+i.width*this.pivot.x,this.offsetY=i.y+i.height*this.pivot.y,this.hasChildren()))for(let n=0;n<this.children.length;n++){t=this.children[n];let e=!1;"Stretch"===t.horizontalAlignment&&(t.offsetX=this.offsetX,t.parentTransform=this.parentTransform+this.rotateAngle,this.flip&&this.elementActions&oo.ElementIsGroup&&(t.parentTransform="Horizontal"===this.flip||"Vertical"===this.flip?-t.parentTransform:t.parentTransform),e=!0),"Stretch"===t.verticalAlignment&&(t.offsetY=this.offsetY,t.parentTransform=this.parentTransform+this.rotateAngle,e=!0),(e||this.measureChildren||t instanceof So&&void 0!==t.measureChildren)&&t.arrange(t.desiredSize)}return this.actualSize=e,this.updateBounds(),this.prevRotateAngle=this.rotateAngle,e}stretchChildren(e){if(this.hasChildren())for(const t of this.children)"Stretch"!==t.horizontalAlignment&&void 0!==t.desiredSize.width||(t.desiredSize.width=e.width-t.margin.left-t.margin.right),"Stretch"!==t.verticalAlignment&&void 0!==t.desiredSize.height||(t.desiredSize.height=e.height-t.margin.top-t.margin.bottom),t instanceof So&&t.stretchChildren(t.desiredSize)}applyPadding(e){e.width+=this.padding.left+this.padding.right,e.height+=this.padding.top+this.padding.bottom}findChildOffsetFromCenter(e,t){let i={x:(n={x:t.x-e.desiredSize.width/2,y:t.y-e.desiredSize.height/2}).x+(r=e).desiredSize.width*r.pivot.x,y:n.y+r.desiredSize.height*r.pivot.y};var n,r;i=Sp(e.rotateAngle,t.x,t.y,i),i=Sp(this.rotateAngle+this.parentTransform,this.offsetX,this.offsetY,i),e.offsetX=i.x,e.offsetY=i.y}GetChildrenBounds(e){const t=e.desiredSize.clone(),i=e.offsetX-t.width*e.pivot.x,n=e.offsetY-t.height*e.pivot.y,r=i+t.width,s=n+t.height;let o={x:i,y:n},a={x:r,y:n},l={x:i,y:s},h={x:r,y:s};return o=Sp(e.rotateAngle,e.offsetX,e.offsetY,o),a=Sp(e.rotateAngle,e.offsetX,e.offsetY,a),l=Sp(e.rotateAngle,e.offsetX,e.offsetY,l),h=Sp(e.rotateAngle,e.offsetX,e.offsetY,h),0!==this.rotateAngle&&(o=Sp(-this.rotateAngle,void 0,void 0,o),a=Sp(-this.rotateAngle,void 0,void 0,a),l=Sp(-this.rotateAngle,void 0,void 0,l),h=Sp(-this.rotateAngle,void 0,void 0,h)),Ds.toBounds([o,a,l,h])}}class Co extends xo{constructor(){super(),this.textContent="",this.canMeasure=!0,this.isLaneOrientation=!1,this.canConsiderBounds=!0,this.hyperlink={color:"blue"},this.doWrap=!0,this.textNodes=[],this.style={color:"black",fill:"transparent",strokeColor:"black",strokeWidth:1,fontFamily:"Arial",fontSize:12,whiteSpace:"CollapseSpace",textWrapping:"WrapWithOverflow",textAlign:"Center",italic:!1,bold:!1,textDecoration:"None",strokeDashArray:"",opacity:5,gradient:null,textOverflow:"Wrap"},this.style.fill="transparent",this.style.strokeColor="transparent"}get content(){return this.textContent}set content(e){this.textContent!==e&&(this.textContent=e,this.isDirt=!0,this.doWrap=!0)}get childNodes(){return this.textNodes}set childNodes(e){this.textNodes=e}get wrapBounds(){return this.textWrapBounds}set wrapBounds(e){this.textWrapBounds=e}refreshTextElement(){this.isDirt=!0}measure(e){let t;return t=this.isDirt&&this.canMeasure?function(e,t,i,n,r){const s=new bs(0,0);let o,a;const l=function(e,t){const i={fill:e.style.fill,stroke:e.style.strokeColor,angle:e.rotateAngle+e.parentTransform,pivotX:e.pivot.x,pivotY:e.pivot.y,strokeWidth:e.style.strokeWidth,dashArray:e.style.strokeDashArray,opacity:e.style.opacity,shadow:e.shadow,gradient:e.style.gradient,visible:e.visible,id:e.id,description:e.description,width:t||e.actualSize.width,height:e.actualSize.height,x:e.offsetX-e.actualSize.width*e.pivot.x+.5,y:e.offsetY-e.actualSize.height*e.pivot.y+.5};return i.fontSize=e.style.fontSize,i.fontFamily=e.style.fontFamily,i.textOverflow=e.style.textOverflow,i.textDecoration=e.style.textDecoration,i.doWrap=e.doWrap,i.whiteSpace=wp(e.style.whiteSpace,e.style.textWrapping),i.content=e.content,i.textWrapping=e.style.textWrapping,i.breakWord=fp(e.style.textWrapping),i.textAlign=mp(e.style.textAlign),i.color=e.style.color,i.italic=e.style.italic,i.bold=e.style.bold,i.dashArray="",i.strokeWidth=0,i.fill="",i}(e,n);return e.childNodes=o=function(e,t,i){let n,r,s=[],o=0;const a=e.content;if("nowrap"!==e.whiteSpace&&"pre"!==e.whiteSpace)if("breakall"===e.breakWord)for(n="",n+=a[0],o=0;o<a.length;o++)if(r=yp(n,e),r>=e.width&&n.length>0)s[s.length]={text:n,x:0,dy:0,width:r},n="";else{n+=a[o+1]||"",n.indexOf("\n")>-1&&(s[s.length]={text:n,x:0,dy:0,width:yp(n,e)},n="");const t=yp(n,e);Math.ceil(t)+2>=e.width&&n.length>0&&(s[s.length]={text:n,x:0,dy:0,width:t},n=""),o===a.length-1&&n.length>0&&(s[s.length]={text:n,x:0,dy:0,width:t},n="")}else s=function(e,t,i){const n=[];let r="",s=0,o=0;const a="nowrap"!==e.whiteSpace,l=e.content.split("\n");let h,c,d,p;for(s=0;s<l.length;s++)for(h="NoWrap"!==e.textWrapping?l[s].split(" "):"NoWrap"===e.textWrapping?[l[s]]:l,o=0;o<h.length;o++){r+=((0!==o||1===h.length)&&a&&r.length>0?" ":"")+h[o],c=r+" "+(h[o+1]||"");const t=yp(c,e);Math.floor(t)>(i||e.width)-2&&r.length>0?(n[n.length]={text:r,x:0,dy:0,width:c===r?t:r===p?d:yp(r,e)},r=""):o===h.length-1&&(n[n.length]={text:r,x:0,dy:0,width:t},r=""),p=c,d=t}return n}(e,0,i);else s[s.length]={text:a,x:0,dy:0,width:yp(a,e)};return s}(l,0,e.isLaneOrientation?n:void 0),e.wrapBounds=a=function(e,t){let i,n,r={x:0,width:0},s=0;for(s=0;s<t.length;s++)i=t[s].width,n=i,i="left"===e.textAlign?0:"center"===e.textAlign?i>e.width&&("Ellipsis"===e.textOverflow||"Clip"===e.textOverflow)?0:-i/2:"right"===e.textAlign?-i:t.length>1?0:-i/2,t[s].dy=1.2*e.fontSize,t[s].x=i,r?(r.x=Math.min(r.x,i),r.width=Math.max(r.width,n)):r={x:i,width:n};return r}(l,o),s.width=a.width,e.wrapBounds.width>=n&&"Wrap"!==l.textOverflow&&(s.width=n),s.height=o.length*e.style.fontSize*1.2,s}(this,0,0,this.isLaneOrientation?e.height:this.width||e.width):this.desiredSize,this.desiredSize=void 0===this.width||void 0===this.height?new bs(t.width,t.height):new bs(this.width,this.height),this.desiredSize=this.validateDesiredSize(this.desiredSize,e),this.desiredSize}arrange(e){return(e.width!==this.actualSize.width||e.height!==this.actualSize.height||this.isDirt)&&(this.doWrap=!0),this.actualSize=e,this.updateBounds(),this.isDirt=!1,this.actualSize}}class Po extends So{constructor(){super(...arguments),this.measureChildren=void 0}measure(e,t,i){let n,r;if(this.hasChildren()){for(const n of this.children){n instanceof Co?n.canMeasure&&(e.width=e.width||this.maxWidth||this.minWidth,n.measure(e)):n instanceof Co||n.measure(e,t,i);let s=n.desiredSize.clone();0!==n.rotateAngle&&(s=xp(s,n.rotateAngle));const o=new Ds(n.margin.left,n.margin.top,s.width+n.margin.right,s.height+n.margin.bottom);n.float&&void 0!==n.getAbsolutePosition(s)||n instanceof Co&&!(n instanceof Co&&n.canConsiderBounds)||(void 0===r?r=o:r.uniteRect(o))}if(r){let e=0,t=0;e=Math.max(r.left,0),t=Math.max(r.top,0),n=new bs(r.width+e,r.height+t)}}return n=super.validateDesiredSize(n,e),super.stretchChildren(n),n.width+=this.padding.left+this.padding.right,n.height+=this.padding.top+this.padding.bottom,this.desiredSize=n,n}arrange(e,t){if(this.outerBounds=new Ds,this.hasChildren()){const i=this.offsetY-e.height*this.pivot.y+this.padding.top,n=this.offsetX-e.width*this.pivot.x+this.padding.left;for(const r of this.children){if(0!=(r.transform&co.Parent)){r.parentTransform=this.parentTransform+this.rotateAngle,("None"!==this.flip||this.elementActions&oo.ElementIsGroup)&&(r.parentTransform="Horizontal"===this.flip||"Vertical"===this.flip?-r.parentTransform:r.parentTransform);const t=r.desiredSize.clone();let s,o={x:0,y:0},a=n,l=i;if("Point"===r.relativeMode){const t=r.getAbsolutePosition(e);void 0!==t&&(a+=t.x,l+=t.y)}s="Object"===r.relativeMode?this.alignChildBasedOnParent(r,t,e,a,l):this.alignChildBasedOnaPoint(r,a,l),o={x:s.x+t.width/2,y:s.y+t.height/2},super.findChildOffsetFromCenter(r,o)}!t||"Stretch"!==r.horizontalAlignment&&"Stretch"!==r.verticalAlignment?r instanceof Co&&r.canMeasure?(r.arrange(r.desiredSize),this.outerBounds.uniteRect(r.outerBounds)):r instanceof Co||(r.arrange(r.desiredSize),this.outerBounds.uniteRect(r.outerBounds)):r.arrange(e)}}return this.actualSize=e,this.updateBounds(),this.outerBounds.uniteRect(this.bounds),e}alignChildBasedOnParent(e,t,i,n,r){switch(e.horizontalAlignment){case"Auto":case"Left":n+=e.margin.left;break;case"Right":n+=i.width-t.width-e.margin.right;break;case"Stretch":case"Center":n+=i.width/2-t.width/2}switch(e.verticalAlignment){case"Auto":case"Top":r+=e.margin.top;break;case"Bottom":r+=i.height-t.height-e.margin.bottom;break;case"Stretch":case"Center":r+=i.height/2-t.height/2}return{x:n,y:r}}alignChildBasedOnaPoint(e,t,i){switch(t+=e.margin.left-e.margin.right,i+=e.margin.top-e.margin.bottom,e.horizontalAlignment){case"Auto":case"Left":t=e.inversedAlignment?t:t-e.desiredSize.width;break;case"Stretch":case"Center":t-=e.desiredSize.width*e.pivot.x;break;case"Right":t=e.inversedAlignment?t-e.desiredSize.width:t}switch(e.verticalAlignment){case"Auto":case"Top":i=e.inversedAlignment?i:i-e.desiredSize.height;break;case"Stretch":case"Center":i-=e.desiredSize.height*e.pivot.y;break;case"Bottom":i=e.inversedAlignment?i-e.desiredSize.height:i}return{x:t,y:i}}}function Oo(e){return To[e.toString()]}let To={Rectangle:"M0,0 L50,0 L50,50 L0,50 z",Ellipse:"M80.5,12.5 C80.5,19.127417 62.59139,24.5 40.5,24.5 C18.40861,24.5 0.5,19.127417 0.5,12.5C0.5,5.872583 18.40861,0.5 40.5,0.5 C62.59139,0.5 80.5,5.872583 80.5,12.5 z",Hexagon:"M30,0 L60,0 L90,30 L60,60 L30,60 L0,30 L30,0 z",Parallelogram:"M30,0 L60,0 L45,30 L15,30 z",Triangle:"M45,0 L90,45 L0,45 L45,0 z",Plus:"M696.6084,158.2656 L674.8074,158.2656 L674.8074,136.4656 L658.4084,136.4656 L658.4084,158.2656 L636.6084,158.2656L636.6084,174.6646 L658.4084,174.6646 L658.4084,196.4656 L674.8074,196.4656 L674.8074,174.6646 L696.6084,174.6646L696.6084,158.2656 z",Star:"M540.3643,137.9336 L546.7973,159.7016 L570.3633,159.7296 L550.7723,171.9366 L558.9053,194.9966 L540.3643,179.4996L521.8223,194.9966 L529.9553,171.9366 L510.3633,159.7296 L533.9313,159.7016 L540.3643,137.9336 z",Pentagon:"M30,0 L60,30 L50,70 L10,70 L0,30 L30,0 z",Heptagon:"M223.7783,195.7134 L207.1303,174.8364 L213.0713,148.8034 L237.1303,137.2174 L261.1883,148.8034 L267.1303,174.8364L250.4813,195.7134 L223.7783,195.7134 z",Octagon:"M98.7319,196.4653 L81.1579,178.8923 L81.1579,154.0393 L98.7319,136.4653 L123.5849,136.4653L141.1579,154.0393 L141.1579,178.8923 L123.5849,196.4653 L98.7319,196.4653 z",Trapezoid:"M127.2842,291.4492 L95.0322,291.4492 L81.1582,256.3152 L141.1582,256.3152 L127.2842,291.4492 z",Decagon:"M657.3379,302.4141 L642.3369,291.5161 L636.6089,273.8821 L642.3369,256.2481 L657.3379,245.3511 L675.8789,245.3511L690.8789,256.2481 L696.6089,273.8821L690.8789,291.5161 L675.8789,302.4141 L657.3379,302.4141 z",RightTriangle:"M836.293,292.9238 L776.293,292.9238 L776.293,254.8408 L836.293,292.9238 z",Cylinder:"M 542.802,362.009C 542.802,368.452 525.341,373.676 503.802,373.676C 482.263,373.676 464.802,368.452 464.802,362.009L 464.802,466.484C 464.802,472.928 482.263,478.151 503.802,478.151C 525.341,478.151 542.802,472.928 542.802,466.484L 542.802,362.016C 542.802,368.459 525.341,373.534 503.802,373.534C 482.263,373.534 464.802,368.31 464.802,361.867L 464.802,362.016C 464.802,355.572 482.263,350.349 503.802,350.349C 525.341,350.349 542.802,355.572 542.802,362.016",Diamond:"M397.784,287.875 L369.5,316.159 L341.216,287.875 L369.5,259.591 L397.784,287.875 z"};class Eo extends xo{constructor(){super(),this.pathData="",this.transformPath=!0,this.absolutePath="",this.canMeasurePath=!1,this.absoluteBounds=new Ds}get data(){return this.pathData}set data(e){this.pathData!==e&&(this.pathData=e,this.isDirt=!0)}getPoints(){return this.pointTimer||(this.pointTimer=setTimeout(()=>{this.points=null,this.pointTimer=null},200)),this.points=this.points||function(e){const t=[];let i,n;window.measureElement.style.visibility="visible";const r=zd(window.measureElement.children[2])[0];r.setAttributeNS(null,"d",e.data);const s=jd(e,e.absoluteBounds);r.setAttributeNS(null,"d",s);const o=r.getTotalLength();for(n=0;n<=o;n+=10)i=r.getPointAtLength(n),t.push({x:i.x,y:i.y});return window.measureElement.style.visibility="hidden",t}(this),function(e,t){const i=[];for(const n of t){let t,r={x:e.offsetX-e.actualSize.width*e.pivot.x+n.x,y:e.offsetY-e.actualSize.height*e.pivot.y+n.y};const s=e.rotateAngle+e.parentTransform;s&&(t=zs(),ks(t,s,e.offsetX,e.offsetY)),t&&(r=Ms(t,r)),i.push(r)}return i}(this,this.points)}measure(e){return this.staticSize&&void 0!==this.width&&void 0!==this.height?this.absoluteBounds=new Ds(this.offsetX-this.width*this.pivot.x,this.offsetY-this.height*this.pivot.y,this.width,this.height):(!this.isDirt||!this.transformPath&&void 0!==this.width&&void 0!==this.height||this.absoluteBounds&&0!==this.absoluteBounds.height)&&!this.canMeasurePath||(this.absoluteBounds=Md(this.data?this.data:"")),this.desiredSize=void 0===this.width?new bs(this.absoluteBounds.width,this.height||this.absoluteBounds.height):void 0===this.height?new bs(this.width||this.absoluteBounds.width,this.absoluteBounds.height):new bs(this.width,this.height),this.desiredSize=this.validateDesiredSize(this.desiredSize,e),this.canMeasurePath=!1,this.desiredSize}arrange(e){return(this.isDirt||this.actualSize.width!==e.width||this.actualSize.height!==e.height)&&(this.isDirt=!0,this.absolutePath=this.updatePath(this.data,this.absoluteBounds,e),this.staticSize||(this.points=null)),this.actualSize=this.desiredSize,this.updateBounds(),this.isDirt=!1,this.actualSize}updatePath(e,t,i){let n=!1,r="",s=-t.x,o=-t.y,a=[];return i.width===t.width&&i.height===t.height||(s=i.width/Number(t.width?t.width:1),o=i.height/Number(t.height?t.height:1),n=!0),a=xs(e),a=Es(a),r=(n||this.isDirt)&&this.transformPath?Ps(a,s,o,n,t.x,t.y,0,0):As(a),n=!1,r}}class Ao extends xo{constructor(){super(),this.imageSource="",this.imageScale="None",this.imageAlign="None",this.stretch="Stretch"}get source(){return this.imageSource}set source(e){this.imageSource=e,this.isDirt=!0}measure(e,t,i){return this.isDirt&&("Stretch"!==this.stretch||void 0===this.width&&void 0===this.height)&&(this.contentSize=function(e,t,i,n){window.measureElement.style.visibility="visible";const r=window.measureElement.children[1];r.setAttribute("src",e);const s=r.getBoundingClientRect();t=new bs(s.width,s.height),window.measureElement.style.visibility="hidden";const o=document.createElement("img");return o.setAttribute("src",e),np(o,{id:i+"sf-imageNode",style:"display: none;"}),document.body.appendChild(o),o.onload=e=>{const t=e.currentTarget;n&&n(i,{width:t.width,height:t.height})},t}(this.source,this.contentSize,t,i),this.isDirt=!1),void 0!==this.width&&void 0!==this.height?(this.desiredSize=new bs(this.width,this.height),this.contentSize=this.desiredSize):this.desiredSize=this.contentSize,this.desiredSize=this.validateDesiredSize(this.desiredSize,e),this.desiredSize}arrange(e){return this.actualSize=new bs(this.desiredSize.width,this.desiredSize.height),this.updateBounds(),this.actualSize}}class Io extends xo{constructor(e,t){super(),this.data="",this.nodeId="",this.diagramId="",this.scale="Stretch",this.diagramId=t,this.nodeId=e}get content(){return this.data}set content(e){this.data=e,this.canReset||(this.canReset=!0,this.template=ep(this,!1),this.canReset=!1,this.isDirt=!0)}measure(e){if(this.isDirt){const e=function(e){window.measureElement.style.visibility="visible";let t=window.measureElement.children[2];t.appendChild(e);const i=e.getBoundingClientRect(),n=t.getBoundingClientRect(),r=i;return r.x=i.left-n.left,r.y=i.top-n.top,t.removeChild(e),window.measureElement.style.visibility="hidden",r}(this.template);this.contentSize=new bs,this.contentSize.width=e.width,this.contentSize.height=e.height,this.templatePosition={x:e.x,y:e.y},this.isDirt=!1}if(void 0===this.width||void 0===this.height){const e=function(e){window.measureElement.style.visibility="visible";const t=window.measureElement.children[2];t.appendChild(e);const i=t.getBoundingClientRect();return t.removeChild(e),window.measureElement.style.visibility="hidden",i}(this.template);this.desiredSize=new bs(e.width,e.height)}else this.desiredSize=new bs(this.width,this.height);return this.desiredSize=this.validateDesiredSize(this.desiredSize,e),this.desiredSize}arrange(e){return this.actualSize=new bs(this.desiredSize.width,this.desiredSize.height),this.updateBounds(),this.actualSize}}var Do=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Ro=(()=>{class e extends Ht{constructor(e,t,i,n){super(e,t,i,n),this.inEdges=[],this.outEdges=[]}}return Do([xt("")],e.prototype,"id",void 0),Do([xt("Center")],e.prototype,"horizontalAlignment",void 0),Do([xt("Center")],e.prototype,"verticalAlignment",void 0),Do([St({},Vs)],e.prototype,"margin",void 0),Do([xt(12)],e.prototype,"width",void 0),Do([xt(12)],e.prototype,"height",void 0),Do([St({},$s)],e.prototype,"style",void 0),Do([xt("Square")],e.prototype,"shape",void 0),Do([xt(eo.Connect)],e.prototype,"visibility",void 0),Do([xt("")],e.prototype,"pathData",void 0),Do([xt(wo.Default)],e.prototype,"constraints",void 0),Do([xt()],e.prototype,"addInfo",void 0),Do([xt()],e.prototype,"outEdges",void 0),Do([xt()],e.prototype,"inEdges",void 0),e})(),Lo=(()=>{class e extends Ro{constructor(e,t,i,n){super(e,t,i,n)}getClassName(){return"PointPort"}}return Do([St({x:.5,y:.5},ws)],e.prototype,"offset",void 0),e})();var zo=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Mo=(()=>{class e extends Ht{}return zo([xt("blue")],e.prototype,"color",void 0),zo([xt("")],e.prototype,"content",void 0),zo([xt("")],e.prototype,"link",void 0),zo([xt("None")],e.prototype,"textDecoration",void 0),e})(),ko=(()=>{class e extends Ht{constructor(e,t,i,n){super(e,t,i,n),i.id||(this.id=e.parentObj&&e.parentObj.propName&&"phases"===e.parentObj.propName?e.parentObj.id:op())}}return zo([xt("")],e.prototype,"content",void 0),zo([xt(void 0)],e.prototype,"template",void 0),zo([xt("String")],e.prototype,"annotationType",void 0),zo([xt(!0)],e.prototype,"visibility",void 0),zo([xt(ro.InheritReadOnly)],e.prototype,"constraints",void 0),zo([St(void 0,Mo)],e.prototype,"hyperlink",void 0),zo([xt("")],e.prototype,"id",void 0),zo([xt()],e.prototype,"width",void 0),zo([xt()],e.prototype,"height",void 0),zo([xt(0)],e.prototype,"rotateAngle",void 0),zo([St({strokeWidth:0,strokeColor:"transparent",fill:"transparent"},Js)],e.prototype,"style",void 0),zo([xt("Center")],e.prototype,"horizontalAlignment",void 0),zo([xt("Center")],e.prototype,"verticalAlignment",void 0),zo([St({},Vs)],e.prototype,"margin",void 0),zo([St({top:void 0,bottom:void 0,left:void 0,right:void 0},Vs)],e.prototype,"dragLimit",void 0),zo([xt("Shape")],e.prototype,"type",void 0),zo([xt()],e.prototype,"addInfo",void 0),e})(),jo=(()=>{class e extends ko{constructor(e,t,i,n){super(e,t,i,n)}getClassName(){return"ShapeAnnotation"}}return zo([St({x:.5,y:.5},ws)],e.prototype,"offset",void 0),e})(),Ho=(()=>{class e extends ko{constructor(e,t,i,n){super(e,t,i,n)}getClassName(){return"PathAnnotation"}}return zo([xt(.5)],e.prototype,"offset",void 0),zo([St({x:0,y:0},ws)],e.prototype,"displacement",void 0),zo([xt("Center")],e.prototype,"alignment",void 0),zo([xt(!1)],e.prototype,"segmentAngle",void 0),e})();function No(e){return _o[e.toString()]}let _o={X:"M14,14 L106,106 M106,14 L14,106",Circle:"M0,50 A50,50,0 1 1 100,50 A50,50,0 1 1 0,50 Z",Square:"M0,0 L10,0 L10,10 L0,10 z"},Bo={OpenArrow:"M15.9,23 L5,16 L15.9,9 L17,10.7 L8.7,16 L17,21.3Z",Square:"M0,0 L10,0 L10,10 L0,10 z",Fletch:"M14.8,10c0,0-3.5,6,0.2,12c0,0-2.5-6-10.9-6C4.1,16,11.3,16,14.8,10z",OpenFetch:"M6,17c-0.6,0-1-0.4-1-1s0.4-1,1-1c10.9,0,11-5,11-5c0-0.6,0.4-1,1-1s1,0.4,1,1C19,10.3,18.9,17,6,17C6,17,6,17,6,17z M18,23c-0.5,0-1-0.4-1-1c0-0.2-0.3-5-11-5c-0.6,0-1-0.5-1-1s0.4-1,1-1c0,0,0,0,0,0c12.9,0,13,6.7,13,7    C19,22.6,18.6,23,18,23z",IndentedArrow:"M17,10c0,0-4.5,5.5,0,12L5,16L17,10z",OutdentedArrow:"M14.6,10c0,0,5.4,6,0,12L5,16L14.6,10z",DoubleArrow:"M19,10 L19,22 L13,16Z M12,10 L12,22 L6,16Z",Arrow:"M15,10 L15,22 L5,16Z",Diamond:"M12,23l-7-7l7-7l6.9,7L12,23z",Circle:"M0,50 A50,50,0 1 1 100,50 A50,50,0 1 1 0,50 Z"};function Wo(e){return Uo[e.toString()]}let Uo={Process:"M419.511,76.687L359.511,76.687L359.511,43.086L419.511,43.086z",Decision:"M 253.005,115.687L 200.567,146.071L 148.097,115.687L 200.534,85.304L 253.005,115.687 Z",Document:"M 60 31.9 c 0 0 -11 -7.7 -30 0 s -30 0 -30 0 V 0 h 60 V 31.9 Z",PreDefinedProcess:"M 0,0 L 50,0 L 50,50 L 0,50 Z  M 8.334,0 L 8.334,50 M 41.667,0 L 41.667,50",Terminator:"M 269.711,29.33C 269.71,44.061 257.77,56 243.04,56L 158.058,56C 143.33,56 131.39,44.061 131.39,29.33L 131.39,29.33C 131.391,14.6057 143.33,2.669 158.058,2.669L 243.044,2.669C 257.772,2.669 269.711,14.6057 269.711,29.333 Z",PaperTap:"M0.0009,17.2042 L0.0009,47.165 C0.001,47.165 14.403,53.5455 25.00,47.165 C35.599,40.7852 44.403,43.5087 50.00,47.165L50.001,17.2042 M50.001,32.7987 L50.001,2.8405 C50.001,2.8405 35.599,-3.5427 25.001,2.8405C14.403,9.2237 5.599,6.494 0.0009,2.8405 L0.0009,32.7987",DirectData:"M 132.62 0 L 17.38 0 C 7.78 0 0 13.43 0 30 C 0 46.57 7.78 60 17.38 60 L 132.62 60 M 132.62 0C 123.02 0 115.24 13.43 115.24 30 C 115.24 46.57 123.02 60 132.62 60 C 142.22 60 150 46.57 150 30 C 150 13.43 142.22 0 132.62 0 z ",SequentialData:"M0.0029,24.999 C0.0029,11.1922 10.433,0.0021 23.295,0.0021 C36.159,0.00216 46.585,11.1922 46.585,24.999C46.585,38.8057 36.159,49.9979 23.295,49.9979 C10.433,49.9979 0.0029,38.8057 0.0029,24.999 z M23.294,49.999 L50.002,49.999",Sort:"M50.001,24.9971 L25.001,49.9971 L0.00097,24.9971 L25.001,-0.00286865 L50.001,24.9971 z M0.000976562,24.9971 L50.001,24.9971",MultiDocument:"M43.6826,40 C44.8746,40.6183 45.8586,41.3502 46.8366,42.1122 L46.8366,4.74487 L3.09857,4.74487 L3.09857,10.9544 M46.837,35.143 C48.027,35.765 49.025,36.604 50.003,37.369 L50.003,0.002 L6.264,0.002 L6.264,4.744 M43.682,47.113 L43.682,10.765 L0.0025,10.7652 L0.0025,47.1132 C0.0025,47.1132 12.5846,53.6101 21.8426,47.1132 C31.1006,40.6163 38.792,43.393 43.6826,47.1132 z",Collate:"M50.001,0.0028 L25.001,25.0029 L0.00097,0.0028 L50.001,0.002 z M0.0009,50.002 L25.001,25.002L50.001,50.002 L0.0009,50.0029 z",SummingJunction:"M7.3252,42.6768 L42.6772,7.3247 M42.6768,42.6768 L7.3248,7.3247 M0.0009,25.001 C0.0009,11.193 11.197,0.0009 25.001,0.0009 C38.809,0.0009 50.001,11.193 50.001,25.001 C50.001,38.809 38.809,50.001 25.001,50.001 C11.197,50.00 0.0009,38.809 0.0009,25.00 z",Or:"M 0 50 L 100 50 M 50 100 L 50 0.0 M 0 50 C 0 22.384 22.392 0 50 0 C 77.616 0 100 22.384 100 50 C 100 77.616 77.616 100 50 100 C 22.392 100 0 77.616 0 50 Z",InternalStorage:"M 0 3.81946A 2.5,3.81946 0 0,1 2.5,0L 47.5 0A 2.5,3.81946 0 0,1 50,3.81946L 50 45.836A 2.5,3.819446 0 0,1 47.5,49.652778L 2.5 49.652778A 2.5,3.819446 0 0,1 0,45.8336L 0 3.819446ZM 0 11.45834L 50 11.4583334M 12.5 0L 12.5 49.652778",Extract:"M0,35 L30,0 L60,35 Z",ManualOperation:"M46.4,28.8 L14.8,28.8 L0,0 L60,0 Z",Merge:"M60,0 L30,35 L0,0 Z",OffPageReference:"M60,33.3 L30.1,39 L0,33.3 L0,0 L60,0 Z",SequentialAccessStorage:"M 60 30 C 60 13.4 46.6 0 30 0 S 0 13.4 0 30 s 13.4 30 30 30 h 28.6 v -6.5 h -9.9C 55.5 48 60 39.5 60 30 Z",Annotation:"M49.9984,50.0029 L-0.00271199,50.0029 L-0.00271199,0.00286865 L49.9984,0.00286865",Annotation2:"M49.9977,50.0029 L25.416,50.0029 L25.416,0.00286865 L49.9977,0.00286865 M25.4166,25.0029 L-0.00227869,25.0029",Data:"M 10 0 L 40 0 L 30 40 L 0 40 Z",Card:"M275,60 L400,60 L400,110 L260,110 L260,75 Z",Delay:"M0,0 L12.029,0 C14.212999,0 16,1.7869979 16,3.9709952 C16,6.1549926 14.212999,7.9409904 12.029,7.9409904 L0,7.9409904 z",Preparation:"M 1048.17 572 C 1051.06 568.86 1055.17 567.05 1059.5 567 L 1094.51 567 C 1098.84 567.05 1102.95 568.86 1105.84 572 L 1126.43 595 C 1127.01 596.28 1127.01 597.72 1126.43 599 L 1105.84 622 C 1102.95 625.14 1098.84 626.95 1094.51 627 L 1059.5 627 C 1055.17 626.95 1051.06 625.14 1048.17 622 L 1027.58 599 C 1027 597.72 1027 596.28 1027.58 595 L 1048.17 572 Z",Display:"M47.8809,19.2914 L32.7968,-0.00594145 L11.3902,-0.00594145 C7.93166,-0.00594145 0.00124586,11.187 0.00124586,24.9968C0.00124586,38.8032 7.93166,49.9962 11.3902,49.9962 L32.7968,49.99 L47.615,31.038 C47.615,31.0388 52.798,24.9968 47.880,19.2914 z",ManualInput:"M 912 732 L 1006.85 707 C 1008.2 707 1009.5 707.53 1010.46 708.46 C 1011.41 709.4 1011.95 710.67 1011.95 712 L 1011.95 762C 1012 764.41 1010.28 766.52 1007.87 767 L 917.1 767 C 915.75 767 914.45 766.47 913.49 765.54 C 912.54 764.6 912 763.33 912 762 L 912 732 Z",LoopLimit:"M 8 9 L 27 9 L 33 15 L 33 26 C 33 27 33 27 32 27 L 4 27 C 3 27 2 27 2 26 L 2 15 L 8 9 Z",StoredData:"M 5.55 0L 50 0A 1.5,30 0 0,1 50,0A 5.555,25 0 0,0 50,50A 1.5,30 0 0,1 50,50L 5.555 50A 5.55,25 0 0,1 5.555,0Z"};function Fo(e,t,i){let n;n="Straight"!==e.type&&e.sourceWrapper?e.sourceWrapper.corners.center:function(e){let t;if(e.sourcePortWrapper){const i=e.sourcePortWrapper;t={x:i.offsetX,y:i.offsetY}}else t=e.sourceID&&e.sourceWrapper&&e.targetWrapper?da(e,0,e.sourceWrapper.corners.center,e.targetWrapper.corners.center,!1):e.sourcePoint;return t}(e);const r=function(e,t,i,n,r){const s=e.sourceWrapper,o=e.targetWrapper,a=e.sourcePortWrapper,l=e.targetPortWrapper;let h=[];const c={corners:void 0,point:t,direction:void 0,margin:{left:5,right:5,bottom:5,top:5}},d={corners:void 0,point:i,direction:void 0,margin:{left:5,right:5,bottom:5,top:5}};let p,u;if(void 0!==s&&void 0!==o&&(p=hp(s),u=hp(o),c.corners=s.corners,d.corners=o.corners),void 0!==a&&(c.direction=Sa({x:a.offsetX,y:a.offsetY},p,s.bounds)),void 0!==l&&(d.direction=Sa({x:l.offsetX,y:l.offsetY},u,o.bounds)),void 0!==s&&void 0!==o)return void 0!==c.direction&&void 0!==d.direction||(n?function(e,t,i){"LeftToRight"===i?(e.direction=e.direction?e.direction:"Right",t.direction=t.direction?t.direction:"Left"):"RightToLeft"===i?(e.direction=e.direction?e.direction:"Left",t.direction=t.direction?t.direction:"Right"):"TopToBottom"===i?(e.direction=e.direction?e.direction:"Bottom",t.direction=t.direction?t.direction:"Top"):"BottomToTop"===i&&(e.direction=e.direction?e.direction:"Top",t.direction=t.direction?t.direction:"Bottom")}(c,d,n):c.corners.top>d.corners.bottom&&Math.abs(c.corners.top-d.corners.bottom)>c.margin.top+c.margin.bottom?(c.direction=c.direction?c.direction:"Top",d.direction=d.direction?d.direction:"Bottom"):c.corners.bottom<d.corners.top&&Math.abs(c.corners.bottom-d.corners.top)>c.margin.bottom+c.margin.top?(c.direction=c.direction?c.direction:"Bottom",d.direction=d.direction?d.direction:"Top"):c.corners.right<d.corners.left&&Math.abs(c.corners.right-d.corners.left)>c.margin.right+c.margin.left||c.corners.right+13<d.corners.left||d.corners.right>=c.corners.left-13&&c.corners.left>d.corners.left?(c.direction=c.direction?c.direction:"Right",d.direction=d.direction?d.direction:"Left"):c.corners.left>d.corners.right&&Math.abs(c.corners.left-d.corners.right)>c.margin.left+c.margin.right||d.corners.right+13<c.corners.left||c.corners.right>=d.corners.left-13&&c.corners.left<d.corners.left?(c.direction=c.direction?c.direction:"Left",d.direction=d.direction?d.direction:"Right"):s.id!==o.id&&!p.equals(p,u)&&u.containsPoint(p.topCenter,c.margin.top)?(c.direction=c.direction?c.direction:"Bottom",d.direction=d.direction?d.direction:"Top"):(c.direction=c.direction?c.direction:"Top",d.direction=d.direction?d.direction:"Bottom")),function(e,t,i,n,r,s){const o=e.sourceWrapper,a=e.targetWrapper,l=e.sourcePortWrapper,h=e.targetPortWrapper;let c,d=[];const p=o.corners,u=a.corners,g={corners:p,point:n,direction:t,margin:{left:5,right:5,bottom:5,top:5}};let m={corners:u,point:r,direction:i,margin:{left:5,right:5,bottom:5,top:5}};const f=Ko(o,p,e.sourceWrapper.bounds),y=Ko(a,u,e.targetWrapper.bounds);let b=!1;if(e.sourceWrapper&&e.targetWrapper&&(b=function(e,t,i){const n=Jo(e,i.sourcePadding),r=Jo(t,i.targetPadding);for(let s=0;s<n.length-1;s++){const e=n[s];for(let t=0;t<r.length-1;t++)if(ic(e,r[t]).enabled)return!0}return!1}(e.sourceWrapper,e.targetWrapper,e)),void 0!==l){switch(g.point={x:l.offsetX,y:l.offsetY},g.direction){case"Bottom":case"Top":g.point.y=g.point.y;break;case"Left":case"Right":g.point.x=g.point.x}e.sourcePadding&&!b&&(h&&(m.point={x:h.offsetX,y:h.offsetY}),g.point=Qo(e,g,m,!1))}else"Orthogonal"===e.type?(e.segments&&e.segments.length>0&&e.segments[0].direction&&(g.direction=e.segments[0].direction),g.point=ha(f,g.direction),c=ha(f,Ca(g.direction)),g.point=da(e,0,g.point,c,!1)):g.point=o.corners.center;if(void 0!==h){switch(m.point={x:h.offsetX,y:h.offsetY},m.direction){case"Bottom":case"Top":m.point.y=m.point.y;break;case"Left":case"Right":m.point.x=m.point.x}e.targetPadding&&!b&&(m.point=Qo(e,g,m,!0))}else"Orthogonal"===e.type?(m.point=ha(y,m.direction),c=ha(y,Ca(m.direction)),m.point=da(e,0,m.point,c,!0)):m.point=a.corners.center;if("Orthogonal"!==e.type){let t,i;if(ia(e),void 0===e.sourcePortWrapper){g.point=g.corners.center,e.segments&&e.segments.length>0&&(i=e.segments[0],t=ws.isEmptyPoint(i.point)?void 0:i);let n=void 0!==t?t.point:m.point;if("Bezier"===e.type&&e.segments.length>0&&e.segments[0].vector1.angle&&e.segments[0].vector1.distance){const t=Math.max(g.corners.width,g.corners.height);n=ws.transform(g.point,e.segments[0].vector1.angle,t/2)}g.point=b?e.sourceWrapper.bounds.center:da(e,0,g.point,n,!1)}if(void 0===e.targetPortWrapper){m.point=m.corners.center,e.segments&&e.segments.length>1&&(i=e.segments[e.segments.length-2],t=ws.isEmptyPoint(i.point)?void 0:i);let n=t?t.point:g.point;if("Bezier"===e.type&&e.segments.length>0&&e.segments[e.segments.length-1].vector2.angle&&e.segments[e.segments.length-1].vector2.distance){const t=Math.max(g.corners.width,g.corners.height);n=ws.transform(m.point,e.segments[0].vector2.angle,t/2)}m.point=b?e.targetWrapper.bounds.center:da(e,0,n,m.point,!0)}d=ea(e,g,m)}else if("Orthogonal"===e.type&&e.segments&&e.segments.length>0&&null!==e.segments[0].direction)d=function(e,t,i,n,r,s,o){let a,l,h,c;ia(e);for(let d=0;d<e.segments.length;d++){if(l=e.segments[d],n&&t.direction===Ca(l.direction)&&(l.direction=t.direction),d>0&&e.segments[d-1].direction===l.direction)d=na(e,d,t);else if(l.direction)t.point=Vo(t,e.segments[d]);else{const i=e.segments[d-1];t.point=i.points[i.points.length-1]}if(d===e.segments.length-1)if(sa(e,t),a=void 0===r?ra(e,t,i):qo(e,t,i),$o(a,e),l.points=[],a.length>=2)for(h=0;h<a.length;h++)l.points.push(a[h]);else c=d;if(void 0!==c&&(c===e.segments.length-1&&(e.segments[c-1].direction=null,e.segments[c-1].length=null),e.segments.splice(c,1)),n&&0===d){const i=Zo(e,n,s);i&&(t.point=i)}}return oa(e,[])}(e,g,m,l,h,o);else{if(!e.segments[0]){const t=new Qa(e,"segments",{type:"Orthogonal"},!0);e.segments.push(t)}e.segments[0].points=d=function(e,t,i,n,r){let s,o=!1,a=[];return o=function(e,t){let i=!1;switch(e){case"Left":switch(t){case"Right":case"Bottom":i=!0}break;case"Top":switch(t){case"Left":case"Right":case"Bottom":i=!0}break;case"Bottom":switch(t){case"Right":i=!0}}return i}(t.direction,i.direction),o&&xa(t,i),"Right"===t.direction&&"Left"===i.direction?s=function(e,t,i,n){let r;const s=Math.round(Math.abs(t.point.y-i.point.y));let o={x:Math.max(t.point.x,t.corners.right),y:t.point.y},a={x:Math.min(i.point.x,i.corners.left),y:i.point.y},l=10;if(n){const e=a;a=o,o=e}return t.corners.bottom+l<i.corners.top-l||t.corners.top-l>i.corners.bottom+l||(l=0),t.margin={left:l,right:l,top:l,bottom:l},i.margin={left:l,right:l,top:l,bottom:l},r=0===s&&(t.corners.right<i.corners.left||n&&t.corners.right<i.corners.left)?bo.One:t.point.x+t.margin.right<i.point.x-i.margin.left||e.sourceWrapper!==e.targetWrapper&&(hp(e.sourceWrapper).containsPoint(a)||hp(e.targetWrapper).containsPoint(o))?bo.Three:bo.Five,r}(e,t,i,o):"Right"===t.direction&&"Right"===i.direction?s=function(e,t,i){const n=e.sourcePortWrapper,r=e.targetPortWrapper;let s;const o=t.point.x-i.point.x,a=t.point.y-i.point.y;return i.margin={left:10,right:10,top:10,bottom:10},t.margin={left:10,right:10,top:10,bottom:10},s=t.corners.right>=i.corners.right?void 0!==n&&(n.offsetY<i.corners.top||n.offsetY>i.corners.bottom)||void 0===n&&t.corners.middleRight.y<i.corners.top||void 0!==n&&n.offsetY>i.corners.bottom+i.margin.bottom&&t.corners.top>i.corners.bottom||void 0===n&&t.corners.middleRight.y>i.corners.bottom||void 0!==n&&n.offsetY<i.corners.top&&t.corners.bottom>i.corners.top||void 0===n&&t.corners.middleRight.y>i.corners.bottom?bo.Three:t.corners.right<i.corners.left||i.corners.right<t.corners.left?bo.Five:0===o||0===a?bo.One:bo.Three:void 0!==r&&t.corners.bottom<r.offsetY||void 0===r&&t.corners.bottom<i.corners.middleRight.y||void 0!==r&&t.corners.top>r.offsetY||void 0===r&&t.corners.top>i.corners.middleRight.y||void 0!==r&&(void 0!==n&&n.offsetX<i.corners.left&&n.offsetX!==r.offsetX&&n.offsetY!==r.offsetY&&Math.abs(t.corners.right-i.corners.left)<=20||void 0===n&&t.corners.right<i.corners.left&&t.corners.center.x!==i.corners.center.x&&t.corners.center.y!==i.corners.center.y)?bo.Three:t.corners.right<i.corners.left?bo.Five:0===o||0===a?bo.One:bo.Three,s}(e,t,i):"Right"===t.direction&&"Top"===i.direction?s=function(e,t,i,n){let r=e.targetPortWrapper,s=e.sourcePortWrapper;const o={x:Math.max(t.point.x,t.corners.right),y:t.point.y},a={x:i.point.x,y:Math.min(i.point.y,i.corners.top)};let l;if(i.margin={left:5,right:5,top:5,bottom:5},t.margin={top:5,bottom:5,left:5,right:5},n){const e=s;s=r,r=e}return l=void 0!==s&&s.offsetY<i.corners.top-i.margin.top||void 0===s&&t.corners.bottom<i.corners.top-i.margin.top?t.corners.bottom<i.corners.top?void 0!==r&&t.corners.right+t.margin.right<r.offsetX||void 0===r&&t.corners.right+t.margin.right<i.corners.topCenter.x?bo.Two:bo.Four:void 0!==r&&t.corners.left>r.offsetX||void 0===r&&t.corners.left>i.corners.topCenter.x?bo.Four:bo.Two:void 0!==s&&Math.abs(t.corners.right-i.corners.left)<=25&&Math.abs(s.offsetY-i.corners.top)<=25||void 0!==r&&Math.abs(r.offsetX-t.corners.topCenter.x)>=25&&t.corners.middleRight.y<r.offsetY?bo.Two:t.corners.right<i.corners.left?bo.Four:e.sourceWrapper!==e.targetWrapper&&(hp(e.sourceWrapper).containsPoint(a)||hp(e.targetWrapper).containsPoint(o))?bo.Two:bo.Four,l}(e,t,i,o):"Right"===t.direction&&"Bottom"===i.direction?s=function(e,t,i,n){let r;t.margin={left:10,right:10,top:10,bottom:10},i.margin={left:10,right:10,top:10,bottom:10};let s=e.sourcePortWrapper,o=e.targetPortWrapper;if(n){const e=s;s=o,o=e}return r=void 0!==s&&s.offsetY>i.corners.bottom+i.margin.bottom||void 0===s&&t.corners.middleRight.y>i.corners.bottom+i.margin.bottom?t.corners.top>i.corners.bottom?void 0!==o&&t.corners.right+t.margin.right<o.offsetX||void 0===o&&t.corners.right+t.margin.right<i.corners.bottomCenter.x?bo.Two:bo.Four:void 0!==o&&t.corners.left>o.offsetX||void 0===o&&t.corners.left>i.corners.bottomCenter.x?bo.Four:bo.Two:void 0!==s&&Math.abs(t.corners.right-i.corners.left)<=25&&Math.abs(s.offsetY-i.corners.bottom)<=25?bo.Two:bo.Four,r}(e,t,i,o):"Bottom"===t.direction&&"Top"===i.direction?s=function(e,t){let i;const n=e.point.x-t.point.x;let r=10;return e.corners.right+r<t.corners.left-r||e.corners.left-r>t.corners.right+r||(r=0),e.margin={left:r,right:r,top:r,bottom:r},t.margin={left:r,right:r,top:r,bottom:r},i=0===n&&e.corners.bottom<t.corners.top?bo.One:e.corners.bottom+e.margin.bottom<t.corners.top-t.margin.top?bo.Three:bo.Five,i}(t,i):"Bottom"===t.direction&&"Bottom"===i.direction?(t.margin={left:10,right:10,top:10,bottom:10},i.margin={left:10,right:10,top:10,bottom:10},s=function(e,t,i){const n=e.sourcePortWrapper,r=e.targetPortWrapper,s=Math.round(Math.abs(t.point.x-i.point.x)),o=Math.round(Math.abs(i.point.y-i.point.y));let a;return a=t.corners.bottom<i.corners.bottom?void 0!==n&&n.offsetX<i.corners.left-i.margin.left||void 0===n&&t.corners.bottomCenter.x<i.corners.left-i.margin.left||void 0!==n&&n.offsetX>i.corners.right+i.margin.right||void 0===n&&t.corners.bottomCenter.x>i.corners.right+i.margin.right?bo.Three:t.corners.bottom<i.corners.top?bo.Five:0===s||0===o?bo.One:bo.Three:void 0!==r&&t.corners.left>r.offsetX||void 0===r&&t.corners.left>i.corners.left||void 0!==r&&t.corners.right<r.offsetX||void 0===r&&t.corners.right<i.corners.right?bo.Three:t.corners.top>i.corners.bottom?bo.Five:0===s||0===o?bo.One:bo.Three,a}(e,t,i)):"Bottom"===t.direction&&"Left"===i.direction?s=function(e,t,i,n){let r,s=e.sourcePortWrapper,o=e.targetPortWrapper;if(n){const e=s;s=o,o=e}return r=void 0!==s&&s.offsetX<i.corners.left-i.margin.left||void 0===s&&t.corners.bottomCenter.x<i.corners.bottomLeft.x-i.margin.left?t.corners.right<i.corners.left?void 0!==o&&t.corners.bottom+t.margin.bottom<o.offsetY||void 0===o&&t.corners.bottom+t.margin.bottom<i.corners.middleLeft.y?bo.Two:bo.Four:void 0!==o&&t.corners.top>o.offsetY||void 0===o&&t.corners.top>i.corners.middleLeft.y?bo.Four:bo.Two:void 0!==o&&Math.abs(t.corners.right-i.corners.left)<=25&&Math.abs(o.offsetY-t.corners.bottom)<=25?bo.Two:bo.Four,r}(e,t,i,o):"Left"===t.direction&&"Left"===i.direction?s=function(e,t,i){const n=e.sourcePortWrapper,r=e.targetPortWrapper;t.margin={left:10,right:10,top:10,bottom:10},i.margin={left:10,right:10,top:10,bottom:10};const s=Math.round(Math.abs(t.point.x-i.point.x)),o=Math.round(Math.abs(t.point.y-i.point.y));let a;return a=t.corners.left<i.corners.left?void 0!==r&&t.corners.bottom+t.margin.bottom<r.offsetY||void 0===r&&t.corners.bottom+t.margin.bottom<i.corners.middleLeft.y||void 0!==r&&t.corners.top-t.margin.top>r.offsetY||void 0===r&&t.corners.top-t.margin.top>i.corners.middleLeft.y?bo.Three:t.corners.right<i.corners.left||i.corners.right<t.corners.left?bo.Five:0===s||0===o?bo.One:bo.Three:void 0!==n&&n.offsetY<i.corners.top-i.margin.top||void 0===n&&t.corners.middleLeft.y<i.corners.top||void 0!==n&&n.offsetY>i.corners.bottom+i.margin.bottom||void 0===n&&t.corners.middleLeft.y>i.corners.bottom+i.margin.bottom?bo.Three:t.corners.left>i.corners.right?bo.Five:0===s||0===o?bo.One:bo.Three,a}(e,t,i):"Left"===t.direction&&"Top"===i.direction?s=function(e,t,i,n){let r,s=e.sourcePortWrapper,o=e.targetPortWrapper;const a={x:Math.min(t.point.x,t.corners.left),y:t.point.y},l={x:i.point.x,y:Math.min(i.point.y,i.corners.top)};if(n){const e=s;s=o,o=e}return r=void 0!==s&&s.offsetY<i.corners.top-i.margin.top||void 0===s&&(t.corners.bottom<i.corners.top-i.margin.top||t.corners.middleLeft.y<i.corners.top-i.margin.top)?t.corners.bottom<i.corners.top?void 0!==o&&t.corners.left-t.margin.left>o.offsetX||void 0===o&&t.corners.left-t.margin.left>i.corners.topCenter.x?bo.Two:bo.Four:void 0!==o&&t.corners.right<o.offsetX||void 0===o&&t.corners.right<i.corners.topCenter.x?bo.Four:bo.Two:void 0!==s&&Math.abs(t.corners.left-i.corners.right)<=25&&Math.abs(s.offsetY-i.corners.top)<=25||e.sourceWrapper!==e.targetWrapper&&(hp(e.sourceWrapper).containsPoint(l)||hp(e.targetWrapper).containsPoint(a))?bo.Two:bo.Four,r}(e,t,i,o):"Top"===t.direction&&"Top"===i.direction&&(s=function(e,t,i){const n=e.sourcePortWrapper,r=e.targetPortWrapper,s=Math.round(Math.abs(t.point.x-i.point.x)),o=Math.round(Math.abs(t.point.y-i.point.y));let a;return t.margin={left:10,right:10,top:10,bottom:10},i.margin={left:10,right:10,top:10,bottom:10},a=t.corners.top<i.corners.top?void 0!==r&&t.corners.left>r.offsetX||void 0===r&&t.corners.left>i.corners.left||void 0!==r&&t.corners.right<r.offsetX||void 0===r&&t.corners.right<i.corners.right?bo.Three:t.corners.bottom<i.corners.top?bo.Five:0===s||0===o?bo.One:bo.Three:void 0!==n&&n.offsetX>i.corners.right||void 0===n&&t.corners.left>i.corners.right||void 0!==n&&n.offsetX<i.corners.left||void 0===n&&t.corners.bottomRight.x<i.corners.left?bo.Three:t.corners.top>i.corners.bottom?bo.Five:0===s||0===o?bo.One:bo.Three,a}(e,t,i)),o&&xa(t,i),a=function(e,t,i,n,r,s){let o;const a=e.sourceWrapper.corners,l=e.targetWrapper.corners;let h,c=20;if(!(i.direction===n.direction&&t!==bo.Five||i.direction!==Ca(n.direction)&&t!==bo.Three))switch(i.direction){case"Left":a.middleLeft.x>l.middleRight.x&&(h=(a.middleLeft.x-l.middleRight.x)/2,c=s?h:Math.min(c,h));break;case"Right":a.middleRight.x<l.middleLeft.x&&(h=(l.middleLeft.x-a.middleRight.x)/2,c=s?h:Math.min(c,h));break;case"Top":a.topCenter.y>l.bottomCenter.y&&(h=(a.topCenter.y-l.bottomCenter.y)/2,c=s?h:Math.min(c,h));break;case"Bottom":a.bottomCenter.y<l.topCenter.y&&(h=(l.topCenter.y-a.bottomCenter.y)/2,c=s?h:Math.min(c,h))}return c=fa(a,i,c),t===bo.One&&(o=[i.point,n.point]),t===bo.Two&&(o=ya(i,n)),t===bo.Three&&(o=ba(e,i,n,c)),t===bo.Four&&(o=va(i,n,void 0,o,c)),t===bo.Five&&(o=function(e,t,i=20){let n,r=i;const s=e.corners.left-e.margin.left,o=e.corners.right+e.margin.right,a=e.corners.bottom+e.margin.bottom,l=e.corners.top-e.margin.top,h=t.corners.left-t.margin.left,c=t.corners.right+t.margin.right,d=t.corners.bottom+t.margin.bottom,p=t.corners.top-t.margin.top;let u;switch(e.direction){case"Left":(l>p&&l<d||a<d&&a>p)&&s>h&&s<=c&&i>=20&&(r=e.point.x-t.corners.left+r),u=ca(e.point,r,180);break;case"Top":(s>h&&s<c||o<c&&o>h)&&l>p&&l<=d&&i>=20&&(r=e.point.y-t.corners.top+r),u=ca(e.point,r,270);break;case"Right":(l>p&&l<d||a<d&&a>p)&&o<c&&o>=h&&i>=20&&(r=t.corners.right-e.point.x+r),u=ca(e.point,r,0);break;case"Bottom":(s>h&&s<c||o<c&&o>h)&&a<d&&a>=p&&i>=20&&(r=t.corners.bottom-e.point.y+r),u=ca(e.point,r,90)}if(n=[e.point,u],"Top"===e.direction||"Bottom"===e.direction){const i=e.direction;e.direction=u.x>t.point.x?"Left":"Right",e.point=u,n=va(e,t,i,n)}else{const i=e.direction;e.direction=u.y>t.point.y?"Top":"Bottom",e.point=u,n=va(e,t,i,n)}return n}(i,n,c)),o}(e,s,t,i,0,r),a}(e,g,m,0,s)}return d}(e,c.direction,d.direction,c.point,d.point,r);if(ia(e),(e.sourceWrapper||e.targetWrapper)&&function(e,t,i){const n=e.sourcePortWrapper,r=e.targetPortWrapper;let s,o=e.sourceWrapper,a=t.point,l={left:0,right:0,top:0,bottom:0},h={x:0,y:0},c="Top";if(o?(a=i.point,l=t.margin):(o=e.targetWrapper,l=i.margin),"Orthogonal"===e.type)if(e.segments&&e.segments.length>0&&e.sourceWrapper&&e.segments[0].direction)t.direction=e.segments[0].direction,h=ha(o.corners,t.direction),s=ha(o.corners,Ca(t.direction)),h=da(e,0,h,s,!1);else{const t={corners:null,direction:null,point:null,margin:null};aa(o,{corners:null,direction:null,point:a,margin:l},t,e),h=t.point,c=t.direction}else{let t;e.segments&&e.segments.length>1&&(t=o===e.sourceWrapper?e.segments[0].point:e.segments[e.segments.length-2].point),h=da(e,0,o.bounds.center,e.segments&&e.segments.length>1?t:a,o===e.targetWrapper)}o===e.sourceWrapper?(t.direction=t.direction||c,t.point=h,e.sourcePortWrapper&&(t.point={x:n.offsetX,y:n.offsetY},e.sourcePadding&&(t.point=Qo(e,t,i,!1)))):(i.direction=i.direction||c,i.point=h,e.targetPortWrapper&&(i.point={x:r.offsetX,y:r.offsetY},e.targetPadding&&(i.point=Qo(e,t,i,!0))))}(e,c,d),"Straight"===e.type||"Bezier"===e.type)h=ea(e,c,d);else if("Orthogonal"===e.type&&e.segments&&e.segments.length>0&&null!==e.segments[0].length&&null!==e.segments[0].direction)h=function(e,t,i,n,r,s,o){let a,l,h,c,d,p=[];if(ia(e),e.segments.length>0){for(let p=0;p<e.segments.length;p++){const u=e.segments[p];if(0===p&&void 0!==e.sourcePortWrapper&&(c={x:s.offsetX,y:s.offsetY},h=Sa(c,hp(n),n.bounds),u.direction===Ca(h)&&(u.direction=h)),p>0&&e.segments[p-1].direction===u.direction)p=na(e,p,t);else{const i=e.segments[p-1];t.point=u.direction?Vo(t,u):i.points[i.points.length-1]}if(p===e.segments.length-1&&(o||r?e.targetWrapper&&void 0===e.targetPortWrapper?(sa(e,t),l=Yo(e,t,i)):l=qo(e,t,i):l=Xo(e,t,i),l))if($o(l,e),u.points=[],l.length>=2)for(a=0;a<l.length;a++)u.points.push(l[a]);else d=p;if(s&&0===p){const i=Zo(e,s,n);i&&(t.point=i)}}void 0!==d&&(d===e.segments.length-1&&(e.segments[d-1].direction=null,e.segments[d-1].length=null),e.segments.splice(d,1)),p=oa(e,p)}return p}(e,c,d,s,o,a,l);else{let t;c.direction?t=fa(s.bounds,c,20):c.direction=d.direction?void 0!==e.targetPortWrapper?d.direction:Ca(d.direction):ws.direction(c.point,d.point),e.segments[0].points=h=ba(e,c,d,t)}return h}(e,n,e.targetPoint,t,i);return pa(e,r[0],!1),pa(e,r[r.length-1],!0),r}function Vo(e,t){e.direction=t.direction,t.points=[],t.points.push(e.point);const i=ca(e.point,"Left"===t.direction||"Top"===t.direction?-t.length:t.length,"Left"===t.direction||"Right"===t.direction?0:90);return t.points.push(i),i}function Xo(e,t,i){let n,r,s;if(t.corners=e.sourceWrapper?e.sourceWrapper.corners:void 0,e.sourcePortWrapper&&(s=Sa({x:e.sourcePortWrapper.offsetX,y:e.sourcePortWrapper.offsetY},hp(e.sourceWrapper),e.sourceWrapper.bounds),!t.corners||"Bottom"!==t.direction&&"Top"!==t.direction?!t.corners||"Left"!==t.direction&&"Right"!==t.direction||i.point.y>t.corners.top&&i.point.y<t.corners.bottom&&(r=t.point.x>i.point.x?"Left":"Right"):i.point.x>t.corners.left&&i.point.x<t.corners.right&&(r=t.point.y>i.point.y?"Top":"Bottom")),e.sourcePortWrapper&&s===Ca(r)){let r;("Left"===s||"Right"===s)&&t.point.y>=t.corners.top&&t.point.y<=t.corners.center.y&&i.point.y>=t.corners.top&&i.point.y<=t.corners.center.y?(t.direction="Top",r=t.point.y-t.corners.top+20):("Left"===s||"Right"===s)&&t.point.y>t.corners.center.y&&t.point.y<=t.corners.bottom&&i.point.y>t.corners.center.y&&i.point.y<=t.corners.bottom?(t.direction="Bottom",r=t.corners.bottom-t.point.y+20):("Top"===s||"Bottom"===s)&&t.point.x>=t.corners.left&&t.point.x<=t.corners.center.x&&i.point.x>=t.corners.left&&i.point.x<=t.corners.center.x?(t.direction="Left",r=t.point.x-t.corners.left+20):("Top"===s||"Bottom"===s)&&t.point.x<=t.corners.right&&t.point.x>t.corners.center.x&&i.point.x<=t.corners.right&&i.point.x<t.corners.center.x&&(t.direction="Right",r=t.corners.right-t.point.x+20),t.direction&&r&&(n=ba(e,t,i,r,!0))}else t.direction=r||ta(t.direction,t.point,i.point),n=ya(t,i);return n}function Yo(e,t,i){let n;i.corners=e.targetWrapper.corners,aa(e.targetWrapper,t,i,e);const r=ta(i.direction,t.point,i.point);return t.direction!==i.direction||"Left"!==t.direction&&"Right"!==t.direction?(t.direction=r,n=ya(t,i)):(t.direction=r,n=ba(e,t,i,e.targetWrapper.width/2+20),t.point=n[1],aa(e.targetWrapper,t,i,e),n=ba(e,t,i)),n}function Go(e,t,i){let n,r;i.corners=e.targetWrapper.corners,"Left"!==t.direction&&"Right"!==t.direction?i.corners.center.y!==t.point.y||i.corners.left<=t.point.x&&t.point.x<=i.corners.right?i.corners.center.y===t.point.y&&"Bottom"===e.segments[e.segments.length-2].direction||i.corners.center.y>t.point.y&&t.point.y>=i.corners.top?(n="Top",r=t.point.y-i.corners.top+20):i.corners.center.y===t.point.y&&"Top"===e.segments[e.segments.length-2].direction||i.corners.center.y<t.point.y&&t.point.y<=i.corners.bottom?(n="Bottom",r=i.corners.bottom-t.point.y+20):void 0!==e.sourcePortWrapper&&void 0!==e.targetPortWrapper&&t.corners.top<=t.point.y&&t.point.y<=t.corners.bottom&&(n=t.direction,r=t.point.y>i.point.y?t.point.y-t.corners.top+20:t.corners.bottom-t.point.y+20):(n="Top",r=i.corners.height/2+20):i.corners.center.x!==t.point.x||i.corners.top<t.point.y&&t.point.y<=i.corners.bottom?i.corners.center.x===t.point.x&&"Right"===e.segments[e.segments.length-2].direction||i.corners.center.x>t.point.x&&t.point.x>=i.corners.left?(n="Left",r=t.point.x-i.corners.left+20):i.corners.center.x===t.point.x&&"Left"===e.segments[e.segments.length-2].direction||i.corners.center.x<=t.point.x&&t.point.x<=i.corners.right?(n="Right",r=i.corners.right-t.point.x+20):void 0!==e.sourcePortWrapper&&void 0!==e.targetPortWrapper&&t.corners.left<=t.point.x&&t.point.x<=t.corners.right&&(n=t.direction,r=t.point.x>i.point.x?t.point.x-t.corners.left+20:t.corners.right-t.point.x+20):(n="Left",r=i.corners.width/2+20);const s=t.point;t.point=ca(t.point,"Left"===n||"Top"===n?-r:r,"Left"===n||"Right"===n?0:90),t.direction=ws.direction(t.point,i.point),void 0===e.sourcePortWrapper||void 0===e.targetPortWrapper||t.corners.center.x!==i.corners.center.x&&t.corners.center.y!==i.corners.center.y||(t.direction=i.direction);const o=ba(e,t,i);return o.splice(0,0,s),o}function qo(e,t,i){let n,r,s;i.corners=e.targetWrapper.corners,void 0!==e.sourcePortWrapper&&(r=Sa({x:e.sourcePortWrapper.offsetX,y:e.sourcePortWrapper.offsetY},hp(e.sourceWrapper),e.sourceWrapper.bounds));const o=function(e,t,i,n){let r=!1;switch(i.direction){case"Left":void 0!==e.sourcePortWrapper&&void 0!==e.targetPortWrapper&&"Right"===n&&t.point.x>i.point.x&&t.point.y>=t.corners.top&&t.point.y<=t.corners.bottom||("Bottom"===n&&t.point.y>i.point.y||"Top"===n&&t.point.y<i.point.y)&&t.point.x>=t.corners.left&&t.point.x<=t.corners.right?(t.direction="Right"===n?t.point.y>i.point.y?"Top":"Bottom":t.point.x<i.point.x?"Right":"Left",r=!0):t.point.x>i.point.x&&(t.point.y>i.point.y||t.point.y<i.point.y)&&!(i.corners.top>t.point.y&&i.corners.bottom<t.point.y)?t.direction="Left":t.point.x<i.point.x&&t.point.y>i.point.y||t.point.x>i.point.x&&t.point.y<=i.point.y&&i.corners.top<t.point.y&&i.corners.center.y>=t.point.y?t.direction="Top":t.point.x<i.point.x&&t.point.y<i.point.y||t.point.x>i.point.x&&t.point.y>i.point.y&&i.corners.bottom<t.point.y&&i.corners.center.y>t.point.y?t.direction="Bottom":t.point.y===i.point.y&&t.point.x<i.point.x&&(t.direction="Right");break;case"Right":void 0!==e.sourcePortWrapper&&void 0!==e.targetPortWrapper&&("Bottom"===n&&t.point.y>i.point.y||"Top"===n&&t.point.y<i.point.y)&&t.point.x>i.point.x&&t.point.x>=t.corners.left&&t.point.x<=t.corners.right?(t.direction=t.point.x>i.point.x?"Left":"Right",r=!0):void 0!==e.sourcePortWrapper&&void 0!==e.targetPortWrapper&&"Left"===n&&t.point.x<i.point.x&&t.point.y>=t.corners.top&&t.point.y<=t.corners.bottom?(t.direction=t.point.y>i.point.y?"Top":"Bottom",r=!0):t.point.x<i.point.x&&i.corners.top<=t.point.y&&i.corners.bottom>=t.point.y&&t.point.y===i.point.y||t.point.y>i.point.y&&t.point.x>i.point.x?t.direction="Top":t.point.y<i.point.y&&t.point.x>i.point.x?t.direction="Bottom":t.point.x<i.point.x&&(t.point.y>i.point.y||t.point.y<i.point.y)?t.direction="Right":t.point.y===i.point.y&&t.point.x>i.point.x&&(t.direction="Left");break;case"Top":void 0!==e.sourcePortWrapper&&void 0!==e.targetPortWrapper&&"Bottom"===n&&t.point.y>i.point.y&&t.point.x>=t.corners.left&&t.point.x<=t.corners.right||("Right"===n&&t.point.x>i.point.x||"Left"===n&&i.point.y>t.point.y&&i.point.x>t.point.x)&&t.point.y>=t.corners.top&&t.point.y<=t.corners.bottom?(t.direction="Bottom"===n?t.point.x>i.point.x?"Left":"Right":t.point.y<i.point.y?"Bottom":"Top",r=!0):t.point.x===i.point.x&&t.point.y<i.point.y?t.direction="Bottom":t.point.y>i.point.y&&t.point.x>i.corners.left&&t.point.x<i.corners.right?t.direction="Left":t.point.y>=i.point.y?t.direction="Top":t.point.y<i.point.y&&t.point.x>i.point.x?t.direction="Left":t.point.y<i.point.y&&t.point.x<i.point.x&&(t.direction="Right");break;case"Bottom":void 0!==e.sourcePortWrapper&&void 0!==e.targetPortWrapper&&(("Right"===n||"Left"===n&&i.point.x>t.point.x)&&t.point.y>i.point.y&&t.point.y>=t.corners.top&&t.point.y<=t.corners.bottom||"Top"===n&&t.point.y<i.point.y&&t.point.x>=t.corners.left&&t.point.x<=t.corners.right)?(t.direction="Right"===n||"Left"===n?t.point.y>i.point.y?"Top":"Bottom":t.point.x>i.point.x?"Left":"Right",r=!0):t.point.y<i.point.y&&t.point.x>i.corners.left&&i.corners.right>t.point.x?t.point.y<i.point.y&&t.point.x>i.corners.left&&i.corners.center.x>=t.point.x?t.direction="Left":t.point.y<i.point.y&&t.point.x<i.corners.right&&i.corners.center.x<t.point.x&&(t.direction="Right"):t.point.y>i.point.y&&t.point.x>i.point.x?t.direction="Left":t.point.y>i.point.y&&t.point.x<i.point.x?t.direction="Right":t.point.y<=i.point.y&&(t.point.x>i.point.x||i.point.x>t.point.x)&&(t.direction="Bottom")}return r}(e,t,i,r);return void 0!==e.sourcePortWrapper&&void 0!==e.targetPortWrapper&&i.direction===Ca(r)&&(("Left"===i.direction&&t.point.x>i.point.x||"Right"===i.direction&&t.point.x<i.point.x)&&t.point.y>=t.corners.top&&t.point.y<=t.corners.bottom||"Bottom"===i.direction&&t.point.y<i.point.y&&t.point.x>=t.corners.left&&t.point.x<=t.corners.right)?n=Go(e,t,i):t.direction===i.direction?n=ba(e,t,i):("Left"===i.direction&&t.point.x>i.point.x||"Right"===i.direction&&t.point.x<i.point.x)&&("Top"===t.direction||"Bottom"===t.direction)&&t.point.y<=i.point.y&&i.corners.top<=t.point.y&&i.corners.bottom>=t.point.y||"Top"===i.direction&&t.point.y>i.point.y||"Bottom"===i.direction&&t.point.y<i.point.y&&i.corners.left<=t.point.x&&i.corners.right>=t.point.x?n=Go(e,t,i):void 0!==e.sourceWrapper&&void 0!==e.targetWrapper&&void 0!==e.targetPortWrapper&&("Left"===t.direction||"Right"===t.direction)&&t.point.y>=t.corners.top&&t.point.y<=t.corners.bottom&&("Top"===i.direction||"Bottom"===i.direction)&&i.corners.center.x===t.corners.center.x?(t.direction="Top"===i.direction?"Bottom":"Top",s="Top"===i.direction?t.corners.bottom-t.point.y+20:t.point.y-t.corners.top+20,n=ba(e,t,i,s)):void 0!==e.sourceWrapper&&void 0!==e.targetWrapper&&void 0!==e.targetPortWrapper&&("Top"===t.direction||"Bottom"===t.direction)&&t.point.x>=t.corners.left&&t.point.x<=t.corners.right&&("Left"===i.direction||"Right"===i.direction)&&i.corners.center.y===t.corners.center.y?(t.direction="Left"===i.direction?"Right":"Left",s="Left"===i.direction?t.corners.right-t.point.x+20:t.point.x-t.corners.left+20,n=ba(e,t,i,s)):o?(s="Left"===t.direction||"Right"===t.direction?"Left"===t.direction?t.point.x-t.corners.left+20:t.corners.right-t.point.x+20:"Top"===t.direction?t.point.y-t.corners.top+20:t.corners.bottom-t.point.y+20,n=ba(e,t,i,s)):n=ya(t,i),n}function Zo(e,t,i){const n={x:t.offsetX,y:t.offsetY};let r;const s=hp(i),o=Sa(n,s,i.bounds),a=e.segments[0];return a.direction!==o&&(function(e,t,i,n,r,s){const o=13;let a;const l=[];let h;l.push(n),n.y===r.y&&("Left"===t&&r.x<n.x||"Right"===t&&r.x>n.x)||n.x===r.x&&("Top"===t&&r.y<n.y||"Bottom"===t&&r.y>n.y)||("Top"===t||"Bottom"===t?"Top"===t&&r.y<n.y&&r.y>n.y-o||"Bottom"===t&&r.y>n.y&&r.y<n.y+o?(h="Top"===t?i.top-o:i.bottom+o,l.push({x:n.x,y:h}),l.push({x:n.x+(r.x-n.x)/2,y:h}),l.push({x:n.x+(r.x-n.x)/2,y:r.y})):Math.abs(n.x-r.x)>o&&("Top"===t&&r.y<n.y||"Bottom"===t&&r.y>n.y)?l.push({x:n.x,y:r.y}):(h="Top"===t?i.top-o:i.bottom+o,a=r.x<n.x?i.left-o:i.right+o,l.push({x:n.x,y:h}),l.push({x:r.x,y:h})):"Left"===t&&r.x<n.x&&r.x>n.x-o||"right"===t&&r.x>n.x&&r.x<n.x+o?(a="Left"===t?i.left-o:i.right+o,l.push({x:a,y:n.y}),l.push({x:a,y:n.y+(r.y-n.y)/2}),l.push({x:r.x,y:n.y+(r.y-n.y)/2})):Math.abs(n.y-r.y)>o&&("Left"===t&&r.x<n.x||"Right"===t&&r.x>n.x)?l.push({x:r.x,y:n.y}):(a="Left"===t?i.left-o:i.right+o,l.push({x:a,y:n.y}),l.push({x:a,y:r.y})),e.points=l)}(a,o,s,a.points[0],a.points[a.points.length-1]),r=a.points[a.points.length-1],a.direction=ws.direction(a.points[a.points.length-2],a.points[a.points.length-1])),r}function $o(e,t,i){const n=t.segments[t.segments.length-2],r=n.points[n.points.length-1];let s;("Top"!==n.direction&&"Bottom"!==n.direction||r.x!==e[1].x)&&("Left"!==n.direction&&"Right"!==n.direction||r.y!==e[1].y)||(n.points[n.points.length-1]=e[1],s=ws.direction(n.points[0],n.points[n.points.length-1]),void 0!==t.sourceWrapper&&void 0===t.sourcePortWrapper&&s===Ca(n.direction)&&("Left"===n.direction||"Right"===n.direction?n.points[0].x="Right"===n.direction?n.points[0].x-t.sourceWrapper.corners.width:n.points[0].x+t.sourceWrapper.corners.width:n.points[0].y="Bottom"===n.direction?n.points[0].y-t.sourceWrapper.corners.height:n.points[0].y+t.sourceWrapper.corners.height),n.direction=s,n.length=ws.distancePoints(n.points[0],n.points[n.points.length-1]),e.splice(0,1))}function Qo(e,t,i,n){const r=n?e.targetPadding:e.sourcePadding,s=n?e.targetPortWrapper:e.sourcePortWrapper,o=new Ds(s.bounds.x-r,s.bounds.y-r,s.actualSize.width+2*r,s.actualSize.height+2*r),a=[o.topLeft,o.topRight,o.bottomRight,o.bottomLeft];a[a.length]=a[0];const l=n?i.point:t.point;return ua({x1:t.point.x,y1:t.point.y,x2:i.point.x,y2:i.point.y},a,0,l)||l}function Jo(e,t){const i=[],n=sc(0,e.corners,t);n.push(n[0]);for(let o=0;o<n.length-1;o++)i.push({x1:(r=n[o]).x,y1:r.y,x2:(s=n[o+1]).x,y2:s.y});var r,s;return i}function Ko(e,t,i){let n;const r=e.rotateAngle+e.parentTransform;if(r){if(r<45)return t;if(r<=135)n={width:t.width,height:t.height,topLeft:t.bottomLeft,topCenter:t.middleLeft,topRight:t.topLeft,middleLeft:t.bottomCenter,center:i.center,middleRight:t.topCenter,bottomLeft:t.bottomRight,bottomCenter:t.middleRight,bottomRight:t.topRight,left:i.left,right:i.right,top:i.top,bottom:i.bottom};else if(r<=225)n={width:t.width,height:t.height,topLeft:t.bottomLeft,topCenter:t.bottomCenter,topRight:t.bottomRight,middleLeft:t.middleRight,center:i.center,middleRight:t.middleLeft,bottomLeft:t.topLeft,bottomCenter:t.topCenter,bottomRight:t.topRight,left:i.left,right:i.right,top:i.top,bottom:i.bottom};else{if(!(r<=315))return t;n={width:t.width,height:t.height,topLeft:t.topRight,topCenter:t.middleRight,topRight:t.bottomRight,middleLeft:t.topCenter,center:i.center,middleRight:t.bottomCenter,bottomLeft:t.topLeft,bottomCenter:t.middleLeft,bottomRight:t.bottomLeft,left:i.left,right:i.right,top:i.top,bottom:i.bottom}}return n}return t}function ea(e,t,i){const n=[];if(e.segments&&e.segments.length>0){let r,s=[],o=t.point;for(r=0;r<e.segments.length;r++){const t=e.segments[r];if(s=[],s.push(o),r!==e.segments.length-1?(s.push(t.point),o=t.point):s.push(i.point),e.segments[r].points=s,e.segments.length>1&&ws.equals(t.points[0],t.points[1])&&e.segments.splice(r,1),t)for(let e=0;e<t.points.length;e++)(e>0||0===r)&&n.push(t.points[e])}}return n}function ta(e,t,i){return"Top"===e||"Bottom"===e?i.x>t.x?"Right":"Left":i.y>t.y?"Bottom":"Top"}function ia(e){if("Straight"===e.type||"Bezier"===e.type){if(0===e.segments.length||e.segments.length>0&&!ws.isEmptyPoint(e.segments[e.segments.length-1].point)){const t="Bezier"===e.type?new $a(e,"segments",{type:"Bezier"},!0):new Za(e,"segments",{type:"Straight"},!0);e.segments.push(t)}}else if(0===e.segments.length||e.segments[e.segments.length-1].direction){const t=new Qa(e,"segments",{type:"Orthogonal"},!0);e.segments.push(t)}}function na(e,t,i){const n=e.segments[t],r=ca(i.point,"Left"===n.direction||"Top"===n.direction?-n.length:n.length,"Left"===n.direction||"Right"===n.direction?0:90);return e.segments[t-1].length+=n.length,e.segments[t-1].points[1]=i.point=r,e.segments.splice(t,1),--t}function ra(e,t,i){let n,r;e.sourcePortWrapper&&(r=Sa({x:e.sourcePortWrapper.offsetX,y:e.sourcePortWrapper.offsetY},hp(e.sourceWrapper),e.sourceWrapper.bounds)),aa(e.targetWrapper,t,i,e);const s=ta(i.direction,t.point,i.point);if(void 0===e.sourcePortWrapper||t.direction!==i.direction||("Top"!==t.direction&&"Bottom"!==t.direction||t.corners.center.x!==i.corners.center.x)&&("Left"!==t.direction&&"Right"!==t.direction||t.corners.center.y!==i.corners.center.y))if(i.point.x>=t.corners.left&&i.point.x<=t.corners.right&&t.point.y>=t.corners.top&&t.point.y<=t.corners.bottom)t.direction=i.point.y>t.point.y?"Bottom":"Top",n=ba(e,t,i,"Top"===t.direction?t.point.y-t.corners.top+20:t.corners.bottom-t.point.y+20);else if(e.sourcePortWrapper&&r===Ca(s)){let o;("Left"===r||"Right"===r)&&t.point.y>=t.corners.top&&t.point.y<=t.corners.bottom?(t.direction=i.point.y>t.point.y?"Bottom":"Top",o=t.corners.height/2+20):("Top"===r||"Bottom"===r)&&t.point.x>=t.corners.left&&t.point.x<=t.corners.right&&(t.direction=i.point.x>t.point.x?"Right":"Left",o=t.corners.width/2+20),t.direction&&o?n=ba(e,t,i,o,!0):(t.direction=s,n=ya(t,i))}else!e.sourcePortWrapper||r!==i.direction||"Top"!==r&&"Bottom"!==r||t.corners.center.x!==i.corners.center.x?(t.direction=s,n=ya(t,i)):(t.direction=i.point.y>t.point.y?"Bottom":"Top",n=ba(e,t,i,"Bottom"===t.direction?t.corners.bottom-t.point.y+20:t.point.y-t.corners.top+20));else t.direction=s,n=ba(e,t,i,"Top"===s||"Bottom"===s?e.sourceWrapper.height/2+20:e.sourceWrapper.width/2+20),t.point=n[1],"Left"===s||"Right"===s?(i.direction=s,i.point="Left"===s?i.corners.middleLeft:i.corners.middleRight):aa(e.targetWrapper,t,i,e),n=ba(e,t,i);return n}function sa(e,t){if(void 0!==e.targetWrapper&&void 0===e.targetPortWrapper){const i=1;if(hp(e.targetWrapper).containsPoint(t.point,i)){const n=e.targetWrapper,r=e.segments[e.segments.length-2],s=r.points[r.points.length-1],o=Ca(r.direction);"Bottom"===o?s.y<n.corners.bottom+i&&(r.points[r.points.length-1].y=n.corners.bottom+20,r.length=ws.distancePoints(r.points[0],r.points[r.points.length-1])):"Top"===o?s.y>n.corners.top-i&&(r.points[r.points.length-1].y=n.corners.top-20,r.length=ws.distancePoints(r.points[0],r.points[r.points.length-1])):"Left"===o?s.x>n.corners.left-i&&(r.points[r.points.length-1].x=n.corners.left-20,r.length=ws.distancePoints(r.points[0],r.points[r.points.length-1])):"Right"===o&&s.x<n.corners.right+i&&(r.points[r.points.length-1].x=n.corners.right+20,r.length=ws.distancePoints(r.points[0],r.points[r.points.length-1])),t.point=r.points[r.points.length-1]}}}function oa(e,t){for(let i=0;i<e.segments.length;i++){const n=e.segments[i];for(let e=0;e<n.points.length;e++)(e>0||0===i)&&t.push(n.points[e])}return t}function aa(e,t,i,n){let r,s={x:0,y:0};const o=Ko(e,e.corners,e.bounds),a=t.margin,l=t.point;if(o.bottomCenter.y+a.bottom<l.y)r="Bottom",s=o.bottomCenter;else if(o.topCenter.y-a.top>l.y)r="Top",s=o.topCenter;else if(o.middleLeft.x-a.left>l.x)r="Left",s=o.middleLeft;else if(o.middleRight.x+a.right<l.x)r="Right",s=o.middleRight;else{const e=Math.abs(l.y-o.topCenter.y),t=Math.abs(l.x-o.middleRight.x),i=Math.abs(l.y-o.bottomCenter.y),n=Math.abs(l.x-o.middleLeft.x);let a=Number.MAX_VALUE;a=e,r="Top",s=o.topCenter,a>t&&(a=t,r="Right",s=o.middleRight),a>i&&(a=i,r="Bottom",s=o.bottomCenter),a>n&&(r="Left",s=o.middleLeft)}i.point=s,i.direction=r;const h=ha(o,Ca(i.direction));i.point=da(n,0,i.point,h,e===n.targetWrapper)}function la(e,t){const i=ws.findLength({x:t.x,y:e.y},t),n=ws.findLength(t,e);let r=Math.asin(i/n);return r=180*r/Math.PI,e.x<t.x?e.y>t.y&&(r=360-r):r=e.y<t.y?180-r:180+r,r}function ha(e,t){let i;switch(t){case"Left":i=e.middleLeft;break;case"Top":i=e.topCenter;break;case"Right":i=e.middleRight;break;case"Bottom":i=e.bottomCenter}return i}function ca(e,t,i){return ws.transform(e,i,t)}function da(e,t,i,n,r){i={x:i.x,y:i.y},n={x:n.x,y:n.y};const s=r?e.targetWrapper:e.sourceWrapper,o=r?e.targetPadding:e.sourcePadding;let a,l;const h=r||"Orthogonal"===e.type?i:n,c=s,d=Sp(-s.parentTransform,s.offsetX,s.offsetY,i),p=Sp(-s.parentTransform,s.offsetX,s.offsetY,n);if("Orthogonal"===e.type){const e=5;d.x===p.x&&(d.y<p.y?d.y-=e:d.y+=e),d.y===p.y&&(d.x<p.x?d.x-=e:d.x+=e),i=Sp(s.parentTransform,s.offsetX,s.offsetY,d)}else if(r){const e=ws.findAngle(i,n);n=ws.transform({x:n.x,y:n.y},e,Math.max(s.actualSize.width,s.actualSize.height))}else{const e=ws.findAngle(n,i);i=ws.transform({x:i.x,y:i.y},e,Math.max(s.actualSize.width,s.actualSize.height))}return(e.sourcePadding||e.targetPadding)&&(a=new Ds(s.bounds.x-o,s.bounds.y-o,s.actualSize.width+2*o,s.actualSize.height+2*o)),s instanceof Eo&&s.data?(l=a?[a.topLeft,a.topRight,a.bottomRight,a.bottomLeft]:c.getPoints(),c.data.split("m").length-1+(c.data.split("M").length-1)==1&&(l[l.length]=l[0])):(l=a?[a.topLeft,a.topRight,a.bottomRight,a.bottomLeft]:sc(0,s.corners),l[l.length]=l[0]),ua({x1:i.x,y1:i.y,x2:n.x,y2:n.y},l,0,h)||i}function pa(e,t,i){return t.x=Math.round(100*t.x)/100,t.y=Math.round(100*t.y)/100,i?e.targetPoint=t:e.sourcePoint=t,t}function ua(e,t,i,n){const r=t.length;let s,o={x1:t[0].x,y1:t[0].y,x2:t[1].x,y2:t[1].y},a=ga(e,o);if(a&&(s=ws.distancePoints(a,n)),isNaN(s)||s>0)for(let l=1;l<r-1;l++){o={x1:t[l].x,y1:t[l].y,x2:t[l+1].x,y2:t[l+1].y};const i=ga(e,o);if(i){const e=ws.distancePoints(i,n);if((isNaN(s)||s>e)&&(s=e,a=i),s>=0&&s<=1)break}}return a}function ga(e,t){const i=e.x1,n=e.y1,r=e.x2,s=e.y2,o=t.x1,a=t.y1,l=t.x2,h=t.y2;let c,d,p,u,g,m,f,y,b,v,w,x,S,C;if(c=s-n,p=i-r,g=r*n-i*s,w=c*o+p*a+g,x=c*l+p*h+g,0!==w&&0!==x&&ma(w,x))return null;if(d=h-a,u=o-l,m=l*a-o*h,b=d*i+u*n+m,v=d*r+u*s+m,0!==b&&0!==v&&ma(b,v))return null;const P=c*u-d*p;return 0===P?null:(S=P<0?-P/2:P/2,S=0,C=p*m-u*g,f=C<0?(C-0)/P:(C+0)/P,C=d*g-c*m,y=C<0?(C-0)/P:(C+0)/P,{x:f,y:y})}function ma(e,t){return e*t>=0}function fa(e,t,i){switch(t.direction){case"Left":t.point.x>e.left&&(i=t.point.x-e.left>i?t.point.x-e.left+i:i);break;case"Right":t.point.x<e.right&&(i=e.right-t.point.x>i?e.right-t.point.x+i:i);break;case"Top":t.point.y>e.top&&(i=t.point.y-e.top>i?t.point.y-e.top+i:i);break;case"Bottom":t.point.y<e.bottom&&(i=e.bottom-t.point.y>i?e.bottom-t.point.y+i:i)}return i}function ya(e,t){let i;switch(e.direction){case"Left":case"Right":let n={x:t.point.x,y:e.point.y};i=ws.equals(e.point,n)||ws.equals(t.point,n)?[e.point,t.point]:[e.point,n,t.point];break;case"Top":case"Bottom":const r={x:e.point.x,y:t.point.y};i=ws.equals(e.point,r)||ws.equals(t.point,r)?[e.point,t.point]:[e.point,r,t.point]}return i}function ba(e,t,i,n,r){n||(n=20);const s=e.sourcePortWrapper;let o,a,l;const h=i.point.x-t.point.x,c=i.point.y-t.point.y;let d;if(!r&&(Math.abs(h)<.001||Math.abs(c)<.001)&&void 0===i.direction)return o=[t.point,i.point],o;if(void 0===e.targetWrapper&&Math.abs(h)<=31&&Math.abs(c)<=31){if("Left"===t.direction||"Right"===t.direction?Math.abs(c)<12&&(t.direction=t.point.y>i.point.y?"Top":"Bottom"):Math.abs(h)<12&&(t.direction=t.point.x>i.point.x?"Left":"Right"),Math.abs(h)>12||Math.abs(c)>12)return ya(t,i);n+=5}return"Left"===t.direction||"Right"===t.direction?("Right"===t.direction?(void 0!==i.direction&&"Right"===i.direction&&(n=Math.max(t.point.x,i.point.x)-t.point.x+n),t.point.x>i.point.x&&void 0===s&&(n=-n)):(void 0!==i.direction&&"Left"===i.direction&&(n=t.point.x-Math.min(t.point.x,i.point.x)+n),(t.point.x>i.point.x||void 0!==s||"Left"===t.direction)&&(n=-n)),d=i.point.y-t.point.y,a=ca(t.point,n,0),d=i.point.y-a.y,0!==d&&(l=ca(a,i.point.y-a.y,90))):"Top"!==t.direction&&"Bottom"!==t.direction||("Bottom"===t.direction?void 0!==i.direction&&"Bottom"===i.direction&&(n=Math.max(t.point.y,i.point.y)-t.point.y+n):(void 0!==i.direction&&"Top"===i.direction&&(n=t.point.y-Math.min(t.point.y,i.point.y)+n),(t.point.y>i.point.y||void 0!==s||"Top"===t.direction)&&(n=-n)),d=i.point.x-t.point.x,a=ca(t.point,n,90),d=i.point.x-a.x,0!==d&&(l=ca(a,i.point.x-a.x,0))),0===d?[t.point,i.point]:(o=[t.point,a,l,i.point],o)}function va(e,t,i,n,r=20){let s;switch(void 0===i?(e.margin={left:2,right:2,top:2,bottom:2},t.margin={left:0,right:5,top:0,bottom:5}):"Bottom"===e.direction?t.corners.top>e.corners.bottom&&t.corners.top-e.corners.bottom<20&&(r=(t.corners.top-e.corners.bottom)/2):"Top"===e.direction?t.corners.bottom<e.corners.top&&e.corners.top-t.corners.bottom<20&&(r=(e.corners.top-t.corners.bottom)/2):"Right"===e.direction?t.corners.left>e.corners.right&&t.corners.left-e.corners.right<20&&(r=(t.corners.left-e.corners.right)/2):"Left"===e.direction&&t.corners.right<e.corners.left&&e.corners.left-t.corners.right<20&&(r=(e.corners.left-t.corners.right)/2),e.direction){case"Left":r=function(e,t,i,n){return e.corners.left-e.margin.left>t.corners.left-t.margin.left&&e.corners.left-e.margin.left<=t.corners.right+t.margin.right?(("Bottom"===t.direction&&e.point.y<t.point.y||"Top"===t.direction&&e.point.y>t.point.y)&&(n+=e.corners.left-t.corners.left),n+=e.point.x-e.corners.left):n+=void 0!==i&&"Top"!==i&&"Bottom"===t.direction&&e.point.y<t.point.y||void 0!==i&&"Bottom"!==i&&"Top"===t.direction&&t.point.y<e.point.y?Math.abs(e.point.x-t.corners.right):e.point.x-e.corners.left,n}(e,t,i,r),s=ca(e.point,r,180);break;case"Right":r=function(e,t,i,n){return e.corners.right+e.margin.right<t.corners.right+t.margin.right&&e.corners.right+e.margin.right>=t.corners.left-t.margin.left?(("Bottom"===t.direction&&e.point.y<t.point.y||"Top"===t.direction&&e.point.y>t.point.y)&&(i+=t.corners.right-e.corners.right),i+=e.corners.right-e.point.x):i+=void 0!==n&&"Top"!==n&&"Bottom"===t.direction&&e.point.y<t.point.y||void 0!==n&&"Bottom"!==n&&"Top"===t.direction&&t.point.y<e.point.y?Math.abs(e.point.x-t.corners.right):e.corners.right-e.point.x,i}(e,t,r,i),s=ca(e.point,r,0);break;case"Top":r=function(e,t,i,n){return e.corners.top-e.margin.top>t.corners.top+t.margin.top&&e.corners.top-e.margin.top<=t.corners.bottom+t.margin.bottom?(("Right"===t.direction&&e.point.x<t.point.x||"Left"===t.direction&&e.point.x>t.point.x)&&(n+=e.corners.top-t.corners.top),n+=e.point.y-e.corners.top):n+=void 0!==i&&"Left"!==i&&"Right"===t.direction&&e.point.x<t.point.x||void 0!==i&&"Right"!==i&&"Left"===t.direction&&t.point.x<e.point.x?Math.abs(e.point.y-t.corners.bottom):e.point.y-e.corners.top,n}(e,t,i,r),s=ca(e.point,r,270);break;case"Bottom":r=function(e,t,i,n){return e.corners.bottom+e.margin.bottom<t.corners.bottom+t.margin.bottom&&e.corners.bottom+e.margin.bottom>=t.corners.top-t.margin.top?(("Right"===t.direction&&e.point.x<t.point.x||"Left"===t.direction&&e.point.x>t.point.x)&&(i+=t.corners.bottom-e.corners.bottom),i+=e.corners.bottom-e.point.y):i+=void 0!==n&&"Left"!==n&&"Right"===t.direction&&e.point.x<t.point.x||void 0!==n&&"Right"!==n&&"Left"===t.direction&&t.point.x<e.point.x?Math.abs(e.point.y-t.corners.bottom):e.corners.bottom-e.point.y,i}(e,t,r,i),s=ca(e.point,r,90)}return void 0!==n?n.push(s):n=[e.point,s],"Top"===e.direction||"Bottom"===e.direction?wa(s,"horizontal",e,t,n):"Right"!==e.direction&&"Left"!==e.direction||wa(s,"vertical",e,t,n),n}function wa(e,t,i,n,r){let s,o,a;"horizontal"===t?(i.margin={left:0,right:10,top:0,bottom:10},n.margin={left:0,right:10,top:0,bottom:10}):"vertical"===t&&(i.margin={left:10,right:0,top:10,bottom:0},n.margin={left:10,right:0,top:10,bottom:0});let l=20;if("horizontal"===t){switch(n.direction){case"Left":if(i.corners.right+i.margin.right<n.corners.left-n.margin.left&&(n.corners.left-i.corners.right>l||i.corners.top-i.margin.top<=n.point.y&&i.corners.bottom+i.margin.bottom>=n.point.y)){const t=Math.min(Math.abs(n.corners.left-i.corners.right)/2,20);l=i.corners.right-e.x+t}else l="Top"===i.direction&&e.y>n.point.y||"Bottom"===i.direction&&e.y<n.point.y?Math.min(n.corners.left,e.x)-e.x-20:e.x>=i.corners.left-i.margin.left&&e.x<=i.corners.right+i.margin.right?Math.min(n.corners.left,i.corners.left)-e.x-20:n.corners.left-e.x-20;break;case"Right":if(i.corners.left-i.margin.left>n.corners.right+n.margin.right&&(i.corners.left-n.corners.right>l||i.corners.top-i.margin.top<=n.point.y&&i.corners.bottom+i.margin.bottom>=n.point.y)){const t=Math.min(Math.abs(i.corners.left-n.corners.right)/2,20);l=i.corners.left-e.x-t}else l="Top"===i.direction&&e.y>n.point.y||"Bottom"===i.direction&&e.y<n.point.y?Math.max(n.corners.right,e.x)-e.x+20:e.x>=i.corners.left-i.margin.left&&e.x<=i.corners.right+i.margin.right?Math.max(n.corners.right,i.corners.right)-e.x+20:n.corners.right-e.x+20}s=ca(e,l,0),o=ca(s,n.point.y-e.y,90),a=n.point}else if("vertical"===t){switch(n.direction){case"Top":if(i.corners.bottom+i.margin.bottom<n.corners.top-n.margin.top&&(n.corners.top-i.corners.bottom>l||i.corners.left-i.margin.left<=n.point.x&&i.corners.right+i.margin.right>=n.point.x)){const t=Math.min(Math.abs(n.corners.top-i.corners.bottom)/2,20);l=i.corners.bottom-e.y+t}else l="Left"===i.direction&&e.x>n.point.x||"Right"===i.direction&&e.x<n.point.x?Math.min(n.corners.top,e.y)-e.y-20:e.y>=i.corners.top-i.margin.top&&e.y<=i.corners.bottom+i.margin.bottom?Math.min(n.corners.top,i.corners.top)-e.y-20:n.corners.top-e.y-20;break;case"Bottom":if(i.corners.top-i.margin.top>n.corners.bottom+n.margin.bottom&&(i.corners.top-n.corners.bottom>l||i.corners.left-i.margin.left<=n.point.x&&i.corners.right+i.margin.right>=n.point.x)){const t=Math.min(Math.abs(i.corners.top-n.corners.bottom)/2,20);l=i.corners.top-e.y-t}else l="Left"===i.direction&&e.x>n.point.x||"Right"===i.direction&&e.x<n.point.x?Math.max(n.corners.bottom,e.y)-e.y+20:e.y>=i.corners.top-i.margin.top&&e.y<=i.corners.bottom+i.margin.bottom?Math.max(n.corners.bottom,i.corners.bottom)-e.y+20:n.corners.bottom-e.y+20}s=ca(e,l,90),o=ca(s,n.point.x-e.x,0),a=n.point}r.push(s),r.push(o),r.push(a)}function xa(e,t){const i=e.direction;e.direction=t.direction,t.direction=i;const n=e.point;e.point=t.point,t.point=n;const r=e.corners;e.corners=t.corners,t.corners=r}function Sa(e,t,i,n){let r;const s=void 0===t?i:t,o=s.topLeft,a=s.topRight,l=s.bottomRight,h=s.bottomLeft,c=s.center,d=la(c,e),p=la(c,l),u=la(c,h),g=la(c,o),m=la(c,a);return r=d>g&&d<m?"Top":d>=p&&d<u?"Bottom":d>=u&&d<=g?"Left":"Right",r}function Ca(e){switch(e){case"Top":return"Bottom";case"Bottom":return"Top";case"Left":return"Right";case"Right":return"Left"}return"auto"}var Pa=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Oa=(()=>{class e extends Ht{}return Pa([xt("")],e.prototype,"content",void 0),Pa([xt("TopLeft")],e.prototype,"position",void 0),Pa([xt("Mouse")],e.prototype,"relativeMode",void 0),Pa([xt(!0)],e.prototype,"showTipPointer",void 0),Pa([xt("auto")],e.prototype,"width",void 0),Pa([xt("auto")],e.prototype,"height",void 0),Pa([xt("Auto")],e.prototype,"openOn",void 0),Pa([xt()],e.prototype,"animation",void 0),e})();function Ta(e){let t;{let i=new Wr;i=Ia(e.tooltip,i),t=new Wr(i),t.beforeCollision=Aa,t.beforeOpen=Ea,t.cssClass="e-diagram-tooltip",t.opensOn="custom",t.appendTo("#"+e.element.id),t.close()}return t}function Ea(e){""!==this.content&&void 0!==this.content||(e.element.style.display="none")}function Aa(e){e.collidedPosition&&e.collidedPosition!==this.position&&(e.element.style.display="none")}function Ia(e,t){return e.content?(t.content=e.content,t.position=e.position,t.showTipPointer=e.showTipPointer,t.width=e.width,t.height=e.height,t.animation=e.animation?e.animation:{close:{effect:"None"}}):t.close(),t}var Da=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Ra=(()=>{class e extends Ht{}return Da([xt()],e.prototype,"width",void 0),Da([xt()],e.prototype,"height",void 0),e})(),La=(()=>{class e extends Ht{}return Da([xt()],e.prototype,"width",void 0),Da([xt()],e.prototype,"height",void 0),Da([xt()],e.prototype,"fit",void 0),Da([xt()],e.prototype,"description",void 0),Da([xt()],e.prototype,"template",void 0),Da([xt()],e.prototype,"tooltip",void 0),e})();var za=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Ma=(()=>{class e extends Ht{}return za([xt("")],e.prototype,"id",void 0),za([xt(-1)],e.prototype,"zIndex",void 0),za([St({},Vs)],e.prototype,"margin",void 0),za([xt(!0)],e.prototype,"visible",void 0),za([St({},Oa)],e.prototype,"tooltip",void 0),za([xt(!1)],e.prototype,"excludeFromLayout",void 0),za([xt()],e.prototype,"addInfo",void 0),za([xt("None")],e.prototype,"flip",void 0),za([St({},La)],e.prototype,"symbolInfo",void 0),e})();class ka extends xo{constructor(e,t,i,n){super(),this.data="",this.nodeId="",this.annotationId="",this.diagramId="",this.diagramId=t,this.nodeId=e,this.annotationId=i,this.templateFn=lp(n)}getNodeTemplate(){return this.templateFn}get content(){return this.data}set content(e){this.data=e,this.canReset||(this.canReset=!0,this.isTemplate||(this.template=ep(this,!0)),this.canReset=!1,this.isDirt=!0)}}var ja=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Ha=(()=>{class e extends Ht{}return ja([xt("")],e.prototype,"id",void 0),ja([xt("transparent")],e.prototype,"fill",void 0),ja([xt("black")],e.prototype,"iconStrokeColor",void 0),ja([xt(0)],e.prototype,"iconStrokeWidth",void 0),ja([xt(!0)],e.prototype,"visibility",void 0),ja([xt(10)],e.prototype,"width",void 0),ja([xt(10)],e.prototype,"height",void 0),ja([xt("transparent")],e.prototype,"handleStrokeColor",void 0),ja([xt(1)],e.prototype,"handleStrokeWidth",void 0),ja([xt("")],e.prototype,"pathData",void 0),ja([xt(0)],e.prototype,"cornerRadius",void 0),ja([St({left:0,right:0,top:0,bottom:0},Vs)],e.prototype,"padding",void 0),e})(),Na=(()=>{class e extends Ha{}return ja([St({x:0,y:0},ws)],e.prototype,"offset",void 0),ja([St({},Vs)],e.prototype,"margin",void 0),e})(),_a=(()=>{class e extends Ha{}return ja([xt(.5)],e.prototype,"offset",void 0),ja([xt("Center")],e.prototype,"alignment",void 0),ja([St({x:0,y:0},ws)],e.prototype,"displacement",void 0),e})();var Ba=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};const Wa=e=>{if(e)switch(e.type){case"Bpmn":return Ga;case"UmlActivity":return Ya;case"UmlClassifier":return sl;default:return Xa}return Xa},Ua=e=>{if(e)switch(e.type){case"Straight":return Za;case"Bezier":return $a;case"Orthogonal":return Qa;default:return Za}};let Fa=(()=>{class e extends Ht{}return Ba([xt(10)],e.prototype,"width",void 0),Ba([xt(10)],e.prototype,"height",void 0),Ba([xt("Arrow")],e.prototype,"shape",void 0),Ba([St({fill:"black",strokeColor:"black",strokeWidth:1},$s)],e.prototype,"style",void 0),Ba([St({x:0,y:.5},ws)],e.prototype,"pivot",void 0),Ba([xt("")],e.prototype,"pathData",void 0),e})(),Va=(()=>{class e extends Ht{}return Ba([xt(0)],e.prototype,"angle",void 0),Ba([xt(0)],e.prototype,"distance",void 0),e})(),Xa=(()=>{class e extends Ht{}return Ba([xt("None")],e.prototype,"type",void 0),e})(),Ya=(()=>{class e extends Xa{}return Ba([xt("Object")],e.prototype,"flow",void 0),Ba([xt(30)],e.prototype,"exceptionFlowHeight",void 0),e})(),Ga=(()=>{class e extends Xa{}return Ba([xt("Sequence")],e.prototype,"flow",void 0),Ba([xt("Normal")],e.prototype,"sequence",void 0),Ba([xt("Default")],e.prototype,"message",void 0),Ba([xt("Default")],e.prototype,"association",void 0),e})(),qa=(()=>{class e extends Ht{constructor(e,t,i,n){super(e,t,i,n),this.points=[]}}return Ba([xt("Straight")],e.prototype,"type",void 0),Ba([xt(!0)],e.prototype,"allowDrag",void 0),e})(),Za=(()=>{class e extends qa{getClassName(){return"StraightSegment"}}return Ba([St({x:0,y:0},ws)],e.prototype,"point",void 0),e})(),$a=(()=>{class e extends Za{getClassName(){return"BezierSegment"}}return Ba([St({x:0,y:0},ws)],e.prototype,"point1",void 0),Ba([St({x:0,y:0},ws)],e.prototype,"point2",void 0),Ba([St({angle:0,distance:0},Va)],e.prototype,"vector1",void 0),Ba([St({angle:0,distance:0},Va)],e.prototype,"vector2",void 0),e})(),Qa=(()=>{class e extends qa{getClassName(){return"OrthogonalSegment"}}return Ba([xt(null)],e.prototype,"length",void 0),Ba([xt(null)],e.prototype,"direction",void 0),e})();function Ja(e,t,i){const n=i?45:180/(2+2/(e.height/e.width)),r=n,s=180-n,o=s+2*n,a=360-n,l=la(t,e.center);return l>r&&l<s?"top":l>s&&l<o?"right":l>o&&l<a?"bottom":"left"}function Ka(e){return!e.distance&&!e.angle}function el(e,t,i){let n=60,r={x:0,y:0};switch(i||(i=Math.abs(t.x-e.x)>Math.abs(t.y-e.y)?e.x<t.x?"right":"left":e.y<t.y?"bottom":"top"),i){case"bottom":case"top":n=Math.min(.45*Math.abs(e.y-t.y),n),r={x:e.x,y:e.y+("bottom"===i?n:-n)};break;case"right":case"left":n=Math.min(.45*Math.abs(e.x-t.x),n),r={x:e.x+("right"===i?n:-n),y:e.y}}return r}function tl(e,t,i,n,r){let s=0,o=0,a=0,l=0;const h=Number((r.distance(t,e)+r.distance(i,t)+r.distance(n,i))/3);if(0!==h)for(let c=0;c<=h;c++){const r=c/h,d=(1-r)*(1-r)*(1-r)*e.x+3*r*(1-r)*(1-r)*t.x+3*r*r*(1-r)*i.x+r*r*r*n.x,p=(1-r)*(1-r)*(1-r)*e.y+3*r*(1-r)*(1-r)*t.y+3*r*r*(1-r)*i.y+r*r*r*n.y;0===c?(s=a=d,o=l=p):(s=Math.min(d,s),o=Math.min(p,o),a=Math.max(d,a),l=Math.max(p,l))}return{x:s,y:o,width:a-s,height:l-o,left:s,top:o,right:s+(a-s),bottom:o+(l-o),center:{x:(s+(a-s))/2,y:(o+(l-o))/2}}}function il(e,t,i,n,r,s,o){const a={x:0,y:0},l=s/o;return a.x=(1-l)*(1-l)*(1-l)*t.x+3*l*(1-l)*(1-l)*i.x+3*l*l*(1-l)*n.x+l*l*l*r.x,a.y=(1-l)*(1-l)*(1-l)*t.y+3*l*(1-l)*(1-l)*i.y+3*l*l*(1-l)*n.y+l*l*l*r.y,a}let nl=(()=>{class e extends Ht{}return Ba([xt(!0)],e.prototype,"optional",void 0),Ba([xt(void 0)],e.prototype,"lowerBounds",void 0),Ba([xt(void 0)],e.prototype,"upperBounds",void 0),e})(),rl=(()=>{class e extends Ht{}return Ba([xt("OneToOne")],e.prototype,"type",void 0),Ba([St({},nl)],e.prototype,"target",void 0),Ba([St({},nl)],e.prototype,"source",void 0),e})(),sl=(()=>{class e extends Xa{}return Ba([xt("UmlClassifier")],e.prototype,"type",void 0),Ba([xt("Aggregation")],e.prototype,"relationship",void 0),Ba([xt("Directional")],e.prototype,"associationType",void 0),Ba([St({},rl)],e.prototype,"multiplicity",void 0),e})(),ol=(()=>{class e extends Ma{constructor(e,t,i,n){super(e,t,i,n),this.parentId="",this.bridges=[],this.status="None",this.shape&&"UmlActivity"===this.shape.type&&$h(i,this),i&&i.shape&&"None"!==i.shape.type&&Qh(i,this)}setPortID(e,t){if(this.targetID&&this.sourceID){const i=e.nameTable[this.targetID],n=e.nameTable[this.sourceID],r=t?i&&i.ports:n&&n.ports;let s;for(let e=0;r&&e<r.length;e++)s=r[e],this.targetPortID===s.id&&t?!(s.constraints&wo.None)&&s.constraints&wo.InConnect||(this.targetPortID=""):this.sourcePortID!==s.id||t||!(s.constraints&wo.None)&&s.constraints&wo.OutConnect||(this.sourcePortID="")}}init(e){let t;this.id||(this.id=op()),this.sourcePortID&&this.setPortID(e),this.targetPortID&&this.setPortID(e,!0);const i=new Po;let n=new Eo;n.id=this.id+"_path";let r=new Eo,s=new Eo;n=this.getSegmentElement(this,n);let o=[];o=this.getConnectorPoints(this.type),o=this.clipDecorators(this,o);const a=Ds.toBounds(o);switch(i.width=a.width,i.height=a.height,i.offsetX=a.x+i.pivot.x*a.width,i.offsetY=a.y+i.pivot.y*a.height,this.shape.type){case"Bpmn":switch(this.shape.flow){case"Sequence":t=this.getBpmnSequenceFlow();break;case"Association":t=new Eo,t.visible=!1,this.getBpmnAssociationFlow();break;case"Message":t=this.getBpmnMessageFlow(),n=this.getSegmentElement(this,n),this.updateShapePosition(this,t)}break;case"UmlActivity":switch(this.shape.flow){case"Object":this.getUMLObjectFlow();break;case"Exception":this.getUMLExceptionFlow(n)}break;case"UmlClassifier":this.getConnectorRelation()}let l=this.intermediatePoints;if("Bezier"===this.type){const e=this.segments[0],t=this.segments[this.segments.length-1];l=[ws.isEmptyPoint(t.point2)?t.bezierPoint2:t.point2,ws.isEmptyPoint(e.point1)?e.bezierPoint1:e.point1]}const h=e.getDescription;if(r=this.getDecoratorElement(o[0],l[1],this.sourceDecorator,!0,h),s=this.getDecoratorElement(o[o.length-1],l[l.length-2],this.targetDecorator,!1,h),r.id=this.id+"_srcDec",s.id=this.id+"_tarDec",n.style=this.style,n.style.fill="transparent",void 0!==h){const t=h(this,e);n.description=t||this.id}i.style.strokeColor="transparent",i.style.fill="transparent",i.style.strokeWidth=0,i.children=[n,r,s],i.id=this.id,void 0!==t&&i.children.push(t),i.offsetX=n.offsetX,i.offsetY=n.offsetY,i.width=n.width,i.height=n.height;for(let c=0;c<this.annotations.length;c++)i.children.push(this.getAnnotationElement(this.annotations[c],this.intermediatePoints,a,h,e.element.id,e.annotationTemplate));for(let c=0;c<this.fixedUserHandles.length;c++)i.children.push(this.getfixedUserHandle(this.fixedUserHandles[c],this.intermediatePoints,a));return this.wrapper=i,i}getConnectorRelation(){const e=this.shape;"Association"===e.relationship?(this.segments[0].type="Straight",this.sourceDecorator.shape="None",this.targetDecorator.shape="Arrow"):"Inheritance"===e.relationship?(this.segments[0].type="Orthogonal",this.sourceDecorator.shape="None",this.targetDecorator.shape="Arrow"):"Composition"===e.relationship||"Aggregation"===e.relationship?(this.segments[0].type="Orthogonal",this.sourceDecorator.shape="Diamond",this.targetDecorator.shape="None"):"Dependency"===e.relationship?(this.segments[0].type="Orthogonal",this.sourceDecorator.shape="None",this.targetDecorator.shape="OpenArrow"):"Realization"===e.relationship&&(this.segments[0].type="Orthogonal",this.sourceDecorator.shape="None",this.targetDecorator.shape="Arrow"),"BiDirectional"===e.associationType&&(this.sourceDecorator.shape="None",this.targetDecorator.shape="None");let t="",i="",n="",r="";e.multiplicity.source&&(e.multiplicity.source.lowerBounds=e.multiplicity.source.lowerBounds,e.multiplicity.source.upperBounds=e.multiplicity.source.upperBounds),e.multiplicity.target&&(e.multiplicity.target.lowerBounds=e.multiplicity.target.lowerBounds,e.multiplicity.target.upperBounds=e.multiplicity.target.upperBounds);const s=e.multiplicity.source,o=e.multiplicity.target;r=s.upperBounds?s.lowerBounds+"..."+s.upperBounds:s.lowerBounds,t=o.upperBounds?o.lowerBounds+"..."+o.upperBounds:o.lowerBounds,"ManyToOne"===e.multiplicity.type&&(e.multiplicity.target.optional=!1,i=r||"*",n="1"),"OneToMany"===e.multiplicity.type&&(e.multiplicity.source.optional=!1,n=t||"*",i="1"),"ManyToOne"===e.multiplicity.type&&(i=r||"*",n=t||"*"),"OneToOne"===e.multiplicity.type&&(e.multiplicity.target.optional=!1,e.multiplicity.source.optional=!1,i="1",n="1"),this.annotations=[{id:this.id+"sourcelabel",content:i,offset:0,alignment:"Before",margin:{right:5,bottom:5}},{id:this.id+"targetlabel",content:n,offset:1,alignment:"Before",margin:{right:5,bottom:5}}]}getBpmnSequenceFlow(){let e=new Eo,t=new Eo;return"Normal"===this.shape.sequence&&"Bezier"!==this.type&&(this.targetDecorator.shape="Arrow"),"Default"===this.shape.sequence&&(e=this.getSegmentElement(this,e),t=Hc(this.intermediatePoints,this),this.targetDecorator.shape="Arrow"),"Conditional"===this.shape.sequence&&(this.targetDecorator.shape="Arrow",this.sourceDecorator.shape="Diamond",t.id=this.id+this.shape.type),t}getUMLObjectFlow(){if(this.annotations)for(let e=0;e<this.annotations.length;e++)this.annotations[e].content="["+this.annotations[e].content+"]"}getUMLExceptionFlow(e){this.type="Straight";const t={x:(this.targetPoint.x+this.sourcePoint.x)/2,y:(this.targetPoint.y+this.sourcePoint.y)/2},i=t.x-this.sourcePoint.x,n=t.y-this.sourcePoint.y,r=this.shape.exceptionFlowHeight/2/Math.sqrt(i*i+n*n),s={x:t.x-i*r,y:t.y-n*r},o={x:t.x+i*r,y:t.y+n*r},a=zs();ks(a,315,t.x,t.y),this.segments=[];let l=new Za(this,"segments",{type:"Straight",point:Ms(a,o)},!0);this.segments.push(l),l=new Za(this,"segments",{type:"Straight",point:Ms(a,s)},!0),this.segments.push(l),e=this.getSegmentElement(this,e)}getBpmnAssociationFlow(){"Default"===this.shape.association&&(this.targetDecorator.shape="Arrow"),"Directional"===this.shape.association&&(this.targetDecorator.shape="Arrow"),"BiDirectional"===this.shape.association&&(this.targetDecorator.shape="Arrow",this.sourceDecorator.shape="Arrow")}getfixedUserHandle(e,t,i){const n=new Po;n.float=!0,e.id=e.id||op(),n.id=this.id+"_"+e.id,n.children=[],n.visible=e.visibility,n.width=e.width,n.height=e.height,n.style.strokeWidth=e.handleStrokeWidth,n.style.fill=e.fill,n.style.strokeColor=e.handleStrokeColor,n.cornerRadius=e.cornerRadius,this.updateAnnotation(e,t,i,n);const r=oc(e,n);return n.children.push(r),n.description=n.id,n}getBpmnMessageFlow(){const e=new Eo;return this.targetDecorator.shape="Arrow",this.targetDecorator.width=5,this.targetDecorator.height=10,this.sourceDecorator.shape="Circle","InitiatingMessage"!==this.shape.message&&"NonInitiatingMessage"!==this.shape.message||(e.id=this.id+"_"+this.shape.message,e.width=25,e.height=15,e.data="M0,0 L19.8,12.8 L40,0 L0, 0 L0, 25.5 L40, 25.5 L 40, 0",e.horizontalAlignment="Center",e.verticalAlignment="Center",e.transform=co.Self,e.style.fill="NonInitiatingMessage"===this.shape.message?"lightgrey":"white"),e}distance(e,t){return Bc(e,t)}findPath(e,t){return _c(e,t)}getAnnotationElement(e,t,i,n,r,s){let o,a;e.id=e.id||op(),r&&(e.template||"Template"===e.annotationType||s&&""===e.content)?(o=new ka(this.id,r,e.id,s),o=sp(o,e,s)):(o=new Co,o.content=e.content,o.style.textOverflow="Wrap"),o.constraints=e.constraints,o.visible=e.visibility,o.rotateAngle=e.rotateAngle,o.horizontalAlignment=e.horizontalAlignment,o.verticalAlignment=e.verticalAlignment,o.width=e.width,o.height=e.height,void 0===i.width||e.template||(o.width=(e.width||i.width)-e.margin.left-e.margin.right),o.margin=e.margin,o.id=this.id+"_"+e.id,0===i.width&&(i.width=this.style.strokeWidth),0===i.height&&(i.height=this.style.strokeWidth),o.style=e.style;const l=Cp(n);return l&&(a=l(e,this)),o.description=a||o.id,this.updateAnnotation(e,t,i,o),o}updateAnnotation(e,t,i,n,r){const s={x:0,y:0};n instanceof ka||xo||r||n.refreshTextElement(),n.width=e.width||i.width;const o=ac(t,e),a=o.point;e instanceof Ho&&e.segmentAngle&&(n.rotateAngle=e.rotateAngle+o.angle,n.rotateAngle=(n.rotateAngle+360)%360),0===i.width&&(i.width=this.style.strokeWidth),0===i.height&&(i.height=this.style.strokeWidth);const l=(a.y-i.y)/i.height;s.x=i.width*((a.x-i.x)/i.width),s.y=i.height*l;const h=function(e,t,i){t%=360;const n=225;let r,s;switch(e.alignment){case"Before":t>=45&&t<=135?(s="right",r=.5===e.offset?"center":"top"):t>=n&&t<=315?(s="left",r=.5===e.offset?"center":"bottom"):t>45&&t<n?(r="top",s=.5===e.offset?"center":"right"):(r="bottom",s=.5===e.offset?"center":"left");break;case"After":t>=45&&t<=135?(s="left",r=.5===e.offset?"center":"top"):t>=n&&t<=315?(s="right",r=.5===e.offset?"center":"bottom"):t>45&&t<n?(r="bottom",s=.5===e.offset?"center":"right"):(r="top",s=.5===e.offset?"center":"left");break;case"Center":s=d(e.horizontalAlignment)?"center":e.horizontalAlignment.toLowerCase(),r=d(e.verticalAlignment)?"center":e.verticalAlignment.toLowerCase()}if(0===e.offset||1===e.offset)switch(o=i[0],a=i[1],Math.abs(a.x-o.x)>Math.abs(a.y-o.y)?o.x<a.x?"right":"left":o.y<a.y?"bottom":"top"){case"left":s=0===e.offset?"right":"left";break;case"right":s=0===e.offset?"left":"right";break;case"bottom":r=0===e.offset?"top":"bottom";break;case"top":r=0===e.offset?"bottom":"top"}var o,a;return{hAlign:s,vAlign:r}}(e,o.angle,t),c=h.hAlign,p=h.vAlign;let u,g;"left"===c?(u="Left",s.x+=e.displacement.x):"right"===c?(u="Right",s.x-=e.displacement.x):"center"===c&&(u="Center"),"top"===p?(g="Top",s.y+=e.displacement.y):"bottom"===p?(g="Bottom",s.y-=e.displacement.y):"center"===p&&(g="Center"),n.horizontalAlignment=u,n.verticalAlignment=g,n.setOffsetWithRespectToBounds(s.x,s.y,"Absolute"),n.relativeMode="Point"}getConnectorPoints(e,t,i,n){const r=Fo(this,i,n).slice(0);return r&&r.length>0&&(this.sourcePoint=r[0],this.targetPoint=r[r.length-1]),r}clipDecorator(e,t,i,n){let r={x:0,y:0},s={x:0,y:0},o={x:0,y:0};const a=t.length;s=i?t[0]:t[a-1],o=i?t[1]:t[a-2];let l=ws.distancePoints(s,o);l=0===l?1:l;let h=1;const c=i?e.sourceWrapper:e.targetWrapper;c&&(h=c.style.strokeWidth,n&&n&go.DecoratorPropertyChange&&(h=1));const d=h-1;return r.x=Math.round(s.x+d*(o.x-s.x)/l),r.y=Math.round(s.y+d*(o.y-s.y)/l),(i&&"None"!==e.sourceDecorator.shape||!i&&"None"!==e.targetDecorator.shape)&&(r=ws.adjustPoint(r,o,!0,n&go.DecoratorPropertyChange?0:h/2)),r}clipDecorators(e,t,i){return"None"!==e.sourceDecorator.shape&&(t[0]=this.clipDecorator(e,t,!0,i)),"None"!==e.targetDecorator.shape&&(t[t.length-1]=this.clipDecorator(e,t,!1,i)),t}updateSegmentElement(e,t,i,n){let r=new Ds;const s=this.getSegmentPath(e,t,n);if("Bezier"===e.type){if(this.segments.length>0)for(let o=0;o<this.segments.length;o++){const t=this.segments[o],i=e.segments[o],n=ws.isEmptyPoint(t.point1)?i.bezierPoint1:i.point1,s=ws.isEmptyPoint(t.point2)?i.bezierPoint2:i.point2;r.uniteRect(tl(t.points[0],n,s,t.points[1],e))}}else r=Ds.toBounds(t);return i.width=r.width,i.height=r.height,i.offsetX=r.x+i.width/2,i.offsetY=r.y+i.height/2,i.data=s,e.wrapper&&(e.wrapper.offsetX=i.offsetX,e.wrapper.offsetY=i.offsetY,e.wrapper.width=r.width,e.wrapper.height=r.height),i}getSegmentElement(e,t,i,n,r=!0){let s=[];return r&&zc(e),s=this.getConnectorPoints(e.type,void 0,i),this.intermediatePoints=s,t.staticSize=!0,this.updateSegmentElement(e,s,t,n)}getDecoratorElement(e,t,i,n,r){const s=new Eo;if(s.transform=co.Self,this.updateDecoratorElement(s,e,t,i),void 0!==r){const e=r(i,this);s.description=e||"source"}return s}bridgePath(e,t,i){let n=t;if(e.bridges.length>0)if("Straight"===e.type&&e.segments.length<2)for(let r=0;r<e.bridges.length;r++){const t=e.bridges[r];t.rendered||(n+=" L"+t.startPoint.x+" "+t.startPoint.y,n+=t.path,t.rendered=!0)}else if("Orthogonal"===e.type||"Straight"===e.type&&e.segments.length>1)for(let r=0;r<e.bridges.length;r++){const t=e.bridges[r];t.segmentPointIndex===i&&(t.rendered||t.segmentPointIndex===i&&(n+=" L"+t.startPoint.x+" "+t.startPoint.y,n+=t.path,t.rendered=!0))}return n}updateDecoratorElement(e,t,i,n){e.offsetX=t.x,e.offsetY=t.y;const r=ws.findAngle(t,i),s=function(e,t){return"Custom"===e?t.pathData:Bo[e]}(n.shape,n),o=new bs(n.width,n.height);e.pivot.x=n.pivot.x,e.pivot.y=n.pivot.y,e.style=n.style,e.rotateAngle=r,e.data=s,e.canMeasurePath=!0,e.width=o.width,e.height=o.height}getSegmentPath(e,t,i){let n,r,s,o="",a=[],l=0;for(;l<t.length;)a.push({x:t[l].x,y:t[l].y}),l++;for(let h=0;h<e.bridges.length;h++)e.bridges[h].rendered=!1;if(a=this.clipDecorators(e,a,i),this.cornerRadius>0&&"Bezier"!==this.type)for(let h=0;h<a.length-1;h++){n=a[h],0===h&&(o="M"+n.x+" "+n.y);const t=ws.distancePoints(a[h],a[h+1]);t>0&&(r=h<a.length-2?ws.adjustPoint(a[h],a[h+1],!1,t<2*this.cornerRadius?t/2:this.cornerRadius):a[h+1],h>0&&(t<2*this.cornerRadius?(s=ws.adjustPoint(a[h],a[h+1],!0,t/2),h<a.length-2&&(r=null)):s=ws.adjustPoint(a[h],a[h+1],!0,this.cornerRadius)),s&&(o+="Q"+n.x+" "+n.y+" "+s.x+" "+s.y),r&&(e.bridges.length>0&&(o=this.bridgePath(e,o,h),"Orthogonal"===e.type&&(o=this.bridgePath(e,o,h+1))),o+=" L"+r.x+" "+r.y))}else if("Bezier"===this.type){let t;const n=this.segments;for(let i=0;i<n.length;i++)a.length>2&&(n[i].bezierPoint1={x:0,y:0},n[i].bezierPoint2={x:0,y:0}),!ws.isEmptyPoint(n[i].point1)||n[i].vector1.angle||n[i].vector1.distance?n[i].bezierPoint1=n[i].vector1.angle||n[i].vector1.distance?ws.transform(a[i],n[i].vector1.angle,n[i].vector1.distance):{x:n[i].point1.x||n[i].bezierPoint1.x,y:n[i].point1.y||n[i].bezierPoint1.y}:((e.sourceID||this.sourcePortID)&&this.sourceWrapper&&(t=Ja(this.sourceWrapper.bounds,a[i],!0)),n[i].bezierPoint1=el(a[i],a[i+1],t)),!ws.isEmptyPoint(n[i].point2)||n[i].vector2.angle||n[i].vector2.distance?n[i].bezierPoint2=n[i].vector2.angle||n[i].vector2.distance?ws.transform(a[i+1],n[i].vector2.angle,n[i].vector2.distance):{x:n[i].point2.x||n[i].bezierPoint2.x,y:n[i].point2.y||n[i].bezierPoint2.y}:((e.targetID||this.targetPortID)&&this.targetWrapper&&(t=Ja(this.targetWrapper.bounds,a[i+1],!0)),n[i].bezierPoint2=el(a[i+1],a[i],t));a.splice(1,0,{x:n[0].bezierPoint1.x,y:n[0].bezierPoint1.y}),a.splice(a.length-1,0,{x:n[n.length-1].bezierPoint2.x,y:n[n.length-1].bezierPoint2.y}),a=this.clipDecorators(e,a,i);for(let e=0;e<n.length;e++)0===e&&(o="M"+a[0].x+" "+a[0].y),o+="C"+n[e].bezierPoint1.x+" "+n[e].bezierPoint1.y+" "+n[e].bezierPoint2.x+" "+n[e].bezierPoint2.y+" "+(e===n.length-1?a[a.length-1].x+" "+a[a.length-1].y:n[e].points[n[e].points.length-1].x+" "+n[e].points[n[e].points.length-1].y)}else for(let h=0;h<a.length;h++)n=a[h],0===h&&(o="M"+n.x+" "+n.y),h>0&&(o=this.bridgePath(e,o,h),o+=" L"+n.x+" "+n.y);return o}updateShapeElement(e){let t;switch(e.shape.type){case"Bpmn":e.wrapper.children[3]instanceof Eo&&(t=e.wrapper.children[3]),"Message"===e.shape.flow&&this.updateShapePosition(e,t);break;case"UmlActivity":"Exception"===e.shape.flow&&this.getUMLExceptionFlow(e.wrapper.children[0])}}updateShapePosition(e,t){let i,n,r=0;const s=this.intermediatePoints;for(let o=0;o<s.length-1;o++){r+=this.distance(s[o],s[o+1]);const e=.5*r;r>=e&&(i=la(s[o],s[o+1]),n=ws.transform(s[o],i,e))}t.offsetX=n.x,t.offsetY=n.y}scale(e,t,i,n,r){let s=0,o=0;if(this.wrapper&&this.wrapper.outerBounds){const r=function(e){const t=e.wrapper.children[0].bounds;return"None"!==e.sourceDecorator.shape&&t.uniteRect(e.wrapper.children[1].bounds),"None"!==e.targetDecorator.shape&&t.uniteRect(e.wrapper.children[2].bounds),t}(this),a=(this.wrapper.bounds.width||this.style.strokeWidth||1)-2,l=(this.wrapper.bounds.height||this.style.strokeWidth||1)-2;s=r.width-a,o=r.height-l,e=(i-Math.max(s,o))/a,t=(n-Math.max(s,o))/l,s=o=Math.min(s,o)}e=t=Math.min(e,t);const a=zs();ks(a,-(r=r||this.wrapper).rotateAngle,r.offsetX,r.offsetY),js(a,e,t,r.offsetX,r.offsetY),ks(a,r.rotateAngle,r.offsetX,r.offsetY);let l=function(e,t){const i=[];for(const n of t)i.push(Ms(e,n));return i}(a,this.intermediatePoints);return this.sourcePoint=l[0],this.targetPoint=l[l.length-1],l=this.intermediatePoints=Fo(this),vc(this,l),{x:s,y:o}}getClassName(){return"Connector"}}return Ba([Ct(Wa)],e.prototype,"shape",void 0),Ba([xt(no.Default)],e.prototype,"constraints",void 0),Ba([xt(10)],e.prototype,"bridgeSpace",void 0),Ba([Pt([],Ho)],e.prototype,"annotations",void 0),Ba([St({},ws)],e.prototype,"sourcePoint",void 0),Ba([St({},ws)],e.prototype,"targetPoint",void 0),Ba([Pt([],_a)],e.prototype,"fixedUserHandles",void 0),Ba([(t=Ua,(e,i)=>{let n={set:yt([],i,t),get:bt([],i,t),enumerable:!0,configurable:!0};Object.defineProperty(e,i,n),Et(e,i,"colProp",{},t)})],e.prototype,"segments",void 0),Ba([xt("")],e.prototype,"sourceID",void 0),Ba([xt("")],e.prototype,"targetID",void 0),Ba([xt(10)],e.prototype,"hitPadding",void 0),Ba([xt(0)],e.prototype,"connectionPadding",void 0),Ba([xt("Straight")],e.prototype,"type",void 0),Ba([xt(0)],e.prototype,"cornerRadius",void 0),Ba([St({shape:"None"},Fa)],e.prototype,"sourceDecorator",void 0),Ba([St({shape:"Arrow"},Fa)],e.prototype,"targetDecorator",void 0),Ba([St({},Oa)],e.prototype,"tooltip",void 0),Ba([xt("")],e.prototype,"sourcePortID",void 0),Ba([xt("")],e.prototype,"targetPortID",void 0),Ba([xt(0)],e.prototype,"sourcePadding",void 0),Ba([St({},Ra)],e.prototype,"previewSize",void 0),Ba([St({},Ra)],e.prototype,"dragSize",void 0),Ba([xt(0)],e.prototype,"targetPadding",void 0),Ba([St({strokeWidth:1,strokeColor:"black"},Qs)],e.prototype,"style",void 0),Ba([xt(null)],e.prototype,"wrapper",void 0),e;var t})();var al=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let ll=(()=>{class e extends Ut{constructor(e,t){super(e,t),this.offset=0,this.scale=1}preRender(){this.unWireEvents(),this.wireEvents()}render(){this.updateRulerGeometry(),this.renderComplete()}getModuleName(){return"Ruler"}destroy(){this.unWireEvents(),this.notify("destroy",{}),super.destroy(),this.element.classList.remove("e-ruler")}getPersistData(){return this.addOnPersist(["loaded"])}onPropertyChanged(e,t){for(const i of Object.keys(e))switch(i){case"length":case"interval":case"segmentWidth":case"tickAlignment":case"markerColor":case"thickness":this.updateRuler()}}updateRulerGeometry(){this.element.style.textAlign="left",this.renderRulerSpace(),this.updateRuler()}renderRulerSpace(){const e=this.getRulerGeometry();let t=document.getElementById(this.element.id+"_ruler_space");return t||(t=Zd("div",{id:this.element.id+"_ruler_space",style:"height:"+e.height+"px;width:"+e.width+"px;cssFloat:left;"}),this.element.appendChild(t)),t}updateRuler(){const e=this.getRulerSize(),t=this.getRulerGeometry();let i=0,n=0;const r=new bs,s=this.getRulerSVG(t);s&&(i=this.length,r.height=e,n=this.offset,i&&i!==1/0)&&this.updateSegments(n,i+this.segmentWidth+Math.abs(n),s,e)}updateSegments(e,t,i,n){let r=e;const s={trans:0};for(;r<t;){const o=this.getNewSegment(r,i);o&&(i.appendChild(o.segment),r=this.updateSegment(e,t,o,r,s,n))}}updateSegment(e,t,i,n,r,s){const o=this.updateSegmentWidth(this.scale);return n===e?(this.startValue=Math.floor(e/o)*o/this.scale,this.startValue=this.startValue%1!=0?Number(this.startValue.toFixed(1)):this.startValue,i.label.textContent=this.startValue.toString(),this.defStartValue=n=this.startValue*this.scale,"Horizontal"===this.orientation?this.hRulerOffset=e-n:this.vRulerOffset=e-n):(this.startValue=n/this.scale,this.startValue=this.startValue%1!=0?Number(this.startValue.toFixed(1)):this.startValue,i.label.textContent=this.startValue.toString()),this.updateTickLabel(i,s),i.segment.setAttribute("transform","translate("+("Horizontal"===this.orientation?r.trans+.5+",0.5":"0.5,"+(r.trans+.5))+")"),r.trans+=o,n+o}updateTickLabel(e,t){const i=e.segment.lastChild.getBBox(),n="Horizontal"===this.orientation,r="RightOrBottom"===this.tickAlignment,s=n?2:0,o=n?r?t/2+5.5-5.5:t/2+5.5:i.height;tp(e.segment.lastChild,n?{x:s,y:o}:{x:s,y:o,transform:"rotate(270)translate("+(r?-(i.width+2)+","+(t/2-i.height):-(i.width+2)+","+(t/2-i.height/2))+")"})}getNewSegment(e,t){const i=this.createNewTicks(e,t);return{segment:i,label:this.createTickLabel(t,i)}}createNewTicks(e,t){let i,n;const r=this.updateSegmentWidth(this.scale),s=$d("g",{class:"e-ruler-segment"});for(let o=0;o<this.interval;o++)n=r/this.interval,i=this.createTick(t,n,o+1,e),s.appendChild(i);return s}getLinePoint(e,t,i){const n=this.updateSegmentWidth(this.scale),r=this.getRulerSize();return(t*=i-1)%n==0?r:.3*r}createTick(e,t,i,n){let r=this.getLinePoint(e,t,i);const s=this.getRulerSize(),o="Horizontal"===this.orientation,a="RightOrBottom"===this.tickAlignment,l=Cp(this.arrangeTick),h={ruler:void 0,tickLength:r,tickInterval:this.segmentWidth/this.interval*(i-1)};l&&l(h),r=h.tickLength;const c=t*(i-1),d=$d("line",{x1:o?c:a?s:0,y1:o?a?s:s-(s-r):c,x2:o?c:a?s-r:s-(s-r),y2:o?a?s-r:0:c,"stroke-width":"1",stroke:"black"});return d.setAttribute("class","e-ruler-tick"),d}createTickLabel(e,t){let i;return t&&(i=$d("text",{class:"e-ruler-tick-label"}),t.appendChild(i)),i}updateSegmentWidth(e){if(100!==this.segmentWidth)return this.segmentWidth;let t,i=1;for(t=100,t=100/Math.pow(2,Math.round(Math.log(e)/Math.log(2)));t>100;)i/=10,t/=10;for(;t<25;)i*=10,t*=10;return t>=25&&t%25!=0&&(t=25*Math.round(t/25)),t*e/i}createMarkerLine(e,t,i){let n;return t&&(n=e.getElementById(t.id+"_marker"),n&&n.parentNode.removeChild(n),n=$d("line",i)),n}drawRulerMarker(e,t,i){let n,r,s,o,a,l,h;const c="Horizontal"===this.orientation,d=e.getElementsByTagName("svg");for(a=0;a<d.length;a++){d[a]&&(n=d[a]);break}if(n){r=this.getRulerSize(),l={id:e.id+"_marker",x1:0,y1:0,x2:c?0:r,y2:c?r:0,stroke:this.markerColor,"stroke-width":1.5,class:"e-d-ruler-marker"},h=this.createMarkerLine(n,e,l),s=this.scale,o=this.offset-this.defStartValue;const a=(c?t.x:t.y)*s+i+o;h.setAttribute("transform","translate("+(c?a+.5+" 0.5":"0.5 "+(a+.5))+")"),n.appendChild(h)}}getRulerGeometry(){return new bs(this.element?this.element.getBoundingClientRect().width:0,this.element?this.element.getBoundingClientRect().height:0)}getRulerSize(){return this.thickness}getRulerSVG(e){let t;const i=this.getRulerSize();let n;if(this.element&&(t=document.getElementById(this.element.id+"_ruler_space"),t)){if(n=$d("svg",{id:this.element.id+"_Ruler_svg",width:"Horizontal"===this.orientation?e.width+200:i+"px",height:"Horizontal"===this.orientation?i:e.height+200+"px",style:"position:inherit;"}),t.childNodes.length>0)for(let e=t.childNodes.length-1;e>=0;e--)t.childNodes[e].parentNode.removeChild(t.childNodes[e]);t.appendChild(n)}return n}wireEvents(){}unWireEvents(){}}return al([xt(5)],e.prototype,"interval",void 0),al([xt(100)],e.prototype,"segmentWidth",void 0),al([xt("Horizontal")],e.prototype,"orientation",void 0),al([xt("RightOrBottom")],e.prototype,"tickAlignment",void 0),al([xt("red")],e.prototype,"markerColor",void 0),al([xt(25)],e.prototype,"thickness",void 0),al([xt(null)],e.prototype,"arrangeTick",void 0),al([xt(400)],e.prototype,"length",void 0),e})();function hl(e,t){let i=document.getElementById(e.element.id+(t?"_hRuler":"_vRuler"));const n=pl(e),r=ul(e);i||(i=Zd("div",{id:e.element.id+(t?"_hRuler":"_vRuler"),style:"height:"+(t?n.height:r.height+100)+"px;overflow:hidden;width:"+(t?r.width+100:n.width)+"px;position:absolute;font-size:11px;"+(t?"margin-left:"+n.width+"px;":"margin-top:"+n.height+"px;")})),e.element.insertBefore(i,e.element.firstChild);const s=t?e.rulerSettings.horizontalRuler:e.rulerSettings.verticalRuler,o=new ll(s);o.orientation=t?"Horizontal":"Vertical",o.length=(t?r.width:r.height)+s.segmentWidth,o.appendTo("#"+e.element.id+(t?"_hRuler":"_vRuler")),t?e.hRuler=o:e.vRuler=o;const a=document.getElementById(e.element.id+(t?"_hRuler":"_vRuler"));t?e.hRuler.element=a:e.vRuler.element=a}function cl(e){const t=-e.scroller.horizontalOffset,i=-e.scroller.verticalOffset;e&&e.rulerSettings.showRulers?(e.hRuler.length=0,e.vRuler.length=0,void 0!==t&&e.hRuler.element&&gl(e,e.hRuler,t,!0),void 0!==i&&e.vRuler.element&&gl(e,e.vRuler,i,!1)):dl(e)}function dl(e){Kd(e.element.id+"_hRuler"),Kd(e.element.id+"_vRuler"),Kd(e.element.id+"_overlapRuler")}function pl(e){let t=0,i=0;return e.rulerSettings.showRulers&&(t=e.rulerSettings.horizontalRuler.thickness,i=e.rulerSettings.verticalRuler.thickness),new bs(i,t)}function ul(e){const t=pl(e);let i=e.scroller.viewPortHeight,n=e.scroller.viewPortWidth;return n<e.element.clientWidth-t.width&&(n=e.element.clientWidth-t.width),i<e.element.clientHeight-t.height&&(i=e.element.clientHeight-t.height),e.hRuler&&e.hRuler.length&&(n=e.hRuler.length),e.vRuler&&e.vRuler.length&&(i=e.vRuler.length),new bs(n,i)}function gl(e,t,i,n){const r=pl(e),s=ul(e),o=n?e.rulerSettings.horizontalRuler:e.rulerSettings.verticalRuler;!function(e,t,i){let n=document.getElementById(e.element.id+(i?"_hRuler":"_vRuler"));const r=i?e.hRuler:e.vRuler;n&&e&&t&&(n.style.width=(i?t.width+r.segmentWidth:r.thickness)+"px",n.style.height=(i?r.thickness:t.height+r.segmentWidth)+"px",n=document.getElementById(e.element.id+"_overlapRuler"),n&&(i?n.style.height=r.thickness+"px":n.style.width=r.thickness+"px"))}(e,s,n),function(e,t,i){const n=document.getElementById(e.element.id+(i?"_hRuler_ruler_space":"_vRuler_ruler_space")),r=i?e.hRuler:e.vRuler;n&&e&&t&&(n.style.width=(i?t.width+2*r.segmentWidth:r.thickness)+"px",n.style.height=(i?r.thickness:t.height+2*r.segmentWidth)+"px")}(e,s,n),t.offset=i,t.scale=e.scroller.currentZoom,t.length=(n?s.width:s.height)+100,t.arrangeTick=Cp(o.arrangeTick),t.dataBind();const a=n?e.hRuler.element:e.vRuler.element;n?a.style.marginLeft=r.width-t.hRulerOffset+"px":a.style.marginTop=r.height-t.vRulerOffset+"px"}function ml(e){if(e){let t=0;return t=e instanceof jo||e instanceof Ho?e.constraints&ro.Select:e instanceof ol?e.constraints&no.Select:e.constraints&so.Select,t}return 1}function fl(e){if(e){let t=0;return t=e instanceof jo||e instanceof Ho?e.constraints&ro.Drag:e instanceof ol?e.constraints&no.Drag:e instanceof Ld?1:e.constraints&so.Drag,t}return 1}function yl(e,t){let i=0;return i=e instanceof ol?e.constraints&no.PointerEvents:e.constraints&so.PointerEvents,i}function bl(e){let t=0;return t=e instanceof ol?e.constraints&no.Delete:e.constraints&so.Delete,t}function vl(e){return e.constraints&no.DragSourceEnd}function wl(e){return e.constraints&no.DragTargetEnd}function xl(e){return e.constraints&no.DragSegmentThumb}function Sl(e){return e instanceof jo||e instanceof Ho?e.constraints&ro.Rotate:e.constraints&so.Rotate}function Cl(e){return e.constraints&so.Shadow}function Pl(e){return e instanceof Td&&e.constraints&so.InConnect?e.constraints&so.InConnect:0}function Ol(e){return e&&e.constraints&&!(e.constraints&wo.None)&&e.constraints&wo.InConnect?e.constraints&wo.InConnect:0}function Tl(e){return e instanceof Td&&e.constraints&so.OutConnect?e.constraints&so.OutConnect:0}function El(e){return e&&e.constraints&&!(e.constraints&wo.None)&&e.constraints&wo.OutConnect?e.constraints&wo.OutConnect:0}function Al(e,t){let i=0;return e instanceof jo||e instanceof Ho?i=e.constraints&ro.Resize:e&&("SouthEast"===t?i=e.constraints&so.ResizeSouthEast:"East"===t?i=e.constraints&so.ResizeEast:"NorthEast"===t?i=e.constraints&so.ResizeNorthEast:"South"===t?i=e.constraints&so.ResizeSouth:"North"===t?i=e.constraints&so.ResizeNorth:"SouthWest"===t?i=e.constraints&so.ResizeSouthWest:"West"===t?i=e.constraints&so.ResizeWest:"NorthWest"===t&&(i=e.constraints&so.ResizeNorthWest)),i}function Il(e){let t=0;return t=e instanceof ol?e.constraints&no.AllowDrop:e.constraints&so.AllowDrop,t}function Dl(e){return e.constraints&lo.Virtualization}function Rl(e){return e.tool&ho.SingleSelect}function Ll(e){return e.tool&ho.MultipleSelect}function zl(e){return e.tool&ho.ZoomPan}function Ml(e){return e.tool&ho.ContinuousDraw}function kl(e){return e.tool&ho.DrawOnce}function jl(e){return e.tool&ho.SingleSelect||e.tool&ho.MultipleSelect}function Hl(e){return e.constraints&lo.UserInteraction}function Nl(e){return e.constraints&lo.ZoomTextEdit}function _l(e){return function(e){return e.constraints&lo.ApiUpdate}(e)||e.diagramActions&go.ToolAction}function Bl(e,t){return e.constraints&wo.Draw}function Wl(e,t){return e.constraints&wo.Drag}function Ul(e){return!(e&mo.DrawSelectorBorder)}function Fl(e){return!!(e&mo.PreventRenderSelector)}var Vl=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Xl=(()=>{class e extends Ht{getClassName(){return"UserHandle"}}return Vl([xt("")],e.prototype,"name",void 0),Vl([xt("")],e.prototype,"pathData",void 0),Vl([xt("")],e.prototype,"content",void 0),Vl([xt("")],e.prototype,"source",void 0),Vl([xt("#000000")],e.prototype,"backgroundColor",void 0),Vl([xt("Top")],e.prototype,"side",void 0),Vl([xt("")],e.prototype,"borderColor",void 0),Vl([xt(.5)],e.prototype,"borderWidth",void 0),Vl([xt(25)],e.prototype,"size",void 0),Vl([xt("white")],e.prototype,"pathColor",void 0),Vl([xt(10)],e.prototype,"displacement",void 0),Vl([xt(!0)],e.prototype,"visible",void 0),Vl([xt(0)],e.prototype,"offset",void 0),Vl([St({},Vs)],e.prototype,"margin",void 0),Vl([xt("Center")],e.prototype,"horizontalAlignment",void 0),Vl([xt("Center")],e.prototype,"verticalAlignment",void 0),Vl([xt(!1)],e.prototype,"disableNodes",void 0),Vl([xt(!1)],e.prototype,"disableConnectors",void 0),Vl([xt("")],e.prototype,"template",void 0),e})();function Yl(e){return Gl[e.toString()]}let Gl={Action:"M 90 82.895 C 90 86.819 86.776 90 82.8 90 H 7.2 C 3.224 90 0 86.819 0 82.895 V 7.105 C 0 3.181 3.224 0 7.2 0 h 75.6 C 86.776 0 90 3.181 90 7.105 V 82.895 Z",Decision:"M10,19.707L0.293,10L10,0.293L19.707,10L10,19.707z",MergeNode:"M10,19.707L0.293,10L10,0.293L19.707,10L10,19.707z",InitialNode:"M10,19.5c-5.238,0-9.5-4.262-9.5-9.5S4.762,0.5,10,0.5s9.5,4.262,9.5,9.5S15.238,19.5,10,19.5z",ForkNode:"m0.75,0.75l636.00002,0l0,290l-636.00002,0l0,-290z",JoinNode:"m0.75,0.75l636.00002,0l0,290l-636.00002,0l0,-290z",TimeEvent:"M50.001,0.00286865 L25.001,25.0029 L0.000976562,0.00286865 L50.001,0.00286865 z M0.000976562,50.0029 L25.001,25.0029 L50.001,50.0029 L0.000976562,50.0029 z",AcceptingEvent:"M17.8336 32.164 L29.64 24 L17.32 16 L48.1664 16 L48.5 32 Z",SendSignal:"M48.164 31.8336 L56 23.832 L47.836 16 L16.168 16 L16.1668 31.8336 Z",ReceiveSignal:"M48.1664 31.8336 L39.836 24 L47.836 16 L16.168 16 L16.168 31.836 Z",StructuredNode:"M0,0 L50,0 L50,50 L0,50 z",Note:"M20 12 L4 12 L4 22 L22 22 L22 14 L20 14 L20 12 L22 14 Z"};var ql=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Zl=(()=>{class e extends Ht{}return ql([xt()],e.prototype,"key",void 0),ql([xt()],e.prototype,"keyModifiers",void 0),e})(),$l=(()=>{class e extends Ht{getClassName(){return"Command"}}return ql([xt("")],e.prototype,"name",void 0),ql([xt()],e.prototype,"canExecute",void 0),ql([xt()],e.prototype,"execute",void 0),ql([St({},Zl)],e.prototype,"gesture",void 0),ql([xt("")],e.prototype,"parameter",void 0),e})(),Ql=(()=>{class e extends Ht{}return ql([Pt([],$l)],e.prototype,"commands",void 0),e})(),Jl=(()=>{class e extends Ht{}return ql([xt()],e.prototype,"show",void 0),ql([xt()],e.prototype,"showCustomMenuOnly",void 0),ql([xt()],e.prototype,"items",void 0),e})();class Kl extends So{constructor(){super(...arguments),this.childTable=[],this.cellStyle={},this.desiredRowHeight=[],this.desiredCellWidth=[]}rowDefinitions(){return this.rowDefns}columnDefinitions(){return this.colDefns}addObject(e,t,i,n,r){if(this.rows.length>=t){const s=this.rows[t];if(s.cells.length>i){r=r||1,n=n||1;const o=s.cells[i];o.columnSpan=Math.max(r,o.columnSpan),o.rowSpan=Math.max(n,o.rowSpan);let a=new rh;a=e,a.rowId=t,a.columnId=i,a.columnSpan=r,this.childTable[a.id]=a,this.addObjectToCell(a,o)}}}addObjectToCell(e,t){t.children||(t.children=[]),e.style.strokeColor="black",e.style.strokeWidth=1,e.style.fill="white",t.children.push(e)}updateProperties(e,t,i,n){this.offsetX=e,this.offsetY=t,this.width=i,this.height=n}setDefinitions(e,t){this.rowDefns=e,this.colDefns=t,this.children=[],this.rows=this.rows||[];for(let i=0;i<e.length;i++){const t=e[i],n=new ih;n.cells=[];const r=new th;r.width=this.width;let s=this.colDefns;(void 0===s||s.length<1)&&(s=[r]),this.addCellInRow(s,t,n),this.rows.push(n)}}addCellInRow(e,t,i){for(let n=0;n<e.length;n++){const r=e[n],s=new nh;s.children=[],this.cellStyle.fill="none",this.cellStyle.strokeColor="none",s.id=op(),s.style=this.cellStyle,s.desiredCellWidth=s.minWidth=r.width,s.desiredCellHeight=s.minHeight=t.height,i.cells.push(s),this.children.push(s)}}calculateSize(){const e=this.rows||[];let t=0,i=0;for(let n=0;n<e.length;n++){const r=this.rows[n];i=0;for(let s=0;s<r.cells.length;s++)if(i+=r.cells[s].desiredCellWidth,s===r.cells.length-1&&(this.width&&this.width!==i&&(r.cells[s].desiredCellWidth+=this.width-i,r.cells[s].minWidth=r.cells[s].desiredCellWidth,r.cells[s].children&&r.cells[s].children.length&&(r.cells[s].children[0].width=r.cells[s].desiredCellWidth),this.colDefns[s].width=r.cells[s].desiredCellWidth),t+=r.cells[s].desiredCellHeight,n===e.length-1&&this.height&&this.height!==t)){const e=this.height-t;if(e>0){for(let t=0;t<r.cells.length;t++)r.cells[t].desiredCellHeight+=e,r.cells[t].minHeight=r.cells[t].desiredCellHeight=r.cells[t].desiredCellHeight,r.cells[t].children&&r.cells[t].children.length&&(r.cells[t].children[0].height=r.cells[t].desiredCellHeight);this.rowDefns[n].height+=e}}}}updateRowHeight(e,t,i,n){const r=this.rows[e];this.rowDefns[e].height=t,void 0!==this.height&&(this.height+=t-r.cells[0].desiredCellHeight);for(let s=0;s<r.cells.length;s++)r.cells[s].desiredCellHeight=r.cells[s].minHeight=t,r.cells[s].children&&r.cells[s].children.length&&(r.cells[s].children[0].height=t,this.setTextRefresh(r.cells[s].children[0]));if(this.desiredRowHeight[e]=t,this.measure(new bs(this.width,this.height)),this.arrange(this.desiredSize),i){const i=void 0!==n?this.calculateCellHeightBasedOnChildren(e,n):this.calculateCellHeight(e);i>t&&this.updateRowHeight(e,i,!1)}}setTextRefresh(e){if(e.children&&e.children.length){const t=e.children;for(let e=0;e<t.length;e++)t[e]instanceof Co&&t[e].refreshTextElement(),t[e]instanceof Po&&this.setTextRefresh(t[e])}}updateColumnWidth(e,t,i,n){this.colDefns[e].width=t,void 0!==this.width&&(this.width+=t-this.rows[this.rows.length-1].cells[e].desiredCellWidth);for(let r=0;r<this.rows.length;r++)this.setTextRefresh(this.rows[r].cells[0]),this.rows[r].cells[e].desiredCellWidth=this.rows[r].cells[e].minWidth=t,this.rows[r].cells[e].children&&this.rows[r].cells[e].children.length&&(this.rows[r].cells[e].children[0].width=t);if(this.desiredCellWidth[e]=t,this.measure(new bs(this.width,this.height)),this.arrange(this.desiredSize),i){const i=void 0!==n?this.calculateCellWidthBasedOnChildren(e,n):this.calculateCellWidth(e);i>t&&this.updateColumnWidth(e,i,!1)}}calculateCellWidth(e){let t,i,n;for(let r=0;r<this.rows.length;r++)n=this.rows[r].cells[e],1===n.columnSpan&&(i=n.outerBounds.width>n.bounds.width&&(0===n.children.length||void 0===n.children[0].maxWidth)?n.outerBounds.width:n.bounds.width,t=t?t<i?i:t:i);return t}calculateCellHeight(e){let t,i,n;const r=this.rows[e];for(let s=0;s<r.cells.length;s++)n=r.cells[s],i=n.outerBounds.height>n.bounds.height?n.outerBounds.height:n.bounds.height,t=t?t<i?i:t:i;return t}calculateCellSizeBasedOnChildren(e,t,i,n){let r;const s=e&&e.children.length>0?e.children[0]:void 0;if(s&&1===e.columnSpan){r="Width"===t?s.bounds.right:s.bounds.bottom,n||(n="Width"===t?s.bounds.width:s.bounds.height);for(let e=0;e<s.children.length;e++){const o=s.children[e];if(o instanceof Po&&-1===o.id.indexOf("header")){const e=("Width"===t?o.bounds.right:o.bounds.bottom)+i;if(e>r){const i=e-r+("Width"===t?s.bounds.width:s.bounds.height);n&&(n=n<i?i:n)}}}}return n}calculateCellWidthBasedOnChildren(e,t){let i,n;for(let r=0;r<this.rows.length;r++)n=this.rows[r].cells[e],i=this.calculateCellSizeBasedOnChildren(n,"Width",t,i);return i}calculateCellHeightBasedOnChildren(e,t){let i,n;const r=this.rows[e];for(let s=0;s<r.cells.length;s++)n=r.cells[s],i=this.calculateCellSizeBasedOnChildren(n,"Height",t,i);return i}addRow(e,t,i){this.rowDefns.length>0?this.rowDefns.splice(e,0,t):this.rowDefns.push(t);const n=new ih;n.cells=[],(new th).width=this.width,this.addCellInRow(this.colDefns,t,n),e>this.rows.length-1?this.rows.push(n):this.rows.splice(e,0,n),i&&(this.measure(new bs(this.width,this.height)),this.arrange(this.desiredSize))}addColumn(e,t,i){let n,r,s,o;const a=this.rows;this.colDefns.length>0?this.colDefns.splice(e,0,t):this.colDefns.push(t),void 0!==this.width&&(this.width+=t.width);for(let l=0;l<a.length;l++)n=a[l],r=this.rowDefns[l],s=t,o=new nh,o.style=this.cellStyle,o.desiredCellWidth=o.minWidth=s.width,o.desiredCellHeight=o.minHeight=r.height,o.children=[],e>n.cells.length-1?n.cells.push(o):n.cells.splice(e,0,o),this.children.push(o);i&&(this.measure(new bs(this.width,this.height)),this.arrange(this.desiredSize))}removeRow(e){let t,i;const n=this.rows[e];this.height-=this.rowDefns[e].height;for(let r=0;r<n.cells.length;r++)t=n.cells[r],this.children.splice(this.children.indexOf(t),1),i=document.getElementById(t.id+"_groupElement"),i&&i.parentElement&&i.parentElement.removeChild(i);this.rows.splice(e,1),this.rowDefns.splice(e,1),this.measure(new bs(this.width,this.height)),this.arrange(this.desiredSize)}removeColumn(e){let t,i;const n=this.rows;this.width-=this.colDefns[e].width;for(let r=0;r<n.length;r++)t=n[r].cells[e],this.children.splice(this.children.indexOf(t),1),i=document.getElementById(t.id+"_groupElement"),i&&i.parentElement&&i.parentElement.removeChild(i),n[r].cells.splice(e,1);this.colDefns.splice(e,1),this.measure(new bs(this.width,this.height)),this.arrange(this.desiredSize)}updateRowIndex(e,t){const i=this.rows[e];this.rows.splice(e,1),this.rows.splice(t,0,i);const n=this.rowDefns[e];this.rowDefns.splice(e,1),this.rowDefns.splice(t,0,n),this.measure(new bs(this.width,this.height)),this.arrange(this.desiredSize)}updateColumnIndex(e,t,i){let n,r;for(let a=e;a<this.rows.length;a++)n=this.rows[a],r=this.rows[a].cells[t],n.cells.splice(t,1),n.cells.splice(i,0,r);const s=this.colDefns[t];this.colDefns.splice(t,1),this.colDefns.splice(i,0,s);const o=this.desiredCellWidth[t];this.desiredCellWidth.splice(t,1),this.desiredCellWidth.splice(i,0,o),this.measure(new bs(this.width,this.height)),this.arrange(this.desiredSize)}measure(e){let t;if(void 0!==this.rows&&this.rows.length>0){let e=0,i=0;t=new bs(0,0),this.calculateSize();for(const r of this.rows){i=0;for(const n of r.cells){const r=n.measure(new bs(n.desiredCellWidth,n.desiredCellHeight));1===n.rowSpan&&(this.desiredRowHeight[e]=0===i||void 0===this.desiredRowHeight[e]?r.height:Math.max(r.height,this.desiredRowHeight[e])),1===n.columnSpan&&(this.desiredCellWidth[i]=0===e||void 0===this.desiredCellWidth[i]?r.width:Math.max(r.width,this.desiredCellWidth[i]),e===this.rows.length-1&&(t.width+=this.desiredCellWidth[i])),i++}t.height+=this.desiredRowHeight[e],e++}e=i=0;let n=0;for(const t of this.rows){i=0;let r=0;for(const s of t.cells){if(1!==s.columnSpan){s.desiredSize.width=0;for(let e=0;e<s.columnSpan;e++)e+i<t.cells.length&&(s.desiredSize.width+=this.desiredCellWidth[e+i],s.minWidth=s.desiredSize.width,s.measure(s.desiredSize));i++}else s.desiredSize.width=this.desiredCellWidth[r],s.measure(s.desiredSize);if(1!==s.rowSpan){s.desiredSize.height=0;for(let e=0;e<s.rowSpan;e++)e+n<this.rows.length&&(s.desiredSize.height+=this.desiredRowHeight[e+n],s.minHeight=s.desiredSize.height,s.measure(s.desiredSize))}else s.desiredSize.height=this.desiredRowHeight[n],s.measure(s.desiredSize);e++,r++}n++}}return void 0===t&&(t=super.validateDesiredSize(t,e)),super.stretchChildren(t),this.desiredSize=t,t}arrange(e,t){let i=0,n=0;if(void 0!==this.rows&&this.rows.length>0){const r=this.offsetX-e.width*this.pivot.x;let s=this.offsetY-e.height*this.pivot.y,o=r;for(const e of this.rows){o=r,i=0;for(const t of e.cells){const e=Math.max(this.desiredCellWidth[i],t.desiredSize.width),r=Math.max(this.desiredRowHeight[n],t.desiredSize.height);t.offsetX=o+e*t.pivot.x,t.offsetY=s+r*t.pivot.y,o+=this.desiredCellWidth[i],t.arrange(new bs(e,r)),i++}s+=this.desiredRowHeight[n],n++}if(t){let e,t,r,s,o;for(n=0;n<this.rows.length;n++)for(t=this.rows[n],i=0;i<t.cells.length;i++)if(e=t.cells[i],e.columnSpan>1&&this.children.splice(this.children.indexOf(e)+1,e.columnSpan-1),e.rowSpan>1)for(r=n,s=0;r+e.rowSpan-1<this.rows.length&&s<e.rowSpan-1;r++,s++)o=this.rows[r+1].cells[i],this.children.splice(this.children.indexOf(o),1)}}return this.actualSize=e,this.updateBounds(),e}}class eh{constructor(){this.height=void 0}}class th{constructor(){this.width=void 0}}class ih{constructor(){this.cells=null}}class nh extends Po{constructor(){super(...arguments),this.columnSpan=1,this.rowSpan=1}}class rh extends xo{constructor(){super(...arguments),this.rowId=0,this.columnId=0,this.rowSpan=1,this.columnSpan=1}}function sh(e,t,i,n){let r;if(ah(e,t,!0)){const s=e.isProtectedOnChange;e.protectPropertyChange(!0),r=e.nameTable[t.parentId];const o=r.wrapper;if(r&&"Canvas"===r.container.type&&!(n||o.bounds.x<=i.x&&o.bounds.right>=i.x&&o.bounds.y<=i.y&&o.bounds.bottom>=i.y||t.constraints&so.AllowMovingOutsideLane)){const i=dp(t);e.clearSelection(),hh(e,t),t.parentId="";const n={type:"ChildCollectionChanged",category:"Internal",undoObject:i,redoObject:dp(t)};e.addHistoryEntry(n),e.commandHandler.isContainer&&(e.commandHandler.isContainer=!1,e.endGroupAction()),dh(t,e)}e.protectPropertyChange(s)}}function oh(e,t){let i,n,r;return e.enableServerDataBinding(!1),e.selectedObject.helperObject?r=e.selectedObject.helperObject:(e.selectedItems.nodes.length>0||e.selectedItems.connectors.length>0)&&(t instanceof Ld&&t.nodes.length+t.connectors.length===1?(i=t.nodes.length>0?t.nodes[0]:t.connectors[0],n=e.selectedItems.wrapper.children[0]):(i=t,n=e.selectedItems.wrapper),e.selectedObject.actualObject=i,!e.currentSymbol&&(i.isLane&&Xh(i,e)&&ah(e,i)||!i.isLane&&ah(e,i)||e.constraints&lo.LineRouting&&e.selectedItems.nodes.length>0))&&(r=function(e,t){let i;const n={};for(const r of Object.keys(t))n[r]=t[r];return Lc(t)===Td&&(i=new Td(e,"nodes",n,!0),i.id=t.id,e.initObject(i)),e.updateDiagramObject(i),i}(e,{id:"helper",rotateAngle:n.rotateAngle,offsetX:n.offsetX,offsetY:n.offsetY,minWidth:n.minWidth,minHeight:n.minHeight,maxWidth:n.maxWidth,maxHeight:n.maxHeight,width:n.actualSize.width,height:n.actualSize.height,style:{strokeDashArray:"2 2",fill:"transparent",strokeColor:"#7D7D7D",strokeWidth:2}}),e.selectedObject.helperObject=r),e.enableServerDataBinding(!0),r}function ah(e,t,i){const n=i?e.nameTable[t.parentId]:e.nameTable[t.parentId]||t;return!(!n||!n.container)}function lh(e,t){const i=e.nameTable[t.parentId];"Canvas"===i.container.type&&(t.margin.left=t.offsetX-i.wrapper.bounds.x-t.width/2,t.margin.top=t.offsetY-i.wrapper.bounds.y-t.height/2),e.nodePropertyChange(t,{},{width:t.width,height:t.height,offsetX:t.offsetX,offsetY:t.offsetY,margin:{left:t.margin.left,right:t.margin.right,top:t.margin.top,bottom:t.margin.bottom},rotateAngle:t.rotateAngle}),i.isLane||(i.wrapper.measure(new bs),i.wrapper.arrange(i.wrapper.desiredSize))}function hh(e,t){if(t.parentId&&""!==t.parentId){const i=e.nameTable[t.parentId];if(i.isLane&&i.parentId){const n=e.nameTable[i.parentId],r=i.id.slice(n.id.length),s=r.substring(0,r.length-1),o=n.shape.lanes;let a;for(let e=0;e<o.length;e++)if(a=o[e],s===a.id)for(let i=0;i<a.children.length;i++)a.children[i].id===t.id&&(a.children.splice(i,1),i--)}e.deleteChild(t)}}function ch(e,t,i,n,r){if(!e.currentSymbol){e.protectPropertyChange(!0);let s=e.nameTable[t.parentId];i=e.getObject(i.id)||i;const o=-1!==e.nodes.indexOf(i)?i.id:i;if("Canvas"!==t.container.type||r){if(s){const n=s.wrapper.bounds,r=t.wrapper.bounds;"Horizontal"===s.shape.orientation?i.margin.left-=r.x-n.x:i.margin.top-=r.y-n.y-e.nameTable[t.parentId+s.shape.lanes[0].id+"_0_header"].wrapper.bounds.height}}else{const e=i.wrapper.offsetY-i.wrapper.actualSize.height/2-(t.wrapper.offsetY-t.wrapper.actualSize.height/2);i.margin.left=i.wrapper.offsetX-i.wrapper.actualSize.width/2-(t.wrapper.offsetX-t.wrapper.actualSize.width/2),i.margin.top=e}const a=e.nameTable[t.id];if(a.children||(a.children=[]),-1===a.children.indexOf(i.id)){hh(e,i),e.getObject(i.id)&&e.removeElements(i);const t=dp(i);if(e.addChild(a,o),i=e.getObject(i.id),a.isLane&&a.parentId){s=e.nameTable[a.parentId];const t=s.shape.lanes,n=a.id.slice(s.id.length),r=n.substring(0,n.length-1);for(let e=0;e<t.length;e++)a.isLane&&r===t[e].id&&(i.parentObj instanceof Mu||(i.parentObj=t[e]),t[e].children.push(i))}if(e.updateDiagramObject(i),dh(i,e),a.parentId?n||ph(a,s,i,e):e.updateDiagramObject(a),!(e.diagramActions&go.UndoRedo)){const n={type:"ChildCollectionChanged",category:"Internal",undoObject:t,redoObject:dp(i),historyAction:r?"AddNodeToLane":void 0};e.addHistoryEntry(n)}}e.protectPropertyChange(!1)}}function dh(e,t){const i=Nd(e.id+"_groupElement",t.element.id),n=Nd(e.parentId?e.parentId+"_groupElement":t.element.id+"_diagramLayer",t.element.id);i&&n&&n.appendChild(i)}function ph(e,t,i,n,r){const s=dp(e);let o,a=!1;const l=t.shape.padding,h=e.wrapper.bounds,c=e.wrapper.outerBounds,d=i.wrapper.bounds;if(t&&"SwimLane"===t.shape.type&&(h.right<d.right+l||h.bottom<d.bottom+l)){const i=t.wrapper.children[0],p=i.bounds.x,u=i.bounds.y;let g;if(h.right<d.right+l&&c.x<=h.x&&(g=d.right-h.right,o=!1,i.updateColumnWidth(e.columnIndex,h.width+g,!0,l)),h.bottom<d.bottom+l&&c.y<=h.y&&(g=d.bottom-h.bottom,o=!0,i.updateRowHeight(e.rowIndex,h.height+g,!0,l)),!(n.diagramActions&go.UndoRedo)&&(r&&(n.startGroupAction(),a=!0),void 0!==o)){const t={category:"Internal",type:o?"RowHeightChanged":"ColumnWidthChanged",undoObject:s,redoObject:dp(e)};n.addHistoryEntry(t)}t.width=t.wrapper.width=i.width,t.height=t.wrapper.height=i.height,wh(t),"Horizontal"===t.shape.orientation&&Ih(t,n,e.wrapper,e.columnIndex),Dh(n,t),n.drag(t,p-i.bounds.x,u-i.bounds.y),Ph(t,n),Ch(t)}return function(e,t,i){const n=e.nameTable[t.parentId];if(n&&n.isLane){const r=e.nameTable[n.parentId],s=r.wrapper.children[0];s.updateColumnWidth(n.columnIndex,s.columnDefinitions()[n.columnIndex].width,!0,i),s.updateRowHeight(n.rowIndex,s.rowDefinitions()[n.rowIndex].height,!0,i);const o=n.wrapper;let a;t.margin.left<i&&(t.margin.left=i),t.margin.top<i&&(t.margin.top=i);for(let t=0;t<o.children.length;t++){const i=o.children[t];if(i instanceof Po){const t=e.nameTable[i.id];if(t.isLane){a=t.wrapper;break}}}a&&("Horizontal"===r.shape.orientation?t.margin.left<i+a.actualSize.width&&(t.margin.left=i+a.actualSize.width):t.margin.top<i+a.actualSize.height&&(t.margin.top=i+a.actualSize.height)),r.wrapper.measure(new bs(r.width,r.height)),r.wrapper.arrange(r.wrapper.desiredSize),t.offsetX=t.wrapper.offsetX,t.offsetY=t.wrapper.offsetY,e.nodePropertyChange(t,{},{margin:{left:t.margin.left,top:t.margin.top}}),s.measure(new bs(s.width,s.height)),s.arrange(s.desiredSize),r.width=r.wrapper.width=r.wrapper.children[0].actualSize.width,r.height=r.wrapper.height=r.wrapper.children[0].actualSize.height}}(n,i,l),n.updateDiagramElementQuad(),a}function uh(e,t,i,n,r,s){const o=Bd(n.element.id);n.diagramRenderer.renderStackHighlighter(e,o,n.scroller.transform,t,i,r,s)}function gh(e,t,i,n,r,s,o,a){const l=new Td(e,"nodes",n,!0);if(l.parentId=i.id,l.isHeader=!!r,l.isPhase=!!s,l.isLane=!!o,a&&(l[s?"PhaseHeaderParent":"LaneHeaderParent"]=a),l.constraints&=~(so.InConnect|so.OutConnect),l.constraints|=so.HideThumbs,e.initObject(l),e.nodes.push(l),l.wrapper.children.length>0){for(let e=0;e<l.wrapper.children.length;e++){const t=l.wrapper.children[e];t instanceof xo&&(t.isCalculateDesiredSize=!1),t instanceof Co&&(t.canConsiderBounds=!1,(!r&&"Vertical"===i.shape.orientation&&s||"Vertical"!==i.shape.orientation&&o)&&(t.isLaneOrientation=!0,t.refreshTextElement()))}l.wrapper.measure(new bs(void 0,void 0)),l.wrapper.arrange(l.wrapper.desiredSize)}return l.wrapper}function mh(e,t,i,n,r,s){let o,a=0,l=0;const h=i.shape;r?(l=s,a=n,o=e.columnDefinitions()[s].width):a=h.header&&h.hasHeader?s+1:s;const c={annotations:[dp(h.phases[s].header.annotation)],maxWidth:o,id:i.id+h.phases[s].id+"_header",offsetX:i.offsetX,offsetY:i.offsetY,style:h.phases[s].style,rowIndex:a,columnIndex:l,container:{type:"Canvas",orientation:r?"Horizontal":"Vertical"}};c.annotations[0].rotateAngle=r?0:270,ml(i)||(c.constraints&=~so.Select),h.phases[s].header.id=c.id;const d=gh(t,0,i,c,!1,!0,!1,h.phases[s].id);e.addObject(d,a,l)}function fh(e,t,i,n,r,s){let o,a,l,h,c;const d=i.shape,p=d.phases.length||1;let u=s?n:d.header&&d.hasHeader?1:0;const g=d.phaseSize&&d.phases.length>0?1:0;for(let m=0;m<p;m++){let n=s?m:r+g;l=e.rows[u].cells[n],h={id:i.id+d.lanes[r].id+m,rowIndex:u,columnIndex:n,width:l.minWidth,height:l.minHeight,offsetX:i.offsetX,offsetY:i.offsetY,style:d.lanes[r].style,constraints:so.Default|so.ReadOnly|so.AllowDrop,container:{type:"Canvas",orientation:s?"Horizontal":"Vertical"}},ml(i)||(h.constraints&=~so.Select),a=gh(t,0,i,h,!1,!1,!0),a.children[0].isCalculateDesiredSize=!1,0===m&&(o={id:i.id+d.lanes[r].id+"_"+m+"_header",style:d.lanes[r].header.style,annotations:[dp(d.lanes[r].header.annotation)],offsetX:i.offsetX,offsetY:i.offsetY,rowIndex:u,columnIndex:n,container:{type:"Canvas",orientation:s?"Horizontal":"Vertical"}},o.annotations[0].rotateAngle=s?270:0,d.lanes[r].header.id=o.id,s?o.width=d.lanes[r].header.width:o.height=d.lanes[r].header.height,ml(i)||(o.constraints&=~so.Select),c=gh(t,0,i,o,!1,!1,!0,d.lanes[r].id),s&&(c.children[0].elementActions=c.children[0].elementActions|oo.HorizontalLaneHeader),a.children.push(c)),e.addObject(a,u,n),s||u++,n=s?m:r+1}}function yh(e,t){const i=new eh;i.height=t,e.push(i)}function bh(e){const t=new th;return t.width=e,t}function vh(e,t,i,n){const r=[];let s,o,a,l,h,c,d=0;const p=t.rowDefinitions().length;let u;for(let g=0;g<p;g++)for(c=t.rows[g],l=0;l<c.cells.length;l++)if(h=c.cells[l].children[0],h&&h.children&&h.children.length)for(a=1;a<h.children.length;a++)if(s=h.children[a],o=e.getObject(s.id),o&&(o.inEdges.length>0||o.outEdges.length>0))for(u=o.inEdges.concat(o.outEdges),d=0;d<u.length;d++)-1===r.indexOf(u[d])&&r.push(u[d]);return r}function wh(e){const t=e.wrapper;if(t.measure(new bs(e.width,e.height)),t.children[0]instanceof Kl){const e=t.children[0];let i=!1;e.width&&e.width<e.desiredSize.width&&(i=!0,e.width=e.desiredSize.width),e.height&&e.height<e.desiredSize.height&&(i=!0,e.height=e.desiredSize.height),i&&e.measure(new bs(e.width,e.height))}t.arrange(t.desiredSize)}function xh(e,t,i){const n=t.wrapper.children[0];let r,s,o,a,l,h,c,d;for(r=i;r<n.rows.length;r++)for(h=n.rows[r],s=0;s<h.cells.length;s++)if(c=h.cells[s],c.children&&c.children.length>0)for(o=0;o<c.children.length;o++)d=c.children[o],a=e.nameTable[d.id],a.isLane&&d.children.length>1&&(l=e.nameTable[d.children[1].id],l&&l.isLane&&(l.rowIndex=r,l.columnIndex=s)),a.rowIndex=r,a.columnIndex=s}function Sh(e,t,i){e.measure(new bs(t.width,t.height)),e.arrange(e.desiredSize);const n=i.getObject(t.parentId);i.addChild(n,t.id)}function Ch(e){if("SwimLane"===e.shape.type&&!e.shape.isLane&&!e.shape.isPhase){let t,i,n,r;const s=e.shape.lanes;let o=Ah(e);const a=e.wrapper.children[0].rowDefinitions();for(i=0;i<s.length;i++,o++)t=s[i],"Horizontal"===e.shape.orientation?(r=a[o].height,t.height!==r&&(t.height=r)):(n=e.wrapper.children[0].columnDefinitions(),r=n[o].width,t.width!==r&&(t.width=r))}}function Ph(e,t){const i=e.shape,n=i.phases;let r,s,o,a;const l=i.header&&i.hasHeader?1:0;let h=e.wrapper.children[0];const c=h.bounds.y+(i.header&&i.hasHeader?i.header.height:0);if("SwimLane"===e.shape.type&&(e=t.getObject(e.id)||e,n.length>0))if(h=e.wrapper.children[0],"Horizontal"===i.orientation)for(o=i.header&&i.hasHeader?h.rows[1]:h.rows[0],r=0;r<n.length;r++)a=o.cells[r].children[0],s=a.bounds.right-h.bounds.x,n[r].offset!==s&&(n[r].offset=s),t.nameTable[a.id].maxWidth=a.maxWidth;else for(r=0;r<n.length;r++)a=h.rows[l+r].cells[0].children[0],s=a.bounds.bottom-c,n[r].offset!==s&&(n[r].offset=s),t.nameTable[a.id].maxWidth=a.maxWidth}function Oh(e,t){if(e&&e.length>0){let i;t.lineRoutingModule&&t.constraints&lo.LineRouting&&t.lineRoutingModule.renderVirtualRegion(t,!0);for(let n=0;n<e.length;n++)i=t.getObject(e[n]),t.lineRoutingModule&&t.constraints&lo.LineRouting&&"Orthogonal"===i.type?t.lineRoutingModule.refreshConnectorSegments(t,i,!0):t.connectorPropertyChange(i,{},{sourceID:i.sourceID,targetID:i.targetID})}}function Th(e,t,i,n){const r=e.getObject(i.id),s=r.shape;let o=s.header&&s.hasHeader?1:0;const a=s.lanes,l=s.phases,h=n.wrapper.actualSize.width,c=n.wrapper.actualSize.height,d=t.wrapper.actualSize.width,p=t.wrapper.actualSize.height;"SwimLane"===r.shape.type&&("Horizontal"===s.orientation?t.isPhase?l[t.columnIndex].offset+=h-d:(o=s.phaseSize&&s.phases.length>0?o+1:o,a[t.rowIndex-o].height+=c-p):t.isPhase?l[t.rowIndex-o].offset+=c-p:(o=s.phaseSize&&s.phases.length>0?1:0,a[t.columnIndex-o].width+=h-d))}function Eh(e,t){let i;const n=e.shape;let r=n.header&&n.hasHeader?1:0;return"Horizontal"===n.orientation?(r+=n.phases.length>0?1:0,i=t.rowIndex-r):i=t.columnIndex-(n.phaseSize&&n.phases.length>0?1:0),i}function Ah(e){let t=0;const i=e.shape;return"Horizontal"===i.orientation&&(t=i.header&&i.hasHeader?1:0),i.phases.length>0&&i.phaseSize&&(t+=1),t}function Ih(e,t,i,n){const r=e.shape;if(r.phases.length>0){const e=t.nameTable[r.phases[n].header.id];e&&e.maxWidth<i.outerBounds.width&&(e.maxWidth=i.outerBounds.width,e.wrapper.maxWidth=i.outerBounds.width)}}function Dh(e,t){if(t.shape.header&&t.shape.hasHeader){const i=e.nameTable[t.wrapper.children[0].rows[0].cells[0].children[0].id];i&&i.isHeader&&i.maxWidth<t.width&&(i.maxWidth=t.width,i.wrapper.maxWidth=t.width)}}function Rh(e,t,i,n){let r;const s=e.nameTable[t.id];if("SwimLane"===s.shape.type){e.protectPropertyChange(!0);const t=s.wrapper.children[0],o=t.bounds,a=s.shape;let l,h,c,d,p,u,g,m,f,y,b=!1;const v=new Ad(a,"lanes",i,!0);c=a.header&&a.hasHeader?1:0,"Horizontal"===a.orientation&&(b=!0,c=a.phases.length>0?c+1:c);const w=vh(e,t),x=void 0!==n?n:a.lanes.length;if(c+=x,r={element:v,cause:e.diagramActions,state:"Changing",type:"Addition",cancel:!1,laneIndex:x},e.triggerEvent(vo.collectionChange,r),!r.cancel){if(b){const e=new eh;e.height=i.height,t.addRow(c,e,!1),s.height=void 0!==s.height?s.height+i.height:s.height,s.wrapper.height=t.height=s.height}else{const n=new th;n.width=i.width,t.addColumn(x+1,n,!1),s.width&&(s.width+=i.width,s.wrapper.width=t.width=s.width),e.diagramActions&go.UndoRedo||(t.rows[0].cells[0].columnSpan+=1)}if(e.diagramActions&go.UndoRedo||(v.id=""===v.id?op():v.id),void 0!==n?a.lanes.splice(n,0,v):a.lanes.push(v),r={element:v,cause:e.diagramActions,state:"Changed",type:"Addition",cancel:!1,laneIndex:x},e.triggerEvent(vo.collectionChange,r),fh(t,e,s,c,x,b),l="Horizontal"===a.orientation?e.nameTable[t.rows[c].cells[0].children[0].id]:a.header&&a.hasHeader?e.nameTable[t.rows[1].cells[c].children[0].id]:e.nameTable[t.rows[0].cells[c].children[0].id],e.diagramActions&go.UndoRedo||(h={type:"LaneCollectionChanged",changeType:"Insert",undoObject:dp(v),redoObject:dp(l),category:"Internal"},e.addHistoryEntry(h)),xh(e,s,"Horizontal"===a.orientation?c:a.header&&a.hasHeader?1:0),wh(s),Dh(e,s),d=i.children,d&&d.length>0)for(p=0;p<d.length;p++)if(f=d[p],y={x:f.wrapper.offsetX,y:f.wrapper.offsetY},"Horizontal"===a.orientation)for(m=t.rows[c].cells[u],u=0;u<t.rows[c].cells.length;u++)Lh(e,t.rows[c].cells[u],y,f);else for(g=0;g<t.rows.length;g++)m=t.rows[g].cells[c],Lh(e,m,y,f);Oh(w,e),e.drag(s,o.x-t.bounds.x,o.y-t.bounds.y)}e.protectPropertyChange(!1)}}function Lh(e,t,i,n){if(t.children&&t.children.length>0){const r=t.children[0],s=e.nameTable[r.id];r.bounds.containsPoint(i)&&e.addChild(s,n)}}function zh(e,t,i){if("SwimLane"===t.shape.type){let n,r,s,o,a,l,h;const c=t.wrapper.bounds.x,d=t.wrapper.bounds.y,p=t.shape,u=p.padding,g=p.phases;let m;const f=t.wrapper.children[0],y="Horizontal"===p.orientation;if(n=p.header&&p.hasHeader?0:-1,p.phases.length>0&&(n+=1),i.offset>(y?p.lanes[0].header.width:p.lanes[0].header.height)){for(h=0;h<g.length;h++)if(s=g[h],o=h>0?g[h-1]:s,s.offset>i.offset){if(m=h>0?i.offset-o.offset:i.offset,y){const t=f.columnDefinitions()[h];t.width-=m,a=e.nameTable[p.phases[h].header.id],a.maxWidth=a.wrapper.maxWidth=t.width,f.updateColumnWidth(h,t.width,!1);const i=new th;i.width=m,l=h,f.addColumn(h,i,!1);break}{const t=f.rowDefinitions()[h+n];t.height-=m,a=e.nameTable[p.phases[h].header.id],f.updateRowHeight(h+n,t.height,!1);const i=new eh;i.height=m,l=h,f.addRow(h+n,i,!1);break}}if(e.diagramActions&go.UndoRedo&&void 0===l){const i=e.historyManager.currentEntry.next;i.isLastPhase&&(l=g.length,function(e,t,i,n,r,s){const o=t.shape.phases[e-2],a=i.previousPhase.offset;if(r){const t=n.columnDefinitions()[e-1],i=new th;e>1?(i.width=t.width-(a-o.offset),t.width=a-o.offset):(i.width=t.width-a,t.width=a),n.updateColumnWidth(e-1,t.width,!1),n.addColumn(e,i,!1)}else{const t=n.rowDefinitions()[e],r=new eh;e>1?(r.height=i.undoObject.offset-a,t.height=a-o.offset):(r.height=t.height-a,t.height=a),n.updateRowHeight(e,t.height,!1),n.addRow(1+e,r,!1)}}(l,t,i,f,y))}const b=new Id(t.shape,"phases",i,!0);if(e.diagramActions&go.UndoRedo||(b.id+=op()),p.phases.splice(l,0,b),mh(f,e,t,n,y,l),y){if(r=e.nameTable[f.rows[n].cells[l].children[0].id],0===l&&p.header&&p.hasHeader){f.rows[0].cells[0].children=f.rows[0].cells[1].children,f.rows[0].cells[1].children=[];const e=f.rows[0];for(let t=0;t<e.cells.length;t++)e.cells[t].minWidth=void 0,e.cells[t].columnSpan=0===t?f.rows[0].cells.length:1}!function(e,t,i,n,r){const s=t.shape;let o,a,l,h,c;const d=Ah(t);for(s.header&&s.hasHeader&&(i.rows[0].cells[0].columnSpan=i.rows[0].cells.length),a=d;a<i.rows.length;a++)c=i.rows[a],l=c.cells[n-1],h=c.cells[n],o=c.cells[n+1],Mh(e,t,l,h,o,a,n);xh(e,t,1)}(e,t,f,l);const i=f.columnDefinitions();if(f.updateColumnWidth(l,i[l].width,!0,u),r.maxWidth=r.wrapper.maxWidth=i[l].width,i.length>l+1){const t=e.nameTable[f.rows[n].cells[l+1].children[0].id];f.updateColumnWidth(l+1,i[l+1].width,!0,u),t.maxWidth=t.wrapper.maxWidth=i[l+1].width}t.width=t.wrapper.width=t.wrapper.children[0].width=f.width}else{r=e.nameTable[f.rows[n+l].cells[0].children[0].id];const i=f.rowDefinitions();let s=i[n+l].height;!function(e,t,i,n,r){let s,o,a;const l=i.rows[n],h=i.rows[n+1],c=i.rows[n-1];for(let d=1;d<l.cells.length;d++)o=l.cells[d],a=h?h.cells[d]:void 0,s=c.cells[d],Mh(e,t,s,o,a,n,d);xh(e,t,1)}(e,t,f,n+l),f.updateRowHeight(n+l,s,!0,u),i.length>n+l+1&&(s=i[n+l+1].height,f.updateRowHeight(n+l+1,s,!0,u)),t.height=t.wrapper.height=t.wrapper.children[0].height=f.actualSize.height}if(wh(t),t.width=t.wrapper.actualSize.width,Dh(e,t),e.drag(t,c-t.wrapper.bounds.x,d-t.wrapper.bounds.y),Ph(t,e),!(e.diagramActions&go.UndoRedo)){const t={type:"PhaseCollectionChanged",changeType:"Insert",undoObject:dp(b),redoObject:dp(r),category:"Internal"};e.addHistoryEntry(t)}e.updateDiagramObject(t)}}}function Mh(e,t,i,n,r,s,o){let a,l;const h=t.shape,c="Horizontal"===h.orientation,d=t.wrapper.children[0];let p;const u=c?s:o;i?(a=c?i.bounds.x+i.bounds.width:i.bounds.x,l=c?i.bounds.y:i.bounds.y+i.bounds.height):(a=d.bounds.x,l=r.bounds.y);const g=new Ds(a,l,n.desiredCellWidth,n.desiredCellHeight),m=gh(e,0,t,{id:t.id+(c?h.lanes[u-2]:h.lanes[u-1]).id+op()[0],rowIndex:s,columnIndex:o,width:n.minWidth,height:n.minHeight,style:(c?h.lanes[u-2]:h.lanes[u-1]).style,constraints:so.Default|so.AllowDrop,container:{type:"Canvas",orientation:c?"Horizontal":"Vertical"}},!1,!1,!0);if(m.children[0].isCalculateDesiredSize=!1,d.addObject(m,s,o),r&&r.children&&r.children.length)for(p=0;p<r.children.length;p++)c?e.nameTable[r.children[p].id].columnIndex+=1:e.nameTable[r.children[p].id].rowIndex+=1;!function(e,t,i,n,r,s,o){let a,l,h;const c=e.nameTable[r.id],d=t||o,p=e.nameTable[c.parentId].shape.padding;if(d.children&&d.children[0].children.length>1)for(let u=1;u<d.children[0].children.length;u++)a=d.children[0].children[u],h=e.nameTable[a.id],l=s?{x:a.bounds.x,y:a.bounds.center.y}:{x:a.bounds.center.x,y:a.bounds.top},n.containsPoint(l)?(i.children[0].children.push(a),d.children[0].children.splice(u,1),u--,e.deleteChild(h),h.isLane||(h.parentId=r.id),c.children||(c.children=[]),t||(s?h.margin.left=h.wrapper.bounds.x-d.children[0].bounds.right:h.margin.top=h.wrapper.bounds.y-d.children[0].bounds.bottom),c.children.push(a.id),h.zIndex=c.zIndex+1,e.removeElements(h)):t&&(s?(h.margin.left-=i.desiredCellWidth,p>h.margin.left&&(h.margin.left=p)):(h.margin.top-=i.desiredCellHeight,p>h.margin.top&&(h.margin.top=p)))}(e,r,n,g,m,c,i)}function kh(e,t,i){if("SwimLane"===t.shape.type&&("ResizeSouth"===i||"ResizeEast"===i)){const n=t.shape,r=t.wrapper.children[0];let s,o;"ResizeSouth"===i?"Vertical"===n.orientation?s=r.rows[r.rows.length-1].cells[0]:(o=r.rows.length-1,s=r.rows[o].cells[r.rows[o].cells.length-1]):(o=n.header&&n.hasHeader?1:0,s=r.rows[o].cells[r.rows[o].cells.length-1]),e.commandHandler.select(e.nameTable[s.children[0].id])}}function jh(e,t,i,n,r,s){let o,a,l,h,c;const d=op();let p,u,g;const m=e.shape,f=m.phases,y=e.offsetX-e.wrapper.actualSize.width/2;let b=e.offsetY-e.wrapper.actualSize.height/2;if("Vertical"===m.orientation&&(b+=m.header&&m.hasHeader?m.header.height:0),!s)for(r||(e.id+=d,m&&m.header&&m.hasHeader?m.header.id+=d:m.header=void 0),o=0;f&&o<f.length;o++)h=f[o],h.id+=d;const v=r?[i.childTable[n.id]]:m.lanes;for(o=0;v&&o<v.length;o++)for(l=v[o],s||(l.id+=d),a=0;l.children&&a<l.children.length;a++)c=l.children[a],u=c.wrapper.offsetX-c.width/2,g=c.wrapper.offsetY-c.height/2,c.zIndex=-1,c.inEdges=c.outEdges=[],(s||i&&(1===i.pasteIndex||0===i.pasteIndex))&&("Vertical"===m.orientation?c.margin.top=g-b:c.margin.left=u-y),s||(c.id+=d);if(!s){if(r&&(p={shape:{lanes:v,phases:f,phaseSize:m.phaseSize,type:"SwimLane",orientation:m.orientation,header:{annotation:{content:"Title"},height:50}}},"Horizontal"===m.orientation?(p.width=e.wrapper.actualSize.width,p.height=n.wrapper.actualSize.height+m.header.height+m.phaseSize,p.offsetX=e.wrapper.offsetX+10*i.pasteIndex,p.offsetY=n.wrapper.offsetY+10*i.pasteIndex):(p.width=n.wrapper.actualSize.width,p.height=e.wrapper.actualSize.height,p.offsetX=n.wrapper.offsetX+10*i.pasteIndex,p.offsetY=e.wrapper.offsetY+10*i.pasteIndex),e=p),0!==i.pasteIndex&&(e.offsetX+=10,e.offsetY+=10),e.zIndex=-1,e=t.add(e),!r)for(const e of Object.keys(i.childTable)){const n=i.childTable[e];n.id+=d,n.sourceID+=d,n.targetID+=d,n.zIndex=-1,t.add(n)}"SVG"!==t.mode&&t.refreshDiagramLayer(),t.select([e])}return e}function Hh(e,t,i,n){let r,s=t.nodes[0];if(n||ah(e,s,!0)){let t,o,a;const l=new xo;i&&(a=e.nameTable[i].parentId,t=s=e.nameTable[i]);const h=i?t.wrapper:s.wrapper,c=e.nameTable[a||s.parentId];c&&"Grid"===c.container.type&&(r=new Po,r.children=[],!n&&s.isHeader||("Horizontal"===c.container.orientation&&s.isPhase||"Vertical"===c.container.orientation&&(s.rowIndex>0&&s.columnIndex>0||s.isLane)?(o=function(e,t,i){const n=new Ds,r="SwimLane"===e.shape.type?e.wrapper.children[0].rows:e.wrapper.rows;for(let s=i?1:0;s<r.length;s++)n.uniteRect(r[s].cells[t].bounds);return n}(c,t?t.columnIndex:s.columnIndex,!(!c.shape.header||!c.shape.hasHeader)),r.offsetX=o.center.x,r.offsetY=o.center.y,l.width=o.width,l.height=o.height):(r.offsetX=c.offsetX,r.offsetY=h.offsetY,l.width=c.wrapper.actualSize.width,l.height=h.actualSize.height)),r.children.push(l),r.measure(new bs),r.arrange(r.desiredSize))}return r}function Nh(e,t,i,n,r){r=void 0!==r?r:Eh(t,i);let s=!1;const o=t.shape.lanes[r];for(let a=o.children.length-1;a>=0;a--)n?n.id===o.children[a].id&&o.children.splice(a,1):(e.removeDependentConnector(o.children[a]),e.diagramActions&go.UndoRedo||(e.diagramActions=e.diagramActions|go.UndoRedo,s=!0),e.remove(o.children[a]),o.children.splice(a,1),s&&(e.diagramActions=e.diagramActions&~go.UndoRedo))}function _h(e){return e.children[0]}function Bh(e,t){e.nodes.splice(e.nodes.indexOf(t),1),e.removeFromAQuad(t),e.removeObjectsFromLayer(t),delete e.nameTable[t.id],e.removeElements(t)}function Wh(e,t,i,n){let r;if("SwimLane"===i.shape.type){const s=i.shape;let o;if(1===s.lanes.length)e.remove(i);else{const a=i.wrapper.bounds.x,l=i.wrapper.bounds.y;let h,c,d,p,u;const g=i.wrapper.children[0];if(o=n?s.lanes.indexOf(n):Eh(i,t),r={element:t,cause:e.diagramActions,state:"Changing",type:"Removal",cancel:!1,laneIndex:o},e.triggerEvent(vo.collectionChange,r),!r.cancel){const n=dp(s.lanes[o]);if(Nh(e,i,t,void 0,o),!(e.diagramActions&go.UndoRedo)){const i={type:"LaneCollectionChanged",changeType:"Remove",undoObject:n,redoObject:dp(t),category:"Internal"};e.addHistoryEntry(i)}s.lanes.splice(o,1);let m=t?"Horizontal"===s.orientation?t.rowIndex:t.columnIndex:Ah(i)+o;if("Horizontal"===s.orientation){for(h=g.rows[m],c=0;c<h.cells.length;c++)if(d=h.cells[c],d&&d.children.length>0)for(p=0;p<d.children.length;p++)u=d.children[p],Uh(e,u);g.removeRow(m)}else{for(i.width=void 0!==i.width?i.width-g.rows[0].cells[m].actualSize.width:i.width,c=0;c<g.rows.length;c++)if(d=g.rows[c].cells[m],d&&d.children.length>0)for(p=0;p<d.children.length;p++)u=d.children[p],Uh(e,u);g.removeColumn(m)}r={element:t,cause:e.diagramActions,state:"Changed",type:"Removal",cancel:!1,laneIndex:o},e.triggerEvent(vo.collectionChange,r),i.width=i.wrapper.width=g.width,i.height=i.wrapper.height=g.height,wh(i),"Vertical"===i.shape.orientation&&(m=0),xh(e,i,m),e.drag(i,a-i.wrapper.bounds.x,l-i.wrapper.bounds.y),e.updateDiagramObject(i)}}}}function Uh(e,t){let i,n;if(t instanceof Po){if(t.children.length>0)for(i=0;i<t.children.length;i++)t.children[i]instanceof Po&&Uh(e,t.children[i]);n=e.getObject(t.id),Bh(e,n)}}function Fh(e,t,i,n){e.protectPropertyChange(!0);let r,s=!1;const o=i.shape,a=i.wrapper.children[0],l=n?o.phases.indexOf(n):function(e,t){const i=t.shape;return"Horizontal"===i.orientation?e.columnIndex:e.rowIndex-(i.header&&i.hasHeader?1:0)}(t,i);if(o.phases.length>1){l===o.phases.length-1&&(s=!0,r=dp(o.phases[l-1]));const n=dp(o.phases[l]);if(o.phases.splice(l,1),!(e.diagramActions&go.UndoRedo)){const i={type:"PhaseCollectionChanged",changeType:"Remove",undoObject:n,previousPhase:r,redoObject:dp(t),category:"Internal",isLastPhase:s};e.addHistoryEntry(i)}"Horizontal"===o.orientation?function(e,t,i,n){let r,s,o,a,l,h,c,d,p,u,g,m;for(n=void 0!==n?n:i.columnIndex,c=0;c<t.rows.length;c++)if(r=t.rows[c],r.cells.length>1&&(s=r.cells[n],o=r.cells.length-1===n?r.cells[n-1]:r.cells[n+1],l=o.children[0],s.children.length>0))if(a=s.children[0],g=e.nameTable[a.id],0===o.children.length&&s.children.length>0)o.children=s.children,o.columnSpan=s.columnSpan-1;else{for(d=0;d<a.children.length;d++){if(u=a.children[d],u instanceof Po){if(m=e.nameTable[u.id],m.isLane||(m.parentId=l.id),r.cells.length-1===n&&(m.margin.left=m.wrapper.bounds.x-l.bounds.x,u.margin.left=m.wrapper.bounds.x-l.bounds.x),l.children.push(u),e.nameTable[l.id]){const t=e.nameTable[l.id];t.children||(t.children=[]),t.children.push(u.id)}a.children.splice(d,1),d--,g&&g.children&&-1!==g.children.indexOf(m.id)&&g.children.splice(g.children.indexOf(m.id),1)}if(r.cells.length-1!==n)for(p=0;p<l.children.length;p++){const t=l.children[p];if(t instanceof Po){const i=e.nameTable[t.id];i.margin.left=i.wrapper.bounds.x-a.bounds.x,t.margin.left=i.wrapper.bounds.x-a.bounds.x}}}if(g&&g.isPhase){const t=e.nameTable[l.id];t&&(l.maxWidth=t.wrapper.maxWidth=t.wrapper.maxWidth+=g.wrapper.maxWidth)}Bh(e,g)}const f=t.columnDefinitions()[n].width;t.removeColumn(n),n<t.columnDefinitions().length?(h=t.columnDefinitions()[n].width,h+=f,t.updateColumnWidth(n,h,!0)):(h=t.columnDefinitions()[n-1].width,h+=f,t.updateColumnWidth(n-1,h,!0))}(e,a,t,l):function(e,t,i,n,r){let s,o,a,l,h,c,d;const p=r.shape;let u,g;const m=void 0!==n?p.header?n+1:n:i.rowIndex,f=t.rows[m];let y=r.wrapper.bounds.y;const b=p.phases.length;void 0!==p.header&&p.hasHeader&&(y+=t.rowDefinitions()[0].height);const v=n===b?t.rows[m-1]:t.rows[m+1];for(a=0;a<f.cells.length;a++)if(s=f.cells[a],c=v.cells[a],d=c.children[0],s.children.length>0){const t=s.children[0],i=e.nameTable[t.id];if(n<b)for(h=0;h<d.children.length;h++)u=d.children[h],u instanceof Po&&(g=e.nameTable[u.id],g.margin.top=g.wrapper.bounds.y-(0===n?y:t.bounds.y),u.margin.top=g.wrapper.bounds.y-(0===n?y:t.bounds.y));for(l=0;l<t.children.length;l++)u=t.children[l],u instanceof Po&&(g=e.nameTable[u.id],g.parentId=d.id,n===b&&(g.margin.top=g.wrapper.bounds.y-(0===n?y:d.bounds.y),u.margin.top=g.wrapper.bounds.y-(0===n?y:d.bounds.y)),d.children.push(u),t.children.splice(l,1),l--,i.children&&-1!==i.children.indexOf(g.id)&&i.children.splice(i.children.indexOf(g.id),1));Bh(e,i)}const w=t.rowDefinitions()[m].height;t.removeRow(m),m<t.rowDefinitions().length?(o=t.rowDefinitions()[m].height,o+=w,t.updateRowHeight(m,o,!0)):(o=t.rowDefinitions()[m-1].height,o+=w,t.updateRowHeight(m-1,o,!0))}(e,a,t,l,i),Dh(e,i),xh(e,i,1),Ph(i,e),e.protectPropertyChange(!1),e.updateDiagramObject(i)}}function Vh(e,t){let i;if(e.isLane){const n=t.getObject(e.parentId);if(n&&"SwimLane"===n.shape.type&&e.isLane){const t=Eh(n,e);i=n.shape.lanes[t]}}return i}function Xh(e,t){if(e.isLane){const i=Vh(e,t);if(t.eventHandler.action.includes("Resize")||i.canMove)return!0}return!1}function Yh(e,t){for(let i=0;i<e.length;i++)if(e[i].id===t)return!0;return!1}function Gh(e,t){t instanceof Td&&(e.shape.header||(t.shape.hasHeader=!1))}function qh(e,t,i,n){return t?n:void 0!==e[i-1]?e[i-1]+n:0}function Zh(e,t){let i=[];if(t)i=e;else{for(let t=0;t<e.length;t++)i.push(e[t]);i.push(e[i.length-2]),i.push(e[i.length-2])}return i}function $h(e,t){if(t instanceof Td)switch(e.shape.shape){case"JoinNode":e.width||(t.width=20),e.height||(t.height=90),e.style&&e.style.fill||(t.style.fill="black");break;case"ForkNode":e.width||(t.width=90),e.height||(t.height=20),e.style&&e.style.fill||(t.style.fill="black");break;case"InitialNode":case"FinalNode":e.style&&e.style.fill||(t.style.fill="black")}else switch(e.shape.flow){case"Object":e.style&&e.style.strokeDashArray||(t.style.strokeDashArray="8 4"),e.style&&e.style.strokeWidth||(t.style.strokeWidth=2),e.targetDecorator&&e.targetDecorator.shape||(t.targetDecorator.shape="OpenArrow");break;case"Control":e.style&&e.style.strokeWidth||(t.style.strokeWidth=2),e.targetDecorator&&e.targetDecorator.shape||(t.targetDecorator.shape="OpenArrow"),e.sourceDecorator&&e.sourceDecorator.shape||(t.sourceDecorator.shape="None")}}function Qh(e,t){switch(e.shape.type){case"Bpmn":switch(e.shape.flow){case"Sequence":("Normal"===e.shape.sequence&&"Bezier"!==e.type||"Default"===e.shape.sequence||"Conditional"===e.shape.sequence)&&(t.targetDecorator&&t.targetDecorator.style&&(t.targetDecorator.style.fill=e.targetDecorator&&e.targetDecorator.style&&e.targetDecorator.style.fill||"black"),"Conditional"===e.shape.sequence&&t.sourceDecorator&&(t.sourceDecorator.style&&(t.sourceDecorator.style.fill=e.sourceDecorator&&e.sourceDecorator.style&&e.sourceDecorator.style.fill||"white"),t.sourceDecorator.width=e.sourceDecorator&&e.sourceDecorator.width||20,t.sourceDecorator.height=e.sourceDecorator&&e.sourceDecorator.width||10));break;case"Association":"Default"!==e.shape.association&&"Directional"!==e.shape.association&&"BiDirectional"!==e.shape.association||(t.targetDecorator&&t.targetDecorator.style&&(t.targetDecorator.style.fill=e.targetDecorator&&e.targetDecorator.style&&e.targetDecorator.style.fill||"black"),"BiDirectional"===e.shape.association&&t.sourceDecorator&&t.sourceDecorator.style&&(t.sourceDecorator.style.fill=e.sourceDecorator&&e.sourceDecorator.style&&e.sourceDecorator.style.fill||"white",t.sourceDecorator.width=e.sourceDecorator&&e.sourceDecorator.width||5,t.sourceDecorator.height=e.sourceDecorator&&e.sourceDecorator.height||10));break;case"Message":t.style&&!t.style.strokeDashArray&&(t.style.strokeDashArray=e.style&&e.style.strokeDashArray||"4 4")}break;case"UmlActivity":switch(e.shape.flow){case"Exception":"Directional"!==e.shape.association&&"BiDirectional"!==e.shape.association||(t.style.strokeDashArray=e.style&&e.style.strokeDashArray||"2 2")}break;case"UmlClassifier":let i=!1;"Association"===e.shape.relationship?i=!0:"Inheritance"===e.shape.relationship?(t.targetDecorator&&t.targetDecorator.style&&(t.targetDecorator.style.fill=e.targetDecorator&&e.targetDecorator.style&&e.targetDecorator.style.fill||"white"),t.style&&(i=!0,t.style.strokeDashArray=e.style&&e.style.strokeDashArray||"4 4")):"Composition"===e.shape.relationship?(t.sourceDecorator&&t.sourceDecorator.style&&(t.sourceDecorator.style.fill=e.sourceDecorator&&e.sourceDecorator.style&&e.sourceDecorator.style.fill||"black"),i=!0):"Aggregation"===e.shape.relationship||void 0===e.shape.relationship?(t.sourceDecorator&&t.sourceDecorator.style&&(t.sourceDecorator.style.fill=e.sourceDecorator&&e.sourceDecorator.style&&e.sourceDecorator.style.fill||"white"),i=!0):"Dependency"===e.shape.relationship?(t.sourceDecorator&&t.sourceDecorator.style&&(t.sourceDecorator.style.fill=e.sourceDecorator&&e.sourceDecorator.style&&e.sourceDecorator.style.fill||"white"),i=!0,t.style.strokeDashArray="4 4"):"Realization"===e.shape.relationship&&(t.sourceDecorator&&t.sourceDecorator.style&&(t.sourceDecorator.style.fill=e.sourceDecorator&&e.sourceDecorator.style&&e.sourceDecorator.style.fill||"white"),i=!0),i&&(t.style.strokeWidth=e.style&&e.style.strokeWidth||2)}}function Jh(e,t,i){let n;n=ws.findLength(t,e)>ws.findLength(i,e)?i:t;const r=ws.findAngle(t,i),s=ws.findAngle(n,e),o=ws.findLength(n,e),a=s+2*(r-s);return{x:n.x+o*Math.cos(a*Math.PI/180),y:n.y+o*Math.sin(a*Math.PI/180)}}function Kh(e,t,i){if(e&&e.children&&e.children.length>0){let n,r=0;for(;r<e.children.length;r++)return n=i[e.children[r]],n.shape.type===t||Kh(n,t,i)}return!1}function ec(e,t,i,n,r){if(i&&(e instanceof ol||e&&(e.shape&&"SwimLane"!==e.shape.type||void 0===e.shape))){let s;for(const o of Object.keys(i))if(s=i[o],"shape"===o&&s.type&&(e.shape={type:s.type}),s)if(Array.isArray(s)&&s.length&&s.length>0&&"annotations"!==r&&"ports"!==r)if(e[o].length>0)for(let n=0;n<=e[o].length;n++)ec(e[o],t?t[o]:void 0,i[o],"annotations"===o||"ports"===o?e:void 0,o);else ec(e[o],t?t[o]:void 0,i[o],"annotations"===o||"ports"===o?e:void 0,o);else if(s instanceof Object&&t&&"annotations"!==r&&"ports"!==r)ec(e[o],t[o],i[o]);else if("annotations"!==r&&"ports"!==r&&t&&!t[o]||!t&&e&&(e[o]||void 0!==e[o]))e[o]=i[o];else{let s;"annotations"!==r&&"ports"!==r||("annotations"===r?(e[o]&&ec(e[o],t[o],i[o]),e[o]||(Lc(n)===ol?(s=new Ho(n,"annotations",i[o]),n.annotations.push(s)):(s=new jo(n,"annotations",i[o]),n.annotations.push(s)))):e[o]?ec(e[o],t[o],i[o]):(s=new Lo(n,"ports",i[o]),n.ports.push(s)))}}}function tc(e,t){const i="Bezier"===e.type?function(e){const t=[];if("Bezier"===e.type){let i=0;for(let n=0;n<e.segments.length;n++){const r=1.5,s=e.segments[n],o=ws.isEmptyPoint(s.point1)?s.bezierPoint1:s.point1,a=ws.isEmptyPoint(s.point2)?s.bezierPoint2:s.point2,l=Number((e.distance(o,s.points[0])+e.distance(a,o)+e.distance(s.points[1],a))/r);for(let e=0;e<l-1;e+=10)t[i]=il(0,s.points[0],ws.isEmptyPoint(s.point1)?s.bezierPoint1:s.point1,ws.isEmptyPoint(s.point2)?s.bezierPoint2:s.point2,s.points[1],e,l),i++}}return t}(e):e.intermediatePoints;for(let n=0;n<i.length-1;n++){const r=i[n],s=i[n+1],o=Ds.toBounds([r,s]);if(o.Inflate(e.hitPadding),o.containsPoint(t)){const i=Jh(t,r,s),n=ic({x1:r.x,x2:s.x,y1:r.y,y2:s.y},{x1:t.x,x2:i.x,y1:t.y,y2:i.y});if(n.enabled){const i=ws.findLength(t,n.intersectPt);if(Math.abs(i)<e.hitPadding)return!0}else{const e=Ds.toBounds([t,t]);if(e.Inflate(3),e.containsPoint(r)||e.containsPoint(s))return!0}if(ws.equals(t,i))return!0}}if(e.annotations.length>0){const i=e.wrapper.children;for(let e=3;e<i.length;e++)if(i[e].bounds.containsPoint(t))return!0}return!1}function ic(e,t){const i={x:0,y:0},n=e,r=(t.y2-t.y1)*(n.x2-n.x1)-(t.x2-t.x1)*(n.y2-n.y1),s=(t.x2-t.x1)*(n.y1-t.y1)-(t.y2-t.y1)*(n.x1-t.x1),o=(n.x2-n.x1)*(n.y1-t.y1)-(n.y2-n.y1)*(n.x1-t.x1);if(0===r||(e.x1===t.x1||e.y1===t.y1)&&(e.x2===t.x2||e.y2===t.y2)&&(0===s||0===o)&&r>0)return{enabled:!1,intersectPt:i};const a=s/r,l=o/r;return a>=0&&a<=1&&l>=0&&l<=1?(i.x=n.x1+a*(n.x2-n.x1),i.y=n.y1+a*(n.y2-n.y1),{enabled:!0,intersectPt:i}):{enabled:!1,intersectPt:i}}function nc(e,t,i,n){const r=ic(rc(e.x,e.y,t.x,t.y),rc(i.x,i.y,n.x,n.y));return r.enabled?r.intersectPt:{x:0,y:0}}function rc(e,t,i,n){return{x1:Number(e)||0,y1:Number(t)||0,x2:Number(i)||0,y2:Number(n)||0}}function sc(e,t,i){const n=[],r={x:t.topRight.x+(i=i||0),y:t.topRight.y},s={x:t.bottomRight.x,y:t.bottomRight.y-i},o={x:t.bottomLeft.x,y:t.bottomLeft.y+i};return n.push({x:t.topLeft.x-i,y:t.topLeft.y}),n.push(r),n.push(s),n.push(o),n}function oc(e,t){const i=new Eo;return i.data=e.pathData,i.height=e.height>10?e.height-(e.padding.bottom+e.padding.top):e.height,i.width=e.width>10?e.width-(e.padding.left+e.padding.right):e.width,i.visible=t.visible,i.id=t.id+"_shape",i.inversedAlignment=!1,i.horizontalAlignment="Center",i.verticalAlignment="Center",i.style={fill:e.iconStrokeColor,strokeColor:e.iconStrokeColor,strokeWidth:e.iconStrokeWidth},i.setOffsetWithRespectToBounds(.5,.5,"Fraction"),i.relativeMode="Object",i.description=t.description||"",i}function ac(e,t,i){const n=lc(e,t),r=ws.findAngle(e[n.index],e[n.index+1]),s=function(e){let t;t=e instanceof _a?0:void 0===e.content?10:0;let i=0;switch(e.alignment){case"Center":i=0;break;case"Before":i=-(0+t);break;case"After":i=0+t}return i}(t),o=ws.transform(n.point,r+45,s);return n.point=o,n.angle=r,n}function lc(e,t){let i,n,r=0,s=t.offset;const o=[];let a,l;for(let c=0;c<e.length-1;c++)r+=ws.distancePoints(e[c],e[c+1]),o.push(r);const h=s*r;for(let c=0;c<o.length;c++){if(o[c]>=h)return n=ws.findAngle(e[c],e[c+1]),i=ws.transform(e[c],n,h-(a||0)),l=c,{point:i,index:l};a=o[c]}return{point:i,index:l}}function hc(e,t){if(e instanceof Td&&e.children)for(let i=0;i<e.children.length;i++)t.nameTable[e.children[i]].children&&hc(e,t),t.removeFromAQuad(t.nameTable[e.children[i]]),t.removeObjectsFromLayer(t.nameTable[e.children[i]]),delete t.nameTable[e.children[i]]}function cc(e,t){if(e&&e.children&&e.children.length>0)for(let i=0;i<e.children.length;i++){const n=e.children[i];n instanceof Po&&cc(n,t)}return-1===t.indexOf(e.id)&&t.push(e.id),t}function dc(e,t,i,n){i=function(e,t){const i=[];let n;const r=new Mu;if(e.getClassName)switch(e.getClassName()){case"Diagram":n=new Mu;break;case"Node":n=new Td(r,"",i);break;case"Path":n=new ed(r,"",i);break;case"Native":n=new td(r,"",i);break;case"Html":n=new id(r,"",i);break;case"Image":n=new nd(r,"",i);break;case"Text":n=new rd(r,"",i);break;case"BasicShape":n=new sd(r,"",i);break;case"FlowShape":n=new od(r,"",i);break;case"BpmnShape":n=new fd(r,"",i);break;case"UmlActivityShape":n=new yd(r,"",i);break;case"UmlClassifierShape":n=new Od(r,"",i);break;case"SwimLane":n=new Dd(r,"",i),e.header&&(n.header=new Ed(r,"",i),n.header.style.fill="");break;case"ShapeAnnotation":n=new jo(r,"",i);break;case"PointPort":n=new Lo(r,"",i);break;case"BpmnGateway":n=new ad(r,"",i);break;case"BpmnDataObject":n=new ld(r,"",i);break;case"BpmnEvent":n=new cd(r,"",i);break;case"BpmnSubEvent":n=new dd(r,"",i);break;case"BpmnActivity":n=new gd(r,"",i);break;case"BpmnAnnotation":n=new md(r,"",i);break;case"MethodArguments":n=new bd(r,"",i);break;case"UmlClassAttribute":n=new vd(r,"",i);break;case"UmlClassMethod":n=new wd(r,"",i);break;case"UmlClass":n=new xd(r,"",i);break;case"UmlInterface":n=new Sd(r,"",i);break;case"UmlEnumerationMember":n=new Cd(r,"",i);break;case"UmlEnumeration":n=new Pd(r,"",i);break;case"Lane":n=new Ad(r,"",i);break;case"Phase":n=new Id(r,"",i);break;case"ChildContainer":n=new Rd;break;case"Connector":n=new ol(r,"",i);break;case"StraightSegment":n=new Za(r,"",i);break;case"BezierSegment":n=new $a(r,"",i);break;case"OrthogonalSegment":n=new Qa(r,"",i);break;case"PathAnnotation":n=new Ho(r,"",i);break;case"Stop":n=new Ys(r,"",i);break;case"Point":n=t||new ws(r,"",i);break;case"UserHandle":n=new Xl(r,"",i);break;case"Command":n=new $l(r,"",i)}else n=t;return n}(t,i);let r=[];r=r.concat(Object.keys(e));for(const s of r)t instanceof Td&&(n="shape"===s),e[s]instanceof Array?pc(e,i,t,s):e[s]instanceof Object&&i&&i[s]?"wrapper"!==s&&(e[s]=dc(e[s],t[s],i[s],n)):(i&&e[s]===i[s]||void 0===e[s])&&(n&&"type"===s||t instanceof Dd&&"orientation"===s||delete e[s]),"[]"!==JSON.stringify(e[s])&&"{}"!==JSON.stringify(e[s])&&void 0!==e[s]||delete e[s];return e}function pc(e,t,i,n){if(0===e[n].length)delete e[n];else if(e[n].every(e=>"number"==typeof e)){let i,r=!0;for(i=0;i<e[n].length;i++)r=!(!r||e[n][i]!==t[n][i]);r&&delete e[n]}else{let r;if("layers"===n&&(e[n].splice(0,1),0===e[n].length&&delete e[n]),e[n])for(r=e[n].length-1;r>=0;r--)"nodes"!==n&&"connectors"!==n||(e[n][r].wrapper=null),"dataManager"!==n&&(e[n][r]=dc(e[n][r],i[n][r],void 0!==t[n]?t[n][r]:[]),"[]"!==JSON.stringify(e[n][r])&&"{}"!==JSON.stringify(e[n][r])&&void 0!==e[n][r]||e[n].splice(r,1))}}function uc(e,t){const i=t.style,n=t;t.canApplyStyle=!0;for(const r of Object.keys(e))switch(r){case"fill":i.fill=e.fill,i instanceof Qs&&(i.fill="transparent");break;case"textOverflow":i.textOverflow=e.textOverflow;break;case"opacity":i.opacity=e.opacity;break;case"strokeColor":i.strokeColor=e.strokeColor;break;case"strokeDashArray":i.strokeDashArray=e.strokeDashArray;break;case"strokeWidth":i.strokeWidth=e.strokeWidth;break;case"bold":i.bold=e.bold;break;case"color":i.color=e.color;break;case"textWrapping":i.textWrapping=e.textWrapping;break;case"fontFamily":i.fontFamily=e.fontFamily;break;case"fontSize":i.fontSize=e.fontSize;break;case"italic":i.italic=e.italic;break;case"textAlign":i.textAlign=e.textAlign;break;case"whiteSpace":i.whiteSpace=e.whiteSpace;break;case"textDecoration":i.textDecoration=e.textDecoration;break;case"gradient":if(i.gradient){gc(e.gradient,i.gradient);break}}t instanceof Co&&n.refreshTextElement()}function gc(e,t){for(const i of Object.keys(e))switch(i){case"type":t.type=e.type;break;case"x1":t.x1=e.x1;break;case"x2":t.x2=e.x2;break;case"y1":t.y1=e.y1;break;case"y2":t.y2=e.y2;break;case"cx":t.cx=e.cx;break;case"cy":t.cy=e.cy;break;case"fx":t.fx=e.fx;break;case"fy":t.fy=e.fy;break;case"r":t.r=e.r;break;case"stops":t.stops=e.stops}}function mc(e,t,i){e.width=t.width,e.height=t.height,e.minHeight=t.minHeight,e.maxHeight=t.maxHeight,e.minWidth=t.minWidth,e.maxWidth=t.maxWidth,e.horizontalAlignment=t.wrapper.children[0].horizontalAlignment,e.verticalAlignment=t.wrapper.children[0].verticalAlignment,e.relativeMode=t.wrapper.children[0].relativeMode,e.visible=t.wrapper.children[0].visible,t.shape instanceof rd&&(e.margin=t.shape.margin),e.id=t.wrapper.children[0].id,e.style=t.style;for(const n of i.views)Kd(t.id+"_groupElement",n),Kd(t.id+"_content_groupElement",n),Kd(t.id+"_html_element",n);t.wrapper.children.splice(0,1),t.wrapper.children.splice(0,0,e)}function fc(e){const t=new Po;t.style.fill="transparent";const i="M 25 50 C 11.21 50 0 38.79 0 25 C 0 11.21 11.21 0 25 0 C 38.78 0 50 11.21 50 25 C 50 38.79 38.78 50 25 50",n=new Eo;n.data=i,n.id=e.id+"_0_finalNode",n.horizontalAlignment="Center",n.verticalAlignment="Center",n.relativeMode="Object",n.style.strokeColor=e.style.strokeColor,n.style.strokeWidth=e.style.strokeWidth;const r=new Eo;return r.data=i,r.id=e.id+"_1_finalNode",r.horizontalAlignment="Center",r.verticalAlignment="Center",r.relativeMode="Object",r.style.fill=e.style.fill,r.style.strokeColor=e.style.strokeColor,r.style.strokeWidth=e.style.strokeWidth,t.children=[n,r],t.children[0].width=e.width,t.children[0].height=e.height,t.children[1].height=e.height/1.5,t.children[1].width=e.width/1.5,t.style.strokeWidth=0,t.style.strokeColor="transparent",t}function yc(e){Kd(e+"_linear"),Kd(e+"_radial")}function bc(e,t){const i=e.indexOf(t);i>=0&&e.splice(i,1)}function vc(e,t,i){let n;e.intermediatePoints=t,e.updateSegmentElement(e,t,e.wrapper.children[0],i);const r=e.sourceDecorator;if("Bezier"===e.type){const t=e.segments[0],i=e.segments[e.segments.length-1];n=[ws.isEmptyPoint(i.point2)?i.bezierPoint2:i.point2,ws.isEmptyPoint(t.point1)?t.bezierPoint1:t.point1]}else n=e.intermediatePoints;t=e.clipDecorators(e,t,i);let s=e.wrapper.children[0];s.canMeasurePath=!0,s=e.wrapper.children[1],e.updateDecoratorElement(s,t[0],n[1],r),s=e.wrapper.children[2],e.updateDecoratorElement(s,t[t.length-1],n[n.length-2],e.targetDecorator),e.updateShapeElement(e)}function wc(e,t,i){const n=e.wrapper,r=n.bounds,s=t.offset,o=t.size/i.scale,a=t.margin;let l;const h=n.offsetX-n.actualSize.width*n.pivot.x,c=n.offsetY-n.actualSize.height*n.pivot.y;if(l={x:0,y:0},e.nodes.length>0){switch(t.side){case"Top":l.x+=h+r.width*s,l.y+=c-(o/2+12.5);break;case"Bottom":l.x+=h+s*r.width,l.y+=c+n.actualSize.height+(o/2+12.5);break;case"Left":l.x+=h-(o/2+12.5),l.y+=c+s*r.height;break;case"Right":l.x+=h+n.actualSize.width+(o/2+12.5),l.y+=c+s*r.height}l.x+=(a.left-a.right)/i.scale+o/2*("Center"===t.horizontalAlignment?0:"Right"===t.horizontalAlignment?-1:1),l.y+=(a.top-a.bottom)/i.scale+o/2*("Center"===t.verticalAlignment?0:"Top"===t.verticalAlignment?-1:1)}else if(e.connectors.length>0){const i=e.connectors[0],n={offset:s},r=lc(i.intermediatePoints,n),h=r.index;l=r.point;const c=ac(i.intermediatePoints,n).angle;let d=zs();ks(d,-c,i.intermediatePoints[h].x,i.intermediatePoints[h].y),l=Ms(d,l),l.x+=a.left-a.right+o/2*("Center"===t.horizontalAlignment?0:"Right"===t.horizontalAlignment?-1:1),l.y+=a.top-a.bottom+o/2*("Center"===t.verticalAlignment?0:"Top"===t.verticalAlignment?-1:1),d=zs(),ks(d,c,i.intermediatePoints[h].x,i.intermediatePoints[h].y),l=Ms(d,l)}if(0!==n.rotateAngle||0!==n.parentTransform){const e=zs();ks(e,n.rotateAngle+n.parentTransform,n.offsetX,n.offsetY),l=Ms(e,l)}return l}function xc(e,t,i,n){if(n.annotation){if(Al(n.annotation))return!0}else if(io[t]&e&&ao[t]&i)return!0;return!1}function Sc(e,t){return!!(io[t]&e)}function Cc(e,t){return e.visibility&t}function Pc(e,t){let i;if("Text"===e.shape.type)i=e.shape;else{const n=t.split("_");t=n[n.length-1];for(let r=0;r<e.annotations.length;r++)t===e.annotations[r].id&&(i=e.annotations[r])}return i}function Oc(e,t){let i={},n=0;if(e.ports){const r=e.ports;for(n=0;n<r.length;n++)t?r[n].constraints&wo.InConnect&&(i=r[n]):r[n].constraints&wo.OutConnect&&(i=r[n])}return i}function Tc(e,t,i){const n=i?e.annotations:e.ports;for(let r=0;r<n.length;r++)if(n[r].id===t)return r.toString();return"-1"}function Ec(e,t){let i;for(i=0;i<e.length;i++)if(t===e[i].id)return!0;return!1}function Ac(e,t,i,n,r,s){const o=e.children;let a;for(let l=0;l<o.length;l++)if(a=n[o[l]],a)if(a.children)Ac(a,t,i,n,r,s);else if(a.offsetX-=t,a.offsetY-=i,!r){n[a.id]=a;const e=a.initContainer();e.children||(e.children=[]);const t=a.init(s);e.children.push(t),e.measure(new bs(a.width,a.height)),e.arrange(e.desiredSize)}}function Ic(e,t,i){if(0===i.length)i.push(e);else if(1===i.length)i[0][t]>e[t]?i.splice(0,0,e):i.push(e);else if(i.length>1){let n=0,r=i.length-1,s=Math.floor((n+r)/2);for(;s!==n;)if(i[s][t]<e[t])n=s,s=Math.floor((n+r)/2);else{if(!(i[s][t]>e[t]))break;r=s,s=Math.floor((n+r)/2)}i[r][t]<e[t]?i.push(e):i[n][t]>e[t]?i.splice(n,0,e):i[n][t]<e[t]&&i[r][t]>e[t]&&i.splice(r,0,e)}}function Dc(e){const t=document.getElementById(e.diagramId),i="ej2_instances";let n=t[i][0].nodes;void 0===n&&(n=function(e){const t=[];for(let i=0;i<e.palettes.length;i++){const n=e.palettes[i].symbols;for(let e=0;e<n.length;e++)n[e]instanceof Td&&t.push(n[e])}return t}(t[i][0]));for(let o=0;n&&o<n.length;o++)if(n[o].id===e.nodeId)return Rc(n[o],e);const r=t[i][0].connectors;for(let o=0;r&&o<r.length;o++)if(r[o].id===e.nodeId)return Rc(r[o],e);const s=t[i][0].enterObject;return s&&(s.id===e.nodeId||s.children)?s.children&&Kh(s,"HTML",t[i][0].enterTable)?t[i][0].enterTable[e.nodeId]:s:null}function Rc(e,t){const i=e.annotations;let n;for(n=0;i&&n<i.length;n++)if(t.annotationId&&i[n].id===t.annotationId)return i[n];return e}let Lc=e=>(e&&(e=void 0!==e.sourceID||void 0!==e.sourcePoint||void 0!==e.targetID||void 0!==e.targetPoint||void 0!==e.type?ol:Td),e),zc=e=>{if(!e.sourceID&&!e.targetID){let t={x:e.sourcePoint.x,y:e.sourcePoint.y},i={x:e.targetPoint.x,y:e.targetPoint.y};"Horizontal"===e.flip?(e.sourcePoint.x=i.x,e.targetPoint.x=t.x):"Vertical"===e.flip?(e.sourcePoint.y=i.y,e.targetPoint.y=t.y):"Both"===e.flip&&(e.sourcePoint=i,e.targetPoint=t)}},Mc=(e,t,i)=>{let n=i.offset.x,r=i.offset.y;return"Horizontal"===t?(n=1-i.offset.x,r=i.offset.y):"Vertical"===t?(n=i.offset.x,r=1-i.offset.y):"Both"===t&&(n=1-i.offset.x,r=1-i.offset.y),e.setOffsetWithRespectToBounds(n,r,"Fraction"),e},kc=(e,t,i,n,r)=>{if(e.hasChildren())for(let s of e.children){let e=t-s.offsetX+t,o=i-s.offsetY+i;"Horizontal"!==r&&"Both"!==r||(s.offsetX=e,s.flipOffset.x=e-s.desiredSize.width/2),"Vertical"!==r&&"Both"!==r||(s.offsetY=o,s.flipOffset.y=o-s.desiredSize.height/2),(s instanceof Po||s instanceof So)&&kc(s,t,i,n,r),s.measure(new bs(s.bounds.width,s.bounds.height)),s.arrange(s.desiredSize);let a=n.nameTable[s.id];a&&n.updateConnectorEdges(a)}},jc=e=>{let t=e.selectedItems.nodes,i=e.selectedItems.connectors,n=e.allowServerDataBinding,r=e.isProtectedOnChange;e.protectPropertyChange(!0),e.allowServerDataBinding=!1,e.selectedItems.nodes=[],e.selectedItems.connectors=[],e.allowServerDataBinding=n,e.protectPropertyChange(r);let s=dp(e.selectedItems);for(let o=0;o<t.length;o++)e.selectedItems.nodes.push(e.nameTable[t[o].id]);for(let o=0;o<i.length;o++)e.selectedItems.connectors.push(e.nameTable[i[o].id]);return s},Hc=(e,t)=>{let i,n=new Eo;for(let r=0;r<e.length-1;r++)i=_c(e[r],e[r+1]),n.data=i[0],n.id=t.id+"_"+t.shape.sequence,n.offsetX=i[1].x,n.offsetY=i[1].y,n.rotateAngle=45,n.transform=co.Self;return n},Nc=(e,t)=>{if(e instanceof Td)for(let i=0;i<e.ports.length;i++)if(e.ports[i].id===t.id.split("_")[1])return!0;return!1},_c=(e,t)=>{let i={x:e.x,y:e.y},n=Bc(e,t);n=Math.min(30,n/2);let r=la(e,t),s=ws.transform({x:i.x,y:i.y},r,n),o=ws.transform({x:s.x,y:s.y},r,-12),a=ws.transform({x:o.x,y:o.y},r,24);return["M"+o.x+" "+o.y+" L"+a.x+" "+a.y,s]},Bc=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Wc(){return(navigator.platform.indexOf("Mac")>=0||navigator.platform.indexOf("iPad")>=0||navigator.platform.indexOf("iPhone")>=0||navigator.platform.indexOf("MacIntel")>=0)&&("safari"===Z.info.name||"webkit"===Z.info.name)}function Uc(e,t,i,n){let r=0;return r=void 0!==t.previewSize[n]?t.previewSize[n]:void 0!==e.symbolPreview[n]?e.symbolPreview[n]:t[n]||i.actualSize[n],r}function Fc(e,t,i){return e&&e.parentId&&(i=(e=t.nameTable[e.parentId]).parentId?Fc(e,t,i):e.id),i}var Vc=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Xc=(()=>{class e extends Ht{}return Vc([xt("None")],e.prototype,"shape",void 0),Vc([xt("white")],e.prototype,"fill",void 0),Vc([xt("Auto")],e.prototype,"horizontalAlignment",void 0),Vc([xt("Auto")],e.prototype,"verticalAlignment",void 0),Vc([xt(10)],e.prototype,"width",void 0),Vc([xt(10)],e.prototype,"height",void 0),Vc([St({x:.5,y:1},ws)],e.prototype,"offset",void 0),Vc([xt("#1a1a1a")],e.prototype,"borderColor",void 0),Vc([xt(1)],e.prototype,"borderWidth",void 0),Vc([St({},Vs)],e.prototype,"margin",void 0),Vc([xt("")],e.prototype,"pathData",void 0),Vc([xt("")],e.prototype,"content",void 0),Vc([xt(0)],e.prototype,"cornerRadius",void 0),Vc([St({left:2,right:2,top:2,bottom:2},Vs)],e.prototype,"padding",void 0),e})();class Yc extends So{constructor(){super(...arguments),this.orientation="Vertical",this.measureChildren=void 0,this.considerPadding=!0}measure(e){return this.desiredSize=this.measureStackPanel(e,"Horizontal"===this.orientation?this.updateHorizontalStack:this.updateVerticalStack),this.desiredSize}arrange(e){return this.actualSize=this.arrangeStackPanel(e,"Horizontal"===this.orientation?this.arrangeHorizontalStack:this.arrangeVerticalStack),this.updateBounds(),this.actualSize}measureStackPanel(e,t){let i;if(void 0!==this.children&&this.children.length>0)for(const n of this.children){n.parentTransform=this.rotateAngle+this.parentTransform,n.measure(this.measureChildren?n.desiredSize:e);let r=n.desiredSize.clone();this.applyChildMargin(n,r),0!==n.rotateAngle&&(r=xp(r,n.rotateAngle)),void 0===i?i=r:n.preventContainer||t(r,i)}return i=super.validateDesiredSize(i,e),this.stretchChildren(i),this.considerPadding&&this.applyPadding(i),i}arrangeStackPanel(e,t){if(void 0!==this.children&&this.children.length>0){let i,n;i=this.offsetX-e.width*this.pivot.x+this.padding.left,n=this.offsetY-e.height*this.pivot.y+this.padding.top;for(const r of this.children){const s=r.desiredSize.clone();let o=s;"Vertical"===this.orientation?n+=r.margin.top:i+=r.margin.left,0!==r.rotateAngle&&(o=xp(s,r.rotateAngle));const a=t(i,n,r,this,e,o);super.findChildOffsetFromCenter(r,a),r.arrange(s,!0),"Vertical"===this.orientation?n+=o.height+r.margin.bottom:i+=o.width+r.margin.right}}return e}updateHorizontalStack(e,t){t.height=Math.max(e.height,t.height),t.width+=e.width}updateVerticalStack(e,t){t.width=Math.max(e.width,t.width),t.height+=e.height}arrangeHorizontalStack(e,t,i,n,r,s){let o=0;return"Top"===i.verticalAlignment?o=t+i.margin.top+s.height/2:"Bottom"===i.verticalAlignment?o=n.offsetY+r.height*(1-n.pivot.y)-n.padding.bottom-i.margin.bottom-s.height/2:(o=n.offsetY-r.height*n.pivot.y+r.height/2,i.margin.top&&(o=t+i.margin.top+s.height/2)),{x:e+s.width/2,y:o}}arrangeVerticalStack(e,t,i,n,r,s){let o=0;return"Left"===i.horizontalAlignment?o=e+i.margin.left+s.width/2:"Right"===i.horizontalAlignment?o=n.offsetX+r.width*(1-n.pivot.x)-n.padding.right-i.margin.right-s.width/2:(o=n.offsetX-r.width*n.pivot.x+r.width/2,i.margin.left&&(o=e+i.margin.left+s.width/2)),{x:o,y:t+s.height/2}}stretchChildren(e){if(void 0!==this.children&&this.children.length>0)for(const t of this.children)"Vertical"===this.orientation?"Stretch"===t.horizontalAlignment&&(t.desiredSize.width=e.width-(t.margin.left+t.margin.right)):"Stretch"===t.verticalAlignment&&(t.desiredSize.height=e.height-(t.margin.top+t.margin.bottom))}applyChildMargin(e,t){t.height+=e.margin.top+e.margin.bottom,t.width+=e.margin.left+e.margin.right}}function Gc(e,t){const i=new Td(t,"nodes",{id:op()+"_path",height:1,constraints:so.Default&~so.Select,verticalAlignment:"Stretch",horizontalAlignment:"Stretch",style:{strokeColor:"black"===e.style.strokeColor?"#ffffff00":e.style.strokeColor}},!0);t.initObject(i),t.nodes.push(i),e.children.push(i.id)}function qc(e,t){const i={},n=t.style;return i.fill="transparent"!==n.fill?n.fill:e.style.fill,i.color=n.color,i.fontSize=12!==n.fontSize?n.fontSize:e.style.fontSize,i.strokeColor="black"!==n.strokeColor?n.strokeColor:e.style.strokeColor,i.strokeWidth=1!==n.strokeWidth?n.strokeWidth:e.style.strokeWidth,i}var Zc=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let $c=(()=>{class e extends Ht{}return Zc([xt("Horizontal")],e.prototype,"orientation",void 0),Zc([xt("Center")],e.prototype,"type",void 0),Zc([xt(void 0)],e.prototype,"offset",void 0),Zc([xt(!1)],e.prototype,"enableRouting",void 0),Zc([xt([])],e.prototype,"children",void 0),Zc([xt("")],e.prototype,"assistants",void 0),Zc([xt("")],e.prototype,"level",void 0),Zc([xt("")],e.prototype,"hasSubTree",void 0),Zc([xt("")],e.prototype,"rows",void 0),e})();var Qc=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};const Jc=e=>{if(e)switch(e.type){case"Basic":return sd;case"Flow":return od;case"Path":return ed;case"Image":return nd;case"Text":return rd;case"Bpmn":return fd;case"Native":return td;case"HTML":return id;case"UmlActivity":return yd;case"UmlClassifier":return Od;case"SwimLane":return Dd;default:return sd}return sd};let Kc=(()=>{class e extends Ht{}return Qc([xt("Basic")],e.prototype,"type",void 0),e})(),ed=(()=>{class e extends Kc{getClassName(){return"Path"}}return Qc([xt("Path")],e.prototype,"type",void 0),Qc([xt("")],e.prototype,"data",void 0),e})(),td=(()=>{class e extends Kc{getClassName(){return"Native"}}return Qc([xt("Native")],e.prototype,"type",void 0),Qc([xt("")],e.prototype,"content",void 0),Qc([xt("Stretch")],e.prototype,"scale",void 0),e})(),id=(()=>{class e extends Kc{getClassName(){return"Html"}}return Qc([xt("HTML")],e.prototype,"type",void 0),Qc([xt("")],e.prototype,"content",void 0),e})(),nd=(()=>{class e extends Kc{getClassName(){return"Image"}}return Qc([xt("Image")],e.prototype,"type",void 0),Qc([xt("")],e.prototype,"source",void 0),Qc([xt("None")],e.prototype,"scale",void 0),Qc([xt("None")],e.prototype,"align",void 0),e})(),rd=(()=>{class e extends Kc{getClassName(){return"Text"}}return Qc([xt("Text")],e.prototype,"type",void 0),Qc([xt("")],e.prototype,"content",void 0),Qc([St({},Vs)],e.prototype,"margin",void 0),e})(),sd=(()=>{class e extends Kc{getClassName(){return"BasicShape"}}return Qc([xt("Basic")],e.prototype,"type",void 0),Qc([xt("Rectangle")],e.prototype,"shape",void 0),Qc([xt(0)],e.prototype,"cornerRadius",void 0),Qc([Pt([],ws)],e.prototype,"points",void 0),e})(),od=(()=>{class e extends Kc{getClassName(){return"FlowShape"}}return Qc([xt("Flow")],e.prototype,"type",void 0),Qc([xt("Terminator")],e.prototype,"shape",void 0),e})(),ad=(()=>{class e extends Ht{getClassName(){return"BpmnGateway"}}return Qc([xt("None")],e.prototype,"type",void 0),e})(),ld=(()=>{class e extends Ht{getClassName(){return"BpmnDataObject"}}return Qc([xt("None")],e.prototype,"type",void 0),Qc([xt(!1)],e.prototype,"collection",void 0),e})(),hd=(()=>{class e extends Ht{}return Qc([xt("None")],e.prototype,"type",void 0),Qc([xt("None")],e.prototype,"loop",void 0),Qc([xt(!1)],e.prototype,"call",void 0),Qc([xt(!1)],e.prototype,"compensation",void 0),e})(),cd=(()=>{class e extends Ht{getClassName(){return"BpmnEvent"}}return Qc([xt("Start")],e.prototype,"event",void 0),Qc([xt("None")],e.prototype,"trigger",void 0),e})(),dd=(()=>{class e extends Ht{getClassName(){return"BpmnSubEvent"}}return Qc([xt("None")],e.prototype,"trigger",void 0),Qc([xt("Start")],e.prototype,"event",void 0),Qc([xt("")],e.prototype,"id",void 0),Qc([St({},ws)],e.prototype,"offset",void 0),Qc([Pt([],jo)],e.prototype,"annotations",void 0),Qc([Pt([],Lo)],e.prototype,"ports",void 0),Qc([xt()],e.prototype,"width",void 0),Qc([xt()],e.prototype,"height",void 0),Qc([St({},Vs)],e.prototype,"margin",void 0),Qc([xt("Center")],e.prototype,"horizontalAlignment",void 0),Qc([xt("Center")],e.prototype,"verticalAlignment",void 0),Qc([xt(!0)],e.prototype,"visible",void 0),e})(),pd=(()=>{class e extends Ht{}return Qc([St({id:"success",event:"End",offset:{x:1,y:.5}},dd)],e.prototype,"success",void 0),Qc([St({id:"failure",event:"Intermediate",trigger:"Error",offset:{x:.25,y:1}},dd)],e.prototype,"failure",void 0),Qc([St({id:"cancel",event:"Intermediate",trigger:"Cancel",offset:{x:.75,y:1}},dd)],e.prototype,"cancel",void 0),e})(),ud=(()=>{class e extends Ht{}return Qc([xt("None")],e.prototype,"type",void 0),Qc([xt(!1)],e.prototype,"adhoc",void 0),Qc([xt("Default")],e.prototype,"boundary",void 0),Qc([xt(!1)],e.prototype,"compensation",void 0),Qc([xt("None")],e.prototype,"loop",void 0),Qc([xt(!0)],e.prototype,"collapsed",void 0),Qc([Pt([],dd)],e.prototype,"events",void 0),Qc([St({},pd)],e.prototype,"transaction",void 0),Qc([xt(void 0)],e.prototype,"processes",void 0),e})(),gd=(()=>{class e extends Ht{getClassName(){return"BpmnActivity"}}return Qc([xt("Task")],e.prototype,"activity",void 0),Qc([St({},hd)],e.prototype,"task",void 0),Qc([St({},ud)],e.prototype,"subProcess",void 0),e})(),md=(()=>{class e extends Ht{constructor(e,t,i,n){super(e,t,i,n)}getClassName(){return"BpmnAnnotation"}}return Qc([xt("")],e.prototype,"text",void 0),Qc([xt("")],e.prototype,"id",void 0),Qc([xt(0)],e.prototype,"angle",void 0),Qc([xt()],e.prototype,"height",void 0),Qc([xt()],e.prototype,"width",void 0),Qc([xt(0)],e.prototype,"length",void 0),e})(),fd=(()=>{class e extends Kc{getClassName(){return"BpmnShape"}}return Qc([xt("Bpmn")],e.prototype,"type",void 0),Qc([xt("Event")],e.prototype,"shape",void 0),Qc([St({},cd)],e.prototype,"event",void 0),Qc([St({},ad)],e.prototype,"gateway",void 0),Qc([St({},ld)],e.prototype,"dataObject",void 0),Qc([St({},gd)],e.prototype,"activity",void 0),Qc([St({},md)],e.prototype,"annotation",void 0),Qc([Pt([],md)],e.prototype,"annotations",void 0),e})(),yd=(()=>{class e extends Kc{getClassName(){return"UmlActivityShape"}}return Qc([xt("UmlActivity")],e.prototype,"type",void 0),Qc([xt("Action")],e.prototype,"shape",void 0),e})(),bd=(()=>{class e extends Ht{getClassName(){return"MethodArguments"}}return Qc([xt("")],e.prototype,"name",void 0),Qc([xt("")],e.prototype,"type",void 0),Qc([St({},Js)],e.prototype,"style",void 0),e})(),vd=(()=>{class e extends bd{getClassName(){return"UmlClassAttribute"}}return Qc([xt("Public")],e.prototype,"scope",void 0),Qc([xt(!1)],e.prototype,"isSeparator",void 0),e})(),wd=(()=>{class e extends vd{getClassName(){return"UmlClassMethod"}}return Qc([Pt([],bd)],e.prototype,"parameters",void 0),e})(),xd=(()=>{class e extends Ht{getClassName(){return"UmlClass"}}return Qc([xt("")],e.prototype,"name",void 0),Qc([Pt([],vd)],e.prototype,"attributes",void 0),Qc([Pt([],wd)],e.prototype,"methods",void 0),Qc([St({},Js)],e.prototype,"style",void 0),e})(),Sd=(()=>{class e extends xd{getClassName(){return"UmlInterface"}}return Qc([xt(!1)],e.prototype,"isSeparator",void 0),e})(),Cd=(()=>{class e extends Ht{getClassName(){return"UmlEnumerationMember"}}return Qc([xt("")],e.prototype,"name",void 0),Qc([xt("")],e.prototype,"value",void 0),Qc([xt(!1)],e.prototype,"isSeparator",void 0),Qc([St({},Js)],e.prototype,"style",void 0),e})(),Pd=(()=>{class e extends Ht{getClassName(){return"UmlEnumeration"}}return Qc([xt("")],e.prototype,"name",void 0),Qc([Pt([],Cd)],e.prototype,"members",void 0),Qc([St({},Js)],e.prototype,"style",void 0),e})(),Od=(()=>{class e extends Kc{getClassName(){return"UmlClassifierShape"}}return Qc([xt("UmlClassifier")],e.prototype,"type",void 0),Qc([St({},xd)],e.prototype,"classShape",void 0),Qc([St({},Sd)],e.prototype,"interfaceShape",void 0),Qc([St({},Pd)],e.prototype,"enumerationShape",void 0),Qc([xt("Class")],e.prototype,"classifier",void 0),e})(),Td=(()=>{class e extends Ma{constructor(e,t,i,n){let r;super(e,t,i,n),this.isCanvasUpdate=!1,this.status="None",this.parentId="",this.processId="",this.umlIndex=-1,this.outEdges=[],this.inEdges=[],this.isHeader=!1,this.isLane=!1,this.isPhase=!1,this.children&&this.children.length>0&&(r=i,r.style&&r.style.fill||(this.style.fill="transparent"),r.style&&r.style.strokeColor||(this.style.strokeColor="transparent")),this.shape&&"UmlActivity"===this.shape.type&&$h(i,this),this.shape&&"SwimLane"===this.shape.type&&Gh(i,this),this.ports&&this.ports.length&&function(e){for(let t=0;t<e.ports.length;t++)e.ports[t].inEdges=[],e.ports[t].outEdges=[]}(this)}get actualSize(){return null!==this.wrapper?this.wrapper.actualSize:new bs(this.width||0,this.height||0)}init(e){let t,i;switch(t="SwimLane"!==this.shape.type?new xo:new Kl,this.shape.changedProperties={},this.shape.oldProperties={},this.shape.type){case"Path":const n=new Eo;n.data=this.shape.data,t=n;break;case"Image":const r=new Ao;r.source=this.shape.source,r.imageAlign=this.shape.align,r.imageScale=this.shape.scale,t=r;break;case"Text":const s=new Co;s.content=this.shape.content,t=s,i=this.style,t.style=i;break;case"Basic":if("Rectangle"===this.shape.shape)t=new xo,t.cornerRadius=this.shape.cornerRadius;else if("Polygon"===this.shape.shape){const e=new Eo;e.data=Ss(this.shape.points),t=e}else{const e=new Eo,i=Oo(this.shape.shape);e.data=i,t=e}break;case"Flow":const o=new Eo,a=Wo(this.shape.shape);o.data=a,t=o;break;case"UmlActivity":t=function(e,t,i){const n=i.shape.shape,r=Yl(n);switch(e.data=r,t=e,n){case"StructuredNode":if(i.annotations)for(let e=0;e<i.annotations.length;e++)i.annotations[e].content="<<"+i.annotations[e].content+">>";t=e;break;case"FinalNode":t=fc(i)}return t}(new Eo,t,this);break;case"Bpmn":if(e.bpmnModule){t=e.bpmnModule.initBPMNContent(t,this,e),this.wrapper.elementActions=this.wrapper.elementActions|oo.ElementIsGroup;const i=this.shape.activity.subProcess;if(i.processes&&i.processes.length){const n=this.shape.activity.subProcess.processes;for(const r of n)!e.nameTable[r]||e.nameTable[r].processId&&e.nameTable[r].processId!==this.id||(e.nameTable[r].processId=this.id,i.collapsed&&e.updateElementVisibility(e.nameTable[r].wrapper,e.nameTable[r],!i.collapsed),t.children.push(e.nameTable[r].wrapper))}}break;case"Native":const l=new Io(this.id,e.element.id);l.content=this.shape.content,l.scale=this.shape.scale,t=l;break;case"HTML":const h=new ka(this.id,e.element.id,void 0,e.nodeTemplate);this.shape.content?h.content=this.shape.content:e.nodeTemplate&&(h.isTemplate=!0,h.template=h.content=ep(h,!0,this)),t=h;break;case"UmlClassifier":t=function(e,t,i){let n,r="NoWrap";"Class"===t.shape.classifier?n=t.shape.classShape:"Enumeration"===t.shape.classifier?n=t.shape.enumerationShape:"Interface"===t.shape.classifier&&(n=t.shape.interfaceShape),t.container={type:"Stack",orientation:"Vertical"},t.constraints=(so.Default|so.HideThumbs)&~(so.Rotate|so.Resize),t.style={fill:t.style.fill,strokeColor:t.style.strokeColor,strokeWidth:1.5},t.children=[],t.maxWidth&&(r="Wrap");const s=new Td(i,"nodes",{id:t.id+"_umlClass_header",annotations:[{id:"name",content:n.name,offset:{x:.5,y:.65},margin:{left:10,right:10},style:{bold:!0,fontSize:14,color:n.style.color,fill:n.style.fill,textWrapping:r}},{content:"<<"+t.shape.classifier+">>",margin:{left:10,right:10},id:"class",style:{fontSize:n.style.fontSize,color:n.style.color,fill:n.style.fill,textWrapping:r},offset:{x:.5,y:.3},constraints:ro.ReadOnly}],constraints:(so.Default|so.HideThumbs)&~(so.Rotate|so.Drag|so.Resize),verticalAlignment:"Stretch",horizontalAlignment:"Stretch",style:{fill:t.style.fill,strokeColor:"black"===t.style.strokeColor?"#ffffff00":t.style.strokeColor}},!0);return i.initObject(s),i.nodes.push(s),i.UpdateBlazorDiagramModel(s,"Node"),t.children.push(s.id),function(e,t,i,n){if("Enumeration"===e.shape.classifier){const r=i.members;if(r&&r.length){Gc(e,t);let i="";for(let s=0;s<r.length;s++){const o=r[s];if(""!==o.name&&(i+=o.name),s!==r.length){const a=qc(e,o),l=new Td(t,"nodes",{id:op()+"_umlMember",annotations:[{id:"name",content:i,offset:{x:0,y:.5},style:{bold:!0,fontSize:a.fontSize,color:a.color,fill:a.fill,textWrapping:n},margin:{left:14,right:5},horizontalAlignment:"Left"}],verticalAlignment:"Stretch",horizontalAlignment:"Stretch",style:{fill:e.style.fill,strokeColor:"black"===e.style.strokeColor?"#ffffff00":e.style.strokeColor,textWrapping:n},constraints:(so.Default|so.HideThumbs)&~(so.Rotate|so.Drag|so.Resize),minHeight:25},!0);t.initObject(l),t.nodes.push(l),t.UpdateBlazorDiagramModel(l,"Node"),e.children.push(l.id),i="",o.isSeparator&&s!==r.length-1&&Gc(e,t)}}}}else{const r=i.attributes;if(r.length){let i="";Gc(e,t);for(let s=0;s<r.length;s++){let o;const a=r[s];if(o=a.scope&&"Public"===a.scope?" +":a.scope&&"Private"===a.scope?"-":a.scope&&"Protected"===a.scope?"#":"~",""!==a.name&&o&&(i+=o+" "+a.name+" : "+a.type),s!==r.length){const o=qc(e,a),l=new Td(t,"nodes",{id:op()+"_umlProperty",style:{fill:e.style.fill,strokeColor:"black"===e.style.strokeColor?"#ffffff00":e.style.strokeColor},annotations:[{id:"name",content:i,offset:{x:0,y:.5},style:{bold:!0,fontSize:o.fontSize,color:o.color,fill:o.fill,textWrapping:n},margin:{left:14,right:5},horizontalAlignment:"Left"}],verticalAlignment:"Stretch",horizontalAlignment:"Stretch",constraints:(so.Default|so.HideThumbs)&~(so.Rotate|so.Drag|so.Resize),minHeight:25},!0);t.initObject(l),t.nodes.push(l),t.UpdateBlazorDiagramModel(l,"Node"),e.children.push(l.id),i="",a.isSeparator&&s!==r.length-1&&Gc(e,t)}}}}}(t,i,n,r),function(e,t,i,n){if(i.methods&&i.methods.length){const r=i.methods;Gc(e,t);let s,o="",a="";for(let i=0;i<r.length;i++){const l=r[i];if(s=l.scope&&"Public"===l.scope?" +":l.scope&&"Private"===l.scope?"-":l.scope&&"Protected"===l.scope?"#":"~",l.parameters)for(let e=0;e<l.parameters.length;e++)o+=l.parameters[e].type?l.parameters[e].name+":"+l.parameters[e].type:l.parameters[e].name,e!==l.parameters.length-1&&(o+=",");if(""!==l.name&&s&&(a+=s+" "+l.name+"("+o+") : "+l.type),i!==r.length){const s=qc(e,l),o=new Td(t,"nodes",{id:op()+"_umlMethods",verticalAlignment:"Stretch",horizontalAlignment:"Stretch",annotations:[{id:"name",content:a,offset:{x:0,y:.5},style:{bold:!0,fontSize:s.fontSize,color:s.color,fill:s.fill,textWrapping:n},margin:{left:14,right:5},horizontalAlignment:"Left"}],style:{fill:e.style.fill,strokeColor:"black"===e.style.strokeColor?"#ffffff00":e.style.strokeColor},minHeight:25,constraints:(so.Default|so.HideThumbs)&~(so.Rotate|so.Drag|so.Resize)},!0);t.initObject(o),t.nodes.push(o),t.UpdateBlazorDiagramModel(o,"Node"),e.children.push(o.id),a="",l.isSeparator&&i!==r.length-1&&Gc(e,t)}}}}(t,i,n,r),t.offsetX=t.offsetX,t.offsetY=t.offsetY,t.style.fill=t.style.fill,t.borderColor=t.borderColor,i.initObject(t),e}(t,this,e);break;case"SwimLane":this.annotations=[],this.ports=[],t.cellStyle.fill="none",t.cellStyle.strokeColor="none",this.container={type:"Grid",orientation:this.shape.orientation},t.id=this.id,this.container.orientation=this.shape.orientation,this.constraints|=so.HideThumbs,function(e,t,i){i.width||0!==i.shape.phases.length||(i.width=100);const n=[],r=[];let s=0;const o=i.shape,a="Horizontal"===o.orientation;if(o.header&&o.hasHeader&&yh(n,o.header.height),function(e,t,i){let n,r=0;const s=i.shape;if(e.length>0)for(let o=0;o<e.length;o++)r+=e[o].height;if(t){if(s.phases.length>0&&s.phaseSize&&(r+=s.phaseSize,yh(e,s.phaseSize)),s.lanes.length>0)for(let o=0;o<s.lanes.length;o++)n=s.lanes[o].height,r+=n,o===s.lanes.length-1&&r<i.height&&(n+=i.height-r),yh(e,n)}else if(s.phases.length>0){let t=0;for(let o=0;o<s.phases.length;o++){let a=s.phases[o].offset;0===o||(a-=t),t+=a,n=a,r+=n,o===s.phases.length-1&&r<i.height&&(n+=i.height-r),yh(e,n)}}else yh(e,i.height)}(n,a,i),function(e,t,i){let n=0;const r=i.shape;let s,o,a,l,h;if(r.phases.length>0&&"Horizontal"===r.orientation)for(l=0;l<r.phases.length;l++)s=r.phases[l].offset,0===l||(s-=n),n+=s,o=bh(s),l===r.phases.length-1&&n<i.width&&(o.width+=i.width-n),e.push(o);else if(t)o=bh(i.width),e.push(o);else{for(h=r.phaseSize&&r.phases.length>0?r.lanes.length+1:r.lanes.length,r.phaseSize&&r.phases.length>0&&(n+=r.phaseSize,o=bh(r.phaseSize),e.push(o)),a=0;a<r.lanes.length;a++)n+=r.lanes[a].width,o=bh(r.lanes[a].width),a===r.lanes.length-1&&n<i.width&&(o.width+=i.width-n),e.push(o);0===r.phases.length&&0===r.lanes.length&&(o=bh(i.width),e.push(o))}}(r,a,i),e.setDefinitions(n,r),o.header&&o.hasHeader&&(function(e,t,i){let n=0;const r=e.columnDefinitions(),s=i.shape;for(let l=0;l<r.length;l++)n+=r[l].width;s.header.id=s.header.id||op();const o={id:i.id+s.header.id,annotations:[dp(s.header.annotation)],style:s.header.style?s.header.style:void 0,offsetX:i.offsetX,offsetY:i.offsetY,rowIndex:0,columnIndex:0,maxWidth:n,container:{type:"Canvas",orientation:"Horizontal"}};ml(i)||(o.constraints&=~so.Select);const a=gh(t,0,i,o,!0);e.addObject(a,0,0,1,e.columnDefinitions().length)}(e,t,i),s++),o.phases.length>0&&o.phaseSize){for(let n=0;n<o.phases.length;n++)""===o.phases[n].id&&(o.phases[n].id=op()),mh(e,t,i,s,a,n);s++}if(o.lanes.length>0)for(let l=0;l<o.lanes.length;l++)""===o.lanes[l].id&&(o.lanes[l].id=op()),fh(e,t,i,s,l,a),s++}(t,e,this)}return t.id=this.id+"_content",t.relativeMode="Object",void 0!==this.width&&(t.width=this.width),t.horizontalAlignment="Stretch",void 0!==this.height&&(t.height=this.height),void 0!==this.minHeight&&(t.minHeight=this.minHeight),void 0!==this.maxHeight&&(t.maxHeight=this.maxHeight),void 0!==this.minWidth&&(t.minWidth=this.minWidth),void 0!==this.maxWidth&&(t.maxWidth=this.maxWidth),"Rectangle"===this.shape.shape&&!this.shape.cornerRadius&&(t.isRectElement=!0),t.verticalAlignment="Stretch",this.shape instanceof rd&&(t.margin=this.shape.margin),Cl(this)&&0!=(this.constraints&so.Shadow)&&(t.shadow=this.shadow),!("Bpmn"===this.shape.type&&"Message"!==this.shape.shape&&"DataSource"!==this.shape.shape||"UmlActivity"===this.shape.type&&"FinalNode"===this.shape.shape)&&"Text"!==this.shape.type&&(t.style=this.style,this.oldGradientValue=this.style.gradient?dp(this.style.gradient):null),(this.wrapper.elementActions&oo.ElementIsGroup||"Horizontal"!==this.flip)&&"Vertical"!==this.flip||(t.flip=this.flip),t}initContainer(){let e;if(this.id||(this.id=op()),!this.container||this.shape instanceof Dd)e=this.children?new So:new Po;else switch(this.container.type){case"Canvas":e=new Po;break;case"Stack":e=new Yc;break;case"Grid":e=new Kl,e.setDefinitions(this.rows,this.columns)}return e.id=this.id,e.offsetX=this.offsetX,e.offsetY=this.offsetY,e.visible=this.visible,e.horizontalAlignment=this.horizontalAlignment,e.verticalAlignment=this.verticalAlignment,this.container&&(e.width=this.width,e.height=this.height,"Stack"===this.container.type&&(e.orientation=this.container.orientation)),e.style.fill=this.backgroundColor,e.style.strokeColor=this.borderColor,e.style.strokeWidth=this.borderWidth,e.rotateAngle=this.rotateAngle,e.minHeight=this.minHeight,e.minWidth=this.minWidth,e.maxHeight=this.maxHeight,e.maxWidth=this.maxWidth,e.pivot=this.pivot,e.margin=this.margin,e.flip=this.flip,this.wrapper=e,e}initPorts(e,t){for(let i=0;i<this.ports.length;i++)this.initPort(e,t,this.ports[i])}initPort(e,t,i){const n=this.wrapper;let r,s;r=this.initPortWrapper(i);const o=Cp(e);o&&(s=o(r,this)),r.description=s||r.id,r.inversedAlignment=n.inversedAlignment,r.elementActions=r.elementActions|oo.ElementIsPort,t.children.push(r)}getIconOffet(e,t){let i,n;return"BottomToTop"===e.orientation?(i=t.offset.x,n=1-t.offset.y):"LeftToRight"===e.orientation?(i=t.offset.y,n=t.offset.x):"RightToLeft"===e.orientation?(i=1-t.offset.y,n=t.offset.x):(i=t.offset.x,n=t.offset.y),{x:i,y:n}}initIcons(e,t,i,n){const r=this.wrapper;let s;const o=this.isExpanded?this.expandIcon:this.collapseIcon;if("None"!==o.shape){const a=new Po;a.float=!0;const l=[];let h;a.id=this.id+"_icon_content",a.children=l,a.height=o.height,a.width=o.width,a.style.strokeColor="transparent",a.margin=o.margin,a.horizontalAlignment="Center",a.verticalAlignment="Center",a.visible=this.visible,s=this.getIconOffet(t,o),a.setOffsetWithRespectToBounds(s.x,s.y,"Fraction"),a.relativeMode="Point",this.initIconSymbol(o,a,e,n);const c=Cp(e);c&&(h=c(o,this)),a.description=h||a.id,a.inversedAlignment=r.inversedAlignment,i.children.push(a)}}initfixedUserHandles(e){const t=this.wrapper,i=new Po;i.float=!0,e.id=e.id||op(),i.id=this.id+"_"+e.id,i.children=[],i.height=e.height,i.width=e.width,i.style.strokeColor=e.handleStrokeColor,i.style.fill=e.fill,i.style.strokeWidth=e.handleStrokeWidth,i.margin=e.margin,i.visible=e.visibility,i.cornerRadius=e.cornerRadius,i.horizontalAlignment="Center",i.verticalAlignment="Center";const n=this.getfixedUserHandleOffet(e);i.setOffsetWithRespectToBounds(n.x,n.y,"Fraction"),i.relativeMode="Point";const r=oc(e,i);return i.children.push(r),i.description=i.id,i.inversedAlignment=t.inversedAlignment,i}getfixedUserHandleOffet(e){return{x:e.offset.x,y:e.offset.y}}initAnnotations(e,t,i,n,r){let s;for(let o=0;o<this.annotations.length;o++){let a;s=this.initAnnotationWrapper(this.annotations[o],i,n,o,r);const l=Cp(e);l&&(a=l(s,this)),s.description=a||s.id,s.inversedAlignment=t.inversedAlignment,t.children.push(s)}}initPortWrapper(e){e.id=e.id||op();let t=new Eo;t.height=e.height,t.width=e.width;const i="Custom"===e.shape?e.pathData:No(e.shape);t.id=this.id+"_"+e.id,t.margin=e.margin,t.data=i;const n=e.style;return t.style={fill:n.fill,strokeColor:n.strokeColor,gradient:null,opacity:n.opacity,strokeDashArray:n.strokeDashArray,strokeWidth:n.strokeWidth},t.horizontalAlignment=e.horizontalAlignment,t.verticalAlignment=e.verticalAlignment,t=Mc(t,this.flip,e),void 0===this.width&&void 0===this.height||(t.float=!0),t.relativeMode="Point",t.visible=!(!Cc(e,eo.Visible)||Cc(e,eo.Hover)||Cc(e,eo.Connect)),t.elementActions=t.elementActions|oo.ElementIsPort,t}initAnnotationWrapper(e,t,i,n,r){e.id=e.id||n+"annotation"||op();const s=e;let o;if(t&&(e.template||"Template"===e.annotationType||r&&""===e.content))o=new ka(this.id,t,e.id,r),o=sp(o,e,r);else{o=new Co,o.canMeasure=!i;const t=e.style,n=e.hyperlink.link?e.hyperlink:void 0;o.style={fill:t.fill,strokeColor:t.strokeColor,strokeWidth:t.strokeWidth,bold:t.bold,textWrapping:t.textWrapping,color:n?n.color||o.hyperlink.color:t.color,whiteSpace:t.whiteSpace,fontFamily:t.fontFamily,fontSize:t.fontSize,italic:t.italic,gradient:null,opacity:t.opacity,strokeDashArray:t.strokeDashArray,textAlign:t.textAlign,textOverflow:e.style.textOverflow,textDecoration:n?n.textDecoration||o.hyperlink.textDecoration:t.textDecoration},o.hyperlink.link=e.hyperlink.link||void 0,o.hyperlink.content=e.hyperlink.content||void 0,o.hyperlink.textDecoration=e.hyperlink.textDecoration||void 0,o.content=n?n.content||o.hyperlink.link:e.content}return o.constraints=e.constraints,o.height=e.height,o.width=e.width,o.visible=e.visibility,o.rotateAngle=e.rotateAngle,o.id=this.id+"_"+e.id,void 0===this.width||e.template||(void 0===e.width||e.width>this.width&&("Wrap"===e.style.textWrapping||"WrapWithOverflow"===e.style.textWrapping))&&(o.width=this.width),o.margin=e.margin,o.horizontalAlignment=e.horizontalAlignment,o.verticalAlignment=e.verticalAlignment,o.setOffsetWithRespectToBounds(s.offset.x,s.offset.y,"Fraction"),void 0===this.width&&void 0===this.height||(o.float=!0),o.relativeMode="Point",o}initIconContainer(e,t){const i=new xo;return i.id=t.id+"_rect",i.height=e.height,i.width=e.width,i.visible=t.visible,i.margin=e.margin,i.cornerRadius=e.cornerRadius,i.style={fill:e.fill,strokeColor:e.borderColor,strokeWidth:e.borderWidth},i.setOffsetWithRespectToBounds(.5,.5,"Fraction"),i.horizontalAlignment="Center",i.verticalAlignment="Center",i.relativeMode="Object",i.description=i.description||"Click here to expand or collapse",i}initIconSymbol(e,t,i,n){let r;if(t.children.push(this.initIconContainer(e,t)),"Template"===e.shape)r=new Io(this.id,n),r.content=e.content,r.height=10,r.width=10;else{r=new Eo,r.data=function(e){let t;switch(e.shape){case"Minus":t="M0,50 L100,50";break;case"Plus":t="M0,-50 L0,50 M-50,0 L50,0";break;case"ArrowUp":t="M0,100 L50,0 L100,100 Z";break;case"ArrowDown":t="M0,0 L50,100 L100,0 Z";break;case"Path":t=e.pathData}return t}(e);const t=Md(r.data);r.height=t.height<10?t.height:10-(e.padding.bottom+e.padding.top),r.width=t.width<10?t.width:10-(e.padding.left+e.padding.right)}r.id=t.id+"_shape",r.horizontalAlignment="Center",r.verticalAlignment="Center",r.visible=t.visible,r.visible=t.visible,r.style={fill:"black",strokeColor:e.borderColor,strokeWidth:e.borderWidth},r.setOffsetWithRespectToBounds(.5,.5,"Fraction"),r.relativeMode="Object",r.description=t.description||"Click here to expand or collapse",t.children.push(r)}getClassName(){return"Node"}}return Qc([Pt([],jo)],e.prototype,"annotations",void 0),Qc([xt(0)],e.prototype,"offsetX",void 0),Qc([St({},$c)],e.prototype,"layoutInfo",void 0),Qc([xt(0)],e.prototype,"offsetY",void 0),Qc([Pt([],Lo)],e.prototype,"ports",void 0),Qc([xt(!0)],e.prototype,"isExpanded",void 0),Qc([Pt([],Na)],e.prototype,"fixedUserHandles",void 0),Qc([St({},Xc)],e.prototype,"expandIcon",void 0),Qc([St({},Xc)],e.prototype,"collapseIcon",void 0),Qc([St({x:.5,y:.5},ws)],e.prototype,"pivot",void 0),Qc([xt()],e.prototype,"width",void 0),Qc([xt()],e.prototype,"height",void 0),Qc([xt()],e.prototype,"minWidth",void 0),Qc([xt()],e.prototype,"minHeight",void 0),Qc([xt()],e.prototype,"maxWidth",void 0),Qc([xt()],e.prototype,"maxHeight",void 0),Qc([xt(0)],e.prototype,"rotateAngle",void 0),Qc([St({fill:"white"},Js)],e.prototype,"style",void 0),Qc([xt("transparent")],e.prototype,"backgroundColor",void 0),Qc([xt("none")],e.prototype,"borderColor",void 0),Qc([xt(0)],e.prototype,"borderWidth",void 0),Qc([xt()],e.prototype,"data",void 0),Qc([Ct(Jc)],e.prototype,"shape",void 0),Qc([St({},Ra)],e.prototype,"previewSize",void 0),Qc([St({},Ra)],e.prototype,"dragSize",void 0),Qc([xt(null)],e.prototype,"wrapper",void 0),Qc([xt(so.Default)],e.prototype,"constraints",void 0),Qc([St({},Xs)],e.prototype,"shadow",void 0),Qc([xt()],e.prototype,"children",void 0),Qc([xt(null)],e.prototype,"container",void 0),Qc([xt("Left")],e.prototype,"horizontalAlignment",void 0),Qc([xt("Top")],e.prototype,"verticalAlignment",void 0),Qc([xt()],e.prototype,"rows",void 0),Qc([xt()],e.prototype,"columns",void 0),Qc([xt()],e.prototype,"rowIndex",void 0),Qc([xt()],e.prototype,"columnIndex",void 0),Qc([xt()],e.prototype,"rowSpan",void 0),Qc([xt()],e.prototype,"columnSpan",void 0),Qc([xt("")],e.prototype,"branch",void 0),e})(),Ed=(()=>{class e extends Ht{}return Qc([xt("")],e.prototype,"id",void 0),Qc([St({},ko)],e.prototype,"annotation",void 0),Qc([St({fill:"#E7F4FF",strokeColor:"#CCCCCC"},$s)],e.prototype,"style",void 0),Qc([xt(50)],e.prototype,"height",void 0),Qc([xt(50)],e.prototype,"width",void 0),e})(),Ad=(()=>{class e extends Ht{getClassName(){return"Lane"}}return Qc([xt("")],e.prototype,"id",void 0),Qc([St({fill:"#F9F9F9",strokeColor:"#CCCCCC"},$s)],e.prototype,"style",void 0),Qc([Pt([],Td)],e.prototype,"children",void 0),Qc([xt(100)],e.prototype,"height",void 0),Qc([xt(100)],e.prototype,"width",void 0),Qc([St({style:{fill:"#E7F4FF",strokeColor:"#CCCCCC"},annotation:{content:"Function"}},Ed)],e.prototype,"header",void 0),Qc([xt(!0)],e.prototype,"canMove",void 0),e})(),Id=(()=>{class e extends Ht{getClassName(){return"Phase"}}return Qc([xt("")],e.prototype,"id",void 0),Qc([St({strokeColor:"#CCCCCC"},$s)],e.prototype,"style",void 0),Qc([St({annotation:{content:"Phase"}},Ed)],e.prototype,"header",void 0),Qc([xt(100)],e.prototype,"offset",void 0),e})(),Dd=(()=>{class e extends Kc{constructor(){super(...arguments),this.padding=20,this.hasHeader=!0}getClassName(){return"SwimLane"}}return Qc([xt("SwimLane")],e.prototype,"type",void 0),Qc([xt(20)],e.prototype,"phaseSize",void 0),Qc([Pt([],Id)],e.prototype,"phases",void 0),Qc([xt("Horizontal")],e.prototype,"orientation",void 0),Qc([Pt([],Ad)],e.prototype,"lanes",void 0),Qc([St({style:{fill:"#E7F4FF",strokeColor:"#CCCCCC"},annotation:{content:"Function"}},Ed)],e.prototype,"header",void 0),Qc([xt(!1)],e.prototype,"isLane",void 0),Qc([xt(!1)],e.prototype,"isPhase",void 0),e})(),Rd=(()=>{class e{getClassName(){return"ChildContainer"}}return Qc([xt("Canvas")],e.prototype,"type",void 0),Qc([xt("Vertical")],e.prototype,"orientation",void 0),e})(),Ld=(()=>{class e extends Ht{init(e){const t=new So;if(t.measureChildren=!1,t.children=[],this.annotation){const i=e.getWrapper(this.nodes.length>0?e.nameTable[this.nodes[0].id].wrapper:e.nameTable[this.connectors[0].id].wrapper,this.annotation.id);t.children.push(i)}else if(this.nodes||this.connectors){for(let i=0;i<this.nodes.length;i++)t.children.push(e.nameTable[this.nodes[i].id].wrapper);for(let i=0;i<this.connectors.length;i++)t.children.push(e.nameTable[this.connectors[i].id].wrapper)}const i=e.isProtectedOnChange;return e.protectPropertyChange(!1),this.wrapper=t,e.protectPropertyChange(i),t}}return Qc([xt(null)],e.prototype,"wrapper",void 0),Qc([Pt([],Td)],e.prototype,"nodes",void 0),Qc([Pt([],ol)],e.prototype,"connectors",void 0),Qc([xt()],e.prototype,"width",void 0),Qc([xt()],e.prototype,"height",void 0),Qc([xt(0)],e.prototype,"rotateAngle",void 0),Qc([xt(0)],e.prototype,"offsetX",void 0),Qc([xt(0)],e.prototype,"offsetY",void 0),Qc([St({x:.5,y:.5},ws)],e.prototype,"pivot",void 0),Qc([xt("CompleteIntersect")],e.prototype,"rubberBandSelectionMode",void 0),Qc([Pt([],Xl)],e.prototype,"userHandles",void 0),Qc([xt(io.All)],e.prototype,"constraints",void 0),Qc([xt()],e.prototype,"setTooltipTemplate",void 0),e})();function zd(e){let t,i=[];if("msie"===Z.info.name||"edge"===Z.info.name)for(let n=0;n<e.childNodes.length;n++)t=e.childNodes[n],1===t.nodeType&&i.push(t);else i=e.children;return i}function Md(e){if(e){const t="measureElement";window[t].style.visibility="visible";const i=zd(window[t].children[2])[0];i.setAttribute("d",e);const n=i.getBBox(),r=new Ds(n.x,n.y,n.width,n.height);return window[t].style.visibility="hidden",r}return new Ds(0,0,0,0)}function kd(e,t,i,n,r){const s=new bs,o=Zd("span",{style:"display:inline-block; line-height: normal"});return e.bold&&(o.style.fontWeight="bold"),e.italic&&(o.style.fontStyle="italic"),void 0!==i&&(o.style.width=i.toString()+"px"),void 0!==n&&(o.style.height=n.toString()+"px"),void 0!==r&&(o.style.maxWidth=r.toString()+"px"),o.style.fontFamily=e.fontFamily,o.style.fontSize=e.fontSize+"px",o.style.color=e.color,o.textContent=t,o.style.whiteSpace=wp(e.whiteSpace,e.textWrapping),o.style.wordBreak=void 0!==r?"break-word":fp(e.textWrapping),document.body.appendChild(o),s.width=o.offsetWidth,s.height=o.offsetHeight,document.body.removeChild(o),s}function jd(e,t,i,n){let r=0,s=0,o=!1,a="",l=[];const h=t;return 0===h.x&&0===h.y||(r=0-Number(h.x),s=0-Number(h.y)),(e.actualSize.width!==h.width||e.actualSize.height!==h.height||n)&&(r=(n&&n.width||e.actualSize.width)/Number(h.width?h.width:1),s=(n&&n.height||e.actualSize.height)/Number(h.height?h.height:1),o=!0),l=xs(e.data),l=Es(l),a=Ps(l,r,s,o,h.x,h.y,0,0),o=!1,a}function Hd(e){return Nd(e).getElementsByClassName("e-diagram-layer")[0]}function Nd(e,t){let i,n;return t&&(n=document.getElementById(t)),i="msie"===Z.info.name||"edge"===Z.info.name?n?n.querySelector("#"+e):document.getElementById(e):n?n.querySelector("#"+CSS.escape(e)):document.getElementById(e),i}function _d(e,t,i){let n,r,s,o="";var a;"native"===i?(r=function(e){let t=null;return t=Vd(e).getElementById(e+"_nativeLayer"),t}(e),o="_content_groupElement"):"html"===i?(r=qd(e).childNodes[0],o="_html_element"):(r=Hd(a=e).getElementById(a+"_diagramLayer"),o="_groupElement");for(let l=0;r.childNodes&&l<r.childNodes.length;l++)if(s=r.childNodes[l],s&&s.id===t+o){n=l;break}return n}function Bd(e){let t=null;return t=Nd(e).getElementsByClassName("e-adorner-layer")[0],t}function Wd(e){let t=null;return t=Bd(e).getElementById(e+"_SelectorElement"),t}function Ud(e){let t=null;return t=Bd(e).getElementById(e+"_diagramAdorner"),t}function Fd(e){let t=null;return t=Nd(e).getElementsByClassName("e-userHandle-layer")[0],t}function Vd(e){let t;return t=Nd(e).getElementsByClassName("e-native-layer")[0],t}function Xd(e){let t=null;return t=Nd(e).getElementsByClassName("e-grid-layer")[0],t}function Yd(e){return Nd(e).getElementsByClassName("e-background-layer")[0].parentNode}function Gd(e){let t=null;return t=Nd(e).getElementsByClassName("e-background-layer")[0],t}function qd(e){let t=null;return window.domTable[e+"html_layer"]?t=window.domTable[e+"html_layer"]:(t=Nd(e).getElementsByClassName("e-html-layer")[0],window.domTable[e+"html_layer"]=t),t}function Zd(e,t){const i=Ue(e);return np(i,t),i}function $d(e,t){const i=document.createElementNS("http://www.w3.org/2000/svg",e);return tp(i,t),i}function Qd(e,t){return(" "+("object"==typeof e.className?e.className.animVal:e.className)+" ").indexOf(" "+t+" ")>-1}function Jd(e,t,i){e=[];for(let n=0,r=i.length;n<r;n++)e.push({pageX:i[n].clientX,pageY:i[n].clientY,pointerId:null});return e}function Kd(e,t){const i=Nd(e,t);i&&i.parentNode.removeChild(i)}function ep(e,t,i){let n;n=t?Zd("div",{style:"height: 100%; width: 100%"}):document.createElementNS("http://www.w3.org/2000/svg","g");const r=Dc(e);let s,o,a={};if(r instanceof Td){if(a=r,"Native"===r.shape.type){let t;const i=document.createElementNS("http://www.w3.org/2000/svg","svg");document.body.appendChild(i),i.innerHTML=r.shape.content,t=i.getElementsByTagName("svg").length>0?i.getElementsByTagName("svg")[0].outerHTML:i.getElementsByTagName("g")[0].outerHTML,r.shape.content=t,e.content=t,i.parentElement.removeChild(i)}s="nodeTemplate"}else a=r,s="annotationTemplate";const l=document.getElementById(e.diagramId).ej2_instances[0];if("string"!=typeof e.content||e.isTemplate)if(e.isTemplate){let t;t=e.getNodeTemplate()(dp(i),l,s+"_"+("nodeTemplate"===s?i.id:e.nodeId+i.id),void 0,void 0,!1);for(let e=0;e<t.length;e++)n.appendChild(t[e])}else n.appendChild(e.content);else{const t=document.getElementById(e.content);if(t)n.appendChild(t);else{let t;for(o of(t=Se(e.content),t(a,l,s,"")))n.appendChild(o)}}return e.isTemplate?n:n.cloneNode(!0)}function tp(e,t){const i=Object.keys(t);for(let n=0;n<i.length;n++)"style"!==i[n]?e.setAttribute(i[n],t[i[n]]):ip(e,t[i[n]])}function ip(e,t){const i=t.split(";");for(let n=0;n<i.length;n++){const t=i[n].split(":");2===t.length&&(e.style[t[0].trim()]=t[1].trim())}}function np(e,t){const i=Object.keys(t);for(let n=0;n<i.length;n++)"style"!==i[n]?e.setAttribute(i[n],t[i[n]]):ip(e,t[i[n]])}function rp(e,t,i,n){return!(t.length>=1&&0===e.x)||"Clip"!==n.textOverflow&&"Ellipsis"!==n.textOverflow||"Wrap"!==n.textWrapping&&"WrapWithOverflow"!==n.textWrapping||(e.x=t[i-1]?t[i-1].x:-e.width/2),e.x}function sp(e,t,i){return i&&!t.template?(e.isTemplate=!0,e.template=e.content=ep(e,!0,t)):e.content=t.template,e}function op(){const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";let t,i="";for(let n=0;n<5;n++){if("crypto"in window&&"getRandomValues"in crypto){const i=new Uint16Array(1);t=(window.msCrypto||window.crypto).getRandomValues(i)[0]%(e.length-1)}else t=Math.floor(Math.random()*e.length);0===n&&t<10?n--:i+=e.substring(t,t+1)}return i}function ap(e,t){if(e.nodes&&e.nodes.length>0)for(let i=0;i<e.nodes.length;i++)if(e.nodes[i].id===t)return i;if(e.connectors&&e.connectors.length>0)for(let i=0;i<e.connectors.length;i++)if(e.connectors[i].id===t)return i;return null}function lp(e){if(e)try{if(document.querySelectorAll(e).length)return Se(document.querySelector(e).innerHTML.trim())}catch(t){return Se(e)}}function hp(e){let t=new Ds;const i=e.offsetY-e.actualSize.height*e.pivot.y,n=e.offsetY+e.actualSize.height*(1-e.pivot.y),r=e.offsetX-e.actualSize.width*e.pivot.x,s=e.offsetX+e.actualSize.width*(1-e.pivot.x);return t=Ds.toBounds([{x:r,y:i},{x:s,y:i},{x:r,y:n},{x:s,y:n}]),t}function cp(e){let t=new Ds;const i=hp(e);let n=i.middleLeft,r=i.topCenter,s=i.bottomCenter,o=i.middleRight,a=i.topLeft,l=i.topRight,h=i.bottomLeft,c=i.bottomRight;if(e.corners={topLeft:a,topCenter:r,topRight:l,middleLeft:n,middleRight:o,bottomLeft:h,bottomCenter:s,bottomRight:c},0!==e.rotateAngle||0!==e.parentTransform){const t=zs();ks(t,e.rotateAngle+e.parentTransform,e.offsetX,e.offsetY),e.corners.topLeft=a=Ms(t,a),e.corners.topCenter=r=Ms(t,r),e.corners.topRight=l=Ms(t,l),e.corners.middleLeft=n=Ms(t,n),e.corners.middleRight=o=Ms(t,o),e.corners.bottomLeft=h=Ms(t,h),e.corners.bottomCenter=s=Ms(t,s),e.corners.bottomRight=c=Ms(t,c)}return t=Ds.toBounds([a,l,h,c]),e.corners.left=t.left,e.corners.right=t.right,e.corners.top=t.top,e.corners.bottom=t.bottom,e.corners.center=t.center,e.corners.width=t.width,e.corners.height=t.height,t}function dp(e,t,i,n){const r={},s="properties";if(e){i=e.propName;let o=[];o=o.concat(Object.keys(e[s]||e));let a=[];if(o.push("version"),i){const e=Cp(t);a=e?e(i):[],o=o.concat(a)}const l=function(e){switch(e){case"nodes":case"children":return["inEdges","outEdges","parentId","processId","nodeId","umlIndex","isPhase","isLane"];case"connectors":return["parentId"];case"annotation":case"annotations":return["nodeId"];case"shape":return["hasHeader"];case"layers":return["objectZIndex"]}return[]}(i);o=o.concat(l),n&&(o=function(e,t){let i=[];return t instanceof Td?i=["width","height","offsetX","offsetY","container","visible","horizontalAlignment","verticalAlignment","backgroundColor","borderColor","borderWidth","rotateAngle","minHeight","minWidth","maxHeight","maxWidth","pivot","margin","flip","wrapper","constraints","style","annotations","ports","isExpanded","expandIcon"]:t instanceof ol?i=["constraints","sourcePadding","targetPadding","cornerRadius","flip","type","targetDecorator","sourceDecorator","sourceID","shape","bridgeSpace","annotations","segments","hitPadding","tooltip","previewSize","dragSize","style","sourcePortID","targetID","targetPortID","visible"]:t instanceof Fa?i=["height","width","shape","style","pivot","pathData"]:t instanceof Kc||t instanceof Xc?(i.push("shape"),t instanceof sd?i.push("cornerRadius"):t instanceof Text?i.push("margin"):t instanceof Image?(i.push("align"),i.push("scale")):t instanceof td?i.push("scale"):t instanceof fd?(i.push("activity"),i.push("annotations")):t instanceof Xc&&(i.push("borderColor"),i.push("borderWidth"),i.push("cornerRadius"),i.push("fill"))):t instanceof gd?i.push("subProcess"):t instanceof hd?(i.push("call"),i.push("compensation"),i.push("loop")):t instanceof ud?(i.push("adhoc"),i.push("boundary"),i.push("compensation"),i.push("loop"),i.push("processes")):t instanceof Ro?(i.push("height"),i.push("width"),i.push("visibility"),i.push("horizontalAlignment"),i.push("verticalAlignment"),i.push("shape")):t instanceof ko?(i.push("constraints"),i.push("height"),i.push("horizontalAlignment"),i.push("rotateAngle"),i.push("template"),i.push("verticalAlignment"),i.push("visibility"),i.push("width"),i.push("margin")):t instanceof Vs?(i.push("left"),i.push("right"),i.push("top"),i.push("bottom")):t instanceof Js&&(i=["strokeWidth","strokeDashArray","opacity","gradient","fontSize","fontFamily","textOverflow","textDecoration","whiteSpace","textWrapping","textAlign","italic","bold"]),t instanceof $s&&(i.push("strokeColor"),i.push("color")),e.concat(i)}(o,e));for(const i of o)"historyManager"!==i&&("wrapper"!==i?e[i]&&e.hasOwnProperty("observers")||(r[i]=e[i]instanceof Array?pp(-1===l.indexOf(i)&&e[s]?e[s][i]:e[i],t,i,n):e[i]instanceof Array==0&&e[i]instanceof HTMLElement?e[i].cloneNode(!0).innerHtml:e[i]instanceof Array==0&&e[i]instanceof Object?dp(-1===l.indexOf(i)&&e[s]?e[s][i]:e[i],void 0,void 0,n):e[i]):e[i]&&(r[i]={actualSize:{width:e[i].actualSize.width,height:e[i].actualSize.height},offsetX:e[i].offsetX,offsetY:e[i].offsetY}))}return r}function pp(e,t,i,n){let r;if(e){r=[];for(let s=0;s<e.length;s++)r.push(e[s]instanceof Array?e[s]:e[s]instanceof Object?dp(e[s],t,i,n):e[s])}return r}function up(e,t){if(e){t||(t={properties:{}});for(const i of Object.keys(e))if(e[i]instanceof Array){const n=gp(e[i],t.properties[i]);t.properties[i]&&t.properties[i].length||(t[i]=n)}else if(e[i]instanceof Array==0&&e[i]instanceof HTMLElement)t[i]=e[i].cloneNode(!0).innerHtml;else if(e[i]instanceof Array==0&&e[i]instanceof Object){const n=up(e[i],t.properties[i]);n.properties&&!Object.keys(n.properties).length&&delete n.properties,t[i]=n}else t[i]=void 0!==t.properties[i]?t[i]:e[i]}return t}function gp(e,t){const i=[];let n=!1;t||(t=[]),t.length||(n=!0);for(let r=0;r<e.length;r++)if(e[r]instanceof Array)gp(e[r],t[r]),n&&i.push(gp);else if(e[r]instanceof Object){const s=up(e[r],t[r]);n&&i.push(s)}else i.push(e[r]);return i}function mp(e){let t="";switch(e){case"Center":t="center";break;case"Left":t="left";break;case"Right":t="right"}return t}function fp(e){let t="";switch(e){case"Wrap":t="breakall";break;case"NoWrap":t="keepall";break;case"WrapWithOverflow":t="normal";break;case"LineThrough":t="line-through"}return t}function yp(e,t){window.measureElement.style.visibility="visible";const i=zd(window.measureElement.children[2])[1];i.textContent=e,ip(i,"font-size:"+t.fontSize+"px; font-family:"+t.fontFamily+";font-weight:"+(t.bold?"bold":"normal"));const n=i.getBBox().width;return window.measureElement.style.visibility="hidden",n}function bp(e,t){let i=0;return i=(e+t)/2,i}function vp(e,t){let i=0,n=0,r=0,s=0,o="";n=e.length;let a=0;do{s>0&&(i=r),r=Math.floor(bp(i,n)),o+=e.substr(i,r),s=yp(o,t)}while(s<=t.width);for(o=o.substr(0,i),a=i;a<n;a++)if(o+=e[a],s=yp(o,t),s>=t.width){e=e.substr(0,o.length-1);break}return"Ellipsis"===t.textOverflow?(e=e.substr(0,e.length-3),e+="..."):e=e.substr(0,e.length),e}function wp(e,t){if("NoWrap"===t&&"PreserveAll"===e)return"pre";let i="";switch(e){case"CollapseAll":i="nowrap";break;case"CollapseSpace":i="pre-line";break;case"PreserveAll":i="pre-wrap"}return i}function xp(e,t){const i=zs();ks(i,t,0,0);const n=Ms(i,{x:0,y:0}),r=Ms(i,{x:e.width,y:0}),s=Ms(i,{x:0,y:e.height}),o=Ms(i,{x:e.width,y:e.height}),a=Math.min(n.x,r.x,s.x,o.x),l=Math.min(n.y,r.y,s.y,o.y),h=Math.max(n.x,r.x,s.x,o.x),c=Math.max(n.y,r.y,s.y,o.y);return new bs(h-a,c-l)}function Sp(e,t,i,n){if(0!==e){const r=zs();return ks(r,e,t,i),Ms(r,n)}return n}function Cp(e){return void 0!==e&&"string"==typeof e&&(e=o(e,window)),e}class Pp{static getContext(e){return e.getContext("2d")}static setCanvasSize(e,t,i){e&&(e.setAttribute("width",t.toString()),e.setAttribute("height",i.toString()))}renderGradient(e,t,i,n){let r,s,o;if("None"!==e.gradient.type){for(let t=0;t<e.gradient.stops.length;t++)r=void 0!==r?e.gradient.stops[t].offset:Math.max(r,e.gradient.stops[t].offset),s=void 0!==s?e.gradient.stops[t].offset:Math.min(s,e.gradient.stops[t].offset);if("Linear"===e.gradient.type){const r=e.gradient;o=t.createLinearGradient(i+r.x1,n+r.y1,i+r.x2,n+r.y2)}else{const r=e.gradient;o=t.createRadialGradient(i+r.fx,n+r.fy,0,i+r.cx,n+r.cy,r.r)}for(let t=0;t<e.gradient.stops.length;t++){const i=e.gradient.stops[t];o.addColorStop(s<0?(r+i.offset)/(2*r):i.offset/r,i.color)}t.fillStyle=o}return t}renderShadow(e,t,i=null){const n=Pp.getContext(t);n.save(),n.beginPath(),n.strokeStyle=n.fillStyle=e.shadow.color,n.globalAlpha=e.shadow.opacity;const r=ws.transform({x:0,y:0},e.shadow.angle,e.shadow.distance),s=e.x+r.x,o=e.y+r.y;this.rotateContext(t,e.angle,s+e.width*e.pivotX,o+e.height*e.pivotY),i?(n.translate(s,o),this.renderPath(t,e,i),n.translate(-s,-o)):(n.rect(s,o,e.width,e.height),n.fillRect(s,o,e.width,e.height)),n.fill(),n.stroke(),n.closePath(),n.restore()}static createCanvas(e,t,i){const n=Zd("canvas",{id:e});return this.setCanvasSize(n,t,i),n}setStyle(e,t){const i=Pp.getContext(e);"none"===t.fill&&(t.fill="transparent"),"none"===t.stroke&&(t.stroke="transparent"),i.strokeStyle=t.stroke,i.lineWidth=t.strokeWidth,0===t.strokeWidth&&(i.strokeStyle="transparent"),i.globalAlpha=t.opacity;let n=[];t.dashArray&&(n=this.parseDashArray(t.dashArray)),i.setLineDash(n),t.gradient&&"None"!==t.gradient.type?this.renderGradient(t,i,t.x,t.y):i.fillStyle=t.fill}rotateContext(e,t,i,n){const r=Pp.getContext(e);r.translate(i,n),r.rotate(t*Math.PI/180),r.translate(-i,-n)}setFontStyle(e,t){const i=Pp.getContext(e);let n="";t.italic&&(n+="italic "),t.bold&&(n+="bold "),n+=t.fontSize+"px ",n+=t.fontFamily,i.font=n}parseDashArray(e){const t=[],i=-1!==e.indexOf(" ")?" ":",",n=e.split(i);for(const r of n)t.push(Number(r));return t}drawRoundedRect(e,t){const i=Pp.getContext(e);i.beginPath();const n=t.x,r=t.y,s=t.width,o=t.height,a=n+s/2,l=r+o/2;i.beginPath(),this.setStyle(e,t),i.moveTo(n,l),i.quadraticCurveTo(n,r,a,r),i.quadraticCurveTo(n+s,r,n+s,l),i.quadraticCurveTo(n+s,r+o,a,r+o),i.quadraticCurveTo(n,r+o,n,l),i.stroke()}drawRectangle(e,t){if(!0===t.visible)if(t.cornerRadius)t.width<30||t.height<30?this.drawRoundedRect(e,t):(t.data=function(e,t,i){let n="";const r=[{x:0+e,y:0},{x:0+i-e,y:0},{x:0+i,y:0+e},{x:0+i,y:0+t-e},{x:0+i-e,y:0+t},{x:0+e,y:0+t},{x:0,y:0+t-e},{x:0,y:0+e}],s=[{x:0+i,y:0},{x:0+i,y:0+t},{x:0,y:0+t},{x:0,y:0}];let o,a,l,h=0;for(n="M"+r[0].x+" "+r[0].y,l=0;l<r.length;l+=2)o=r[l+1],n+="L"+o.x+" "+o.y,a=r[l+2]||r[0],n+="Q"+s[h].x+" "+s[h].y+" "+a.x+" "+a.y,h++;return n}(t.cornerRadius,t.height,t.width),this.drawPath(e,t));else{const i=Pp.getContext(e);t.shadow&&this.renderShadow(t,e),i.save(),i.beginPath(),this.rotateContext(e,t.angle,t.x+t.width*t.pivotX,t.y+t.height*t.pivotY),this.setStyle(e,t),i.rect(t.x,t.y,t.width,t.height),i.fillRect(t.x,t.y,t.width,t.height),i.fill(),i.stroke(),i.closePath(),i.restore()}}drawPath(e,t){let i=[];i=xs(t.data),i=Cs(i),t.shadow&&this.renderShadow(t,e,i);const n=Pp.getContext(e);n.save(),n.beginPath();const r=t.y+t.height*t.pivotY,s=t.x+t.width*t.pivotX;"Horizontal"===t.flip||"Vertical"===t.flip?(n.translate(t.x+t.width/2,t.y+t.height/2),n.rotate(-t.angle*Math.PI/180),n.translate(-t.x-t.width/2,-t.y-t.height/2)):this.rotateContext(e,t.angle,s,r),this.setStyle(e,t),n.translate(t.x,t.y),"Horizontal"===t.flip?(n.scale(-1,1),n.translate(-1*t.width,0)):"Vertical"===t.flip?(n.scale(1,-1),n.translate(0,-1*t.height)):"Both"===t.flip&&(n.scale(-1,-1),n.translate(-1*t.width,-1*t.height)),this.renderPath(e,t,i),n.fill(),n.translate(-t.x,-t.y),n.stroke(),n.restore()}renderPath(e,t,i){if(!0===t.visible){const t=Pp.getContext(e);let n,r,s,o,a,l,h,c,d,p;const u=i;for(h=0,c=0,p=0,d=u.length;p<d;++p){const e=u[p];switch("x1"in e&&(s=e.x1),"x2"in e&&(a=e.x2),"y1"in e&&(o=e.y1),"y2"in e&&(l=e.y2),"x"in e&&(h=e.x),"y"in e&&(c=e.y),e.command){case"M":t.moveTo(h,c),e.x=h,e.y=c;break;case"L":t.lineTo(h,c),e.x=h,e.y=c;break;case"C":t.bezierCurveTo(s,o,a,l,h,c),e.x=h,e.y=c,e.x1=s,e.y1=o,e.x2=a,e.y2=l;break;case"Q":t.quadraticCurveTo(s,o,h,c),e.x=h,e.y=c,e.x1=s,e.y1=o;break;case"A":let i={x:n,y:r},d=e.r1,p=e.r2;const u=e.angle*(Math.PI/180),g=e.largeArc,m=e.sweep,f={x:h,y:c},y={x:Math.cos(u)*(i.x-f.x)/2+Math.sin(u)*(i.y-f.y)/2,y:-Math.sin(u)*(i.x-f.x)/2+Math.cos(u)*(i.y-f.y)/2},b=Math.pow(y.x,2)/Math.pow(d,2)+Math.pow(y.y,2)/Math.pow(p,2);b>1&&(d*=Math.sqrt(b),p*=Math.sqrt(b));const v=Math.pow(p,2)*Math.pow(y.x,2);let w=(g===m?-1:1)*Math.sqrt((Math.pow(d,2)*Math.pow(p,2)-Math.pow(d,2)*Math.pow(y.y,2)-v)/(Math.pow(d,2)*Math.pow(y.y,2)+Math.pow(p,2)*Math.pow(y.x,2)));isNaN(w)&&(w=0);const x={x:w*d*y.y/p,y:w*-p*y.x/d},S={x:(i.x+f.x)/2+Math.cos(u)*x.x-Math.sin(u)*x.y,y:(i.y+f.y)/2+Math.sin(u)*x.x+Math.cos(u)*x.y},C=this.a([1,0],[(y.x-x.x)/d,(y.y-x.y)/p]),P=[(y.x-x.x)/d,(y.y-x.y)/p],O=[(-y.x-x.x)/d,(-y.y-x.y)/p];let T=this.a(P,O);if(this.r(P,O)<=-1&&(T=Math.PI),this.r(P,O)>=1&&(T=0),e.centp=S,e.xAxisRotation=u,e.rx=d,e.ry=p,e.a1=C,e.ad=T,e.sweep=m,null!=t){const e=d>p?d:p,i=d>p?1:d/p,n=d>p?p/d:1;t.save(),t.translate(S.x,S.y),t.rotate(u),t.scale(i,n),t.arc(0,0,e,C,C+T,!m),t.scale(1/i,1/n),t.rotate(-u),t.translate(-S.x,-S.y),t.restore()}break;case"Z":case"z":t.closePath(),h=n,c=r}n=h,r=c}}}drawText(e,t,i,n,r,s,o){if(t.content&&!0===t.visible){const i=Pp.getContext(e);i.save(),this.setStyle(e,t),s&&(t.fontSize*=s),this.rotateContext(e,t.angle,t.x+t.width*t.pivotX,t.y+t.height*t.pivotY),this.setFontStyle(e,t);let n=0,r=[];r=t.childNodes;const a=t.wrapBounds;if(i.fillStyle=t.color,a){const e=this.labelAlign(t,a,r);for(n=0;n<r.length;n++){const l=r[n];l.x=rp(l,r,n,t);const h=e.x+(s?l.x*s:l.x)-a.x,c=e.y+(s?l.dy*s:l.dy)*n+.8*t.fontSize;if(a.width>t.width&&"Wrap"!==t.textOverflow&&"NoWrap"===t.textWrapping&&(l.text=vp(l.text,t)),"Clip"!==t.textOverflow&&"Ellipsis"!==t.textOverflow||"Wrap"!==t.textWrapping?i.fillText(l.text,h,c):c<o.actualSize.height+o.bounds.y&&("Ellipsis"===t.textOverflow&&r[n+1]&&e.y+r[n+1].dy*(n+1)+.8*t.fontSize>o.actualSize.height+o.bounds.y&&(l.text=l.text.slice(0,l.text.length-3),l.text=l.text.concat("...")),i.fillText(l.text,h,c)),"Underline"===t.textDecoration||"Overline"===t.textDecoration||"LineThrough"===t.textDecoration){const r=h;let s;const o=h+i.measureText(l.text).width;let a;switch(t.textDecoration){case"Underline":s=c+2,a=c+2;break;case"Overline":s=e.y+l.dy*n,a=e.y+l.dy*n;break;case"LineThrough":s=(c+e.y+l.dy*n)/2+2,a=(c+e.y+l.dy*n)/2+2}i.beginPath(),i.moveTo(r,s),i.lineTo(o,a),i.strokeStyle=t.color,i.lineWidth=.08*t.fontSize,i.globalAlpha=t.opacity,i.stroke()}}}i.restore()}}loadImage(e,t,i,n,r){this.rotateContext(i,t.angle,n,r);const s=new Image;s.src=t.source,this.image(e,s,t.x,t.y,t.width,t.height,t)}drawImage(e,t,i,n){if(t.visible){const i=Pp.getContext(e);i.save();const r=t.x+t.width*t.pivotX,s=t.y+t.height*t.pivotY,o=new Image;o.src=t.source,i.canvas.id.split("_"),n?o.onload=()=>{this.loadImage(i,t,e,r,s)}:this.loadImage(i,t,e,r,s),i.restore()}}image(e,t,i,n,r,s,o){e.beginPath();const a=t.width,l=t.height,h=r,c=s;let d=0,p=0;if(o&&"None"!==o.alignment){const u=o.alignment.toLowerCase().substr(1,3),g=o.alignment.toLowerCase().substr(5,3);if("Slice"===o.scale){const o=()=>{d=h,p=l*h/a},m=()=>{d=a*c/l,p=c};h>c?(o(),c>p&&m()):h===c?a>l?m():o():(m(),h>d&&o());const f=this.getSliceOffset(u,d,h,a),y=this.getSliceOffset(g,p,c,l),b=a-f,v=l-y,w=d-f*(d/a),x=p-y*(p/l),S=Zd("canvas",{width:r.toString(),height:s.toString()});S.getContext("2d").drawImage(t,f,y,b,v,0,0,w,x),e.drawImage(S,i,n,r,s)}else if("Meet"===o.scale){const r=l/a,s=c/h;d=s>r?h:c/r,p=s>r?h*r:c,i+=this.getMeetOffset(u,d,h),n+=this.getMeetOffset(g,p,c),e.drawImage(t,0,0,a,l,i,n,d,p)}else e.drawImage(t,i,n,r,s)}else if("None"!==o.flip){let a=1,l=1;"Horizontal"!==o.flip&&"Both"!==o.flip||(i=-i,r=-r,a=-1),"Vertical"!==o.flip&&"Both"!==o.flip||(n=-n,s=-s,l=-1),e.scale(a,l),e.drawImage(t,i,n,r,s)}else e.drawImage(t,i,n,r,s);e.closePath()}getSliceOffset(e,t,i,n){switch(e){case"min":return 0;case"mid":return(t-i)/2*n/t;case"max":return(t-i)*n/t;default:return 0}}getMeetOffset(e,t,i){const n=Math.max(t,i),r=Math.min(t,i);switch(e){case"min":return 0;case"mid":return(n-r)/2;case"max":return n-r;default:return 0}}m(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2))}r(e,t){return(e[0]*t[0]+e[1]*t[1])/(this.m(e)*this.m(t))}a(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(this.r(e,t))}labelAlign(e,t,i){const n=new bs(t.width,i.length*(1.2*e.fontSize)),r={x:0,y:0},s=e.y;let o=.5*e.width;const a=.5*e.height;return"left"===e.textAlign?o=0:"center"===e.textAlign?o=t.width>e.width&&("Ellipsis"===e.textOverflow||"Clip"===e.textOverflow)&&"NoWrap"===e.textWrapping?0:.5*e.width:"right"===e.textAlign&&(o=1*e.width),r.x=e.x+o+(t?t.x:0),r.y=s+a-n.height/2,r}}class Op{renderShadow(e,t,i=null,n){const r=ws.transform({x:0,y:0},e.shadow.angle,e.shadow.distance);let s,o;n&&(o=n.getElementById(t.id+"_shadow")),o||(s=i?"path":"rect",o=document.createElementNS("http://www.w3.org/2000/svg",s),t.appendChild(o));const a={id:t.id+"_shadow",fill:e.shadow.color,stroke:e.shadow.color,opacity:e.shadow.opacity.toString(),transform:"rotate("+e.angle+","+(e.x+e.width*e.pivotX)+","+(e.y+e.height*e.pivotY)+")translate("+(e.x+r.x)+","+(e.y+r.y)+")"};if(n){const e=n.getElementById(t.id);e&&e.insertBefore(o,e.firstChild)}tp(o,a),i?i&&this.renderPath(o,e,i):tp(o,{width:e.width,height:e.height})}parseDashArray(e){return[]}drawRectangle(e,t,i,n,r,s,o){let a,l,h;t.shadow&&!n&&this.renderShadow(t,e,void 0,s),a=t.id===e.id?t.id+"_container":t.id,s&&(l=s.getElementById(a)),l&&!r||(l=document.createElementNS("http://www.w3.org/2000/svg","rect"),e.appendChild(l)),s&&!t.shadow&&(h=s.getElementById(t.id+"_groupElement_shadow"),h&&h.parentNode.removeChild(h));const c={id:a,x:t.x.toString(),y:t.y.toString(),width:t.width.toString(),height:t.height.toString(),visibility:t.visible?"visible":"hidden",transform:"rotate("+t.angle+","+(t.x+t.width*t.pivotX)+","+(t.y+t.height*t.pivotY)+")",rx:t.cornerRadius||0,ry:t.cornerRadius||0,opacity:t.opacity,"aria-label":o||""};t.class&&(c.class=t.class),o||(c["pointer-events"]="none"),tp(l,c),this.setSvgStyle(l,t,i)}updateSelectionRegion(e,t){let i;i=e.parentNode.getElementById(t.id);const n={id:t.id,x:t.x.toString(),y:t.y.toString(),width:t.width.toString(),height:t.height.toString(),transform:"rotate("+t.angle+","+(t.x+t.width*t.pivotX)+","+(t.y+t.height*t.pivotY)+")",class:"e-diagram-selected-region"};i||(i=document.createElementNS("http://www.w3.org/2000/svg","rect"),e.appendChild(i)),this.setSvgStyle(i,t),tp(i,n)}createGElement(e,t){return $d(e,t)}drawLine(e,t){const i=document.createElementNS("http://www.w3.org/2000/svg","line");this.setSvgStyle(i,t);const n=t.x+t.width*t.pivotX,r=t.y+t.height*t.pivotY,s={id:t.id,x1:t.startPoint.x+t.x,y1:t.startPoint.y+t.y,x2:t.endPoint.x+t.x,y2:t.endPoint.y+t.y,stroke:t.stroke,"stroke-width":t.strokeWidth.toString(),opacity:t.opacity.toString(),transform:"rotate("+t.angle+" "+n+" "+r+")",visibility:t.visible?"visible":"hidden"};t.class&&(s.class=t.class),tp(i,s),e.appendChild(i)}drawCircle(e,t,i,n){const r=document.createElementNS("http://www.w3.org/2000/svg","circle");this.setSvgStyle(r,t);let s=t.class||"";i||(s+=" e-disabled");const o={id:t.id,cx:t.centerX,cy:t.centerY,r:t.radius,visibility:t.visible?"visible":"hidden",class:s,"aria-label":n?n["aria-label"]:""};r.style.display=t.visible?"block":"none",tp(r,o),e.appendChild(r)}drawPath(e,t,i,n,r,s){let o,a,l=[];l=xs(t.data),l=Cs(l),t.shadow&&this.renderShadow(t,e,l,r),r&&!t.shadow&&(o=r.getElementById(t.id+"_groupElement_shadow"),o&&o.parentNode.removeChild(o)),r&&(a=r.getElementById(t.id)),a&&!n||(a=document.createElementNS("http://www.w3.org/2000/svg","path"),e.appendChild(a)),this.renderPath(a,t,l);const h={id:t.id,transform:"rotate("+t.angle+","+(t.x+t.width*t.pivotX)+","+(t.y+t.height*t.pivotY)+")translate("+t.x+","+t.y+")",visibility:t.visible?"visible":"hidden",opacity:t.opacity,"aria-label":s||""};t.class&&(h.class=t.class),tp(a,h),this.setSvgStyle(a,t,i)}renderPath(e,t,i){let n,r,s,o,a,l,h,c;const d=i;let p="";for(a=0,l=0,c=0,h=d.length;c<h;++c){const e=d[c];switch("x1"in e&&(n=e.x1),"x2"in e&&(s=e.x2),"y1"in e&&(r=e.y1),"y2"in e&&(o=e.y2),"x"in e&&(a=e.x),"y"in e&&(l=e.y),e.command){case"M":p=p+"M"+a.toString()+","+l.toString()+" ";break;case"L":p=p+"L"+a.toString()+","+l.toString()+" ";break;case"C":p=p+"C"+n.toString()+","+r.toString()+","+s.toString()+","+o.toString()+",",p+=a.toString()+","+l.toString()+" ";break;case"Q":p=p+"Q"+n.toString()+","+r.toString()+","+a.toString()+","+l.toString()+" ";break;case"A":p=p+"A"+e.r1.toString()+","+e.r2.toString()+","+e.angle.toString()+",",p+=e.largeArc.toString()+","+e.sweep+","+a.toString()+","+l.toString()+" ";break;case"Z":case"z":p+="Z "}}e.setAttribute("d",p)}setSvgFontStyle(e,t){e.style.fontStyle=t.italic?"italic":"normal",e.style.fontWeight=t.bold?"bold":"normal",e.style.fontSize=t.fontSize.toString()+"px",e.style.fontFamily=t.fontFamily}drawText(e,t,i,n,r,s,o){if(void 0!==t.content){let s,a,l,h,c,d,p,u=0,g=0,m=0;if(i&&(p=i.getElementById(t.id+"_text")),p){if(t.doWrap)for(;p.firstChild;)p.removeChild(p.firstChild)}else t.doWrap=!0,p=document.createElementNS("http://www.w3.org/2000/svg","text"),"pre-wrap"===t.whiteSpace&&p.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),e.appendChild(p);let f=t.x+t.width*t.pivotX,y=t.y+t.height*t.pivotY,b=0;if(t.doWrap||"Wrap"!==t.textOverflow){const e=document.getElementById(t.id+"_text");for(e&&(e.innerHTML=""),this.setSvgStyle(p,t,r),this.setSvgFontStyle(p,t),s=document.createTextNode(t.content),a=t.childNodes,l=t.wrapBounds,h=this.svgLabelAlign(t,l,a),l.width>t.width&&"Wrap"!==t.textOverflow&&"NoWrap"===t.textWrapping&&(a[0].text=vp(t.content,t)),m=0;m<a.length;m++)if(d=document.createElementNS("http://www.w3.org/2000/svg","tspan"),s=document.createTextNode(a[m].text),c=a[m],c.x=rp(c,a,m,t),u=h.x+c.x-l.x,g=h.y+c.dy*m+.8*t.fontSize,"Clip"!==t.textOverflow&&"Ellipsis"!==t.textOverflow||"WrapWithOverflow"!==t.textWrapping&&"Wrap"!==t.textWrapping||!o)this.setText(p,d,c,s,u,g);else{const e=t.isHorizontalLane?o.actualSize.width:o.actualSize.height;if(!(g<e))break;"Ellipsis"===t.textOverflow&&a[m+1]&&h.y+a[m+1].dy*(m+1)+.8*t.fontSize>e&&(c.text=c.text.slice(0,c.text.length-3),c.text=c.text.concat("..."),s.data=c.text),this.setText(p,d,c,s,u,g),b+=c.dy}}b&&t.isHorizontalLane&&(f=t.parentOffsetX+t.pivotX,y=t.parentOffsetY+t.pivotY,t.y=t.parentOffsetY-b*t.pivotY+.5),t.textDecoration&&"LineThrough"===t.textDecoration&&(t.textDecoration=fp(t.textDecoration)),tp(p,{id:t.id+"_text",fill:t.color,visibility:t.visible?"visible":"hidden","text-decoration":t.textDecoration,transform:"rotate("+t.angle+","+f+","+y+")translate("+t.x+","+t.y+")",opacity:t.opacity,"aria-label":n||""})}}setText(e,t,i,n,r,s){tp(t,{x:r.toString(),y:s.toString()}),e.setAttribute("fill",i.text),t.appendChild(n),e.appendChild(t)}drawImage(e,t,i,n){let r;i&&(r=i.getElementById(t.id+"image")),r||(r=document.createElementNS("http://www.w3.org/2000/svg","image"),e.appendChild(r));const s=new Image;s.src=t.source;let o="None"!==t.scale?t.scale:"";const a=t.alignment;let l=a.charAt(0).toLowerCase()+a.slice(1);"Stretch"!==o&&(l+=" "+o.charAt(0).toLowerCase()+o.slice(1)),tp(r,{id:t.id+"image",x:t.x.toString(),y:t.y.toString(),transform:"rotate("+t.angle+","+(t.x+t.width*t.pivotX)+","+(t.y+t.height*t.pivotY)+")",width:t.width.toString(),visibility:t.visible?"visible":"hidden",height:t.height.toString(),preserveAspectRatio:l,opacity:(t.opacity||1).toString()}),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",s.src.toString())}drawHTMLContent(e,t,i,n,r){let s,o;if(t){let i,n,r;for(i=0;i<t.childNodes.length;i++)for(r=t.childNodes[i],n=0;n<r.childNodes.length;n++)if(r.childNodes[n].id===e.id+"_html_element"){s=r.childNodes[n];break}}if(!s){o=t.querySelector("#"+e.id+"_html_element")||t.querySelector("#"+e.nodeId+"_html_element"),o||(o=Zd("div",{id:e.nodeId+"_html_element",class:"foreign-object"})),s=Zd("div",{id:e.id+"_html_element",class:"foreign-object"});let i=!1;t.parentNode&&t.parentNode.parentNode&&t.parentNode.parentNode.parentNode&&t.parentNode.parentNode.parentNode.classList.contains("e-overview")&&(i=!0),s.appendChild(i?e.template.cloneNode(!0):e.isTemplate?e.template:e.template.cloneNode(!0)),void 0!==r&&t.childNodes.length>r&&t.insertBefore(s,t.childNodes[r]),o.appendChild(s),t.appendChild(o)}const a=hp(e).topLeft;s.setAttribute("style","height:"+e.actualSize.height+"px; width:"+e.actualSize.width+"px;left:"+a.x+"px; top:"+a.y+"px;position:absolute;transform:rotate("+(e.rotateAngle+e.parentTransform)+"deg);pointer-events:"+(n?"all":"none")+";visibility:"+(e.visible?"visible":"hidden")+";opacity:"+e.style.opacity+";")}drawNativeContent(e,t,i,n,r){let s,o;r&&(s=r.getElementById(e.id+"_native_element"),o=r.getElementById(e.id+"_clip")),s||(s=document.createElementNS("http://www.w3.org/2000/svg","g"),s.setAttribute("id",e.id+"_native_element"),s.appendChild(e.template.cloneNode(!0)),t.appendChild(s)),o&&s.removeChild(o),s.setAttribute("style","visibility:"+(e.visible?"visible":"hidden")+";opacity:"+e.style.opacity+";"),this.setNativTransform(e,s,i,n),"Slice"===e.scale&&this.drawClipPath(e,s,i,n,r),tp(s,e.description?{"aria-label":e.description}:{})}setNativTransform(e,t,i,n){const r=0!==e.contentSize.width?e.contentSize.width:1,s=0!==e.contentSize.height?e.contentSize.height:1;t.setAttribute("transform","rotate("+e.parentTransform+","+e.offsetX+","+e.offsetY+") translate("+(e.offsetX-e.templatePosition.x*n/r-n*e.pivot.x)+","+(e.offsetY-e.templatePosition.y*i/s-i*e.pivot.y)+") scale("+n/r+","+i/s+")")}drawClipPath(e,t,i,n,r){const s=e.contentSize.width,o=e.contentSize.height,a=e.width/(n/s),l=e.height/(i/o),h=e.templatePosition.x+(e.width>=e.height?0:(s-a)/2),c=e.templatePosition.y+(e.height>=e.width?0:(o-l)/2);let d=r.getElementById(e.id+"_clip");d=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),d.setAttribute("id",e.id+"_clip"),t.appendChild(d);let p=r.getElementById(e.id+"_clip_rect");return p=document.createElementNS("http://www.w3.org/2000/svg","rect"),d.appendChild(p),tp(p,{id:e.id+"_clip_rect",width:a.toString(),height:l.toString(),x:h.toString(),y:c.toString()}),Wc()?t.setAttribute("clip-path","url("+location.protocol+"//"+location.host+location.pathname+"#"+e.id+"_clip)"):t.setAttribute("clip-path","url(#"+e.id+"_clip)"),t}renderGradient(e,t,i){let n,r,s;const o=Yd(i);let a,l,h=o.getElementById(i+"gradient_pattern");if(h||(h=$d("defs",{id:i+"gradient_pattern"}),o.insertBefore(h,o.firstChild)),yc(t.id),"None"!==e.gradient.type){for(let t=0;t<e.gradient.stops.length;t++)n=n?Math.max(n,e.gradient.stops[t].offset):e.gradient.stops[t].offset,r=r?Math.min(r,e.gradient.stops[t].offset):e.gradient.stops[t].offset;"Linear"===e.gradient.type?(l=e.gradient,l.id=t.id+"_linear",s=this.createLinearGradient(l),h.appendChild(s)):(a=e.gradient,a.id=t.id+"_radial",s=this.createRadialGradient(a),h.appendChild(s));for(let t=0;t<e.gradient.stops.length;t++){const i=e.gradient.stops[t],o=r<0?(n+i.offset)/(2*n):i.offset/n,a=document.createElementNS("http://www.w3.org/2000/svg","stop");tp(a,{offset:o.toString(),style:"stop-color:"+i.color}),s.appendChild(a)}}return s}createLinearGradient(e){const t=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");return tp(t,{id:e.id,x1:e.x1+"%",y1:e.y1+"%",x2:e.x2+"%",y2:e.y2+"%"}),t}createRadialGradient(e){const t=document.createElementNS("http://www.w3.org/2000/svg","radialGradient");return tp(t,{id:e.id,cx:e.cx+"%",cy:e.cy+"%",r:e.r+"%",fx:e.fx+"%",fy:e.fy+"%"}),t}setSvgStyle(e,t,i){if(t.canApplyStyle||void 0===t.canApplyStyle){"none"===t.fill&&(t.fill="transparent"),"none"===t.stroke&&(t.stroke="transparent");let n,r=[];if(t.dashArray&&(r=(new Pp).parseDashArray(t.dashArray)),t.gradient&&"None"!==t.gradient.type&&i){const r=this.renderGradient(t,e,i);n=Wc()?"url("+location.protocol+"//"+location.host+location.pathname+"#"+r.id+")":"url(#"+r.id+")"}else n=t.fill;t.stroke&&e.setAttribute("stroke",t.stroke),null!=t.strokeWidth&&e.setAttribute("stroke-width",t.strokeWidth.toString()),r&&e.setAttribute("stroke-dasharray",r.toString()||"none"),n&&e.setAttribute("fill",n)}}svgLabelAlign(e,t,i){const n=new bs(t.width,i.length*(1.2*e.fontSize)),r={x:0,y:0};let s=.5*e.width;const o=.5*e.height;return"left"===e.textAlign?s=0:"center"===e.textAlign?s=t.width>e.width&&("Ellipsis"===e.textOverflow||"Clip"===e.textOverflow)&&"NoWrap"===e.textWrapping?0:.5*e.width:"right"===e.textAlign&&(s=1*e.width),r.x=0+s+(t?t.x:0),r.y=1.2+o-n.height/2,r}}class Tp{constructor(e,t,i){this.renderer=null,this.isSvgMode=!0,this.transform={x:0,y:0},this.diagramId=e,this.element=Nd(this.diagramId),this.svgRenderer=t,this.isSvgMode=i,this.renderer=i?new Op:new Pp}setCursor(e,t){e.style.cursor=t}setLayers(){this.iconSvgLayer=this.element.getElementsByClassName("e-ports-expand-layer")[0],this.adornerSvgLayer=this.element.getElementsByClassName("e-adorner-layer")[0],this.nativeSvgLayer=this.element.getElementsByClassName("e-native-layer")[0],this.diagramSvgLayer=this.element.getElementsByClassName("e-diagram-layer")[0]}getAdornerLayer(){return Ud(this.diagramId)}getParentSvg(e,t,i){return this.diagramId&&e&&e.id?e.id.split("_icon_content").length>1||e.id.split("_nodeport").length>1||e.elementActions&oo.ElementIsPort?this.iconSvgLayer:t&&"selector"===t?this.adornerSvgLayer:e instanceof Io?this.nativeSvgLayer:this.diagramSvgLayer:i}getParentElement(e,t,i,n){let r=t;if(i&&this.diagramId&&e&&e.id){e.id.split("_icon_content").length>1?(r=i.getElementById(this.diagramId+"_diagramExpander"),t=null):e.id.split("_nodeport").length>1?r=i.getElementById(this.diagramId+"_diagramPorts"):e instanceof Io?(r=i.getElementById(this.diagramId+"_nativeLayer"),t=null):e.elementActions&oo.ElementIsPort?(r=i.getElementById(this.diagramId+"_diagramPorts"),t=null):r=i.getElementById(this.diagramId+"_diagramLayer");const s=this.getGroupElement(e,t||r,n);r=s.g,s.svg&&(i=s.svg)}return{g:r,svg:i}}getGroupElement(e,t,i){let n;const r=this.getParentSvg(e);let s;if(t&&r){if(r&&(n=r.getElementById(e.id+"_groupElement"),!n&&r!==this.nativeSvgLayer)){const t=this.nativeSvgLayer;n=t.getElementById(e.id+"_groupElement"),s=t}n||(n=this.svgRenderer.createGElement("g",{id:e.id+"_groupElement"}),void 0!==i&&t.childNodes.length>i?t.insertBefore(n,t.childNodes[i]):t.appendChild(n))}return{g:n,svg:s}}renderElement(e,t,i,n,r,s,o,a,l){e instanceof So?(e.id=e.id?e.id:op(),this.renderContainer(e,t,i,n,r,s,o,a,l)):e instanceof Ao?this.renderImageElement(e,t,n,r,o):e instanceof Eo?this.renderPathElement(e,t,n,r,o,l):e instanceof Co?this.renderTextElement(e,t,n,r,o):e instanceof Io?this.renderNativeElement(e,t,n,r,o):e instanceof ka?this.renderHTMLElement(e,t,i,n,r,o,a):this.renderRect(e,t,n,r,l)}drawSelectionRectangle(e,t,i,n,r,s){const o={width:i*s.scale,height:n*s.scale,x:.5+(e=(e+s.tx)*s.scale),y:.5+(t=(t+s.ty)*s.scale),fill:"transparent",stroke:"gray",angle:0,pivotX:.5,pivotY:.5,strokeWidth:1,dashArray:"6 3",opacity:1,visible:!0,id:r.id+"_selected_region"},a=this.getAdornerLayer();this.svgRenderer.updateSelectionRegion(a,o)}renderHighlighter(e,t,i){const n=e.actualSize.width||2,r=e.actualSize.height||2;let s=e.offsetX-n*e.pivot.x,o=e.offsetY-r*e.pivot.y;s=(s+i.tx)*i.scale,o=(o+i.ty)*i.scale,this.svgRenderer.drawRectangle(t,{width:n*i.scale,height:r*i.scale,x:s,y:o,fill:"transparent",stroke:"#8CC63F",angle:e.rotateAngle,pivotX:e.pivot.x,pivotY:e.pivot.y,strokeWidth:4,dashArray:"",opacity:1,cornerRadius:0,visible:!0,id:t.id+"_highlighter",class:"e-diagram-highlighter"},this.diagramId,void 0,void 0,t)}renderStackHighlighter(e,t,i,n,r,s,o){const a=e.actualSize.width||2;let l=e.offsetX-a*e.pivot.x;const h=e.actualSize.height||2;let c,d=e.offsetY-h*e.pivot.y;l=(l+i.tx)*i.scale;const p=e.bounds;let u="";if(d=(d+i.ty)*i.scale,n)if(s){const t=a*i.scale;c="M 0 0 L "+(t+2)+" 0 Z";let n=-p.x,s=-p.y,o=[];n=e.actualSize.width/Number(p.width?p.width:1)*i.scale,s=e.actualSize.height/Number(p.height?p.height:1)*i.scale,o=xs("M7,4 L8,4 8,7 11,7 11,8 8,8 8,11 7,11 7,8 4,8 4,7 7,7 z M7.5,0.99999994C3.9160004,1 1,3.9160004 0.99999994,7.5 1,11.084 3.9160004,14 7.5,14 11.084,14 14,11.084 14,7.5 14,3.9160004 11.084,1 7.5,0.99999994 z M7.5,0 C11.636002,0 15,3.3639984 15,7.5 15,11.636002 11.636002,15 7.5,15 3.3640003,15 0,11.636002 0,7.5 0,3.3639984 3.3640003,0 7.5,0 z"),o=Es(o),u=Ps(o,n+t+2,s-8,!1,p.x,p.y,0,0),r.y>=e.offsetY&&(d+=h)}else{o&&r.y>=e.offsetY&&(d+=h);const t=a*i.scale;c="M -10 -10 L 0 0 Z M -10 10 L 0 0 Z M 0 0 L "+t+" 0 Z M "+t+" 0 L "+(t+10)+" 10 Z L "+(t+10)+" -10 Z"}else{const t=h*i.scale;c="M 10 -10 L 0 0 Z M -10 -10 L 0 0 Z M 0 0 L 0 "+t+" Z M 0  "+t+" L -10  "+(t+10)+" Z L 10  "+(t+10)+" Z",r.x>=e.offsetX&&(l+=a)}this.svgRenderer.drawPath(t,{data:c+u,width:a*i.scale,height:h*i.scale,x:l,y:d,fill:"transparent",stroke:"#8CC63F",angle:e.rotateAngle,pivotX:e.pivot.x,pivotY:e.pivot.y,strokeWidth:1,dashArray:"",opacity:1,visible:!0,id:t.id+"_stack_highlighter",class:"e-diagram-highlighter"},this.diagramId)}drawLine(e,t){this.svgRenderer.drawLine(e,t)}drawPath(e,t){this.svgRenderer.drawPath(e,t,this.diagramId)}renderResizeHandle(e,t,i,n,r,s,o,a,l,h){const c=e.offsetX-e.actualSize.width*e.pivot.x,d=e.offsetY-e.actualSize.height*e.pivot.y,p=e.actualSize.height,u=e.actualSize.width;!h&&i&ao.Rotate&&Ul(this.rendererActions)&&!Fl(this.rendererActions)&&(this.renderPivotLine(e,t,s,r,o),this.renderRotateThumb(e,t,s,r,o)),this.renderBorder(e,t,s,a,l,h);const g=e.actualSize.width*n,m=e.actualSize.height*n;l||!Ul(this.rendererActions)||Fl(this.rendererActions)||(g>=40&&m>=40&&(r&io.ResizeNorthWest&&this.renderCircularHandle("resizeNorthWest",e,c,d,t,Sc(r,"ResizeNorthWest"),i&ao.ResizeNorthWest,s,void 0,o,{"aria-label":"Thumb to resize the selected object on top left side direction"},void 0,"e-diagram-resize-handle e-northwest"),r&io.ResizeNorthEast&&this.renderCircularHandle("resizeNorthEast",e,c+u,d,t,Sc(r,"ResizeNorthEast"),i&ao.ResizeNorthEast,s,void 0,o,{"aria-label":"Thumb to resize the selected object on top right side direction"},void 0,"e-diagram-resize-handle e-northeast"),r&io.ResizeSouthWest&&this.renderCircularHandle("resizeSouthWest",e,c,d+p,t,Sc(r,"ResizeSouthWest"),i&ao.ResizeSouthWest,s,void 0,o,{"aria-label":"Thumb to resize the selected object on bottom left side direction"},void 0,"e-diagram-resize-handle e-southwest"),r&io.ResizeSouthEast&&this.renderCircularHandle("resizeSouthEast",e,c+u,d+p,t,Sc(r,"ResizeSouthEast"),i&ao.ResizeSouthEast,s,void 0,o,{"aria-label":"Thumb to resize the selected object on bottom right side direction"},void 0,"e-diagram-resize-handle e-southeast")),r&io.ResizeNorth&&this.renderCircularHandle("resizeNorth",e,c+u/2,d,t,Sc(r,"ResizeNorth"),i&ao.ResizeNorth,s,void 0,o,{"aria-label":"Thumb to resize the selected object on top side direction"},void 0,"e-diagram-resize-handle e-north"),r&io.ResizeSouth&&this.renderCircularHandle("resizeSouth",e,c+u/2,d+p,t,Sc(r,"ResizeSouth"),i&ao.ResizeSouth,s,void 0,o,{"aria-label":"Thumb to resize the selected object on bottom side direction"},void 0,"e-diagram-resize-handle e-south"),r&io.ResizeWest&&this.renderCircularHandle("resizeWest",e,c,d+p/2,t,Sc(r,"ResizeWest"),i&ao.ResizeWest,s,void 0,o,{"aria-label":"Thumb to resize the selected object on left side direction"},void 0,"e-diagram-resize-handle e-west"),r&io.ResizeEast&&this.renderCircularHandle("resizeEast",e,c+u,d+p/2,t,Sc(r,"ResizeEast"),i&ao.ResizeEast,s,void 0,o,{"aria-label":"Thumb to resize the selected object on right side direction"},void 0,"e-diagram-resize-handle e-east"))}renderEndPointHandle(e,t,i,n,r,s,o,a){const l=e.sourcePoint,h=e.targetPoint,c=e.wrapper;let d,p;if(this.renderCircularHandle("connectorSourceThumb",c,l.x,l.y,t,Sc(n,"ConnectorSourceThumb"),i&ao.ConnectorSource,r,s,void 0,{"aria-label":"Thumb to move the source point of the connector"},void 0,"e-diagram-endpoint-handle e-targetend"),this.renderCircularHandle("connectorTargetThumb",c,h.x,h.y,t,Sc(n,"ConnectorTargetThumb"),i&ao.ConnectorTarget,r,o,void 0,{"aria-label":"Thumb to move the target point of the connector"},void 0,"e-diagram-endpoint-handle e-targetend"),a)if(("Straight"===e.type||"Bezier"===e.type)&&e.segments.length>0)for(d=0;d<e.segments.length-1;d++)p=e.segments[d],this.renderCircularHandle("segementThumb_"+(d+1),c,p.point.x,p.point.y,t,!0,i&ao.ConnectorSource,r,s,null,null,d);else for(d=0;d<e.segments.length;d++)this.renderOrthogonalThumbs("orthoThumb_"+(d+1),c,e.segments[d],t,Sc(n,"ConnectorSourceThumb"),r);if("Bezier"===e.type)for(d=0;d<e.segments.length;d++){const s=e.segments[d];let o=ws.isEmptyPoint(s.point1)?s.bezierPoint1:s.point1;this.renderCircularHandle("bezierPoint_"+(d+1)+"_1",c,o.x,o.y,t,Sc(n,"ConnectorSourceThumb"),i&ao.ConnectorSource,r,void 0,void 0,{"aria-label":"Thumb to move the source point of the connector"},void 0,"e-diagram-bezier-handle e-source"),Sc(n,"ConnectorSourceThumb")&&this.renderBezierLine("bezierLine_"+(d+1)+"_1",c,t,s.points[0],ws.isEmptyPoint(s.point1)?s.bezierPoint1:s.point1,r),o=ws.isEmptyPoint(s.point2)?s.bezierPoint2:s.point2,this.renderCircularHandle("bezierPoint_"+(d+1)+"_2",c,o.x,o.y,t,Sc(n,"ConnectorTargetThumb"),i&ao.ConnectorTarget,r,void 0,void 0,{"aria-label":"Thumb to move the target point of the connector"},void 0,"e-diagram-bezier-handle e-target"),Sc(n,"ConnectorTargetThumb")&&this.renderBezierLine("bezierLine_"+(d+1)+"_2",c,t,s.points[1],ws.isEmptyPoint(s.point2)?s.bezierPoint2:s.point2,r)}}renderOrthogonalThumbs(e,t,i,n,r,s){let o,a,l,h=0;for(h=0;h<i.points.length-1;h++)l=ws.distancePoints(i.points[h],i.points[h+1]),o=i.points[h].y.toFixed(2)===i.points[h+1].y.toFixed(2)?"horizontal":"vertical",a=!!(l>=50&&i.allowDrag),this.renderOrthogonalThumb(e+"_"+(h+1),t,(i.points[h].x+i.points[h+1].x)/2,(i.points[h].y+i.points[h+1].y)/2,n,a,o,s)}renderOrthogonalThumb(e,t,i,n,r,s,o,a){let l,h,c;"horizontal"===o?(l="M0,7 L15,0 L30,7 L15,14 z",h=-15,c=-7):(l="M7,0 L0,15 L7,30 L14,15 z",h=-7,c=-15),this.svgRenderer.drawPath(r,{x:(i+a.tx)*a.scale+h,y:(n+a.ty)*a.scale+c,angle:0,fill:"#e2e2e2",stroke:"black",strokeWidth:1,dashArray:"",data:l,width:20,height:20,pivotX:0,pivotY:0,opacity:1,visible:s,id:e},this.diagramId)}renderPivotLine(e,t,i,n,r){const s=e;let o=!!(n&io.Rotate);r&&(o=!1);const a=this.getBaseAttributes(s,i);a.fill="None",a.stroke="black",a.strokeWidth=1,a.dashArray="2,3",a.visible=o;const l=i.scale;a.x*=l,a.y*=l,a.width*=l,a.height*=l,a.id="pivotLine",a.class="e-diagram-pivot-line";const h={x:s.actualSize.width*s.pivot.x*l,y:0};a.startPoint={x:s.actualSize.width*s.pivot.x*l,y:-20},a.endPoint=h,this.svgRenderer.drawLine(t,a)}renderBezierLine(e,t,i,n,r,s){const o=this.getBaseAttributes(t,s);o.id=e,o.stroke="black",o.strokeWidth=1,o.dashArray="3,3",o.fill="None",o.class="e-diagram-bezier-line",o.x=0,o.y=0;const a=s.scale,l={x:(r.x+s.tx)*a,y:(r.y+s.ty)*a};o.startPoint={x:(n.x+s.tx)*a,y:(n.y+s.ty)*a},o.endPoint=l,this.svgRenderer.drawLine(i,o)}renderCircularHandle(e,t,i,n,r,s,o,a,l,h,c,d,p){const u=t;let g=7,m={x:i,y:n};if(0!==u.rotateAngle||0!==u.parentTransform){const e=zs();ks(e,u.rotateAngle+u.parentTransform,u.offsetX,u.offsetY),m=Ms(e,m)}const f=this.getBaseAttributes(u);f.stroke="black",f.strokeWidth=1,void 0!==d?(g=5,f.id="segmentEnd_"+d,f.fill="#e2e2e2"):(g=7,f.fill=l?"#8CC63F":"white"),f.centerX=(m.x+a.tx)*a.scale,f.centerY=(m.y+a.ty)*a.scale,f.radius=g,f.angle=0,f.id=e,f.visible=s,f.class=p,l&&(f.class+=" e-connected"),h&&(f.visible=!1),this.svgRenderer.drawCircle(r,f,o,c)}renderBorder(e,t,i,n,r,s){const o=this.getBaseAttributes(e,i);o.x*=i.scale,o.y*=i.scale,o.width*=i.scale,o.height*=i.scale,o.fill="transparent",o.stroke="#097F7F",o.strokeWidth=1.2,o.gradient=null,o.dashArray="6,3",o.class="e-diagram-border",s&&(o.class+=" e-diagram-lane"),o.id="borderRect",o.id=this.rendererActions&mo.DrawSelectorBorder?"borderRect_symbol":"borderRect",n||(o.class+=" e-disabled"),r&&(o.class+=" e-thick-border"),o.cornerRadius=0;const a=this.getParentSvg(e,"selector");this.svgRenderer.drawRectangle(t,o,this.diagramId,void 0,!0,a)}renderUserHandler(e,t,i,n){const r=e.wrapper;let s;for(const o of e.userHandles){s=!0,(o.disableConnectors&&e.connectors.length>0||o.disableNodes&&e.nodes.length>0)&&(s=!1);const a=document.getElementById(o.name+"_template_hiddenUserHandle");a&&(o.template=a.childNodes[0].cloneNode(!0));const l=wc(e,o,i);if(l.x=(l.x+i.tx)*i.scale,l.y=(l.y+i.ty)*i.scale,o.visible&&(o.visible=!!(e.constraints&io.UserHandle)),s)if(o.pathData){const e=o.pathData?o.pathData:o.content,i=this.getBaseAttributes(r);i.id=o.name+"_userhandle",i.fill=o.backgroundColor,i.stroke=o.borderColor,i.strokeWidth=o.borderWidth,i.centerX=l.x,i.centerY=l.y,i.radius=.5*o.size,i.class="e-diagram-userhandle-circle",i.angle=0,i.visible=o.visible,i.opacity=1,this.svgRenderer.drawCircle(t,i,1,{"aria-label":o.name+"user handle"});const n=5;let s=[];s=xs(e),s=Es(s);let a=Md(e);const h=Ps(s,(o.size-.45*o.size)/a.width,(o.size-.45*o.size)/a.height,!0,a.x,a.y,0,0);a=Md(h),this.svgRenderer.drawPath(t,{x:l.x-a.width/2,y:l.y-a.height/2,angle:0,id:"",class:"e-diagram-userhandle-path",fill:o.pathColor,stroke:o.backgroundColor,strokeWidth:.5,dashArray:"",data:h,width:o.size-n,height:o.size-n,pivotX:0,pivotY:0,opacity:1,visible:o.visible},this.diagramId,void 0,void 0,{"aria-label":o.name+"user handle"})}else if(o.content){const e=new Io(o.name,this.diagramId);e.content=o.content,e.offsetX=l.x,e.offsetY=l.y,e.id=o.name+"_shape",e.horizontalAlignment="Center",e.verticalAlignment="Center",e.visible=o.visible,e.setOffsetWithRespectToBounds(l.x,l.y,"Fraction"),e.relativeMode="Object",e.description=o.name||"User handle",e.measure(new bs(o.size,o.size)),e.arrange(e.desiredSize),this.svgRenderer.drawNativeContent(e,t,o.size,o.size,this.adornerSvgLayer)}else if(o.source){const e=new Ao,n=this.getBaseAttributes(e,i);n.width=o.size,n.height=o.size,n.x=l.x-o.size/2,n.y=l.y-o.size/2,n.sourceWidth=o.size,n.sourceHeight=o.size,n.alignment=e.imageAlign,n.source=o.source,n.scale=e.imageScale,n.visible=o.visible,n.description=o.name||"User handle",n.id=o.name+"_",this.renderer.drawImage(t,n,this.adornerSvgLayer,!1)}else{const e=new ka(o.name,this.diagramId);e.offsetX=l.x,e.offsetY=l.y,e.id=o.name+"_shape",e.visible=o.visible,e.relativeMode="Object",e.template=o.template,e.measure(new bs(o.size,o.size)),e.arrange(e.desiredSize),this.svgRenderer.drawHTMLContent(e,n,void 0,!0,void 0)}}}renderRotateThumb(e,t,i,n,r){let s;new Eo;const o=new bs;o.width=18,o.height=16;let a=!!(n&io.Rotate);r&&(a=!1);let l=e.offsetX-e.actualSize.width*e.pivot.x+e.pivot.x*e.actualSize.width,h=e.offsetY-e.actualSize.height*e.pivot.y;if(l=(l+i.tx)*i.scale,h=(h+i.ty)*i.scale,s={x:l-.5*o.width,y:h-30-.5*o.height},0!==e.rotateAngle||0!==e.parentTransform){const t=zs();ks(t,e.rotateAngle+e.parentTransform,(i.tx+e.offsetX)*i.scale,(i.ty+e.offsetY)*i.scale),s=Ms(t,s)}const c={x:s.x,y:s.y,angle:e.rotateAngle+e.parentTransform,fill:"#231f20",stroke:"black",strokeWidth:.5,dashArray:"",data:"M 16.856144362449648 10.238890446662904 L 18.000144362449646 3.437890446662903L 15.811144362449646 4.254890446662903 C 14.837144362449646 2.5608904466629028 13.329144362449647  1.2598904466629026 11.485144362449645 0.5588904466629026 C 9.375144362449646 - 0.24510955333709716 7.071144362449646  - 0.18010955333709716 5.010144362449646 0.7438904466629028 C 2.942144362449646 1.6678904466629028 1.365144362449646 3.341890446662903 0.558144362449646 5.452890446662903 C - 0.244855637550354 7.567890446662903 - 0.17985563755035394 9.866890446662904 0.7431443624496461 11.930890446662904 C 1.6681443624496461 13.994890446662904 3.343144362449646 15.575890446662903 5.457144362449647 16.380890446662903 C 6.426144362449647 16.7518904466629 7.450144362449647 16.9348904466629 8.470144362449647 16.9348904466629 C 9.815144362449647 16.9348904466629 11.155144362449647 16.6178904466629 12.367144362449647 15.986890446662901 L 11.351144362449647 14.024890446662901 C 9.767144362449647 14.8468904466629 7.906144362449647 14.953890446662902 6.237144362449647 14.3178904466629 C 4.677144362449647 13.7218904466629 3.444144362449647 12.5558904466629 2.758144362449647 11.028890446662901 C 2.078144362449646 9.501890446662903 2.031144362449646 7.802890446662903 2.622144362449646 6.243890446662903 C 3.216144362449646 4.6798904466629025 4.387144362449646 3.442890446662903 5.914144362449646 2.760890446662903 C 7.437144362449646 2.078890446662903 9.137144362449646 2.0298904466629026 10.700144362449645 2.6258904466629027 C 11.946144362449646 3.100890446662903 12.971144362449646 3.9538904466629026 13.686144362449646 5.049890446662903 L 11.540144362449645 5.850890446662903 L 16.856144362449648 10.238890446662904 Z",width:20,height:20,pivotX:0,pivotY:0,opacity:1,visible:a,id:e.id,class:"e-diagram-rotate-handle"};c.id="rotateThumb",this.svgRenderer.drawPath(t,c,this.diagramId,!0,void 0,{"aria-label":"Thumb to rotate the selected object"})}renderPathElement(e,t,i,n,r,s){const o=this.getBaseAttributes(e,i,s);o.data=e.absolutePath,o.data=e.absolutePath;const a=e.description?e.description:e.id;this.isSvgMode||(o.x=e.flipOffset.x?e.flipOffset.x:o.x,o.y=e.flipOffset.y?e.flipOffset.y:o.y),e.isExport&&(o.data=jd(e,e.absoluteBounds,0,o)),this.renderer.drawPath(t,o,this.diagramId,void 0,n,a)}renderSvgGridlines(e,t,i,n,r,s){const o=document.createElementNS("http://www.w3.org/2000/svg","pattern"),a=document.createElementNS("http://www.w3.org/2000/svg","defs");a.setAttribute("id",this.diagramId+"_grid_pattern_defn"),(e.constraints&to.ShowHorizontalLines||e.constraints&to.ShowVerticalLines)&&o.setAttribute("id",this.diagramId+"_pattern");let l=0,h=0,c=0,d=0,p=1,u=!1;const g="Lines"===e.gridType,m=g?e.verticalGridlines.lineIntervals:e.verticalGridlines.dotIntervals,f=g?e.horizontalGridlines.lineIntervals:e.horizontalGridlines.dotIntervals;if(n.showRulers&&n.dynamicGrid&&r&&s)c=s.updateSegmentWidth(i.scale),d=r.updateSegmentWidth(i.scale),e.horizontalGridlines.scaledIntervals=[c/r.interval],e.verticalGridlines.scaledIntervals=[d/s.interval],u=!0;else{for(let e=0;e<m.length;e+=1)l+=m[e];for(let e=0;e<f.length;e+=1)h+=f[e];p=this.scaleSnapInterval(e,i.scale)}l=u?d:l*p,h=u?c:h*p,tp(o,{id:this.diagramId+"_pattern",x:0,y:0,width:l,height:h,patternUnits:"userSpaceOnUse"}),this.horizontalSvgGridlines(o,l,h,p,e,n,s,u,g,f),this.verticalSvgGridlines(o,l,h,p,e,n,r,u,g,m),a.appendChild(o),t.appendChild(a)}horizontalSvgGridlines(e,t,i,n,r,s,o,a,l,h){let c,d=0,p=[];if(r.constraints&to.ShowHorizontalLines){r.horizontalGridlines.lineDashArray&&(p=this.renderer.parseDashArray(r.horizontalGridlines.lineDashArray)),s.showRulers&&s.dynamicGrid&&o&&(h=this.updateLineIntervals(h,s,o,i,l)),h=Zh(h,l);for(let i=0;i<h.length;i+=2){d=qh(h,l,i,d);const s=0;let o;c=document.createElementNS("http://www.w3.org/2000/svg",l?"path":"circle");let u=l?d+h[i]/2:d;u=a?u:u*n,l?(o=""===p.toString()?{"stroke-width":h[i],d:"M0,"+u+" L"+t+","+u+" Z",class:1.25===h[i]?"e-diagram-thick-grid":"e-diagram-thin-grid",stroke:r.horizontalGridlines.lineColor}:{"stroke-width":h[i],stroke:r.horizontalGridlines.lineColor,d:"M0,"+u+" L"+t+","+u+" Z",class:1.25===h[i]?"e-diagram-thick-grid":"e-diagram-thin-grid",dashArray:p.toString()},tp(c,o),e.appendChild(c),d+=h[i+1]+h[i]):(this.renderDotGrid(i,e,r,s,u,n,!0),d+=h[i])}}}renderDotGrid(e,t,i,n,r,s,o){let a,l,h,c,d=o?i.verticalGridlines.dotIntervals:i.horizontalGridlines.dotIntervals;d=Zh(d,!1);for(let p=1;p<d.length;p+=2)a=p===d.length-1?d[0]:d[p-1],l=document.createElementNS("http://www.w3.org/2000/svg","circle"),h=n,h*=s,c={cx:o?h:r,cy:o?r:h,fill:i.horizontalGridlines.lineColor,r:a},tp(l,c),t.appendChild(l),n+=d[p]+d[p-1]}verticalSvgGridlines(e,t,i,n,r,s,o,a,l,h){let c,d=0,p=[];if(r.constraints&to.ShowVerticalLines){r.verticalGridlines.lineDashArray&&(p=this.renderer.parseDashArray(r.verticalGridlines.lineDashArray)),s.showRulers&&s.dynamicGrid&&o&&(h=this.updateLineIntervals(h,s,o,t,l));const u=0;h=Zh(h,l);for(let t=0;t<h.length;t+=2){d=qh(h,l,t,d);let s,o=l?d+h[t]/2:d;o=a?o:o*n,c=document.createElementNS("http://www.w3.org/2000/svg",l?"path":"circle"),l?(s=""===p.toString()?{"stroke-width":h[t],d:"M"+o+",0 L"+o+","+i+" Z",class:1.25===h[t]?"e-diagram-thick-grid":"e-diagram-thin-grid",stroke:r.verticalGridlines.lineColor}:{"stroke-width":h[t],class:1.25===h[t]?"e-diagram-thick-grid":"e-diagram-thin-grid",stroke:r.verticalGridlines.lineColor,d:"M"+o+",0 L"+o+","+i+" Z",dashArray:p.toString()},tp(c,s),e.appendChild(c),d+=h[t+1]+h[t]):(this.renderDotGrid(t,e,r,u,o,n,!1),d+=h[t])}}}updateGrid(e,t,i,n,r,s){const o=t.getElementById(this.diagramId+"_grid_rect");let a=!1;if(o){let l=t.getElementById(this.diagramId+"_pattern");l&&l.parentNode.removeChild(l);let h=0,c=0,d=1;const p="Lines"===e.gridType,u=p?e.verticalGridlines.lineIntervals:e.verticalGridlines.dotIntervals,g=p?e.horizontalGridlines.lineIntervals:e.horizontalGridlines.dotIntervals;n.showRulers&&n.dynamicGrid&&s&&r?(h=s.updateSegmentWidth(i.scale),c=r.updateSegmentWidth(i.scale),a=!0,e.horizontalGridlines.scaledIntervals=[h/r.interval],e.verticalGridlines.scaledIntervals=[c/s.interval]):d=this.scaleSnapInterval(e,i.scale);let m=0;for(let e=0;e<g.length;e+=1)m+=g[e];let f=0;for(let e=0;e<u.length;e+=1)f+=u[e];let y={x:-i.tx*i.scale,y:-i.ty*i.scale};tp(o,y),f=a?c:f*d,m=a?h:m*d,y={id:this.diagramId+"_pattern",x:0,y:0,width:f,height:m,patternUnits:"userSpaceOnUse"},l=document.createElementNS("http://www.w3.org/2000/svg","pattern"),tp(l,y),this.horizontalSvgGridlines(l,f,m,d,e,n,s,a,p,g),this.verticalSvgGridlines(l,f,m,d,e,n,r,a,p,u);const b=t.getElementById(this.diagramId+"_grid_pattern_defn");b&&b.appendChild(l)}}updateLineIntervals(e,t,i,n,r){const s=[],o=n/i.interval,a=r?i.interval:i.interval+1;for(let l=0;l<2*a;l++)s[l]=l%2==0?r?0===l?1.25:.25:0:r?o-s[l-1]:o;return s}scaleSnapInterval(e,t){if(t>=2)for(;t>=2;)t/=2;else if(t<=.5)for(;t<=.5;)t*=2;let i;if(e.horizontalGridlines.scaledIntervals=e.horizontalGridlines.snapIntervals,e.verticalGridlines.scaledIntervals=e.verticalGridlines.snapIntervals,1!==t){let n=e.horizontalGridlines;for(n.scaledIntervals=[],i=0;i<n.snapIntervals.length;i++)n.scaledIntervals[i]=n.snapIntervals[i]*t;for(n=e.verticalGridlines,n.scaledIntervals=[],i=0;i<n.snapIntervals.length;i++)n.scaledIntervals[i]=n.snapIntervals[i]*t}return t}renderTextElement(e,t,i,n,r){const s=this.getBaseAttributes(e,i);s.cornerRadius=0,s.whiteSpace=wp(e.style.whiteSpace,e.style.textWrapping),s.content=e.content,s.breakWord=fp(e.style.textWrapping),s.textAlign=mp(e.style.textAlign),s.color=e.style.color,s.italic=e.style.italic,s.bold=e.style.bold,s.fontSize=e.style.fontSize,s.fontFamily=e.style.fontFamily,s.textOverflow=e.style.textOverflow,s.textWrapping=e.style.textWrapping,s.textDecoration=e.style.textDecoration,s.doWrap=e.doWrap,s.wrapBounds=e.wrapBounds,s.childNodes=e.childNodes,s.isHorizontalLane=e.isLaneOrientation,s.id=e.id?e.id:op(),e.isLaneOrientation&&(s.parentOffsetX=this.groupElement.offsetX,s.parentOffsetY=this.groupElement.offsetY,s.parentWidth=this.groupElement.actualSize.width,s.parentHeight=this.groupElement.actualSize.height),s.dashArray="",s.strokeWidth=0,s.fill=e.style.fill;const o=e.description?e.description:e.content?e.content:e.id;("Wrap"===e.style.textWrapping||"WrapWithOverflow"===e.style.textWrapping)&&this.groupElement&&s.height>this.groupElement.actualSize.height&&("Clip"===e.style.textOverflow||"Ellipsis"===e.style.textOverflow)&&(s.y=s.y+(s.height-this.groupElement.actualSize.height)/2),this.renderer.drawRectangle(t,s,this.diagramId,void 0,void 0,n),this.renderer.drawText(t,s,n,o,this.diagramId,e.isExport&&Math.min(e.exportScaleValue.x||e.exportScaleValue.y),this.groupElement),this.isSvgMode&&(e.doWrap=!1)}renderNativeElement(e,t,i,n,r){let s,o;const a=this.getParentSvg(e,void 0,t)||n,l=this.getParentElement(e,t,a).g||t,h=this.getBaseAttributes(e,i);switch(h.fill="transparent",h.cornerRadius=e.cornerRadius,h.stroke="transparent",this.renderer.drawRectangle(t,h,this.diagramId,void 0,void 0,n),e.scale){case"None":s=e.contentSize.width,o=e.contentSize.height;break;case"Stretch":s=e.actualSize.width,o=e.actualSize.height;break;case"Meet":s=o=e.actualSize.width<=e.actualSize.height?e.actualSize.width:e.actualSize.height;break;case"Slice":s=o=e.actualSize.width>=e.actualSize.height?e.actualSize.width:e.actualSize.height}this.svgRenderer&&this.svgRenderer.drawNativeContent(e,l,o,s,a)}renderHTMLElement(e,t,i,n,r,s,o){const a=this.getBaseAttributes(e,n);a.fill="transparent",a.cornerRadius=e.cornerRadius,a.stroke="transparent",this.renderer.drawRectangle(t,a,this.diagramId,void 0,void 0,r),this.svgRenderer&&this.svgRenderer.drawHTMLContent(e,i.children[0],n,function(e){let t=e.parentElement;do{if(Qd(t,"e-diagram"))return!0;t=t.parentElement}while(t);return!1}(i),o)}renderImageElement(e,t,i,n,r){const s=this.getBaseAttributes(e,i);let o,a,l,h;if(s.cornerRadius=0,this.renderer.drawRectangle(t,s,this.diagramId,void 0,void 0,n),"Stretch"===e.stretch)o=e.actualSize.width,a=e.actualSize.height;else{const t=e.contentSize.width,i=e.contentSize.height;let n,r=s.width/t,c=s.height/i;switch(e.stretch){case"Meet":n=Math.min(r,c),o=t*n,a=i*n,s.x+=Math.abs(s.width-o)/2,s.y+=Math.abs(s.height-a)/2;break;case"Slice":r=s.width/t,c=s.height/i,n=Math.max(r,c),o=t*n,a=i*n,l=s.width/o*t,h=s.height/a*i;break;case"None":o=t,a=i}}s.width=o,s.height=a,s.sourceWidth=l,s.sourceHeight=h,s.source=e.source,s.alignment=e.imageAlign,s.scale=e.imageScale,s.description=e.description?e.description:e.id,this.renderer.drawImage(t,s,n,r)}renderContainer(e,t,i,n,r,s,o,a,l){const h={svg:r,g:t};if(this.diagramId&&(r=this.getParentSvg(e)||r,this.isSvgMode)){const i=this.getParentElement(e,t,r,a).g||t;r=this.getParentSvg(this.hasNativeParent(e.children))||r;const n=this.getParentElement(this.hasNativeParent(e.children),i,r,a);h.svg=n.svg||r,h.g=n.g||i,s?(r&&(r.getElementById(h.g.id)||t.appendChild(h.g)),t=h.g):t=h.g}if(this.renderRect(e,t,n,r),this.groupElement=e,e.hasChildren()){let s,h,c;for(const d of e.children)r=this.getParentSvg(this.hasNativeParent(e.children)||d)||r,this.isSvgMode&&(h=this.getParentElement(this.hasNativeParent(e.children)||d,t,r),s=h.g||t,h.svg&&(r=h.svg)),this.isSvgMode||(d.flip=e.flip),this.renderElement(d,s||t,i,n,r,!0,o,a,l),d instanceof Co&&s&&!(e.elementActions&oo.ElementIsGroup)&&(c=d.flip&&"None"!==d.flip?d.flip:e.flip,this.renderFlipElement(d,s,c)),d.elementActions&oo.ElementIsPort&&s&&(c=d.flip&&"None"!==d.flip?d.flip:e.flip,this.renderFlipElement(e,s,c)),!(d instanceof Co)&&"None"!==e.flip&&e.elementActions&oo.ElementIsGroup&&this.renderFlipElement(d,s||t,e.flip);e.elementActions&oo.ElementIsGroup||this.renderFlipElement(e,t,e.flip)}}renderFlipElement(e,t,i){let n={},r=1,s=1,o=0,a=0,l=0,h=0;if("None"!==i?("Horizontal"!==i&&"Both"!==i||(o=e.bounds.center.x,l=-e.bounds.center.x,r=-1),"Vertical"!==i&&"Both"!==i||(a=e.bounds.center.y,h=-e.bounds.center.y,s=-1),n={transform:"translate("+o+","+a+") scale("+r+","+s+") translate("+l+","+h+")"}):n={transform:"translate(0,0)"},n)if(e&&e.children&&e.children.length&&e.children[0]instanceof ka){const i=t.id.split("_preview");(t=(document.getElementById(i[0]+"_html_div")||qd(this.diagramId).children[0]).querySelector("#"+e.id+"_content_html_element"))&&(t.style.transform="scale("+r+","+s+")rotate("+(e.rotateAngle+e.parentTransform)+"deg)")}else tp(t,n)}hasNativeParent(e,t){if(e&&e.length>0){const i=e[0];if(i instanceof Io)return i;i.children&&i.children.length&&this.hasNativeParent(i.children,t++||0)}}renderRect(e,t,i,n,r){const s=this.getBaseAttributes(e,i,r);s.cornerRadius=e.cornerRadius||0,this.renderer.drawRectangle(t,s,this.diagramId,void 0,void 0,n,e.description?e.description:e.id)}drawRect(e,t){t.cornerRadius=0,this.svgRenderer.drawRectangle(e,t,this.diagramId)}getBaseAttributes(e,t,i){const n={width:e.actualSize.width,height:e.actualSize.height,x:e.offsetX-e.actualSize.width*e.pivot.x+.5,y:e.offsetY-e.actualSize.height*e.pivot.y+.5,fill:e.style.fill,stroke:e.style.strokeColor,angle:e.rotateAngle+e.parentTransform,pivotX:e.pivot.x,pivotY:e.pivot.y,strokeWidth:e.style.strokeWidth,dashArray:e.style.strokeDashArray||"",opacity:e.style.opacity,shadow:e.shadow,gradient:e.style.gradient,visible:e.visible,id:e.id,description:e.description,canApplyStyle:e.canApplyStyle};return i&&(n.x=n.x-.5,n.y=n.y-.5),e.isExport&&(n.width*=e.exportScaleValue.x,n.height*=e.exportScaleValue.y,n.x*=e.exportScaleValue.x,n.y*=e.exportScaleValue.y,n.strokeWidth*=e.exportScaleValue.x),e.flip&&(n.flip=e.flip),t&&(n.x+=t.tx,n.y+=t.ty),n}static renderSvgBackGroundImage(e,t,i,n,r,s){if(e.source){let o=Yd(t.id).getElementById(t.id+"_image");if(!o){const e=function(e){let t=null;return t=Nd(e).getElementsByClassName("e-background-image-layer")[0],t}(t.id);o=document.createElementNS("http://www.w3.org/2000/svg","image"),o.setAttribute("id",t.id+"_image"),e.appendChild(o)}const a=new Image;a.src=e.source,o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a.src.toString());const l="None"!==e.scale?e.scale:"",h=e.align;let c=h.charAt(0).toLowerCase()+h.slice(1);l&&(c+=" "+l.charAt(0).toLowerCase()+l.slice(1)),tp(o,{id:t.id+"_image",x:i,y:n,width:r,height:s,preserveAspectRatio:c})}}transformLayers(e,t){const i=e.tx*e.scale,n=e.ty*e.scale;return(i!==this.transform.x||n!==this.transform.y||0===i||0===n)&&(t&&(window.domTable[this.diagramId+"_diagramLayer"]||(window.domTable[this.diagramId+"_diagramLayer"]=this.diagramSvgLayer.getElementById(this.diagramId+"_diagramLayer")),window.domTable[this.diagramId+"_diagramLayer"].setAttribute("transform","translate("+e.tx*e.scale+","+e.ty*e.scale+"),scale("+e.scale+")")),function(e){let t=null;return window.domTable[e+"_gridline"]?t=window.domTable[e+"_gridline"]:(t=Xd(e).getElementById(e+"_gridline"),window.domTable[e+"_gridline"]=t),t}(this.diagramId).setAttribute("transform","translate("+e.tx*e.scale+","+e.ty*e.scale+")"),window.domTable[this.diagramId+"_diagramPorts"]||(window.domTable[this.diagramId+"_diagramPorts"]=this.iconSvgLayer.getElementById(this.diagramId+"_diagramPorts")),window.domTable[this.diagramId+"_diagramPorts"].setAttribute("transform","translate("+e.tx*e.scale+","+e.ty*e.scale+"),scale("+e.scale+")"),window.domTable[this.diagramId+"_diagramExpander"]||(window.domTable[this.diagramId+"_diagramExpander"]=this.iconSvgLayer.getElementById(this.diagramId+"_diagramExpander")),window.domTable[this.diagramId+"_diagramExpander"].setAttribute("transform","translate("+e.tx*e.scale+","+e.ty*e.scale+"),scale("+e.scale+")"),window.domTable[this.diagramId+"_nativeLayer"]||(window.domTable[this.diagramId+"_nativeLayer"]=this.nativeSvgLayer.getElementById(this.diagramId+"_nativeLayer")),window.domTable[this.diagramId+"_nativeLayer"].setAttribute("transform","translate("+e.tx*e.scale+","+e.ty*e.scale+"),scale("+e.scale+")"),qd(this.diagramId).children[0].style.transform="translate("+e.tx*e.scale+"px,"+e.ty*e.scale+"px)scale("+e.scale+")",this.transform={x:e.tx*e.scale,y:e.ty*e.scale},!0)}updateNode(e,t,i,n,r){this.renderElement(e,t,i,n,this.getParentSvg(e),void 0,void 0,r)}}var Ep=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Ap=(()=>{class e extends Ht{}return Ep([xt("")],e.prototype,"source",void 0),Ep([xt("transparent")],e.prototype,"color",void 0),Ep([xt("None")],e.prototype,"scale",void 0),Ep([xt("None")],e.prototype,"align",void 0),e})(),Ip=(()=>{class e extends Ht{}return Ep([xt("Page")],e.prototype,"mode",void 0),Ep([xt("PageSettings")],e.prototype,"region",void 0),Ep([St({top:25,bottom:25,left:25,right:25},Vs)],e.prototype,"margin",void 0),Ep([xt(!1)],e.prototype,"canZoomIn",void 0),Ep([xt(void 0)],e.prototype,"customBounds",void 0),Ep([xt(!1)],e.prototype,"canFit",void 0),e})(),Dp=(()=>{class e extends Ht{}return Ep([xt(null)],e.prototype,"width",void 0),Ep([xt(null)],e.prototype,"height",void 0),Ep([St({},Vs)],e.prototype,"margin",void 0),Ep([xt("Landscape")],e.prototype,"orientation",void 0),Ep([xt("Infinity")],e.prototype,"boundaryConstraints",void 0),Ep([St({},Ap)],e.prototype,"background",void 0),Ep([xt(!1)],e.prototype,"multiplePage",void 0),Ep([xt(!1)],e.prototype,"showPageBreaks",void 0),Ep([St({},Ip)],e.prototype,"fitOptions",void 0),e})(),Rp=(()=>{class e extends Ht{}return Ep([xt(0)],e.prototype,"horizontalOffset",void 0),Ep([xt(0)],e.prototype,"verticalOffset",void 0),Ep([xt(1)],e.prototype,"currentZoom",void 0),Ep([xt(0)],e.prototype,"viewPortWidth",void 0),Ep([xt(0)],e.prototype,"viewPortHeight",void 0),Ep([xt(.2)],e.prototype,"minZoom",void 0),Ep([xt(30)],e.prototype,"maxZoom",void 0),Ep([xt("Diagram")],e.prototype,"scrollLimit",void 0),Ep([xt()],e.prototype,"scrollableArea",void 0),Ep([xt(!1)],e.prototype,"canAutoScroll",void 0),Ep([St({left:15,right:15,top:15,bottom:15},Vs)],e.prototype,"autoScrollBorder",void 0),Ep([St({left:0,right:0,top:0,bottom:0},Vs)],e.prototype,"padding",void 0),e})();class Lp{constructor(){this.services={}}register(e,t){this.services[e]=t}getService(e){return this.services[e]}}var zp=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Mp=(()=>{class e extends Ht{}return zp([xt("lightgray")],e.prototype,"lineColor",void 0),zp([xt("")],e.prototype,"lineDashArray",void 0),zp([xt([1.25,18.75,.25,19.75,.25,19.75,.25,19.75,.25,19.75])],e.prototype,"lineIntervals",void 0),zp([xt([1,19,.5,19.5,.5,19.5,.5,19.5,.5,19.5])],e.prototype,"dotIntervals",void 0),zp([xt([20])],e.prototype,"snapIntervals",void 0),e})(),kp=(()=>{class e extends Ht{}return zp([St({},Mp)],e.prototype,"horizontalGridlines",void 0),zp([St({},Mp)],e.prototype,"verticalGridlines",void 0),zp([xt(to.All)],e.prototype,"constraints",void 0),zp([xt(5)],e.prototype,"snapAngle",void 0),zp([xt("Lines")],e.prototype,"gridType",void 0),zp([xt(5)],e.prototype,"snapObjectDistance",void 0),e})();var jp=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Hp=(()=>{class e extends Ht{}return jp([xt(5)],e.prototype,"interval",void 0),jp([xt(100)],e.prototype,"segmentWidth",void 0),jp([xt("Horizontal")],e.prototype,"orientation",void 0),jp([xt("RightOrBottom")],e.prototype,"tickAlignment",void 0),jp([xt("red")],e.prototype,"markerColor",void 0),jp([xt(25)],e.prototype,"thickness",void 0),jp([xt(null)],e.prototype,"arrangeTick",void 0),e})(),Np=(()=>{class e extends Ht{}return jp([xt(!1)],e.prototype,"showRulers",void 0),jp([xt(!0)],e.prototype,"dynamicGrid",void 0),jp([St({orientation:"Horizontal"},Hp)],e.prototype,"horizontalRuler",void 0),jp([St({orientation:"Vertical"},Hp)],e.prototype,"verticalRuler",void 0),e})();var _p=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Bp=(()=>{class e extends Ht{}return _p([xt("")],e.prototype,"property",void 0),_p([xt("")],e.prototype,"field",void 0),e})();var Wp=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Up=(()=>{class e extends Ht{}return Wp([xt("")],e.prototype,"read",void 0),Wp([xt("")],e.prototype,"create",void 0),Wp([xt("")],e.prototype,"update",void 0),Wp([xt("")],e.prototype,"destroy",void 0),Wp([xt()],e.prototype,"customFields",void 0),e})(),Fp=(()=>{class e extends Ht{}return Wp([xt("")],e.prototype,"id",void 0),Wp([xt("")],e.prototype,"sourceID",void 0),Wp([xt("")],e.prototype,"targetID",void 0),Wp([xt(null)],e.prototype,"sourcePointX",void 0),Wp([xt(null)],e.prototype,"sourcePointY",void 0),Wp([xt(null)],e.prototype,"targetPointX",void 0),Wp([xt(null)],e.prototype,"targetPointY",void 0),Wp([xt(null)],e.prototype,"dataManager",void 0),Wp([St({},Up)],e.prototype,"crudAction",void 0),e})(),Vp=(()=>{class e extends Ht{}return Wp([xt("")],e.prototype,"id",void 0),Wp([xt(null)],e.prototype,"dataManager",void 0),Wp([xt(null)],e.prototype,"dataSource",void 0),Wp([xt("")],e.prototype,"root",void 0),Wp([xt("")],e.prototype,"parentId",void 0),Wp([xt()],e.prototype,"doBinding",void 0),Wp([Pt([],Bp)],e.prototype,"dataMapSettings",void 0),Wp([St({},Up)],e.prototype,"crudAction",void 0),Wp([St({},Fp)],e.prototype,"connectionDataSource",void 0),e})();var Xp=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Yp=(()=>{class e extends Ht{}return Xp([xt("")],e.prototype,"fixedNode",void 0),Xp([xt(30)],e.prototype,"horizontalSpacing",void 0),Xp([xt("SamePoint")],e.prototype,"connectionPointOrigin",void 0),Xp([xt("Nonlinear")],e.prototype,"arrangement",void 0),Xp([xt(30)],e.prototype,"verticalSpacing",void 0),Xp([xt(30)],e.prototype,"maxIteration",void 0),Xp([xt(40)],e.prototype,"springFactor",void 0),Xp([xt(50)],e.prototype,"springLength",void 0),Xp([St({left:50,top:50,right:0,bottom:0},Vs)],e.prototype,"margin",void 0),Xp([xt("Auto")],e.prototype,"horizontalAlignment",void 0),Xp([xt("Auto")],e.prototype,"verticalAlignment",void 0),Xp([xt("TopToBottom")],e.prototype,"orientation",void 0),Xp([xt("Auto")],e.prototype,"connectionDirection",void 0),Xp([xt("Default")],e.prototype,"connectorSegments",void 0),Xp([xt("None")],e.prototype,"type",void 0),Xp([xt()],e.prototype,"getLayoutInfo",void 0),Xp([xt()],e.prototype,"layoutInfo",void 0),Xp([xt()],e.prototype,"getBranch",void 0),Xp([xt()],e.prototype,"bounds",void 0),Xp([xt(!0)],e.prototype,"enableAnimation",void 0),Xp([xt(!1)],e.prototype,"enableRouting",void 0),Xp([xt("")],e.prototype,"root",void 0),e})();function Gp(e,t,i){return e.x>=t.x-i&&e.x<=t.x+i&&e.y>=t.y-i&&e.y<=t.y+i}function qp(e){return e.selectedItems.nodes.length>0||e.selectedItems.connectors.length>0}function Zp(e){return 1===e.selectedItems.connectors.length&&!e.selectedItems.nodes.length}function $p(e,t,i=!0,n){if(t instanceof Ld)return!0;if(t instanceof Td)for(;t;){if(-1!==e.selectedItems.nodes.indexOf(t)&&void 0===e.selectedItems.annotation)return!0;if(i)break;t=e.nameTable[t.parentId]}else if(t instanceof ol){if(-1!==e.selectedItems.connectors.indexOf(t)&&void 0===e.selectedItems.annotation)return!0}else if((t instanceof jo||t instanceof Ho)&&e.selectedItems.annotation&&e.selectedItems.wrapper.children[0].id===n.id)return!0;return!1}const Qp={None:"default",Rotate:"crosshair",Select:"default",Drag:"move",ResizeWest:"w-resize",ResizeEast:"e-resize",ResizeSouth:"s-resize",ResizeNorth:"n-resize",Draw:"crosshair",PortDraw:"crosshair",ResizeNorthEast:"ne-resize",ResizeNorthWest:"nw-resize",ResizeSouthEast:"se-resize",ResizeSouthWest:"sw-resize",ConnectorSourceEnd:"move",ConnectorTargetEnd:"move",BezierSourceThumb:"move",BezierTargetThumb:"move",OrthoThumb:"move",SegmentEnd:"move",Pan:"grab",Hyperlink:"pointer",PortDrag:"pointer",LabelSelect:"pointer",LabelDrag:"move",LabelRotate:"crosshair",LabelResizeWest:"w-resize",LabelResizeEast:"e-resize",LabelResizeSouth:"s-resize",LabelResizeNorth:"n-resize",LabelResizeNorthEast:"ne-resize",LabelResizeNorthWest:"nw-resize",LabelResizeSouthEast:"se-resize",LabelResizeSouthWest:"sw-resize"};class Jp{constructor(){this.valueCreated="created",this.valueUpdated="updated",this.valueDeleted="deleted",this.valueUnchanged="unchanged",this.newNodeObject=[],this.newConnectorObject=[],this.diagramObject={}}updateObjectCollection(e,t){for(let i=0;i<e.length;i++)e[i].objects||(e[i].objects=[]),e[i].objects=t.layers[i].objects}getOldObject(e,t,i){let n=t?i.oldNodeObjects:i.oldConnectorObjects;for(let r=0;r<n.length;r++)if(n[r].id===e)return n[r]}changeSegments(e,t){for(let i of Object.keys(e))if("segments"===i){let n=this.removeNullValues(t[i]);e[i]=n}return e}removeNullValues(e){let t=[],i={};for(var n=0;n<e.length;n++)i=this.removeNullObjectValues(e[n]),t.push(i);return t}removeNullObjectValues(e){let t={};for(let i of Object.keys(e))void 0!==e[i]&&(t[i]=e[i]instanceof Object?this.removeNullObjectValues(e[i]):e[i]);return t}getDifferenceValues(e,t,i,n){let r,s,o,a,l=e instanceof Td;if(e&&(a=this.getOldObject(e.id,!!l,n),a)){let c=dp(e);if(o=this.map(c,a),r=this.frameObject({},o),s=this.removeEmptyValues(r),s=this.changeSegments(s,c),s.children&&(s.children=dp(e).children),s.ports&&s.ports.length)for(var h=0;h<s.ports.length;h++)c.ports[h].outEdges&&(s.ports[h].outEdges=c.ports[h].outEdges),c.ports[h].inEdges&&(s.ports[h].inEdges=c.ports[h].inEdges);return this.getDiagramObjects(s,e.id,l,t,i,n)}}getLayerObject(e,t,i){}getDiagramObjects(e,t,i,n,r,s){let o=0;if(o=ap(s,t),e.sfIndex=o,i?this.newNodeObject.push(e):this.newConnectorObject.push(e),n&&(n.sourceWrapper instanceof Co&&r||n.portId)){let e,r;r=i?n.portId?this.newNodeObject[0].ports:this.newNodeObject[0].annotations:this.newConnectorObject[0].annotations||[];for(let o=0;o<r.length;o++)if(Object.keys(r[o]).length>0){let a=s.nameTable[t];if(e=r[o],n.portId)this.newNodeObject[0].ports=[e];else{for(let t=0;t<a.annotations.length;t++)n.sourceWrapper.id===a.id+"_"+a.annotations[t].id&&(e.sfIndex=t);i?this.newNodeObject[0].annotations=[e]:this.newConnectorObject[0].annotations=[e]}}}this.diagramObject={nodes:this.newNodeObject,connectors:this.newConnectorObject}}removeArrayValues(e){let t=[];if(JSON.stringify(e)!==JSON.stringify({data:[]}))for(let i=0;i<e.length;i++)if(e[i]instanceof Object){let n=this.removeEmptyValues(e[i]);t.push(n)}else t.push(e[i]);return t}removeEmptyValues(e){let t={};for(let i of Object.keys(e))if("wrapper"!==i&&("data"!==i||"data"===i&&!(e[i]instanceof Array))){let n=e[i],r=JSON.stringify(n);if(n instanceof Array){let e=this.removeArrayValues(n);"[]"!==JSON.stringify(e)&&(t[i]=e)}else if(n instanceof Object){if(r!==JSON.stringify({data:[]})){let e=this.removeEmptyValues(n);"{}"!==JSON.stringify(e)&&(t[i]=e)}}else r!==JSON.stringify(["data"])&&r!==JSON.stringify("data")&&r!==JSON.stringify({data:[]})&&"version"!==i&&"ejsAction"!==i&&(t[i]=e[i])}return t}map(e,t,i){if(this.isFunction(e)||this.isFunction(t))throw"Invalid argument. Function given, object expected.";if(this.isValue(e)||this.isValue(t))return{type:this.compareValues(e,t),data:void 0===e?t:e};let n={};if(this.isArray(e))for(let s=0;s<e.length;s++){n[i]||(n[i]=[]);let r=this.map(e[s],t[s]);n[i].push(r)}else for(let s in e){if(this.isFunction(e[s]))continue;let i;void 0!==t[s]&&(i=t[s]);let r=this.map(e[s],i,this.isArray(i)?s:void 0);n[s]=this.isArray(i)?r[s]:r}if(this.isArray(t))for(var r=t.length-1;r>=0;r--){if(n[i]||(n[i]=[]),this.isFunction(t[r])||void 0!==n[i][r]){n[i][r].type&&n[i][r].type!==this.valueUpdated&&delete n[i];continue}let e=this.map(void 0,t[r]);n[i][r]=e}else for(let s in t){if(this.isFunction(t[s])||void 0!==n[s]){n[s].type&&n[s].type!==this.valueUpdated&&n[s].type!==this.valueDeleted&&delete n[s];continue}let e=this.map(void 0,t[s]);n[s]=e}return n}compareValues(e,t){return e===t||this.isDate(e)&&this.isDate(t)&&e.getTime()===t.getTime()?this.valueUnchanged:void 0===e?this.valueCreated:void 0===t?this.valueDeleted:this.valueUpdated}isFunction(e){return"[object Function]"===Object.prototype.toString.call(e)}isArray(e){return"[object Array]"===Object.prototype.toString.call(e)}isDate(e){return"[object Date]"===Object.prototype.toString.call(e)}isObject(e){return"[object Object]"===Object.prototype.toString.call(e)}isValue(e){return!this.isObject(e)&&!this.isArray(e)}frameObject(e,t){for(let i in t)if(this.isArray(t[i])){e[i]||(e[i]=[]);for(let n=0;n<t[i].length;n++){let r=this.frameObject({},t[i][n]);e[i].push(r)}}else if("type"!=i||"type"==i&&t[i]!==this.valueUpdated&&t[i]!==this.valueUnchanged&&t[i]!==this.valueDeleted&&t[i]!==this.valueCreated){if(this.isFunction(t[i]))continue;if(this.isValue(t[i]))return t.data;{let n=this.frameObject({},t[i]);(this.isValue(n)||Object.keys(n).length>0)&&(e[i]=n)}}return e}}var Kp=function(e,t,i,n){return new(i||(i=Promise))(function(r,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(o,a)}l((n=n.apply(e,t||[])).next())})};class eu{constructor(e,t=!1){this.commandHandler=null,this.deepDiffer=new Jp,this.inAction=!1,this.isProtectChange=!1,this.currentElement=null,this.blocked=!1,this.isTooltipVisible=!1,this.childTable={},this.undoElement={nodes:[],connectors:[]},this.checkProperty=!0,this.undoParentElement={nodes:[],connectors:[]},this.commandHandler=e,this.isProtectChange=t}startAction(e){this.currentElement=e,this.inAction=!0}mouseDown(e){this.currentElement=e.source,this.startPosition=this.currentPosition=this.prevPosition=e.position,this.isTooltipVisible=!0,this.startAction(e.source),this.checkProperty=!0,this.mouseDownElement=e.source}checkPropertyValue(){this.checkProperty&&this.commandHandler.startTransaction(this.isProtectChange)}mouseMove(e){return this.currentPosition=e.position,this.inAction&&(this.commandHandler.startTransaction(this.isProtectChange),this.checkProperty=!1),!this.blocked}mouseUp(e){this.checkPropertyValue(),this.currentPosition=e.position,this.isTooltipVisible=!1,this.commandHandler.endTransaction(this.isProtectChange),this.endAction(),this.mouseDownElement=null}endAction(){this.isTooltipVisible||this.commandHandler.closeTooltip(),this.commandHandler=null,this.currentElement=null,this.currentPosition=null,this.inAction=!1,this.blocked=!1}mouseWheel(e){this.currentPosition=e.position}mouseLeave(e){this.mouseUp(e)}updateSize(e,t,i,n,r,s){e=this.commandHandler.renderContainerHelper(e)||e;const o={snapped:!1,offset:0,left:!1,right:!1},a={snapped:!1,offset:0,top:!1,bottom:!1};let l=this.currentPosition.x-this.startPosition.x,h=this.currentPosition.y-this.startPosition.y;const c=!(e instanceof Co)&&this.commandHandler.snappingModule&&this.commandHandler.snappingModule.canSnap(),d=c?this.commandHandler.snappingModule.getLayer():null,p=e instanceof Co?s:e.rotateAngle;let u;u=zs(),ks(u,-p,0,0);let g=e.offsetX,m=e.offsetY;g-=e.width*e.pivot.x,m-=e.height*e.pivot.y;let f,y=0,b=0;const v=e instanceof Co?e.actualSize.width:e.width,w=e instanceof Co?e.actualSize.height:e.height;switch(n){case"ResizeWest":f=Ms(u,{x:l,y:h}),l=f.x,h=f.y,b=1,l=c?this.commandHandler.snappingModule.snapLeft(o,a,d,l,h,e,i===t,r):l,h=0,y=(r.width-l)/v;break;case"ResizeEast":f=Ms(u,{x:l,y:h}),l=f.x,h=f.y,l=c?this.commandHandler.snappingModule.snapRight(o,a,d,l,h,e,i===t,r):l,h=0,y=(r.width+l)/v,b=1;break;case"ResizeNorth":y=1,f=Ms(u,{x:l,y:h}),l=f.x,h=f.y,h=c?this.commandHandler.snappingModule.snapTop(o,a,d,l,h,e,i===t,r):h,b=(r.height-h)/w;break;case"ResizeSouth":y=1,f=Ms(u,{x:l,y:h}),l=f.x,h=f.y,h=c?this.commandHandler.snappingModule.snapBottom(o,a,d,l,h,e,i===t,r):h,b=(r.height+h)/w;break;case"ResizeNorthEast":f=Ms(u,{x:l,y:h}),l=f.x,h=f.y,l=c?this.commandHandler.snappingModule.snapRight(o,a,d,l,h,e,i===t,r):l,h=c?this.commandHandler.snappingModule.snapTop(o,a,d,l,h,e,i===t,r):h,y=(r.width+l)/v,b=(r.height-h)/w;break;case"ResizeNorthWest":f=Ms(u,{x:l,y:h}),l=f.x,h=f.y,h=c?this.commandHandler.snappingModule.snapTop(o,a,d,l,h,e,i===t,r):h,l=c?this.commandHandler.snappingModule.snapLeft(o,a,d,l,h,e,i===t,r):l,y=(r.width-l)/v,b=(r.height-h)/w;break;case"ResizeSouthEast":f=Ms(u,{x:l,y:h}),l=f.x,h=f.y,h=c?this.commandHandler.snappingModule.snapBottom(o,a,d,l,h,e,i===t,r):h,l=c?this.commandHandler.snappingModule.snapRight(o,a,d,l,h,e,i===t,r):l,b=(r.height+h)/w,y=(r.width+l)/v;break;case"ResizeSouthWest":f=Ms(u,{x:l,y:h}),l=f.x,h=f.y,h=c?this.commandHandler.snappingModule.snapBottom(o,a,d,l,h,e,i===t,r):h,l=c?this.commandHandler.snappingModule.snapLeft(o,a,d,l,h,e,i===t,r):l,y=(r.width-l)/v,b=(r.height+h)/w}return{width:y,height:b}}getPivot(e){switch(e){case"ResizeWest":return{x:1,y:.5};case"ResizeEast":return{x:0,y:.5};case"ResizeNorth":return{x:.5,y:1};case"ResizeSouth":return{x:.5,y:0};case"ResizeNorthEast":return{x:0,y:1};case"ResizeNorthWest":return{x:1,y:1};case"ResizeSouthEast":return{x:0,y:0};case"ResizeSouthWest":return{x:1,y:0}}return{x:.5,y:.5}}}class tu extends eu{constructor(e,t,i){super(e,!0),this.action=i}mouseDown(e){this.inAction=!0,super.mouseDown(e)}mouseMove(e){if(super.mouseMove(e),this.inAction&&!1===ws.equals(this.currentPosition,this.prevPosition)){const e=Ds.toBounds([this.prevPosition,this.currentPosition]);this.mouseDownElement&&!fl(this.mouseDownElement)?this.commandHandler.clearObjectSelection(this.mouseDownElement):(this.commandHandler.clearSelectedItems(),this.commandHandler.drawSelectionRectangle(e.x,e.y,e.width,e.height))}return!this.blocked}mouseUp(e){if(this.checkPropertyValue(),!this.commandHandler.isUserHandle(this.currentPosition))if(!1===ws.equals(this.currentPosition,this.prevPosition)&&this.inAction){const e=Ds.toBounds([this.prevPosition,this.currentPosition]);this.commandHandler.doRubberBandSelection(e)}else{const t=this.commandHandler.getSelectedObject();this.commandHandler.hasSelection()&&e.info&&e.info.ctrlKey?e&&e.source&&(this.commandHandler.isSelected(e.source)?1===e.clickCount&&(this.commandHandler.unSelect(e.source),this.commandHandler.updateBlazorSelector()):this.commandHandler.selectObjects([e.source],!0)):(this.commandHandler.clearSelection(null===e.source),"LabelSelect"===this.action?this.commandHandler.labelSelect(e.source,e.sourceWrapper):e.source&&this.commandHandler.selectObjects([e.source],!1,t))}this.inAction=!1,super.mouseUp(e)}mouseLeave(e){this.inAction&&this.mouseUp(e)}}class iu extends eu{mouseUp(e){this.checkPropertyValue(),this.inAction=!1;const t=e.source;let i;const n=e.sourceWrapper.id;for(let r=0;r<t.fixedUserHandles.length;r++)n.indexOf(t.fixedUserHandles[r].id)>-1&&(i=t.fixedUserHandles[r]);this.commandHandler.triggerEvent(vo.fixedUserHandleClick,{fixedUserHandle:i,element:e.source}),super.mouseUp(e)}}class nu extends eu{constructor(e,t){super(e,!0),this.isConnected=!1,this.endPoint=t}mouseDown(e){const t=Object.create(null,{mouseDown:{get:()=>super.mouseDown}});return Kp(this,void 0,void 0,function*(){let i,n;if(this.inAction=!0,this.undoElement=void 0,this instanceof lu||(this.undoElement=dp(e.source)),t.mouseDown.call(this,e),e.source&&e.source.connectors&&(i={x:this.prevPosition.x,y:this.prevPosition.y},n=e.source.connectors[0],this.oldConnector=dp(n)),"BezierSourceThumb"===this.endPoint||"BezierTargetThumb"===this.endPoint)for(let e=0;e<n.segments.length;e++){const t=n.segments[e],i=ws.isEmptyPoint(t.point1)?t.bezierPoint1:t.point1,r=ws.isEmptyPoint(t.point2)?t.bezierPoint2:t.point2;(Gp(this.currentPosition,i,n.hitPadding)||Gp(this.currentPosition,r,n.hitPadding))&&(this.selectedSegment=t)}this.currentPosition=e.position})}mouseUp(e){const t=Object.create(null,{mouseUp:{get:()=>super.mouseUp}});return Kp(this,void 0,void 0,function*(){if(this.isConnected&&e.source.connectors){const t=e.source.connectors[0],i="ConnectorSourceEnd"===this.endPoint?"sourceID":"targetID",n="ConnectorSourceEnd"===this.endPoint?"sourcePortID":"targetPortID",r={connector:t,oldValue:{nodeId:this.oldConnector[i],portId:this.oldConnector[n]},newValue:{nodeId:t[i],portId:t[n]},cancel:!1,state:"Changed",connectorEnd:this.endPoint};t[i]!==this.oldConnector[i]&&(this.commandHandler.triggerEvent(vo.connectionChange,r),this.isConnected=!1)}if(this.checkPropertyValue(),this.commandHandler.updateSelector(),this.commandHandler.removeSnap(),this.commandHandler.changeAnnotationDrag(e),this instanceof lu||("ConnectorSourceEnd"!==this.endPoint||!e.source.connectors.length||ws.equals(e.source.connectors[0].sourcePoint,this.undoElement.connectors[0].sourcePoint)&&e.source.connectors[0].sourceID===this.undoElement.connectors[0].sourceID)&&("ConnectorTargetEnd"!==this.endPoint||ws.equals(e.source.connectors[0].targetPoint,this.undoElement.connectors[0].targetPoint)&&e.source.connectors[0].targetID===this.undoElement.connectors[0].targetID)){if(!(this instanceof lu||"BezierTargetThumb"!==this.endPoint&&"BezierSourceThumb"!==this.endPoint)&&this.undoElement&&e.source){const t=dp(e.source);this.commandHandler.addHistoryEntry({type:"SegmentChanged",redoObject:t,undoObject:this.undoElement,category:"Internal"})}}else{let t,i,n,r;if(e.source&&e.source.connectors&&(t={x:this.prevPosition.x,y:this.prevPosition.y},i=e.source.connectors[0]),e.target){const t=this.commandHandler.findTarget(e.targetWrapper,e.target,"ConnectorSourceEnd"===this.endPoint,!0);t instanceof Lo?n=t.id:r=t.id}if(this.commandHandler.triggerEvent("ConnectorSourceEnd"===this.endPoint?vo.sourcePointChange:vo.targetPointChange,{connector:i,state:"Completed",targetNode:r,oldValue:t,newValue:t,cancel:!1,targetPort:n}),this.commandHandler.removeTerminalSegment(i,!0),this.undoElement&&e.source){let t;t=dp(e.source);const i={type:"ConnectionChanged",redoObject:dp(t),undoObject:dp(this.undoElement),category:"Internal"};this.commandHandler.addHistoryEntry(i)}}this.commandHandler.updateBlazorSelector(),this.canCancel=void 0,this.tempArgs=void 0,t.mouseUp.call(this,e)})}mouseMove(e){let t;if(super.mouseMove(e),!(this instanceof lu)&&("ConnectorSourceEnd"===this.endPoint&&ws.equals(e.source.connectors[0].sourcePoint,this.undoElement.connectors[0].sourcePoint)||"ConnectorTargetEnd"===this.endPoint&&ws.equals(e.source.connectors[0].targetPoint,this.undoElement.connectors[0].targetPoint))){let t,i,n,r;if(e.source&&e.source.connectors&&(t={x:this.prevPosition.x,y:this.prevPosition.y},i=e.source.connectors[0]),e.target){r=e.target.id;const t=this.commandHandler.findTarget(e.targetWrapper,e.target,"ConnectorSourceEnd"===this.endPoint,!0);t instanceof Lo||t instanceof dd?n=t.id:r=t.id}this.commandHandler.triggerEvent("ConnectorSourceEnd"===this.endPoint?vo.sourcePointChange:vo.targetPointChange,{connector:i,state:"Start",targetNode:r,oldValue:t,newValue:t,cancel:!1,targetPort:n})}if(this.currentPosition=e.position,this.currentPosition&&this.prevPosition){const i=this.currentPosition.x-this.prevPosition.x,n=this.currentPosition.y-this.prevPosition.y;let r,s,o,a,l,h,c;if(this.currentPosition=this.commandHandler.snapConnectorEnd(this.currentPosition),e.source&&e.source.connectors&&(r={x:this.currentPosition.x,y:this.currentPosition.y},s={x:this.prevPosition.x,y:this.prevPosition.y},l=e.source.connectors[0]),e.target){const t=this.commandHandler.findTarget(e.targetWrapper,e.target,"ConnectorSourceEnd"===this.endPoint,!0);t instanceof Lo?h=t.id:c=t.id}let d={connector:l,state:"Progress",targetNode:c,oldValue:s,newValue:r,cancel:!1,targetPort:h};if(this instanceof lu||this.commandHandler.triggerEvent("ConnectorSourceEnd"===this.endPoint?vo.sourcePointChange:vo.targetPointChange,d),e.target&&(o=Oc(e.target,!0),a=Oc(e.target,!1)),!d.cancel&&this.inAction&&void 0!==this.endPoint&&0!==i||0!==n)if(this.blocked=!this.commandHandler.dragConnectorEnds(this.endPoint,e.source,this.currentPosition,this.selectedSegment,e.target,h),this.commandHandler.updateSelector(),e.target&&("ConnectorSourceEnd"===this.endPoint&&(Tl(e.target)||El(a))||"ConnectorTargetEnd"===this.endPoint&&(Pl(e.target)||Ol(o)))){this.commandHandler.canDisconnect(this.endPoint,e,h,c)&&(t=this.commandHandler.disConnect(e.source,this.endPoint,this.canCancel),this.isConnected=!0);const i=this.commandHandler.findTarget(e.targetWrapper,e.target,"ConnectorSourceEnd"===this.endPoint,!0);i instanceof Td?(Pl(i)&&"ConnectorTargetEnd"===this.endPoint||Tl(i)&&"ConnectorSourceEnd"===this.endPoint)&&(t=this.commandHandler.connect(this.endPoint,e,this.canCancel),this.isConnected=!0):this.checkConnect(i)&&(this.isConnected=!0,t=this.commandHandler.connect(this.endPoint,e,this.canCancel))}else-1===this.endPoint.indexOf("Bezier")&&(this.isConnected=!0,t=this.commandHandler.disConnect(e.source,this.endPoint,this.canCancel),this.commandHandler.updateSelector());if(this.commandHandler.canEnableDefaultTooltip()){const t=this.getTooltipContent(e.position);this.commandHandler.showTooltip(e.source,e.position,t,"ConnectTool",this.isTooltipVisible),this.isTooltipVisible=!1}t&&(this.tempArgs=t)}return this.prevPosition=this.currentPosition,!this.blocked}mouseLeave(e){this.mouseUp(e)}getTooltipContent(e){return"X:"+Math.round(e.x)+" Y:"+Math.round(e.y)}checkConnect(e){return!(!Ol(e)||"ConnectorTargetEnd"!==this.endPoint)||!(!El(e)||"ConnectorSourceEnd"!==this.endPoint)||!(e.constraints&wo.None||Ol(e)||El(e))&&(null==e.constraints||(e.constraints&wo.Default&~(wo.InConnect|wo.OutConnect))>0)}endAction(){super.endAction(),this.prevPosition=null,this.endPoint=null}}class ru extends eu{constructor(e,t){super(e,!0),this.currentTarget=null,this.canCancel=!1,this.objectType=t}mouseDown(e){if(e.source instanceof Td||e.source instanceof ol){const t=this.commandHandler.getSelectedObject();this.commandHandler.selectObjects([e.source],e.info&&e.info.ctrlKey,t);const i={nodes:[],connectors:[]};e.source instanceof Td?i.nodes.push(dp(e.source)):i.connectors.push(dp(e.source)),this.undoElement=dp(i)}else this.undoElement=dp(e.source);this.undoParentElement=this.commandHandler.getSubProcess(e.source),"Port"===this.objectType&&(this.portId=e.sourceWrapper.id),this.commandHandler.insertBlazorConnector(e.source),super.mouseDown(e),this.initialOffset={x:0,y:0}}mouseUp(e,t){const i=Object.create(null,{mouseUp:{get:()=>super.mouseUp}});return Kp(this,void 0,void 0,function*(){let n,r,s;this.checkPropertyValue();let o,a=!1;const l={nodes:[],connectors:[]};if("Port"!==this.objectType){if(e.source instanceof Td||e.source instanceof ol){e.source instanceof Td?l.nodes.push(dp(e.source)):l.connectors.push(dp(e.source)),s=dp(l);const t=e.source.wrapper;s.offsetX=t.offsetX,s.offsetY=t.offsetY}else s=dp(e.source);if(o=this.commandHandler.renderContainerHelper(e.source)||e.source||this.commandHandler.renderContainerHelper(e.source),("helper"===o.id&&!s.nodes[0].isLane&&!s.nodes[0].isPhase||"helper"!==o.id)&&((o instanceof Ld&&o.width===this.undoElement.width&&o.height===this.undoElement.height||!(o instanceof Ld))&&(o.offsetX!==this.undoElement.offsetX||o.offsetY!==this.undoElement.offsetY||o.sourcePoint!==this.undoElement.sourcePoint||o.targetPoint!==this.undoElement.targetPoint)||this.isSelectionHasConnector(o))){e.source&&(r={offsetX:e.source.wrapper.offsetX,offsetY:e.source.wrapper.offsetY},n={offsetX:e.source.wrapper.offsetX,offsetY:e.source.wrapper.offsetY});let i={source:e.source,state:"Completed",oldValue:n,newValue:r,target:this.currentTarget,targetPosition:this.currentPosition,allowDrop:!0,cancel:!1};if(i={source:e.source,state:"Completed",oldValue:n,newValue:r,target:this.currentTarget,targetPosition:this.currentPosition,allowDrop:i.allowDrop,cancel:i.cancel},this.commandHandler.triggerEvent(vo.positionChange,i),!t){this.commandHandler.startGroupAction(),a=!0;const t={type:"PositionChanged",redoObject:dp(s),undoObject:dp(this.undoElement),category:"Internal"};if(s.nodes[0]&&s.nodes[0].processId){const t={type:"SizeChanged",category:"Internal",undoObject:this.undoParentElement,redoObject:this.commandHandler.getSubProcess(e.source)};this.commandHandler.addHistoryEntry(t)}this.commandHandler.addHistoryEntry(t)}}if(this.commandHandler.snapPoint(this.prevPosition,this.currentPosition,0,0),this.commandHandler.removeSnap(),this.commandHandler.removeHighlighter(),e.source&&this.currentTarget&&Il(this.currentTarget)&&this.commandHandler.isDroppable(e.source,this.currentTarget)){this.commandHandler.drop(this.currentElement,this.currentTarget,this.currentPosition);let t={element:e.source,target:this.currentTarget,position:this.currentPosition,cancel:!1};if(this.commandHandler.triggerEvent(vo.drop,t),!t.cancel&&e.source&&this.commandHandler.isParentAsContainer(this.currentTarget)){const t=e.source instanceof Ld?e.source.nodes:[e.source];let i,n=!1;for(let e=0;e<t.length;e++){if(t[0].parentId!==t[e].parentId){i=!1;break}i=!0}for(let e=0;e<t.length;e++)!t[e].container&&i&&(n=!0,this.commandHandler.updateLaneChildrenZindex(t[e],this.currentTarget),this.commandHandler.dropChildToContainer(this.currentTarget,t[e]),this.commandHandler.renderContainerHelper(t[e]));a&&this.commandHandler.isContainer&&n&&this.commandHandler.endGroupAction()}}e.source&&this.currentTarget&&this.commandHandler.dropAnnotation(e.source,this.currentTarget),this.commandHandler.updateSelector(),a&&!this.commandHandler.isContainer&&this.commandHandler.endGroupAction()}else{l.nodes.push(dp(e.source)),e.portId=this.portId,s=dp(l);const t={type:"PortPositionChanged",objectId:this.portId,redoObject:dp(s),undoObject:dp(this.undoElement),category:"Internal"};this.commandHandler.addHistoryEntry(t)}this.commandHandler.updateBlazorSelector(),i.mouseUp.call(this,e)})}isSelectionHasConnector(e){return!(!(e.nodes&&e.connectors&&e.nodes.length>0&&e.connectors.length>0)||e.width===this.undoElement.width&&e.height===this.undoElement.height)}getBlazorPositionChangeEventArgs(e,t){return{source:e.source,state:e.state,oldValue:e.oldValue,newValue:e.newValue,target:Lc(t)===ol?{connector:t}:{node:t},targetPosition:this.currentPosition,allowDrop:!0,cancel:!1}}mouseMove(e){super.mouseMove(e);let t,i,n=!1;t=this.commandHandler.renderContainerHelper(e.source)||e.source,t instanceof Td||t instanceof ol?t instanceof Td?t.offsetX===this.undoElement.nodes[0].offsetX&&t.offsetY===this.undoElement.nodes[0].offsetY&&(n=!0):ws.equals(t.sourcePoint,this.undoElement.connectors[0].sourcePoint)&&ws.equals(t.targetPoint,this.undoElement.connectors[0].targetPoint)&&(n=!0):t.wrapper.offsetX===this.undoElement.wrapper.offsetX&&t.wrapper.offsetY===this.undoElement.wrapper.offsetY&&(n=!0),t&&(i={offsetX:t.wrapper.offsetX,offsetY:t.wrapper.offsetY});let r={source:t,state:"Start",oldValue:i,newValue:i,target:e.target,targetPosition:e.position,allowDrop:!0,cancel:!1};if(r={source:t,state:"Start",oldValue:i,newValue:i,target:e.target,targetPosition:e.position,allowDrop:r.allowDrop,cancel:r.cancel},n&&this.commandHandler.triggerEvent(vo.positionChange,r),this.currentPosition=e.position,"Port"!==this.objectType){const i=this.initialOffset.x+(this.currentPosition.x-this.prevPosition.x),n=this.initialOffset.y+(this.currentPosition.y-this.prevPosition.y);let r,s;this.commandHandler.dragOverElement(e,this.currentPosition),this.commandHandler.disConnect(e.source),this.commandHandler.removeSnap();const o=this.commandHandler.snapPoint(this.prevPosition,this.currentPosition,i,n);this.initialOffset.x=i-o.x,this.initialOffset.y=n-o.y,t&&(r={offsetX:t.wrapper.offsetX,offsetY:t.wrapper.offsetY},s={offsetX:t.wrapper.offsetX+o.x,offsetY:t.wrapper.offsetY+o.y}),this.currentTarget&&e.target!==this.currentTarget&&this.commandHandler.removeChildFromBPmn(e.source,e.target,this.currentTarget),this.currentTarget=e.target;let a={source:t,state:"Progress",oldValue:r,newValue:s,target:e.target,targetPosition:e.position,allowDrop:!0,cancel:!1};if(this.commandHandler.triggerEvent(vo.positionChange,a),!a.cancel&&!this.canCancel){this.blocked=!this.commandHandler.dragSelectedObjects(o.x,o.y);const e=!this.commandHandler.mouseOver(this.currentElement,this.currentTarget,this.currentPosition);this.blocked=this.blocked||e}if(this.commandHandler.removeStackHighlighter(),this.commandHandler.renderStackHighlighter(e),this.currentTarget&&e.source!==this.currentTarget&&this.commandHandler.isDroppable(e.source,this.currentTarget)&&"helper"!==e.source.id){const t=e.source instanceof Ld?e.source.nodes[0]:e.source;this.commandHandler.isParentAsContainer(t,!0)||"SwimLane"===t.shape.type||t.shape.isPhase||(this.currentTarget.isLane?this.commandHandler.renderStackHighlighter(e,this.currentTarget):this.commandHandler.drawHighlighter(this.currentTarget))}else this.commandHandler.removeHighlighter();if(this.commandHandler.canEnableDefaultTooltip()){const t=this.getTooltipContent(e.source);this.commandHandler.showTooltip(e.source,e.position,t,"MoveTool",this.isTooltipVisible),this.isTooltipVisible=!1}}else{const t=zs(),i=e.source;ks(t,-i.rotateAngle,i.offsetX,i.offsetY);const n=Ms(t,{x:this.prevPosition.x,y:this.prevPosition.y}),r=Ms(t,{x:e.position.x,y:e.position.y});this.commandHandler.portDrag(e.source,e.sourceWrapper,r.x-n.x,r.y-n.y)}return this.prevPosition=this.currentPosition,!this.blocked}getTooltipContent(e){return"X:"+Math.round(e.wrapper.bounds.x)+" Y:"+Math.round(e.wrapper.bounds.y)}mouseLeave(e){this.mouseUp(e)}endAction(){super.endAction(),this.currentTarget=null,this.prevPosition=null}}class su extends eu{constructor(e){super(e,!0)}mouseDown(e){if(this.undoElement=dp(e.source),this.undoElement.nodes[0]&&this.undoElement.nodes[0].children){const e=this.commandHandler.getAllDescendants(this.undoElement.nodes[0],[]);for(let t=0;t<e.length;t++){const i=this.commandHandler.cloneChild(e[t].id);this.childTable[e[t].id]=dp(i)}}super.mouseDown(e)}mouseUp(e){const t=Object.create(null,{mouseUp:{get:()=>super.mouseUp}});return Kp(this,void 0,void 0,function*(){let i;if(this.checkPropertyValue(),i=this.commandHandler.renderContainerHelper(e.source)||e.source,this.undoElement.rotateAngle!==i.wrapper.rotateAngle){const t={rotateAngle:i.wrapper.rotateAngle};let n;this.commandHandler.triggerEvent(vo.rotateChange,{source:e.source,state:"Completed",oldValue:t,newValue:t,cancel:!1}),n=dp(e.source);const r={type:"RotationChanged",redoObject:dp(n),undoObject:dp(this.undoElement),category:"Internal",childTable:this.childTable};this.commandHandler.addHistoryEntry(r),this.commandHandler.updateSelector()}this.commandHandler.updateBlazorSelector(),this.canCancel=void 0,this.tempArgs=void 0,t.mouseUp.call(this,e)})}mouseMove(e){let t;if(super.mouseMove(e),t=this.commandHandler.renderContainerHelper(e.source)||e.source,this.undoElement.rotateAngle===t.wrapper.rotateAngle){const i={rotateAngle:t.wrapper.rotateAngle};this.commandHandler.triggerEvent(vo.rotateChange,{source:e.source,state:"Start",oldValue:i,newValue:i,cancel:!1})}this.currentPosition=e.position;let i=ws.findAngle({x:t.wrapper.offsetX,y:t.wrapper.offsetY},this.currentPosition)+90;const n=this.commandHandler.snapAngle(i);i=0!==n?n:i,i=(i+360)%360;const r={source:e.source,state:"Progress",oldValue:{rotateAngle:t.wrapper.rotateAngle},newValue:{rotateAngle:i},cancel:!1};if(this.commandHandler.triggerEvent(vo.rotateChange,r),!r.cancel&&(this.blocked=!this.commandHandler.rotateSelectedItems(i-t.wrapper.rotateAngle)),this.commandHandler.canEnableDefaultTooltip()){const t=this.getTooltipContent(e.source);this.commandHandler.showTooltip(e.source,e.position,t,"RotateTool",this.isTooltipVisible),this.isTooltipVisible=!1}return!this.blocked}getTooltipContent(e){return Math.round(e.rotateAngle%360).toString()+"\xb0"}mouseLeave(e){this.mouseUp(e)}endAction(){super.endAction()}}class ou extends eu{constructor(e,t){super(e,!0),this.initialBounds=new Ds,this.canCancel=!1,this.corner=t}mouseDown(e){if(this.undoElement=dp(e.source),this.undoParentElement=this.commandHandler.getSubProcess(e.source),super.mouseDown(e),this.undoElement.nodes[0]&&this.undoElement.nodes[0].children){const e=this.commandHandler.getAllDescendants(this.undoElement.nodes[0],[]);for(let t=0;t<e.length;t++){const i=this.commandHandler.cloneChild(e[t].id);this.childTable[e[t].id]=dp(i)}}this.commandHandler.checkSelection(e.source,this.corner),super.mouseDown(e),this.initialBounds.x=e.source.wrapper.offsetX,this.initialBounds.y=e.source.wrapper.offsetY,this.initialBounds.height=e.source.wrapper.actualSize.height,this.initialBounds.width=e.source.wrapper.actualSize.width}mouseUp(e,t){const i=Object.create(null,{mouseUp:{get:()=>super.mouseUp}});return Kp(this,void 0,void 0,function*(){let n;if(this.checkPropertyValue(),this.commandHandler.removeSnap(),this.commandHandler.updateSelector(),n=this.commandHandler.renderContainerHelper(e.source)||e.source,this.undoElement.offsetX!==n.wrapper.offsetX||this.undoElement.offsetY!==n.wrapper.offsetY||this.undoElement.width!==n.wrapper.bounds.width||this.undoElement.height!==n.wrapper.bounds.height){{const t=this.updateSize(e.source,this.currentPosition,this.prevPosition,this.corner,this.initialBounds);this.blocked=this.scaleObjects(t.width,t.height,this.corner,this.currentPosition,this.prevPosition,n);const i={offsetX:e.source.wrapper.offsetX,offsetY:e.source.wrapper.offsetY,width:e.source.wrapper.actualSize.width,height:e.source.wrapper.actualSize.height};this.commandHandler.triggerEvent(vo.sizeChange,{source:e.source,state:"Completed",oldValue:i,newValue:i,cancel:!1})}const i=dp(e.source),r={type:"SizeChanged",redoObject:dp(i),undoObject:dp(this.undoElement),category:"Internal",childTable:this.childTable};if(!t){if(this.commandHandler.startGroupAction(),this.commandHandler.addHistoryEntry(r),i.nodes[0]&&i.nodes[0].processId){const t={type:"SizeChanged",redoObject:this.commandHandler.getSubProcess(e.source),undoObject:this.undoParentElement,category:"Internal"};this.commandHandler.addHistoryEntry(t)}this.commandHandler.endGroupAction()}}return this.commandHandler.updateBlazorSelector(),i.mouseUp.call(this,e),!this.blocked})}mouseMove(e){let t;super.mouseMove(e),t=this.commandHandler.renderContainerHelper(e.source)||e.source,this.undoElement.offsetX===t.wrapper.offsetX&&this.undoElement.offsetY===t.wrapper.offsetY&&this.commandHandler.triggerEvent(vo.sizeChange,{source:e.source,state:"Start",oldValue:{offsetX:e.source.wrapper.offsetX,offsetY:e.source.wrapper.offsetY,width:e.source.wrapper.actualSize.width,height:e.source.wrapper.actualSize.height},newValue:this.currentElement,cancel:!1}),this.currentPosition=e.position;let i={x:this.currentPosition.x-this.startPosition.x,y:this.currentPosition.y-this.startPosition.y};i=Sp(-this.currentElement.wrapper.rotateAngle,void 0,void 0,i),i=this.getChanges(i),this.commandHandler.removeSnap();const n=this.updateSize(e.source,this.startPosition,this.currentPosition,this.corner,this.initialBounds);if(this.blocked=!this.scaleObjects(n.width,n.height,this.corner,this.startPosition,this.currentPosition,t),this.commandHandler.canEnableDefaultTooltip()){const t=this.getTooltipContent(e.source);this.commandHandler.showTooltip(e.source,e.position,t,"ResizeTool",this.isTooltipVisible),this.isTooltipVisible=!1}return this.prevPosition=this.currentPosition,!this.blocked}mouseLeave(e){this.mouseUp(e)}getTooltipContent(e){return"W:"+Math.round(e.wrapper.bounds.width)+" H:"+Math.round(e.wrapper.bounds.height)}getChanges(e){switch(this.corner){case"ResizeEast":return{x:e.x,y:0};case"ResizeSouthEast":return e;case"ResizeSouth":return{x:0,y:e.y};case"ResizeNorth":return{x:0,y:-e.y};case"ResizeNorthEast":return{x:e.x,y:-e.y};case"ResizeNorthWest":return{x:-e.x,y:-e.y};case"ResizeWest":return{x:-e.x,y:0};case"ResizeSouthWest":return{x:-e.x,y:e.y}}return e}scaleObjects(e,t,i,n,r,s){s instanceof Ld&&1===s.nodes.length&&s.nodes[0].constraints&so.AspectRatio&&("ResizeWest"===i||"ResizeEast"===i||"ResizeNorth"===i||"ResizeSouth"===i?1===t&&1===e||(t=e=Math.max(1===t?0:t,1===e?0:e)):t=e=n!==r?Math.max(t,e):0);const o={offsetX:s.offsetX,offsetY:s.offsetY,width:s.width,height:s.height};this.blocked=this.commandHandler.scaleSelectedItems(e,t,this.getPivot(this.corner));const a={offsetX:s.offsetX,offsetY:s.offsetY,width:s.width,height:s.height};let l,h;return l={source:s,state:"Progress",oldValue:o,newValue:a,cancel:!1},h={source:s,state:"Progress",oldValue:o,newValue:a,cancel:l.cancel},this.commandHandler.triggerEvent(vo.sizeChange,h),(h.cancel||this.canCancel)&&this.commandHandler.scaleSelectedItems(1/e,1/t,this.getPivot(this.corner)),this.blocked}}class au extends eu{constructor(e,t){super(e,!0),this.sourceObject=t}mouseDown(e){super.mouseDown(e),this.inAction=!0,this.commandHandler.setFocus()}mouseMove(e){let t;if(super.mouseMove(e),this.drawingObject||(this.drawingObject=this.commandHandler.drawObject({offsetX:this.currentPosition.x,width:3,height:3,offsetY:this.currentPosition.y})),this.inAction&&!1===ws.equals(this.currentPosition,this.prevPosition)){const e=Ds.toBounds([this.prevPosition,this.currentPosition]);t=this.commandHandler.checkBoundaryConstraints(void 0,void 0,e),t&&this.commandHandler.updateNodeDimension(this.drawingObject,e)}return t}mouseUp(e){let t;this.checkPropertyValue();const i=Ds.toBounds([this.prevPosition,this.currentPosition]);t=this.commandHandler.checkBoundaryConstraints(void 0,void 0,i),this.drawingObject&&this.drawingObject instanceof Td&&(this.commandHandler.addObjectToDiagram(this.drawingObject),this.drawingObject=null),this.commandHandler.updateBlazorSelector(),super.mouseUp(e),this.inAction=!1}endAction(){super.endAction()}mouseLeave(e){this.inAction&&this.mouseUp(e)}}class lu extends nu{constructor(e,t,i){super(e,t),this.sourceObject=i}mouseDown(e){const t=Object.create(null,{mouseDown:{get:()=>super.mouseDown}});return Kp(this,void 0,void 0,function*(){t.mouseDown.call(this,e),this.inAction=!0,this.commandHandler.setFocus()})}mouseMove(e){if(this.commandHandler.enableServerDataBinding(!1),this.inAction){const t={sourcePoint:this.currentPosition,targetPoint:this.currentPosition};this.drawingObject||(this.drawingObject=this.commandHandler.drawObject(t)),e.source=this.drawingObject,(e.target&&e.target instanceof Td||e.actualObject&&e.sourceWrapper&&Nc(e.actualObject,e.sourceWrapper))&&("ConnectorTargetEnd"!==this.endPoint||Pl(e.target))&&this.commandHandler.connect(this.endPoint,e),this.endPoint="ConnectorTargetEnd"}return this.inAction||(this.commandHandler.updateSelector(),e.source&&e.sourceWrapper&&this.commandHandler.renderHighlighter(e,!0)),super.mouseMove(e),this.commandHandler.enableServerDataBinding(!0),!this.blocked}mouseUp(e){const t=Object.create(null,{mouseUp:{get:()=>super.mouseUp}});return Kp(this,void 0,void 0,function*(){this.commandHandler.enableServerDataBinding(!1),this.checkPropertyValue(),this.drawingObject&&this.drawingObject instanceof ol&&(this.commandHandler.addObjectToDiagram(this.drawingObject),this.drawingObject=null),this.commandHandler.updateBlazorSelector(),this.inAction=!1,this.commandHandler.enableServerDataBinding(!0),t.mouseUp.call(this,e)})}endAction(){super.endAction()}mouseLeave(e){this.inAction&&this.mouseUp(e)}}class hu extends eu{constructor(e){super(e,!0)}mouseDown(e){super.mouseDown(e),this.commandHandler.clearSelection(),e.source||(this.drawingNode=this.commandHandler.drawObject({shape:{type:"Text"},offsetX:this.currentPosition.x,offsetY:this.currentPosition.y}))}mouseMove(e){if(super.mouseMove(e),this.drawingNode?(this.drawingNode.style.strokeColor="black",this.drawingNode.style.strokeDashArray="2 2",this.drawingNode.style.fill="transparent"):(this.drawingNode=this.commandHandler.drawObject({shape:{type:"Text"},offsetX:this.currentPosition.x,width:30,height:30,offsetY:this.currentPosition.y}),this.drawingNode.style.strokeDashArray="2 2",this.drawingNode.style.fill="transparent"),this.inAction&&!1===ws.equals(this.currentPosition,this.prevPosition)){const e=Ds.toBounds([this.prevPosition,this.currentPosition]);this.commandHandler.updateNodeDimension(this.drawingNode,e)}return!this.blocked}mouseUp(e){this.checkPropertyValue(),this.drawingNode?(this.drawingNode.style.strokeColor="none",this.drawingNode.style.fill="none"):this.drawingNode=e.source,this.drawingNode&&(this.drawingNode instanceof Td||this.drawingNode instanceof ol)&&this.commandHandler.addText(this.drawingNode,this.currentPosition),super.mouseUp(e),this.inAction=!1}endAction(){super.endAction()}}class cu extends eu{constructor(e,t){super(e),this.zooming=t}mouseDown(e){super.mouseDown(e),this.inAction=!0,this.commandHandler.setBlazorDiagramProps(!0)}mouseMove(e){if(super.mouseMove(e),this.inAction)if(this.zooming||!1!==ws.equals(this.currentPosition,this.prevPosition)){if(e.moveTouches&&e.moveTouches.length&&e.moveTouches.length>=2){const t=e.startTouches[0],i=e.startTouches[1],n=e.moveTouches[0],r=e.moveTouches[1],s=this.getDistance(n,r)/this.getDistance(t,i);this.commandHandler.zoom(s,0,0,e.position),this.updateTouch(t,n),this.updateTouch(i,r)}}else this.commandHandler.scroll(this.currentPosition.x-this.prevPosition.x,this.currentPosition.y-this.prevPosition.y,this.currentPosition);return this.commandHandler.dataBinding(),!this.blocked}mouseUp(e){this.commandHandler.setBlazorDiagramProps(!1),this.checkPropertyValue(),this.commandHandler.updatePanState(!1),super.mouseUp(e),this.inAction=!1}endAction(){super.endAction()}getDistance(e,t){const i=t.pageX-e.pageX,n=t.pageY-e.pageY;return Math.sqrt(i*i+n*n)}updateTouch(e,t){e.pageX=t.pageX,e.pageY=t.pageY}}class du extends eu{constructor(e){super(e,!0)}mouseUp(e){this.checkPropertyValue(),this.commandHandler.initExpand(e),super.mouseUp(e)}}class pu extends eu{constructor(e){super(e,!0)}mouseUp(e){this.checkPropertyValue(),window.open(e.sourceWrapper.hyperlink.link,"_blank").focus(),super.mouseUp(e)}}class uu extends eu{constructor(e){super(e,!0)}mouseDown(e){if(super.mouseDown(e),this.inAction=!0,this.drawingObject){let e;const t=this.drawingObject.shape;e=t.points[t.points.length-1],e={x:e.x,y:e.y},this.drawingObject.shape.points.push(e)}else{this.startPoint={x:this.startPosition.x,y:this.startPosition.y};this.drawingObject=this.commandHandler.drawObject({offsetX:this.currentPosition.x,offsetY:this.currentPosition.y,width:5,height:5,style:{strokeColor:"black",strokeWidth:1},shape:{type:"Basic",shape:"Polygon",points:[{x:this.startPoint.x,y:this.startPoint.y},{x:this.currentPosition.x,y:this.currentPosition.y}]}})}}mouseMove(e){if(super.mouseMove(e),this.inAction){const e=this.drawingObject.shape;if(this.drawingObject&&this.currentPosition&&(e.points[e.points.length-1].x=this.currentPosition.x,e.points[e.points.length-1].y=this.currentPosition.y,this.drawingObject.wrapper.children[0].data=Ss(this.drawingObject.shape.points),this.inAction&&!1===ws.equals(this.currentPosition,this.prevPosition))){const e=Ds.toBounds(this.drawingObject.shape.points);this.commandHandler.updateNodeDimension(this.drawingObject,e)}}return!0}mouseUp(e,t){this.checkPropertyValue(),super.mouseMove(e),this.inAction&&(this.inAction=!1,this.drawingObject&&this.commandHandler.addObjectToDiagram(this.drawingObject)),this.endAction()}mouseWheel(e){super.mouseWheel(e),this.mouseMove(e)}endAction(){this.inAction=!1,this.drawingObject=null}}class gu extends eu{constructor(e){super(e,!0)}mouseMove(e){if(super.mouseMove(e),this.inAction){const e=this.drawingObject;e.targetPoint=this.currentPosition,this.commandHandler.updateConnectorPoints(e)}return!0}mouseDown(e){if(super.mouseDown(e),this.inAction=!0,this.drawingObject){const e=this.drawingObject;let t;t=new Za(e,"segments",{type:"Straight"},!0),t.point=this.currentPosition,e.segments[e.segments.length-1]=t}else this.drawingObject=this.commandHandler.drawObject({id:"Connector",type:"Straight",sourcePoint:this.currentPosition,targetPoint:this.currentPosition})}mouseWheel(e){super.mouseWheel(e),this.mouseMove(e)}mouseUp(e){if(this.checkPropertyValue(),super.mouseMove(e),this.inAction&&this.drawingObject){const e=this.drawingObject;e.segments[e.segments.length-1].point={x:0,y:0},this.commandHandler.addObjectToDiagram(this.drawingObject)}this.endAction()}endAction(){this.drawingObject=null,this.inAction=!1}}class mu extends eu{constructor(e){super(e,!0)}mouseDown(e){this.inAction=!0,this.undoElement=dp(e.source),this.annotationId=e.sourceWrapper.id,super.mouseDown(e)}mouseMove(e){super.mouseMove(e);let t=this.currentPosition.x-this.prevPosition.x,i=this.currentPosition.y-this.prevPosition.y;const n=e.source;if(n instanceof Td){const e=zs();ks(e,-n.rotateAngle,0,0);const r=Ms(e,{x:t,y:i});t=r.x,i=r.y}return this.inAction&&(this.commandHandler.labelDrag(e.source,e.sourceWrapper,t,i),this.commandHandler.updateSelector()),this.prevPosition=this.currentPosition,!this.blocked}mouseUp(e){this.checkPropertyValue();const t=e.source;this.inAction=!1;const i={type:"AnnotationPropertyChanged",objectId:this.annotationId,undoObject:dp(this.undoElement),category:"Internal",redoObject:dp(t)};this.commandHandler.addHistoryEntry(i),super.mouseUp(e)}mouseLeave(e){this.mouseUp(e)}}class fu extends eu{constructor(e,t){super(e,!0),this.corner=t}mouseDown(e){this.inAction=!0;const t=e.source.nodes.length?e.source.nodes[0]:e.source.connectors[0];this.annotationId=e.source.wrapper.children[0].id,this.undoElement=dp(t);const i=e.source.wrapper.children[0];this.initialBounds={x:i.offsetX,y:i.offsetY,width:i.actualSize.width,height:i.actualSize.height},super.mouseDown(e)}mouseMove(e){return super.mouseMove(e),this.inAction&&this.resizeObject(e),!this.blocked}mouseUp(e){this.checkPropertyValue();const t=e.source.nodes.length?e.source.nodes[0]:e.source.connectors[0];this.inAction=!1;const i={type:"AnnotationPropertyChanged",objectId:this.annotationId,redoObject:dp(t),undoObject:dp(this.undoElement),category:"Internal"};this.commandHandler.addHistoryEntry(i),super.mouseUp(e)}mouseLeave(e){this.mouseUp(e)}resizeObject(e){let t;t=e.source.nodes.length?e.source.nodes[0]:e.source.connectors[0];const i=e.source.wrapper.children[0];let n,r;const s={x:i.offsetX,y:i.offsetY};let o=i.rotateAngle;o+=t instanceof Td?t.rotateAngle:0,o=(o+360)%360;const a=zs();ks(a,o,s.x,s.y);const l=this.corner.slice(5),h=this.updateSize(i,this.startPosition,this.currentPosition,l,this.initialBounds,o),c=i.offsetX-i.actualSize.width*i.pivot.x,d=i.offsetY-i.actualSize.height*i.pivot.y;let p=this.getPivot(l);p={x:c+i.actualSize.width*p.x,y:d+i.actualSize.height*p.y};const u=Ms(a,p);h.x=u.x,h.y=u.y,n=h.width,r=h.height,n=n<0?1:n,r=r<0?1:r,this.commandHandler.labelResize(t,e.source.annotation,n,r,h,e.source),this.commandHandler.updateSelector()}}class yu extends eu{constructor(e){super(e,!0)}mouseDown(e){this.inAction=!0,this.annotationId=e.source.wrapper.children[0].id,this.undoElement=dp(e.source.nodes.length?e.source.nodes[0]:e.source.connectors[0]),super.mouseDown(e)}mouseMove(e){if(super.mouseMove(e),e.source&&this.inAction){let t;t=e.source.annotation,this.commandHandler.labelRotate(e.source.nodes[0]?e.source.nodes[0]:e.source.connectors[0],t,this.currentPosition,e.source),this.commandHandler.updateSelector()}return this.prevPosition=this.currentPosition,!this.blocked}mouseUp(e){this.checkPropertyValue(),this.inAction=!1;const t={type:"AnnotationPropertyChanged",objectId:this.annotationId,redoObject:dp(e.source.nodes.length?e.source.nodes[0]:e.source.connectors[0]),undoObject:dp(this.undoElement),category:"Internal"};this.commandHandler.addHistoryEntry(t),super.mouseUp(e)}mouseLeave(e){this.mouseUp(e)}}class bu extends eu{constructor(e,t){super(e,!0),this.endPoint=t}mouseDown(e){let t,i=!0;if(e.source&&e.source.connectors&&(t=e.source.connectors[0]),e.info&&(i=e.info.ctrlKey&&"Orthogonal"!==e.actualObject.type),t&&i){this.inAction=!0,this.undoElement=dp(e.source),super.mouseDown(e);for(let e=0;e<t.segments.length;e++){const i=t.segments[e];if("OrthoThumb"===this.endPoint)for(let e=0;e<i.points.length-1;e++){const t={x:0,y:0};t.x=(i.points[e].x+i.points[e+1].x)/2,t.y=(i.points[e].y+i.points[e+1].y)/2,Gp(this.currentPosition,t,30)&&(this.selectedSegment=i,this.segmentIndex=e)}else Gp(this.currentPosition,i.point,10)&&(this.selectedSegment=i)}}}mouseMove(e){if(super.mouseMove(e),this.currentPosition=e.position,this.currentPosition&&this.prevPosition){const t=this.currentPosition.y-this.prevPosition.y,i=this.currentPosition.x-this.prevPosition.x;let n;if(this.currentPosition=this.commandHandler.snapConnectorEnd(this.currentPosition),e.source&&e.source.connectors&&(n=e.source.connectors[0]),this.inAction&&void 0!==this.selectedSegment&&void 0!==this.endPoint&&(0!==i||0!==t)){if("OrthoThumb"===this.endPoint)this.blocked=!this.dragOrthogonalSegment(n,this.selectedSegment,this.currentPosition,this.segmentIndex);else{const e=this.currentPosition.x-this.selectedSegment.point.x,t=this.currentPosition.y-this.selectedSegment.point.y,i=n.segments.indexOf(this.selectedSegment);this.blocked=!this.commandHandler.dragControlPoint(n,e,t,!1,i)}this.commandHandler.updateSelector()}}return this.prevPosition=this.currentPosition,!this.blocked}mouseUp(e){let t,i;if(e.source&&e.source.connectors&&(t=e.source.connectors[0],i={segments:t.segments}),e&&e.source&&e.info&&e.info.ctrlKey&&e.info.shiftKey&&"Straight"===t.type)this.addOrRemoveSegment(t,this.currentPosition);else if("OrthoThumb"===this.endPoint&&this.selectedSegment){const e=t.segments.indexOf(this.selectedSegment),n=t.segments[e-1],r=t.segments[e+1];if(e===t.segments.length-2&&this.updateLastSegment(t,this.selectedSegment))t.segments.splice(t.segments.length-2,1);else if(n&&Math.abs(n.length)<5)1!==e&&this.removePrevSegment(t,e);else if(r){const i=ws.distancePoints(r.points[0],r.points[1]);Math.abs(r.length||0===r.length?r.length:i)<=5&&this.removeNextSegment(t,e)}this.commandHandler.updateEndPoint(t,i)}if(this.undoElement){const t=dp(e.source);this.commandHandler.addHistoryEntry({type:"SegmentChanged",redoObject:t,undoObject:this.undoElement,category:"Internal"})}super.mouseUp(e)}removePrevSegment(e,t){const i=e.segments[t-2],n=e.segments[t+1];if(!((n.length||0===n.length?n.length:ws.distancePoints(n.points[0],n.points[1]))<=5)){const n=e.segments.slice(t-1,t+1);let r={element:e,removeSegments:n,type:"Removal",cancel:!1};if(this.commandHandler.triggerEvent(vo.segmentCollectionChange,r),!r.cancel){const n=e.segments[t+1];e.segments.splice(t-1,2);const r=this.selectedSegment;"Left"===r.direction||"Right"===r.direction?(i.points[i.points.length-1].x=n.points[0].x,n.points[0].y=i.points[i.points.length-1].y):(i.points[i.points.length-1].y=n.points[0].y,n.points[0].x=i.points[i.points.length-1].x),(r.length||0===r.length)&&this.findSegmentDirection(i),this.findSegmentDirection(n)}}}findSegmentDirection(e){e.direction&&(e.length||0===e.length)&&(e.length=ws.distancePoints(e.points[0],e.points[e.points.length-1]),e.direction=ws.direction(e.points[0],e.points[e.points.length-1]))}removeNextSegment(e,t){const i=this.selectedSegment,n=e.segments[t-1],r=e.segments[t+2],s=e.segments[t+1];let o,a;if(s.length||0===s.length?(o=e.segments.slice(t,2),a={element:e,removeSegments:o,type:"Removal",cancel:!1},a={element:e,removeSegments:o,type:"Removal",cancel:!1},this.commandHandler.triggerEvent(vo.segmentCollectionChange,a),a.cancel||(e.segments.splice(t,2),"Top"===i.direction||"Bottom"===i.direction?(r.points[0].y=i.points[0].y,n.points[n.points.length-1].x=r.points[0].x):(r.points[0].x=i.points[0].x,n.points[n.points.length-1].y=r.points[0].y))):(o=e.segments.slice(t+1,1),a={element:e,removeSegments:o,type:"Removal",cancel:!1},this.commandHandler.triggerEvent(vo.segmentCollectionChange,a),a.cancel||(e.segments.splice(t+1,1),"Top"===i.direction||"Bottom"===i.direction?n.points[n.points.length-1].x=s.points[s.points.length-1].x:n.points[n.points.length-1].y=s.points[s.points.length-1].y,this.findSegmentDirection(n),i.length=i.direction=null)),n&&r&&!a.cancel&&(n.length=ws.distancePoints(n.points[0],r.points[0]),n.direction=ws.direction(n.points[0],r.points[0]),r.length||0===r.length)){r.length=ws.distancePoints(n.points[n.points.length-1],r.points[r.points.length-1]);const e=n.points,t=r.points;r.direction=ws.direction(e[e.length-1],t[t.length-1])}}addOrRemoveSegment(e,t){let i,n;const r={segments:e.segments};for(let s=0;s<e.segments.length;s++)Gp(t,e.segments[s].point,e.hitPadding)&&(n=s,i=!0);if(i&&void 0!==n){if(e.segments&&e.segments[n]&&"Straight"===e.segments[n].type){const t=e.segments[n],i=e.segments[n+1];i&&(e.segments.splice(n,1),i.points[0]=t.points[0])}}else{this.commandHandler.enableServerDataBinding(!1);const n=this.findIndex(e,t);if(e.segments&&e.segments[n]&&"Straight"===e.segments[n].type){const r=e.segments[n],s=new Za(e,"segments",{type:"Straight",point:t},!0);s.points[0]=r.points[0],s.points[1]=t,r.points[0]=t,e.segments.splice(n,0,s),i=!0}this.commandHandler.enableServerDataBinding(!0)}i&&this.commandHandler.updateEndPoint(e,r)}findIndex(e,t){const i=[];for(let n=0;n<e.segments.length;n++){const r=e.segments[n],s=Ds.toBounds([r.points[0],r.points[1]]);s.Inflate(e.hitPadding),s.containsPoint(t)&&i.push(r)}if(1===i.length)return e.segments.indexOf(i[0]);{let n,r,s,o,a,l;for(let e=0;e<i.length;e++)o=i[e],a=(t.y-o.points[0].y)/(o.points[1].y-t.y),l=(t.x-o.points[0].x)/(o.points[1].x-t.x),n=Math.abs(a-l),0===e&&(r=n,s=0),n<r&&(r=n,s=e);return e.segments.indexOf(i[s])}}dragOrthogonalSegment(e,t,i,n){const r={x:0,y:0},s={segments:e.segments};r.x=(t.points[n].x+t.points[n+1].x)/2,r.y=(t.points[n].y+t.points[n+1].y)/2;const o=i.y-r.y,a=i.x-r.x;let l=e.segments.indexOf(t),h=!1;return-1!==l&&(0===l&&1===e.segments.length&&2===t.points.length?(l=this.addSegments(e,t,a,o,l),h=!0):l!==e.segments.length-1||null!==t.direction&&null!==t.length?0===l&&(l=this.insertFirstSegment(e,t,a,o,l),h=!0):(l=this.addTerminalSegment(e,t,a,o,n),h=!0),l&&(h&&(this.selectedSegment=t=e.segments[l],this.segmentIndex=0),this.updateAdjacentSegments(e,l,a,o),this.commandHandler.updateEndPoint(e,s))),!0}addSegments(e,t,i,n,r){let s;const o=[],a=ws.distancePoints(t.points[0],t.points[1]),l=ws.direction(t.points[0],t.points[1]);o.push(new Qa(e,"segments",{type:"Orthogonal",direction:l,length:a/4},!0)),o.push(new Qa(e,"segments",{type:"Orthogonal",direction:t.points[0].y===t.points[1].y?n>0?"Bottom":"Top":i>0?"Right":"Left",length:t.points[0].x===t.points[1].x?n:i},!0)),o.push(new Qa(e,"segments",{type:"Orthogonal",direction:l,length:a/2},!0));let h={element:e,addSegments:o,type:"Addition",cancel:!1};return this.commandHandler.triggerEvent(vo.segmentCollectionChange,h),h.cancel||(e.segments=o.concat(e.segments),s=r+2),s}insertFirstSegment(e,t,i,n,r){let s,o;const a=[];let l,h,c;if(e.sourcePortID&&t.length&&e.segments[0].points.length>2){let r;for(let s=0;s<t.points.length-1;s++){const o=ws.distancePoints(t.points[s],t.points[s+1]),l=ws.direction(t.points[s],t.points[s+1]);c=new Qa(e,"segments",{type:"Orthogonal",direction:l,length:o},!0),0===c.length&&(c.direction=!r||"Top"!==r.direction&&"Bottom"!==r.direction?n>0?"Bottom":"Top":i>0?"Right":"Left"),r=c,a.push(c)}}else l={type:"Orthogonal",direction:t.direction,length:t.length/3},a.push(new Qa(e,"segments",l,!0)),"Bottom"===t.direction||"Top"===t.direction?(o=Math.abs(i),s=i>0?"Right":"Left"):(o=Math.abs(n),s=n>0?"Bottom":"Top"),c=new Qa(e,"segments",{type:"Orthogonal",direction:s,length:o},!0),a.push(c);let d={element:e,addSegments:a,type:"Addition",cancel:!1};if(this.commandHandler.triggerEvent(vo.segmentCollectionChange,d),!d.cancel){if(e.sourcePortID&&t.length&&e.segments[0].points.length>2)e.segments.splice(0,1),h=1;else{const i=e.segments[1];i&&i.length&&(i.length=s!==i.direction?i.length+o:i.length-o),h=2,t.length=2*t.length/3}e.segments=a.concat(e.segments)}return h}updateAdjacentSegments(e,t,i,n){const r=e.segments[t],s=r.points[r.points.length-1];let o=!0;"Orthogonal"===r.type&&(r.points[0]=r.points[0],r.points[r.points.length-1]=s,e.segments[t-1]&&(o=this.updatePreviousSegment(i,n,e,t)),e.segments.length-1>t&&o&&this.updateNextSegment(e,r,e.segments[t+1],i,n))}addTerminalSegment(e,t,i,n,r){let s,o,a,l,h=e.segments.indexOf(t);const c=[],d=e.segments.pop(),p=e.segments[e.segments.length-1];s=p&&"Orthogonal"===p.type?p:null;for(let f=0;f<t.points.length-2;f++)a=ws.distancePoints(t.points[f],t.points[f+1]),l=ws.direction(t.points[f],t.points[f+1]),o=new Qa(e,"segments",{type:"Orthogonal",length:a,direction:l},!0),c.push(o),s=o;const u=r;if((2===t.points.length||u===t.points.length-2)&&(s&&(s.length+=5),void 0!==u)){a=2*ws.distancePoints(t.points[t.points.length-2],t.points[t.points.length-1])/3,l=ws.direction(t.points[t.points.length-2],t.points[t.points.length-1]);const i=new Qa(e,"segments",{type:"Orthogonal",length:a,direction:l});c.push(i)}const g=new Qa(e,"segments",{type:"Orthogonal"},!0);let m;return c.push(g),m={element:e,addSegments:c,type:"Addition",cancel:!1},this.commandHandler.triggerEvent(vo.segmentCollectionChange,m),m.cancel?e.segments.push(d):(e.segments=e.segments.concat(c),h+=r),this.commandHandler.updateEndPoint(e),h}updatePortSegment(e,t,i,n,r){if(1===i&&2===e.points.length&&e.length<0){const n=t.sourceWrapper.corners,r=t.segments[i],s=t.segments[i+1];let o;const a=[];let l;o=new Qa(t,"segments",{type:"Orthogonal",length:13,direction:e.direction}),a.push(o),l="Left"===r.direction?r.points[0].x-(n.middleLeft.x-20):"Right"===r.direction?n.middleRight.x+20-r.points[0].x:"Bottom"===r.direction?n.bottomCenter.y+20-r.points[0].y:r.points[0].y-(n.topCenter.y-20),o=new Qa(t,"segments",{type:"Orthogonal",length:l,direction:r.direction}),a.push(o),r.length=r.length-l,s&&s.length&&s.direction&&(s.direction===e.direction?s.length-=13:s.direction===Ca(e.direction)&&(s.length+=13)),t.segments=a.concat(t.segments),this.selectedSegment=t.segments[3]}}updatePreviousSegment(e,t,i,n){const r=i.segments[n],s=i.segments[n-1];s.points[s.points.length-1]=r.points[0];const o=!i.sourceID||""!==i.sourcePortID;let a=!0;return"Orthogonal"===s.type&&("Bottom"===s.direction?s.length+=t:"Top"===s.direction?s.length-=t:"Right"===s.direction?s.length+=e:s.length-=e,""!==i.sourcePortID&&s.length<0?this.updatePortSegment(s,i,n,e,t):i.sourceID&&""===i.sourcePortID&&s.length<0&&1===n&&(a=!1,this.updateFirstSegment(i,r)),o&&this.changeSegmentDirection(s)),a}changeSegmentDirection(e){e.length<0&&(e.direction=Ca(e.direction),e.length*=-1)}updateNextSegment(e,t,i,n,r){i.points[0]=t.points[t.points.length-1],i&&"Orthogonal"===i.type&&(i.length||0===i.length)&&("Left"===i.direction||"Right"===i.direction?0!==n&&(i.length="Right"===i.direction?i.length-n:i.length+n,(i.length||0===i.length)&&this.changeSegmentDirection(i)):0!==r&&(i.length="Bottom"===i.direction?i.length-r:i.length+r,(i.length||0===i.length)&&this.changeSegmentDirection(i)))}updateFirstSegment(e,t){const i=e.segments.indexOf(t);let n=!1;const r=e.segments[i],s=e.segments[i-1];let o;const a={segments:e.segments};if(s.length<0&&e.sourceID){const t=e.sourceWrapper.corners,l=[];let h,c=!1;this.changeSegmentDirection(r);const d=e.segments[i+1],p=e.segments[i+2];switch(d&&this.changeSegmentDirection(d),p&&this.changeSegmentDirection(p),s.direction){case"Top":case"Bottom":o=r.length>0&&"Left"===r.direction?t.middleLeft:t.middleRight,r.length>t.width/2?Math.abs(s.length)<t.height/2&&(s.length=ws.distancePoints(t.center,s.points[s.points.length-1]),r.points[0].x=o.x,r.length=ws.distancePoints(r.points[0],r.points[r.points.length-1]),r.length-=20,n=!0):(d&&d.direction&&d.length&&(d.points[0].y=o.y,d.points[0].x=d.points[d.points.length-1].x="Right"===r.direction?o.x+20:o.x-20),n=!0,c=!0);break;case"Left":case"Right":o=r.length>0&&"Top"===r.direction?t.topCenter:t.bottomCenter,r.length>t.height/2?Math.abs(s.length)<t.width/2&&(s.length=ws.distancePoints(t.center,s.points[s.points.length-1]),r.points[0].y=o.y,r.length=ws.distancePoints(r.points[0],r.points[r.points.length-1]),r.length-=20,n=!0):(d&&d.direction&&d.length&&(d.points[0].x=o.x,d.points[0].y=d.points[d.points.length-1].y="Bottom"===r.direction?o.y+20:o.y-20),n=!0,c=!0)}this.changeSegmentDirection(s),this.changeSegmentDirection(r),n&&(h={type:"Orthogonal",direction:r.direction,length:20},l.push(new Qa(e,"segments",h,!0)),c&&(d&&d.direction&&d.length&&(d.length=ws.distancePoints(d.points[0],d.points[d.points.length-1])),p&&p.direction&&p.length&&(p.length=ws.distancePoints(d.points[d.points.length-1],p.points[p.points.length-1])),e.segments.splice(i-1,2)),e.segments=l.concat(e.segments)),this.selectedSegment=c?e.segments[i-1]:e.segments[i+1],this.commandHandler.updateEndPoint(e,a)}}updateLastSegment(e,t){if(e.targetID&&""===e.targetPortID){let i,n,r,s;const o=e.targetWrapper.corners,a=t.points[0],l=t.points[t.points.length-1];return"Right"===t.direction||"Left"===t.direction?(i={x:a.x,y:a.y},n={x:"Left"===t.direction?l.x-o.width/2:l.x+o.width/2,y:l.y},r={x:o.center.x,y:o.center.y-o.height},s={x:o.center.x,y:o.center.y+o.height}):(i={x:a.x,y:a.y},n={x:l.x,y:"Bottom"===t.direction?l.y+o.height/2:l.y-o.height/2},r={x:o.center.x-o.width,y:o.center.y},s={x:o.center.x+o.width,y:o.center.y}),ic({x1:i.x,y1:i.y,x2:n.x,y2:n.y},{x1:r.x,y1:r.y,x2:s.x,y2:s.y}).enabled}return!1}destroy(){}getModuleName(){return"ConnectorEditingTool"}}class vu{constructor(e,t){this.currentAction="None",this.previousAction="None",this.focus=!1,this.isBlocked=!1,this.isMouseDown=!1,this.inAction=!1,this.doingAutoScroll=!1,this.diagram=null,this.objectFinder=null,this.tool=null,this.eventArgs=null,this.keyArgs={},this.diagram=e,this.objectFinder=new wu,this.commandHandler=t}get action(){return this.currentAction}set action(e){e!==this.currentAction&&("PortDraw"===this.currentAction&&(this.diagram.tool&=~ho.DrawOnce,this.tool&&this.tool.mouseUp({position:this.currentPosition}),this.tool=null),"Rotate"===e||"LabelRotate"===e?this.diagram.diagramCanvas.classList.add("e-diagram-rotate"):"Rotate"!==this.currentAction&&"LabelRotate"!==this.currentAction||this.diagram.diagramCanvas.classList.remove("e-diagram-rotate"),this.currentAction=e,this.diagram.diagramActions="None"!==this.currentAction&&"Select"!==this.currentAction&&!(this.diagram.diagramActions&go.TextEdit)||this.commandHandler.isUserHandle(this.currentPosition)?this.diagram.diagramActions|go.ToolAction:this.diagram.diagramActions&~go.ToolAction,this.diagram.setCursor(this.diagram.getCursor(e,this.inAction)))}get blocked(){return this.isBlocked}set blocked(e){this.isBlocked=e,this.diagram.setCursor(this.blocked?"not-allowed":this.diagram.getCursor(this.action,this.inAction))}getMousePosition(e){let t,i,n;-1!==e.type.indexOf("touch")?(t=e,i=t.changedTouches[0].clientX,n=t.changedTouches[0].clientY):(i=e.clientX,n=e.clientY);let r=new bs;r=pl(this.diagram);const s=this.diagram.element.getBoundingClientRect();return i=i+this.diagram.diagramCanvas.scrollLeft-s.left-r.width,n=n+this.diagram.diagramCanvas.scrollTop-s.top-r.height,i/=this.diagram.scroller.transform.scale,n/=this.diagram.scroller.transform.scale,i-=this.diagram.scroller.transform.tx,n-=this.diagram.scroller.transform.ty,{x:i,y:n}}windowResize(e){return this.resizeTo&&clearTimeout(this.resizeTo),this.resizeTo=setTimeout(()=>{this.updateViewPortSize(this.diagram.element)},300),!1}updateViewPortSize(e){const t=document.getElementById(e.id);if(t){const e=t.getBoundingClientRect();this.diagram.scroller.setViewPortSize(e.width,e.height);let i=new bs;i=pl(this.diagram);const n=this.diagram.getSizeValue(this.diagram.width,i.width),r=this.diagram.getSizeValue(this.diagram.height,i.height);this.diagram.diagramCanvas.style.width=n,this.diagram.diagramCanvas.style.height=r,this.diagram.scroller.setSize(),this.diagram.transformLayers(),this.diagram.rulerSettings.showRulers&&cl(this.diagram)}}canHideResizers(){return(this.tool instanceof ru||this.tool instanceof su)&&this.isMouseDown}updateCursor(){if(1===this.diagram.selectedItems.nodes.length||1===this.diagram.selectedItems.connectors.length){let e=[];e=e.concat(this.diagram.selectedItems.nodes,this.diagram.selectedItems.connectors),this.blocked=!(this.eventArgs&&this.eventArgs.source&&!fl(this.eventArgs.source))&&this.isMouseDown&&1===e.length&&this.tool instanceof tu&&!fl(e[0])}}isForeignObject(e,t){let i=e;if(i)for(;null!==i.parentNode;){if("string"==typeof i.className&&(!t&&-1!==i.className.indexOf("foreign-object")||t&&-1!==i.className.indexOf("e-diagram-text-edit")))return i;i=i.parentNode}return null}isMetaKey(e){return navigator.platform.match("Mac")?e.metaKey:e.ctrlKey}renderUmlHighLighter(e){this.diagram.commandHandler.removeStackHighlighter();const t=this.diagram.selectedItems.nodes[0];if(t&&t.container&&"Stack"===t.container.type&&"UmlClassifier"===t.shape.type&&!t.wrapper.bounds.containsPoint(this.currentPosition)){const i=this.diagram.findObjectsUnderMouse({x:this.currentPosition.x-20,y:this.currentPosition.y}),n=this.diagram.findObjectUnderMouse(i,this.action,this.inAction);n&&n.parentId&&n.parentId===t.id&&uh(n.wrapper,"Vertical"===this.diagram.nameTable[n.parentId].container.orientation,e.position,this.diagram,!0)}}isDeleteKey(e,t){return navigator.platform.match("Mac")&&"Backspace"===e&&"delete"===t}isMouseOnScrollBar(e){const t=e.offsetX,i=e.offsetY,n=this.diagram.diagramCanvas,r=n.offsetHeight,s=n.offsetWidth;let o,a,l,h,c;return!!(r<n.scrollHeight&&(o={x:s-17,y:0},a={x:s,y:0},l={x:s-17,y:r},h={x:s,y:r},c=Ds.toBounds([o,a,l,h]),c.containsPoint({x:t,y:i})))||!!(s<n.scrollWidth&&(o={x:0,y:r-17},a={x:s,y:r-17},l={x:0,y:r},h={x:s,y:r},c=Ds.toBounds([o,a,l,h]),c.containsPoint({x:t,y:i})))}updateVirtualization(){const e=setInterval(t=>{this.diagram.removeVirtualObjects(e)},50);setTimeout(()=>{this.diagram.deleteVirtualObject=!0},50)}checkPreviousAction(){if(this.action!==this.previousAction&&this.diagram.selectedItems.userHandles.length)for(let e=0;e<this.diagram.selectedItems.userHandles.length;e++)this.previousAction&&this.diagram.selectedItems.userHandles[e]&&(this.checkUserHandleEvent(vo.onUserHandleMouseLeave),this.previousAction="None")}checkUserHandleEvent(e){if(this.diagram.selectedItems&&this.diagram.selectedItems.userHandles.length>0){const t=e===vo.onUserHandleMouseLeave?this.previousAction:this.action,i={element:void 0};for(let n=0;n<this.diagram.selectedItems.userHandles.length;n++)if(t===this.diagram.selectedItems.userHandles[n].name||e===vo.onUserHandleMouseUp&&"Select"===t){i.element=this.diagram.selectedItems.userHandles[n],e===vo.onUserHandleMouseEnter&&(this.previousAction=this.action),e===vo.onUserHandleMouseDown&&(this.userHandleObject=this.diagram.selectedItems.userHandles[n].name);const t=document.getElementById(this.diagram.selectedItems.userHandles[n].name+"_userhandle");e===vo.onUserHandleMouseUp?this.commandHandler.isUserHandle(this.currentPosition)&&t&&t.id===this.userHandleObject+"_userhandle"&&this.diagram.triggerEvent(e,i):this.diagram.triggerEvent(e,i)}}}mouseDown(e){if(!0===this.inAction&&this.tool instanceof au)return;this.focus=!0;const t=e.touches;if(this.isMouseOnScrollBar(e))return this.isScrolling=!0,void e.preventDefault();if(this.checkUserHandleEvent(vo.onUserHandleMouseDown),!this.checkEditBoxAsTarget(e)&&Hl(this.diagram)||zl(this.diagram)&&!jl(this.diagram))if("Select"!==this.action&&"Drag"!==this.action||this.diagram.updatePortVisibility(this.hoverElement,eo.Hover,!0),!(this.tool instanceof uu||this.tool instanceof gu)||2!==e.button&&2!==e.buttons)if(!0===this.inAction&&!0===this.isMouseDown&&(this.tool instanceof uu||this.tool instanceof gu))this.isMouseDown=!0,this.eventArgs={},this.getMouseEventArgs(this.currentPosition,this.eventArgs),this.eventArgs.position=this.currentPosition,this.tool.mouseDown(this.eventArgs);else{let i;this.isMouseDown=!0,this.currentPosition=this.prevPosition=this.getMousePosition(e),this.eventArgs={},this.diagram.textEditing&&!this.isMouseOnScrollBar(e)&&(this.diagram.endEdit(),this.diagram.textEditing=!1);const n=this.objectFinder.findObjectsUnderMouse(this.currentPosition,this.diagram,this.eventArgs,null,this.action),r=this.objectFinder.findObjectUnderMouse(this.diagram,n,this.action,this.inAction,this.eventArgs,this.currentPosition);let s=null;null!==r&&(s=this.diagram.findElementUnderMouse(r,this.currentPosition),s&&(i=this.commandHandler.findTarget(s,r))),this.action=this.diagram.findActionToBeDone(r,s,this.currentPosition,i);const o=this.isMetaKey(e);o&&e.shiftKey&&this.diagram.connectorEditingToolModule?this.action="SegmentEnd":!o&&!e.shiftKey||zl(this.diagram)||(this.action="Select"),this.tool=this.diagram.getTool(this.action),this.tool||(this.action="Select",this.tool=this.diagram.getTool(this.action)),this.getMouseEventArgs(this.currentPosition,this.eventArgs),(o||e.shiftKey)&&(this.eventArgs.info=o&&e.shiftKey?{ctrlKey:o,shiftKey:e.shiftKey}:{ctrlKey:!0}),this.eventArgs.position=this.currentPosition,this.tool.mouseDown(this.eventArgs),this.initialEventArgs={source:this.eventArgs.source,sourceWrapper:this.eventArgs.sourceWrapper},this.initialEventArgs.position=this.currentPosition,this.initialEventArgs.info=this.eventArgs.info,this.inAction=!1,"touchstart"===e.type&&(t&&t.length>=2&&(this.touchStartList=Jd(this.touchStartList,0,t)),t||e.preventDefault())}else this.inAction=!1,this.tool.mouseUp(this.eventArgs);this.isForeignObject(e.target)||this.isForeignObject(e.target,!0)||t||e.preventDefault()}mouseMoveExtend(e,t){(this.tool instanceof uu||this.tool instanceof gu)&&this.tool.mouseMove(this.eventArgs),this.diagram.scrollSettings.canAutoScroll?this.checkAutoScroll(e):this.blocked||this.tool.mouseMove(this.eventArgs),this.eventArgs.target&&(this.hoverElement=this.eventArgs.target);const i=!(this.eventArgs.target instanceof Td&&t instanceof Td);this.tool instanceof nu&&this.diagram.updatePortVisibility(this.hoverElement instanceof Td?this.hoverElement:this.hoverNode,eo.Connect|eo.Hover,i),this.hoverElement instanceof Td&&this.hoverNode instanceof Td&&this.hoverNode&&this.hoverNode.id!==this.hoverElement.id&&this.diagram.updatePortVisibility(this.hoverNode,eo.Connect|eo.Hover,!0),this.hoverElement=i?null:t,this.hoverNode=i?null:t}checkAction(e){if("LabelSelect"===this.action&&this.eventArgs.sourceWrapper&&(this.eventArgs.sourceWrapper instanceof Co||this.eventArgs.sourceWrapper instanceof ka)){const e=this.commandHandler.findTarget(this.eventArgs.sourceWrapper,this.eventArgs.source);!$p(this.diagram,e,!1,this.eventArgs.sourceWrapper)&&fl(e)&&(this.action="LabelDrag",this.tool=this.getTool(this.action),this.tool.mouseDown(this.initialEventArgs))}else fl(e)&&ml(e)&&this.initialEventArgs&&this.initialEventArgs.source&&"Select"===this.action&&(!$p(this.diagram,this.eventArgs.source,!1)&&this.eventArgs.source instanceof Ld&&this.getMouseEventArgs(this.currentPosition,this.eventArgs),e instanceof ol&&(!(e instanceof ol)||Gp(this.currentPosition,e.sourcePoint,e.hitPadding)||Gp(this.currentPosition,e.targetPoint,e.hitPadding))||(this.action="Drag"),this.tool=this.getTool(this.action),this.tool.mouseDown(this.initialEventArgs))}isSwimlaneElements(e){return!e||!(e.isLane||e.isPhase||e.isHeader)}mouseMove(e,t){var i,n;if(this.focus=!0,this.isScrolling)e.preventDefault();else if(Hl(this.diagram)||zl(this.diagram)&&!jl(this.diagram)){this.currentPosition=this.getMousePosition(e);const r=this.diagram.findObjectsUnderMouse(this.currentPosition),s=this.diagram.findObjectUnderMouse(r,this.action,this.inAction);n=this.currentPosition,(i=this.diagram).rulerSettings.showRulers&&(i.hRuler.drawRulerMarker(i.hRuler.element,n,i.scroller.horizontalOffset),i.vRuler.drawRulerMarker(i.vRuler.element,n,i.scroller.verticalOffset));let o,a=!1;if("touchmove"===e.type&&(t=e.touches)&&t.length>1&&(this.touchMoveList=Jd(this.touchMoveList,0,t),"PinchZoom"!==this.action&&(a=!0)),!1===ws.equals(this.currentPosition,this.prevPosition)||this.inAction){if(!1===this.isMouseDown||a){this.eventArgs={};let e=null;if(null!==s){if(e=this.diagram.findElementUnderMouse(s,this.currentPosition),s!==this.hoverElement){const e=this.getContent();this.hoverElement&&"Auto"===this.hoverElement.tooltip.openOn&&""!==e&&this.elementLeave(),this.diagram.updatePortVisibility(this.hoverElement,eo.Hover,!0),s instanceof Td&&(this.hoverNode=s);let t=!0;!this.isSwimlaneElements(s)&&this.hoverElement&&this.isSwimlaneElements(this.hoverElement)&&(t=!1),this.hoverElement=t?s:this.hoverElement,t?this.elementEnter(this.currentPosition,!1):this.hoverElement=s}else this.hoverElement||this.hoverElement!==s||this.elementEnter(this.currentPosition,!0);e&&(o=this.commandHandler.findTarget(e,s))}this.action=this.diagram.findActionToBeDone(s,e,this.currentPosition,o),this.checkUserHandleEvent(vo.onUserHandleMouseEnter),this.checkPreviousAction(),this.getMouseEventArgs(this.currentPosition,this.eventArgs),this.tool=this.getTool(this.action),this.mouseEvents(),this.tool instanceof lu||this.tool instanceof gu||this.tool instanceof uu?this.tool.mouseMove(this.eventArgs):t&&this.tool instanceof cu&&this.tool.mouseDown(this.eventArgs),this.updateCursor(),this.renderUmlHighLighter(this.eventArgs);let i=!1;(!this.hoverElement||this.tool instanceof cu||!(s instanceof Td)||!this.isSwimlaneElements(s)||0!==this.diagram.selectedItems.nodes.length&&$p(this.diagram,this.hoverElement))&&(i=!0),this.diagram.updatePortVisibility(this.hoverElement,eo.Hover,i);const n=this.getContent();null===s&&this.hoverElement&&"Auto"===this.hoverElement.tooltip.openOn&&n&&(this.hoverElement=null,this.elementLeave()),a=!1}else{this.eventArgs.position=this.currentPosition,"Drag"===this.action&&!$p(this.diagram,this.eventArgs.source,!1)&&this.eventArgs.source instanceof Ld&&this.getMouseEventArgs(this.currentPosition,this.eventArgs),this.mouseEvents(),(e.ctrlKey||e.shiftKey)&&(this.eventArgs.info=e.ctrlKey&&e.shiftKey?{ctrlKey:e.ctrlKey,shiftKey:e.shiftKey}:{ctrlKey:!0}),this.checkAction(s);const t=this.getConnectorPadding(this.eventArgs);this.getMouseEventArgs(this.currentPosition,this.eventArgs,this.eventArgs.source,t),this.updateCursor(),this.inAction=!0,this.initialEventArgs=null,"Drag"!==this.action&&"Rotate"!==this.action||(this.diagram.diagramActions=this.diagram.diagramActions|go.Interactions),this.mouseMoveExtend(e,s)}this.prevPosition=this.currentPosition,this.isForeignObject(e.target,!0)||e.preventDefault()}}}getContent(){return this.hoverElement instanceof Td&&this.hoverElement.constraints&so.Tooltip||this.hoverElement instanceof ol&&this.hoverElement.constraints&no.Tooltip?this.hoverElement.tooltip.content:this.diagram.tooltip.content}checkAutoScroll(e){const t=this.startAutoScroll(e);if(!t&&this.doingAutoScroll)this.doingAutoScroll=!1,clearInterval(this.timeOutValue);else if(t){if((this.tool instanceof au||this.tool instanceof lu||this.tool instanceof ru||this.tool instanceof ou||this.tool instanceof tu)&&this.inAction){const i=this,n=100;this.diagram.scrollSettings.canAutoScroll&&t&&!this.doingAutoScroll&&(this.doingAutoScroll=!0,this.timeOutValue=setInterval(r=>{i.doAutoScroll(t,e,n)},n))}}else this.blocked=!this.tool.mouseMove(this.eventArgs)}mouseUp(e){this.checkUserHandleEvent(vo.onUserHandleMouseUp),"SVG"===this.diagram.mode&&Dl(this.diagram)&&this.updateVirtualization(),this.diagram.previousSelectedObject=null,this.diagram.diagramRenderer.rendererActions=this.diagram.removeConstraints(this.diagram.diagramRenderer.rendererActions,mo.DrawSelectorBorder);const t=e.touches;if(this.isScrolling)return this.isScrolling=!1,void e.preventDefault();if(!this.checkEditBoxAsTarget(e)&&Hl(this.diagram)||zl(this.diagram)&&!jl(this.diagram)){if(this.tool&&(!(this.tool instanceof uu||this.tool instanceof gu)||(this.tool instanceof uu||this.tool instanceof gu)&&2===e.detail)){if(!this.isForeignObject(e.target)&&this.isMouseDown&&document.getElementById(this.diagram.element.id+"content").focus(),!this.inAction&&3!==e.which&&"Drag"===this.action){this.action="Select";const t=this.diagram.findObjectsUnderMouse(this.currentPosition),i=this.diagram.findObjectUnderMouse(t,this.action,this.inAction);let n=!0;!e.ctrlKey&&this.isMouseDown&&this.diagram.selectedItems.nodes.length+this.diagram.selectedItems.connectors.length>1&&1===e.which&&!(this.diagram.diagramActions&go.PreventClearSelection)&&(n=!1,this.commandHandler.clearSelection()),$p(this.diagram,i)&&n||this.commandHandler.selectObjects([i])}let t=!1;const i=this.updateContainerProperties();let n;if(this.addUmlNode(),this.inAction=!1,this.isMouseDown=!1,this.currentPosition=this.getMousePosition(e),this.diagram.selectedObject.helperObject&&(n=this.updateContainerBounds()),this.tool&&(this.tool.prevPosition||this.tool instanceof pu)){this.eventArgs.position=this.currentPosition;const n=this.getConnectorPadding(this.eventArgs);this.getMouseEventArgs(this.currentPosition,this.eventArgs,this.eventArgs.source,n);const r=this.isMetaKey(e);if((r||e.shiftKey)&&(this.eventArgs.info=r&&e.shiftKey?{ctrlKey:r,shiftKey:e.shiftKey}:{ctrlKey:!0}),this.diagram.diagramActions&go.Interactions&&(this.diagram.diagramActions=this.diagram.diagramActions&~go.Interactions),this.eventArgs.clickCount=e.detail,this.diagram.selectedObject.helperObject&&(this.tool instanceof ru||this.tool instanceof ou)){if(this.diagram.selectedObject.actualObject&&""!==this.diagram.selectedObject.actualObject.parentId){const e=this.diagram.getObject(this.diagram.selectedObject.actualObject.parentId);e&&e.isLane&&(this.commandHandler.isContainer=!0)}t=this.diagram.lineRoutingModule&&this.diagram.nameTable.helper&&this.eventArgs.target&&this.eventArgs.target.isLane&&(this.eventArgs.source instanceof Ld&&this.eventArgs.source.nodes.length>0&&""===this.eventArgs.source.nodes[0].parentId||""===this.eventArgs.source.parentId),t&&(this.diagram.diagramActions=this.diagram.diagramActions|go.PreventLaneContainerUpdate),this.tool.mouseUp(this.eventArgs,i.isPreventHistory)}else this.tool.mouseUp(this.eventArgs),!this.diagram.checkMenu||-1===window.navigator.userAgent.indexOf("Linux")&&-1===window.navigator.userAgent.indexOf("X11")||(!e.pageY&&e instanceof TouchEvent&&e.changedTouches?(window.getSelection().removeAllRanges(),this.diagram.contextMenuModule.contextMenu.open(e.changedTouches[0].pageY,e.changedTouches[0].pageX,this.diagram.element),e.preventDefault()):this.diagram.contextMenuModule.contextMenu.open(e.pageY,e.pageX,this.diagram.element),this.diagram.checkMenu=!1);i.hasStack&&this.diagram.endGroupAction()}if(n&&this.diagram.endGroupAction(),this.updateContainerBounds(!0),2!==this.eventArgs.clickCount&&(this.commandHandler.updateSelectedNodeProperties(this.eventArgs.source),t)){this.diagram.diagramActions=this.diagram.diagramActions&~go.PreventLaneContainerUpdate;let e=this.eventArgs.source instanceof Ld?this.eventArgs.source.nodes:[this.eventArgs.source];if(e)for(let t=0;t<e.length;t++)e[t].container||(this.commandHandler.dropChildToContainer(this.eventArgs.target,e[t]),this.commandHandler.renderContainerHelper(e[t]))}if(this.diagram.selectedObject&&this.diagram.selectedObject.helperObject&&(this.diagram.remove(this.diagram.selectedObject.helperObject),this.diagram.selectedObject={helperObject:void 0,actualObject:void 0},this.diagram.diagramActions&go.PublicMethod&&this.diagram.constraints&lo.LineRouting&&(this.diagram.diagramActions=this.diagram.diagramActions&~go.PublicMethod)),this.blocked=!1,this.hoverElement){let e=eo.Connect;$p(this.diagram,this.hoverElement)&&(e|=eo.Hover),this.diagram.updatePortVisibility(this.hoverElement,e,!0),this.hoverElement=null}this.touchStartList=null,this.touchMoveList=null,this.tool instanceof hu||(this.tool=null)}t||e.preventDefault(),this.diagram.currentDrawingObject=void 0;const i=this.diagram.selectedItems;let n=!1;if(this.commandHandler.isUserHandle(this.currentPosition)&&this.isForeignObject(e.target)&&(n=!0),!this.inAction&&i.wrapper&&i.userHandles.length>0&&!n&&this.diagram.renderSelector(!0),!this.inAction&&!this.diagram.currentSymbol&&this.eventArgs){let t={element:this.eventArgs.source||this.diagram,position:this.eventArgs.position,count:e.detail,actualObject:this.eventArgs.actualObject,button:0===e.button?"Left":1===e.button?"Middle":"Right"};this.diagram.tool!==ho.ZoomPan&&this.diagram.triggerEvent(vo.click,t)}this.eventArgs={}}this.diagram.diagramActions=this.diagram.diagramActions&~go.PreventLaneContainerUpdate,this.eventArgs={},this.diagram.commandHandler.removeStackHighlighter()}getConnectorPadding(e){let t;const i=e.source;if(i&&i instanceof Ld&&i.connectors.length){const e=i.connectors[0];t=e.constraints&no.ConnectToNearByPort?e.connectionPadding:0}return t||0}getBlazorClickEventArgs(e){return e={element:this.eventArgs.source?{selector:this.eventArgs.source}:{diagram:this.diagram},position:this.eventArgs.position,count:e.count,actualObject:this.eventArgs.actualObject?{selector:this.eventArgs.actualObject}:{diagram:this.diagram},button:e.button},this.eventArgs.source instanceof Td?(e.element.selector.nodes=[],e.element.selector.nodes.push(this.eventArgs.source)):this.eventArgs.source instanceof ol&&(e.element.selector.connectors=[],e.element.selector.connectors.push(this.eventArgs.source)),e}addSwimLaneObject(e){let t,i,n,r,s,o,a=0;const l=e.shape,h=this.objectFinder.findObjectsUnderMouse(this.currentPosition,this.diagram,this.eventArgs,null,this.action);if(i||(i=this.diagram.findObjectUnderMouse(h,this.action,this.inAction)),this.diagram.clearSelectorLayer(),i&&!(i.isLane||i.isPhase||i.isHeader))for(let c=0;c<h.length;c++){const e=this.diagram.nameTable[h[c].id];(e.isLane||e.isPhase||e.isHeader)&&(i=e)}if(i&&(l.isPhase||l.isLane&&i.isLane)&&(t=this.diagram.nameTable[i.parentId]),t&&(n=t.shape,s=l.isLane?l.orientation===n.orientation:l.orientation!==n.orientation),s&&i){if(n.header&&n.hasHeader&&"Horizontal"===n.orientation&&(a=1),n.phases.length>0&&(a+=1),l.isPhase){o="Horizontal"===n.orientation?this.currentPosition.x-t.wrapper.bounds.x:this.currentPosition.y-(t.wrapper.bounds.y+n.header.height);const e={id:op(),offset:o,header:{annotation:{content:"Phase"}}};this.diagram.addPhases(t,[e])}else{const e={id:op(),style:l.lanes[0].style,header:{annotation:{content:l.lanes[0].header.annotation.content,style:l.lanes[0].header.annotation.style},style:l.lanes[0].header.style}};"Horizontal"===l.orientation?e.height=l.lanes[0].height:e.width=l.lanes[0].width,"Horizontal"===n.orientation?(r=i.rowIndex?i.rowIndex:this.diagram.nameTable[i.parentId].rowIndex,i.wrapper.offsetY<this.currentPosition.y&&(r+=1)):(r=i.columnIndex?i.columnIndex:this.diagram.nameTable[i.parentId].columnIndex,this.currentPosition.x<i.wrapper.bounds.center.x&&(r-=1)),n.lanes.length>r-a?(e.header.width=n.lanes[r-a].header.width,e.header.height=n.lanes[r-a].header.height):(e.header.width=n.lanes[r-a-1].header.width,e.header.height=n.lanes[r-a-1].header.height),this.diagram.addLanes(t,[e],r-a)}this.commandHandler.select(t)}else if(l.isLane){const t={id:op(),width:e.width,height:e.height,addInfo:e.addInfo,shape:{type:"SwimLane",header:{annotation:{content:"Header"},height:50,style:l.lanes[0].header.style},phases:[{id:op(),header:{annotation:{content:"Phase"}}}],lanes:[{id:op(),height:e.height,width:e.width,style:l.lanes[0].style,header:{annotation:{content:l.lanes[0].header.annotation.content,style:l.lanes[0].header.annotation.style},style:l.lanes[0].header.style}}],orientation:l.orientation}};"Vertical"===l.orientation&&(t.width+=20),t.offsetX=this.currentPosition.x+t.width/2,t.offsetY=this.currentPosition.y+t.height/2,this.diagram.add(t)}}mouseLeave(e){this.tool&&this.inAction&&this.tool.mouseLeave(this.eventArgs),this.diagram.selectedObject.helperObject&&(this.updateContainerProperties(),this.updateContainerBounds()&&this.diagram.endGroupAction()),this.eventArgs&&this.eventArgs.source&&(this.diagram.updatePortVisibility(this.eventArgs.source,eo.Hover,!0),this.hoverElement=null),this.eventArgs&&!this.eventArgs.source&&this.hoverElement&&(this.hoverElement=null),this.tool instanceof nu&&this.eventArgs&&this.eventArgs.target&&this.eventArgs.target instanceof Td&&(this.diagram.updatePortVisibility(this.eventArgs.target,eo.Hover|eo.Connect,!0),this.hoverElement=null);const t=this.diagram.selectedItems;t&&t.wrapper&&this.diagram.renderSelector(!0),(this.diagram.diagramActions&go.Interactions||this.diagram.diagramActions&go.ToolAction)&&(this.diagram.diagramActions=this.diagram.diagramActions&~go.ToolAction),this.isMouseDown=!1,this.focus=!1,this.touchStartList=null,this.touchMoveList=null,this.elementLeave(),this.commandHandler.removeSnap(),this.inAction=!1,this.eventArgs={},this.diagram.selectedObject&&this.diagram.selectedObject.helperObject&&(this.diagram.remove(this.diagram.selectedObject.helperObject),this.diagram.selectedObject={helperObject:void 0,actualObject:void 0}),this.tool=null,function(){const e=document.getElementsByClassName("e-d-ruler-marker");let t,i;if(e&&e.length>0)for(i=e.length-1;i>=0;i--)t=e[i],t&&t.parentNode.removeChild(t)}(),"Rotate"===this.action&&this.diagram.diagramCanvas.classList.remove("e-diagram-rotate"),e.preventDefault()}mouseWheel(e){this.diagram.blazorActions|=Ks.interaction;const t=e.wheelDelta>0||-40*e.detail>0,i=this.getMousePosition(e);if(this.diagram.tooltipObject.close(),this.isMetaKey(e))this.diagram.zoom(t?1.2:1/1.2,i),e.preventDefault();else{const n=this.diagram.scroller.horizontalOffset,r=this.diagram.scroller.verticalOffset,s=t?20:-20;this.tool&&(this.tool instanceof uu||this.tool instanceof gu)&&(this.eventArgs={},this.getMouseEventArgs(i,this.eventArgs),this.eventArgs.position=i,this.tool.mouseWheel(this.eventArgs)),this.diagram.scrollActions|=yo.Interaction,e.shiftKey?this.diagram.scroller.zoom(1,s,0,i):this.diagram.scroller.zoom(1,0,s,i),this.diagram.scrollActions&=~yo.Interaction,n===this.diagram.scroller.horizontalOffset&&r===this.diagram.scroller.verticalOffset||e.preventDefault()}if(this.diagram.textEditing){if(this.diagram.isTriggerEvent=!0,this.diagram.activeLabel.parentId){const e=this.diagram.getObject(this.diagram.activeLabel.parentId);this.diagram.startTextEdit(e,this.diagram.activeLabel.id)}this.diagram.isTriggerEvent=!1}this.diagram.blazorActions=this.diagram.blazorActions&~Ks.interaction}keyDown(e){if(!(this.diagram.diagramActions&go.TextEdit)&&!this.checkEditBoxAsTarget(e)||"Escape"===e.key||27===e.keyCode){const t="inAction";let i;const n=e.keyCode?e.keyCode:e.which,r=e.key,s=this.isMetaKey(e);if(this.diagram.commandManager&&this.diagram.commands){const o=this.diagram.commands;for(const a of Object.keys(o))if(i=this.diagram.commands[a],i&&(i.gesture.keyModifiers||i.gesture.key)&&(n===i.gesture.key||r===uo[i.gesture.key]||this.isDeleteKey(r,a))&&(!i.gesture.keyModifiers&&!e.altKey&&!e.shiftKey&&!s||i.gesture.keyModifiers&&(s||e.altKey||e.shiftKey)&&this.altKeyPressed(i.gesture.keyModifiers)&&e.altKey||this.shiftKeyPressed(i.gesture.keyModifiers)&&e.shiftKey||this.ctrlKeyPressed(i.gesture.keyModifiers)&&s)){const n=Cp(i.canExecute);if(n&&n({keyDownEventArgs:KeyboardEvent,parameter:i.parameter})){if(e.preventDefault(),"Escape"===e.key)if(this.checkEditBoxAsTarget(e))document.getElementById(this.diagram.diagramCanvas.id).focus();else if(this.diagram.currentSymbol){const e="selectedSymbols",t="sourceElement",i="intDestroy";this.diagram.removeFromAQuad(this.diagram.currentSymbol),this.diagram.removeObjectsFromLayer(this.diagram.nameTable[this.diagram.currentSymbol.id]),this.diagram.removeElements(this.diagram.currentSymbol),hc(this.diagram.currentSymbol,this.diagram),delete this.diagram.nameTable[this.diagram.currentSymbol.id],this.diagram.droppable[t].draggable[i]();const n=this.diagram.droppable[e];n.parentNode.removeChild(n);const r=this.diagram.diagramActions;this.diagram.diagramActions=this.diagram.addConstraints(r,go.PreventClearSelection),this.tool.mouseUp(this.eventArgs),this.diagram.diagramRenderer.rendererActions=this.diagram.removeConstraints(this.diagram.diagramRenderer.rendererActions,mo.DrawSelectorBorder),this.diagram.previousSelectedObject&&this.diagram.select(this.diagram.previousSelectedObject),this.action="Select",this.diagram.previousSelectedObject=null,this.diagram.currentSymbol=null,this.diagram.diagramActions=this.diagram.removeConstraints(r,go.PreventClearSelection),this.isMouseDown=!1}else this.inAction&&this.diagram.drawingObject&&this.tool&&this.tool[t]&&(this.tool.mouseUp(this.eventArgs),this.tool=null,this.isMouseDown=!1);i.execute&&this.diagram.tool!==ho.ZoomPan&&Cp(i.execute)({keyDownEventArgs:KeyboardEvent,parameter:i.parameter});break}}}}this.keyArgs={element:this.diagram.selectedItems,key:e.key,keyCode:e.keyCode?e.keyCode:e.which},this.getKeyModifier(this.keyArgs,e),this.diagram.diagramActions&go.TextEdit&&this.getlabel(this.keyArgs,e),this.diagram.triggerEvent(vo.keyDown,this.keyArgs)}getlabel(e,t){const i=this.diagram.activeLabel;e.target=this.diagram.element.id+"_editBox";const n=this.diagram.nameTable[i.parentId];if(document.getElementById(this.diagram.element.id+"_editBox")){e.text=document.getElementById(this.diagram.element.id+"_editBox").value;for(let t=0;t<n.annotations.length;t++)if(n.annotations[t].id===i.id){e.label=n.annotations[t];break}}}getKeyModifier(e,t){e.keyModifiers=po.None,t.ctrlKey&&(e.keyModifiers|=po.Control),t.shiftKey&&(e.keyModifiers|=po.Shift),t.altKey&&(e.keyModifiers|=po.Alt),this.isMetaKey(t)&&(e.keyModifiers|=po.Meta)}keyUp(e){this.keyArgs={element:this.diagram.selectedItems,key:e.key,keyCode:e.keyCode?e.keyCode:e.which},this.getKeyModifier(this.keyArgs,e),this.diagram.diagramActions&go.TextEdit&&this.getlabel(this.keyArgs,e),this.diagram.triggerEvent(vo.keyUp,this.keyArgs)}startAutoScroll(e){const t=this.getMousePosition(e);t.x*=this.diagram.scroller.currentZoom,t.y*=this.diagram.scroller.currentZoom;const i=pl(this.diagram);let n;const r=this.diagram.scrollSettings.autoScrollBorder;if("mozilla"===Z.info.name&&0===this.diagram.scroller.viewPortWidth){const e=document.getElementById(this.diagram.element.id).getBoundingClientRect();e.width!==this.diagram.scroller.viewPortWidth&&this.diagram.scroller.setViewPortSize(e.width,e.height)}return this.diagram.scrollSettings.canAutoScroll&&(t.x+this.diagram.scroller.horizontalOffset+r.right+i.width>=this.diagram.scroller.viewPortWidth-18?n="right":t.x+this.diagram.scroller.horizontalOffset<r.left?n="left":t.y+this.diagram.scroller.verticalOffset+r.bottom+i.height>this.diagram.scroller.viewPortHeight-18?n="bottom":t.y+this.diagram.scroller.verticalOffset<r.top&&(n="top")),n}doAutoScroll(e,t,i,n){const r=e;if((this.tool instanceof au||this.tool instanceof lu||this.tool instanceof ru||this.tool instanceof ou||this.tool instanceof tu)&&this.inAction){const e=this.getMousePosition(t);let i=0,n=0;const s={x:e.x,y:e.y};switch(r){case"right":s.x=e.x+10,i=10;break;case"left":s.x=e.x-10,i=-10;break;case"bottom":s.y=e.y+10,n=10;break;case"top":s.y=e.y-10,n=-10}this.eventArgs.position={x:s.x,y:s.y},this.currentPosition=this.eventArgs.position;const o=this.objectFinder.findObjectsUnderMouse(this.currentPosition,this.diagram,this.eventArgs,null,this.action);this.eventArgs.target=this.diagram.findObjectUnderMouse(o,this.action,this.inAction),this.tool.mouseMove(this.eventArgs),this.diagram.scrollActions|=yo.Interaction,this.diagram.scroller.zoom(1,-i,-n,e),this.diagram.scrollActions&=~yo.Interaction}}mouseEvents(){const e=this.diagram.findObjectsUnderMouse(this.currentPosition);for(let i=0;i<e.length;i++)this.eventArgs.actualObject===e[i]&&e.splice(i,1);let t={targets:{}};if(t={targets:e,element:this.eventArgs.source===this.eventArgs.actualObject?void 0:this.eventArgs.source,actualObject:this.eventArgs.actualObject},this.lastObjectUnderMouse&&this.diagram.mouseLeave&&(!this.eventArgs.actualObject||this.lastObjectUnderMouse!==this.eventArgs.actualObject)){this.diagram.triggerEvent(vo.mouseLeave,{targets:void 0,element:this.lastObjectUnderMouse,actualObject:void 0}),this.lastObjectUnderMouse=null}(!this.lastObjectUnderMouse&&this.eventArgs.source||this.lastObjectUnderMouse!==this.eventArgs.actualObject)&&(this.lastObjectUnderMouse=this.eventArgs.actualObject,void 0!==this.eventArgs.actualObject&&this.diagram.triggerEvent(vo.mouseEnter,t)),this.eventArgs.actualObject&&this.diagram.triggerEvent(vo.mouseOver,t)}getBlazorCollectionObject(e,t){if(e)for(let i=0;i<e.length;i++)Lc(e[i])===ol?t.targets.connector.push(e[i]):t.targets.node.push(e[i])}elementEnter(e,t){if(!t){const e=this.hoverElement instanceof Td&&this.hoverElement.constraints&so.Tooltip||this.hoverElement instanceof ol&&this.hoverElement.constraints&no.Tooltip,t=this.getContent();"Auto"===this.hoverElement.tooltip.openOn&&""!==t&&(i=this.diagram,Ia((n=e?this.hoverElement:void 0)?n.tooltip:i.tooltip,i.tooltipObject)),this.diagram.tooltipObject.offsetX=0,this.diagram.tooltipObject.offsetY=0;const r=this.diagram.findObjectsUnderMouse(this.currentPosition),s=this.diagram.findObjectUnderMouse(r,this.action,this.inAction);let o=document.getElementById(s.id+(s.shape&&s.shape instanceof td?"_content_native_element":"_groupElement"));"Auto"===this.hoverElement.tooltip.openOn&&""!==t&&(this.diagram.tooltipObject.close(),this.diagram.tooltipObject.openOn=this.hoverElement.tooltip.openOn,this.diagram.tooltipObject.dataBind()),function(e,t){let i=0;return e instanceof ol?e.constraints&no.Tooltip?i=e.constraints&no.Tooltip:e.constraints&no.InheritTooltip&&(i=t.constraints&lo.Tooltip):e.constraints&so.Tooltip?i=e.constraints&so.Tooltip:e.constraints&so.InheritTooltip&&(i=t.constraints&lo.Tooltip),i}(this.hoverElement,this.diagram)&&"Auto"===this.hoverElement.tooltip.openOn&&this.diagram.tooltipObject.open(o)}var i,n}elementLeave(){this.diagram.tooltipObject&&"Custom"!==this.diagram.tooltipObject.openOn&&this.diagram.tooltipObject.close()}altKeyPressed(e){return!!(e&po.Alt)}ctrlKeyPressed(e){return!!(e&po.Control)}shiftKeyPressed(e){return!!(e&po.Shift)}scrolled(e){this.diagram.updateScrollOffset()}doubleClick(e){if(Hl(this.diagram)){let t;const i=this.diagram.findObjectsUnderMouse(this.currentPosition),n=this.diagram.findObjectUnderMouse(i,this.action,this.inAction);if(null!==n&&Hl(this.diagram))if(t=this.diagram.findElementUnderMouse(n,this.currentPosition),this.tool&&(this.tool instanceof uu||this.tool instanceof gu))this.tool.mouseUp(this.eventArgs),this.isMouseDown=!1,this.eventArgs={},this.tool=null,e.preventDefault();else{const e=this.diagram.commandHandler.getObjectLayer(n.id);if(e&&!e.lock&&e.visible&&!(this.diagram.diagramActions&go.TextEdit)){let e="";"TextAnnotation"===n.shape.shape&&(e=n.wrapper.children[1].id.split("_")[1]),this.diagram.startTextEdit(n,e||(t instanceof Co?t.id.split(n.id+"_")[1]:void 0))}}this.diagram.triggerEvent(vo.doubleClick,{source:n||this.diagram,position:this.currentPosition,count:e.detail})}}itemClick(e,t){const i=e;return ah(this.diagram,i,!0)?i:null}inputChange(e){let t,i,n,r,s,o,a,l,h;const c=document.getElementById(this.diagram.element.id+"_editBox"),d=document.getElementById(this.diagram.element.id+"_editTextBoxDiv"),p=c.value,u=p.split("\n");r=this.diagram.selectedItems.nodes[0]?this.diagram.selectedItems.nodes[0]:this.diagram.selectedItems.connectors[0],(!r&&this.tool instanceof hu||r&&"SwimLane"===r.shape.type)&&(r=this.diagram.nameTable[this.diagram.activeLabel.parentId]),r&&("Text"!==r.shape.type&&r.annotations.length>0||"Text"===r.shape.type)&&(n=this.diagram.getWrapper(r.wrapper,this.diagram.activeLabel.id),t=r.wrapper.bounds.width<n.bounds.width?r.wrapper.bounds.width:n.bounds.width,t=t>90?t:90,a=kd(n.style,p,void 0,void 0,t),i=Number(c.style.fontSize.split("px")[0]),u.length>1&&""===u[u.length-1]&&(a.height=a.height+i),l=this.diagram.scroller.transform,h=Nl(this.diagram)?l.scale:1,o=a.width,o=(90>o?90:o)*h,s=(12>a.height?12:a.height)*h,d.style.left=(n.bounds.center.x+l.tx)*l.scale-o/2-2.5+"px",d.style.top=(n.bounds.center.y+l.ty)*l.scale-s/2-3+"px",d.style.width=o+"px",d.style.height=s+"px",c.style.minHeight="12px",c.style.minWidth="90px",c.style.width=o+"px",c.style.height=s+"px")}isAddTextNode(e,t){return!(!(this.tool instanceof hu||t)||(this.tool=null,e&&!Ml(this.diagram)&&(this.diagram.drawingObject=void 0,this.diagram.currentDrawingObject=void 0),Ec(this.diagram.nodes,e.id)||Ec(this.diagram.connectors,e.id)||this.diagram.bpmnModule&&this.diagram.bpmnModule.textAnnotationConnectors.indexOf(e)>-1))}checkEditBoxAsTarget(e){return!(!e.target||e.target.id!==this.diagram.element.id+"_editBox")}getMouseEventArgs(e,t,i,n){let r,s,o;if(t.position=e,i?(s=this.diagram.findObjectsUnderMouse(this.currentPosition,i),r=this.diagram.findTargetObjectUnderMouse(s,this.action,this.inAction,t.position,i)):"Drag"===this.action||"ConnectorSourceEnd"===this.action||"SegmentEnd"===this.action||"OrthoThumb"===this.action||"BezierSourceThumb"===this.action||"BezierTargetThumb"===this.action||"ConnectorTargetEnd"===this.action||-1!==this.action.indexOf("Rotate")||-1!==this.action.indexOf("Resize")?(r=this.diagram.selectedItems,!this.diagram.currentSymbol&&"Drag"===this.action&&r&&this.diagram.selectedItems.nodes.length>0&&"SwimLane"===this.diagram.selectedItems.nodes[0].shape.type&&(s=this.diagram.findObjectsUnderMouse(this.currentPosition),r=this.diagram.findObjectUnderMouse(s,this.action,this.inAction))):(s=this.diagram.findObjectsUnderMouse(this.currentPosition),r=this.diagram.findObjectUnderMouse(s,this.action,this.inAction)),r&&r.isHeader&&(r=this.diagram.nameTable[r.parentId],this.eventArgs.actualObject=r),r){let e,t,a;if(o=this.diagram.findElementUnderMouse(r,this.currentPosition,n),(o&&r.ports&&r.ports.length&&!Nc(r,o)||!o||!r)&&s&&s.length&&i instanceof Ld)for(e=i.connectors[0],a=s.length-1;a>=0;a--)if(t=s[a],t instanceof Td&&e&&e.connectionPadding){if(r=t,o=this.diagram.findElementUnderMouse(r,this.currentPosition,n),e.constraints&no.ConnectToNearByPort&&r&&r.ports&&r.ports.length&&Nc(r,o))break;if(t instanceof Td&&e&&e.connectionPadding&&t.wrapper.outerBounds.containsPoint(this.currentPosition)&&e.constraints&no.ConnectToNearByNode&&!(e.constraints&no.ConnectToNearByPort)){r=t,o=this.diagram.findElementUnderMouse(r,this.currentPosition,0);break}}}return i?(t.target=r,t.targetWrapper=o):(t.source=r,t.sourceWrapper=o),t.actualObject=this.eventArgs.actualObject,t.source instanceof Ld&&void 0===t.actualObject&&(t.source.nodes.length>0||t.source.connectors.length>0)&&(t.actualObject=t.source.nodes.length>0?this.diagram.nameTable[t.source.nodes[0].id]:this.diagram.nameTable[t.source.connectors[0].id]),t.startTouches=this.touchStartList,t.moveTouches=this.touchMoveList,t}resetTool(){this.action="Select",this.hoverElement=null,this.hoverNode=null,this.tool=this.diagram.getTool(this.action),this.updateCursor()}getTool(e){switch(e){case"Select":return new tu(this.commandHandler,!0);case"Drag":return new ru(this.commandHandler);case"Rotate":return new su(this.commandHandler);case"LayoutAnimation":return new du(this.commandHandler);case"FixedUserHandle":return new iu(this.commandHandler,!0);case"Hyperlink":return new pu(this.commandHandler);case"ResizeSouthEast":case"ResizeSouthWest":case"ResizeNorthEast":case"ResizeNorthWest":case"ResizeSouth":case"ResizeNorth":case"ResizeWest":case"ResizeEast":return new ou(this.commandHandler,e);case"ConnectorSourceEnd":case"ConnectorTargetEnd":case"BezierSourceThumb":case"BezierTargetThumb":return new nu(this.commandHandler,e);case"SegmentEnd":case"OrthoThumb":return new bu(this.commandHandler,e);case"Draw":const t="shape",i=function(e){let t;return e&&(e.type?t="Connector":e.shape&&!e.type&&(t="Node")),t}(this.diagram.drawingObject);if("Node"===i&&"Text"===this.diagram.drawingObject.shape.type)return new hu(this.commandHandler);if("Node"===i&&"Polygon"===this.diagram.drawingObject.shape[t]&&!this.diagram.drawingObject.shape.points)return new uu(this.commandHandler);if("Node"===i||"Node"===i&&"Polygon"===this.diagram.drawingObject.shape[t]&&this.diagram.drawingObject.shape.points)return new au(this.commandHandler,this.diagram.drawingObject);if("Connector"===i&&"Polyline"===this.diagram.drawingObject.type)return new gu(this.commandHandler);if("Connector"===i)return new lu(this.commandHandler,"ConnectorSourceEnd",this.diagram.drawingObject);break;case"Pan":return new cu(this.commandHandler,!1);case"PinchZoom":return new cu(this.commandHandler,!0);case"PortDrag":return new ru(this.commandHandler,"Port");case"PortDraw":return new lu(this.commandHandler,"ConnectorSourceEnd",this.diagram.drawingObject);case"LabelSelect":return new tu(this.commandHandler,!0,"LabelSelect");case"LabelDrag":return new mu(this.commandHandler);case"LabelResizeSouthEast":case"LabelResizeSouthWest":case"LabelResizeNorthEast":case"LabelResizeNorthWest":case"LabelResizeSouth":case"LabelResizeNorth":case"LabelResizeWest":case"LabelResizeEast":return new fu(this.commandHandler,e);case"LabelRotate":return new yu(this.commandHandler)}return null}getCursor(e){const t=this.diagram.selectedItems.annotation?this.diagram.selectedItems.wrapper.children[0]:this.diagram.selectedItems;return function(e,t){if(t+=360,t%=360,-1===e.indexOf("Resize"))return Qp[e];{const i=Qp[e];if(t>=0&&t<25||t>=160&&t<=205||t>=340&&t<=360)return i;if(t>=25&&t<=70||t>=205&&t<=250)return"n-resize"===i||"s-resize"===i?"ne-resize":"nw-resize"===i||"se-resize"===i?"n-resize":"e-resize"===i||"w-resize"===i?"nw-resize":"e-resize";if(t>=70&&t<=115||t>=250&&t<=295)return"n-resize"===i||"s-resize"===i?"e-resize":"nw-resize"===i||"se-resize"===i?"ne-resize":"e-resize"===i||"w-resize"===i?"n-resize":"nw-resize";if(!(t>=115&&t<=155||t>=295&&t<=340))return"n-resize";if("n-resize"===i||"s-resize"===i)return"nw-resize";if("nw-resize"===i||"se-resize"===i)return"e-resize";if("e-resize"===i||"w-resize"===i)return"ne-resize"}return Qp[e]}(e,this.diagram.selectedItems.annotation?t.rotateAngle+t.parentTransform:t.rotateAngle)}findElementUnderMouse(e,t,i){return this.objectFinder.findElementUnderSelectedItem(e,t,i)}findObjectsUnderMouse(e,t){return this.objectFinder.findObjectsUnderMouse(e,this.diagram,this.eventArgs,t)}findObjectUnderMouse(e,t,i){return this.objectFinder.findObjectUnderMouse(this.diagram,e,t,i,this.eventArgs,this.currentPosition)}findTargetUnderMouse(e,t,i,n,r){return this.objectFinder.findObjectUnderMouse(this.diagram,e,t,i,this.eventArgs,n,r)}findActionToBeDone(e,t,i,n){return function(e,t,i,n,r,s,o){if(s&&s.length>1&&r&&r.length>1)return"PinchZoom";if(n.currentSymbol)return"Drag";if("PortDraw"===n.eventHandler.action&&(n.tool&=~ho.DrawOnce),(kl(n)||Ml(n))&&n.drawingObject)return"Draw";if(qp(n)){const e=n.selectedItems;if(e.wrapper&&Sc(e.constraints,"UserHandle"))for(const t of e.userHandles)if(t.visible&&Gp(i,wc(e,t,n.scroller.transform),t.size/(2*n.scroller.transform.scale)))return t.name}if(qp(n)){const e=n.selectedItems.annotation?n.selectedItems.wrapper.children[0]:n.selectedItems.wrapper,t=e.bounds,r=n.selectedItems,s=new Ds(t.x,t.y,t.width,t.height);if(Zp(n)&&!n.selectedItems.annotation){const e=n.selectedItems.connectors[0],t=10/n.scrollSettings.currentZoom,s=10/n.scrollSettings.currentZoom;if(Sc(r.constraints,"ResizeAll")){if(Sc(r.constraints,"ConnectorSourceThumb")&&vl(e)&&Gp(i,e.sourcePoint,t))return"ConnectorSourceEnd";if(Sc(r.constraints,"ConnectorTargetThumb")&&wl(e)&&Gp(i,e.targetPoint,s))return"ConnectorTargetEnd";const o=function(e,t,i,n){const r=10/n.scrollSettings.currentZoom,s=10/n.scrollSettings.currentZoom;if("Bezier"===e.type)for(let o=0;o<e.segments.length;o++){const t=e.segments[o];if(Gp(i,ws.isEmptyPoint(t.point1)?t.bezierPoint1:t.point1,s))return"BezierSourceThumb";if(Gp(i,ws.isEmptyPoint(t.point2)?t.bezierPoint2:t.point2,r))return"BezierTargetThumb"}if(n.connectorEditingToolModule&&xl(e))if("Straight"===e.type||"Bezier"===e.type){for(let o=0;o<e.segments.length;o++)if(Gp(i,e.segments[o].point,10))return"SegmentEnd"}else for(let o=0;o<e.segments.length;o++){const t={x:0,y:0},n=e.segments[o];if(n.allowDrag)for(let e=0;e<n.points.length-1;e++)if(ws.distancePoints(n.points[e],n.points[e+1])>=50&&(t.x=(n.points[e].x+n.points[e+1].x)/2,t.y=(n.points[e].y+n.points[e+1].y)/2,Gp(i,t,30)))return"OrthoThumb"}return null}(e,0,i,n);if("OrthoThumb"===o)return o;if(Sc(r.constraints,"ConnectorSourceThumb")&&vl(e)&&o)return o;if(Sc(r.constraints,"ConnectorTargetThumb")&&wl(e)&&o)return o}}else{const t=10/n.scroller.currentZoom,o=zs();ks(o,e.rotateAngle+e.parentTransform,e.offsetX,e.offsetY);const a=e.offsetX-e.pivot.x*e.actualSize.width,l=e.offsetY-e.pivot.y*e.actualSize.height;let h={x:a+(.5===e.pivot.x?2*e.pivot.x:e.pivot.x)*e.actualSize.width/2,y:l-30/n.scroller.currentZoom};h=Ms(o,h);const c=!!n.selectedItems.annotation,d=!(!c||!Sl(n.selectedItems.annotation));if(Sc(r.constraints,"Rotate")&&Gp(i,h,t)&&n.selectedItems.thumbsConstraints&ao.Rotate){if(c&&d)return"LabelRotate";if(!c)return"Rotate"}if(s.Inflate(t),s.containsPoint(i)){const t=function(e,t,i,n,r,s){let o;return 1===e.selectedItems.nodes.length&&0===e.selectedItems.connectors.length&&e.selectedItems.nodes[0].container&&(o=function(e,t,i,n,r){const s=10/e.scroller.currentZoom,o=40/e.scroller.currentZoom,a=e.selectedItems,l=t.actualSize.width,h=t.actualSize.height,c=new Ds(n,r+20,t.style.strokeWidth,h-40),d=new Ds(n+l,r+20,t.style.strokeWidth,h-40),p=new Ds(n+20,r,l-40,t.style.strokeWidth),u=new Ds(n+20,r+h,l-40,t.style.strokeWidth),g=ah(e,e.selectedItems.nodes[0],!0)?e.nameTable[e.selectedItems.nodes[0].parentId]:e.selectedItems.nodes[0];if(l>=o&&h>=o){if(xc(a.constraints,"ResizeEast",a.thumbsConstraints,a)&&d.containsPoint(i,s))return"ResizeEast";if(xc(a.constraints,"ResizeSouth",a.thumbsConstraints,a)&&u.containsPoint(i,s))return"ResizeSouth";if("Grid"!==g.container.type){if(xc(a.constraints,"ResizeWest",a.thumbsConstraints,a)&&c.containsPoint(i,s))return"ResizeWest";if(xc(a.constraints,"ResizeNorth",a.thumbsConstraints,a)&&p.containsPoint(i,s))return"ResizeNorth"}}return null}(e,t,i,r,s)),o||e.selectedItems.nodes[0]&&(e.selectedItems.nodes[0].isPhase||e.selectedItems.nodes[0].isLane||"SwimLane"===e.selectedItems.nodes[0].shape.type)||(o=function(e,t,i,n,r,s){const o=40/e.scroller.currentZoom,a=10/e.scroller.currentZoom,l=e.selectedItems,h=!!l.annotation;if(t.actualSize.width>=o&&t.actualSize.height>=o){if(xc(l.constraints,"ResizeSouthEast",l.thumbsConstraints,l)&&Gp(i,Ms(n,{x:r+t.actualSize.width,y:s+t.actualSize.height}),a))return h?"LabelResizeSouthEast":"ResizeSouthEast";if(xc(l.constraints,"ResizeSouthWest",l.thumbsConstraints,l)&&Gp(i,Ms(n,{x:r,y:s+t.actualSize.height}),a))return h?"LabelResizeSouthWest":"ResizeSouthWest";if(xc(l.constraints,"ResizeNorthEast",l.thumbsConstraints,l)&&Gp(i,Ms(n,{x:r+t.actualSize.width,y:s}),a))return h?"LabelResizeNorthEast":"ResizeNorthEast";if(xc(l.constraints,"ResizeNorthWest",l.thumbsConstraints,l)&&Gp(i,Ms(n,{x:r,y:s}),a))return h?"LabelResizeNorthWest":"ResizeNorthWest"}return xc(l.constraints,"ResizeEast",l.thumbsConstraints,l)&&Gp(i,Ms(n,{x:r+t.actualSize.width,y:s+t.actualSize.height/2}),a)?h?"LabelResizeEast":"ResizeEast":xc(l.constraints,"ResizeWest",l.thumbsConstraints,l)&&Gp(i,Ms(n,{x:r,y:s+t.actualSize.height/2}),a)?h?"LabelResizeWest":"ResizeWest":xc(l.constraints,"ResizeSouth",l.thumbsConstraints,l)&&Gp(i,Ms(n,{x:r+t.actualSize.width/2,y:s+t.actualSize.height}),a)?h?"LabelResizeSouth":"ResizeSouth":xc(l.constraints,"ResizeNorth",l.thumbsConstraints,l)&&Gp(i,Ms(n,{x:r+t.actualSize.width/2,y:s}),a)?h?"LabelResizeNorth":"ResizeNorth":null}(e,t,i,n,r,s)),o||null}(n,e,i,o,a,l);if(t)return t}}}if(zl(n)&&!e)return"Pan";if(o instanceof Lo&&!zl(n)){const e=function(e,t,i,n){if(Wl(t)&&(Cc(t,eo.Hover)||Cc(t,eo.Visible))){if(t.constraints&wo.Drag)return"PortDrag"}else if(Bl(t)&&(Cc(t,eo.Hover)||Cc(t,eo.Visible))&&t.constraints&wo.Draw){e.drawingObject={};const i={type:"Orthogonal",sourcePortID:t.id};return e.drawingObject=i,e.tool|=ho.DrawOnce,e.currentDrawingObject=i,"PortDraw"}return"None"}(n,o);if("None"!==e)return e}if((o instanceof jo||o instanceof Ho)&&!zl(n)&&ml(o))return $p(n,o,void 0,t)&&fl(o)?"LabelDrag":"LabelSelect";if(null!==e){if(!(e instanceof Td||e instanceof ol))return"Select";if(t&&t.id){const i=t.id.split(e.id)[1];if(i&&i.match("^_icon"))return"LayoutAnimation"}if(t&&t.id){let i;for(let n=0;n<e.fixedUserHandles.length;n++)if(i=e.fixedUserHandles[n].id,t.id&&t.id.indexOf(i)>-1)return"FixedUserHandle"}if(t instanceof Co&&t.hyperlink.link)return"Hyperlink";if(!fl(e)||!$p(n,e,!1)||void 0!==n.selectedItems.annotation)return e&&zl(n)&&!jl(n)?"Pan":n.selectedItems.nodes.length&&n.selectedItems.nodes[0].isLane&&n.selectedItems.wrapper&&n.selectedItems.wrapper.bounds.containsPoint(i)?"Drag":"Select";if(e instanceof ol&&!Gp(i,e.sourcePoint,e.hitPadding)&&!Gp(i,e.targetPoint,e.hitPadding)||!(e instanceof ol))return"Drag"}return"Select"}(e,t,this.currentPosition,this.diagram,this.touchStartList,this.touchMoveList,n)}updateContainerBounds(e){let t=!1;if(this.diagram.selectedObject.helperObject&&this.diagram.selectedObject.actualObject instanceof Td){const i=this.tool instanceof ou,n=this.diagram.selectedObject.actualObject,r=this.diagram.nameTable[n.parentId];e?sh(this.diagram,n,this.currentPosition,i):((!r||r&&"SwimLane"!==r.shape.type)&&this.diagram.updateDiagramObject(n),t=function(e,t,i,n){let r;const s=[];let o=!1;if(ah(e,t,!0)){e.protectPropertyChange(!0),r=e.nameTable[t.parentId];const a=r.wrapper;if(r&&"Canvas"===r.container.type){if(n||a.bounds.x<=i.x&&a.bounds.right>=i.x&&a.bounds.y<=i.y&&a.bounds.bottom>=i.y){let i;const n=a.bounds.y,s=a.bounds.x,l=e.nameTable[r.parentId]||r;if("SwimLane"===l.shape.type)o=ph(r,l,t,e,!0);else{const t=e.nameTable[r.parentId]||r,o=t.shape;i=t.wrapper,a.actualSize.width<a.outerBounds.width&&!(a.bounds.x>a.outerBounds.x)&&(void 0!==r.rowIndex?(i.updateColumnWidth(r.columnIndex,a.outerBounds.width,!0),"Horizontal"===o.orientation&&o.phaseSize&&Ih(t,e,a,r.columnIndex),Dh(e,t),e.drag(t,s-a.bounds.x,n-a.bounds.y)):e.scale(r,1+(a.outerBounds.width-a.actualSize.width)/a.actualSize.width,1,a.outerBounds.x<a.bounds.x?{x:1,y:.5}:{x:0,y:.5})),a.actualSize.height<a.outerBounds.height&&!(a.bounds.y>a.outerBounds.y)&&(void 0!==r.rowIndex?(i.updateRowHeight(r.rowIndex,a.outerBounds.height,!0),e.drag(t,s-a.bounds.x,n-a.bounds.y)):e.scale(r,1,1+(a.outerBounds.height-a.actualSize.height)/a.actualSize.height,a.outerBounds.y<a.bounds.y?{x:.5,y:1}:{x:.5,y:0}))}}e.select([t]),Oh(s,e)}e.protectPropertyChange(!1)}return o}(this.diagram,n,this.currentPosition,i),this.diagram.updateSelector(),(n.isLane||n.isPhase)&&(this.diagram.clearSelection(),this.commandHandler.selectObjects([n])))}return t}updateContainerProperties(){let e,t,i,n,r=!1,s=!1,o={hasStack:!1,isPreventHistory:!1};if(this.diagram.selectedObject.helperObject){const a=this.diagram.findObjectsUnderMouse(this.currentPosition);let l=this.diagram.findObjectUnderMouse(a,this.action,this.inAction);if(e=this.diagram.selectedObject.helperObject,n=this.diagram.selectedObject.actualObject,n instanceof Td){if("SwimLane"===n.shape.type&&(i=vh(this.diagram,n.wrapper.children[0])),"SwimLane"!==n.shape.type&&n.parentId&&"SwimLane"===this.diagram.getObject(n.parentId).shape.type&&l instanceof Td&&this.diagram.getObject(l.parentId)&&"SwimLane"!==this.diagram.getObject(l.parentId).shape.type&&(l=this.diagram.getObject(l.parentId)),"Drag"===this.currentAction&&n.container&&"Canvas"===n.container.type&&n.parentId&&"SwimLane"===this.diagram.getObject(n.parentId).shape.type&&l&&l!==n&&l.container&&"Canvas"===l.container.type&&l.isLane&&n.isLane&&l.parentId===n.parentId)(function(e,t,i,n){let r,s,o,a,l,h,c,d,p,u;const g=e.getObject(t.parentId),m=g.shape,f=g.wrapper.children[0],y=m.lanes,b=vh(e,f);if("Horizontal"===m.orientation&&t.rowIndex!==i.rowIndex||"Vertical"===m.orientation&&t.columnIndex!==i.columnIndex){if("Horizontal"===m.orientation)l=t.rowIndex,h=i.rowIndex,r=(m.header&&m.hasHeader?1:0)+(m.phases.length&&m.phaseSize?1:0),d=t.rowIndex-r,p=i.rowIndex-r,y[d].canMove&&(d<p?n&&i.wrapper.offsetY>n.y&&(h+=p>0?-1:1,p+=p>0?-1:1):n&&i.wrapper.offsetY<n.y&&(h+=1,p+=1),l!==h&&f.updateRowIndex(l,h));else if(l=t.columnIndex,h=i.columnIndex,r=m.phases.length&&m.phaseSize?1:0,d=t.columnIndex-r,p=i.columnIndex-r,u=m.header&&m.hasHeader?1:0,y[d].canMove&&(d<p?n&&i.wrapper.offsetX>n.x&&(h+=p>0?-1:1,p+=p>0?-1:1):n&&i.wrapper.offsetX<n.x&&(h+=1,p+=1),l!==h)){if(!(0!==m.phaseSize&&0!==m.phases.length||0!==h&&0!==l)&&m.header&&m.hasHeader){const e=0===h?l:h;f.rows[0].cells[e].children=f.rows[0].cells[0].children,f.rows[0].cells[e].columnSpan=f.rows[0].cells[0].columnSpan,f.rows[0].cells[0].children=[]}f.updateColumnIndex(0,l,h)}l!==h&&(c=y[d],c.canMove&&(s={target:dp(i),source:dp(t)},c=y[d],y.splice(d,1),y.splice(p,0,c),a={target:dp(s.source),source:dp(s.target)},o={type:"LanePositionChanged",redoObject:a,undoObject:s,category:"Internal"},e.diagramActions&go.UndoRedo||e.commandHandler.addHistoryEntry(o),xh(e,g,0),Oh(b,e),function(e,t){let i,n;for(let r=0;r<e.length;r++){i=e[r];for(let e=0;e<i.children.length;e++)n=t.nameTable[i.children[e].id],n.offsetX=n.wrapper.offsetX,n.offsetY=n.wrapper.offsetY}}(y,e),g.wrapper.measure(new bs(g.width,g.height)),g.wrapper.arrange(g.wrapper.desiredSize),e.updateDiagramObject(g)))}e.updateDiagramElementQuad()})(this.diagram,n,l,this.currentPosition),o.isPreventHistory=!0;else{let a,h=this.diagram.nameTable[n.parentId];if(!h||h&&"SwimLane"!==h.shape.type)if(h&&h.isLane&&n.constraints&so.AllowMovingOutsideLane){const t=this.diagram.getObject(h.parentId),i=this.diagram.getObject(t.id+t.shape.lanes[0].id+"0"),r=i.wrapper.bounds.x,s=i.wrapper.bounds.y;new Ds(r,s,t.wrapper.bounds.bottomRight.x-r,t.wrapper.bounds.bottomRight.y-s).containsPoint(this.currentPosition)&&(n.offsetX=e.offsetX,n.offsetY=e.offsetY,n.width=e.width,n.height=e.height,n.rotateAngle=e.rotateAngle)}else n.offsetX=e.offsetX,n.offsetY=e.offsetY,n&&n.shape&&"UmlClassifier"!==n.shape.type&&("Bpmn"!==n.shape.type||"Bpmn"===n.shape.type&&"TextAnnotation"!==n.shape.shape)&&(n.width=e.width,n.height=e.height),n.rotateAngle=e.rotateAngle;if(h&&h.container&&"Stack"===h.container.type&&(this.diagram.startGroupAction(),s=!0),!l&&h&&h.container&&"Stack"===h.container.type&&"Drag"===this.action){const e=h.wrapper.children.indexOf(n.wrapper);if(a={targetIndex:void 0,target:void 0,sourceIndex:e,source:dp(n)},e>-1){const i=h.children;i.splice(i.indexOf(n.id),1),this.diagram.nameTable[n.id].parentId="",t=!0,h.wrapper.children.splice(e,1)}}if(function(e,t,i,n){const r=e,s=i.nameTable[r.parentId],o=i.nameTable[r.parentId];if(t&&o&&o.container&&"Stack"===o.container.type&&t.container&&"Stack"===t.container.type&&o.id!==t.parentId){const e=o.wrapper.children.indexOf(r.wrapper);e>-1&&(i.nameTable[r.id].parentId=t.id,o.wrapper.children.splice(e,1))}if(t&&t.parentId&&r.parentId&&"Drag"===n&&o.container&&"Stack"===o.container.type){const n=s.wrapper.children.indexOf(t.wrapper),o=s.wrapper.children.indexOf(r.wrapper),a={targetIndex:n,target:t,sourceIndex:o,source:e};s.wrapper.children.splice(o,1),s.wrapper.children.splice(n,0,r.wrapper),i.commandHandler.addHistoryEntry({type:"StackChildPositionChanged",redoObject:{targetIndex:o,target:t,sourceIndex:n,source:e},undoObject:a,category:"Internal"})}}(n,l,this.diagram,this.action),h=ah(this.diagram,n)?this.diagram.nameTable[n.parentId]:this.diagram.nameTable[n.parentId]||n,h&&h.container&&"Canvas"===h.container.type&&(h.wrapper.maxWidth=h.maxWidth=h.wrapper.actualSize.width,h.wrapper.maxHeight=h.maxHeight=h.wrapper.actualSize.height,r=!0),ah(this.diagram,n,!0)&&h&&"Canvas"===h.container.type?lh(this.diagram,n):o=this.updateContainerPropertiesExtend(h,n,i,e,o),this.diagram.lineRoutingModule&&this.diagram.constraints&lo.LineRouting&&!ah(this.diagram,n,!0)&&(n.children&&(this.diagram.realActions|=fo.EnableGroupAction),this.diagram.nodePropertyChange(n,{},{width:n.width,height:n.height,offsetX:n.offsetX,offsetY:n.offsetY}),n.children&&(this.diagram.realActions&=~fo.EnableGroupAction)),n.shape.lanes&&this.updateLaneChildNode(n),r&&(h.maxWidth=h.wrapper.maxWidth=void 0,h.maxHeight=h.wrapper.maxHeight=void 0),t){this.diagram.nodePropertyChange(h,{},{offsetX:h.offsetX,offsetY:h.offsetY,width:h.width,height:h.height,rotateAngle:h.rotateAngle});const e={redoObject:{sourceIndex:void 0,source:a.source},type:"StackChildPositionChanged",undoObject:a,category:"Internal"};this.diagram.diagramActions&go.UndoRedo||this.diagram.addHistoryEntry(e)}n&&n.container&&("Stack"===n.container.type||"Canvas"===n.container.type&&""===n.parentId)&&(n&&n.shape&&"UmlClassifier"===n.shape.type&&(n.wrapper.measureChildren=!0),this.diagram.nodePropertyChange(n,{},{offsetX:n.offsetX,offsetY:n.offsetY,width:n.width,height:n.height,rotateAngle:n.rotateAngle}),n&&n.shape&&"UmlClassifier"===n.shape.type&&(n.wrapper.measureChildren=!1))}Oh(i,this.diagram),o.hasStack=s}}return n&&(n.isPhase||n.isLane||n.shape&&"SwimLane"===n.shape.type)&&this.diagram.updateDiagramElementQuad(),o}updateLaneChildNode(e){for(let t=0;t<e.shape.lanes.length;t++)if(e.shape.lanes[t].children&&e.shape.lanes[t].children.length>0)for(let i=0;i<e.shape.lanes[t].children.length;i++){const n=this.diagram.nameTable[e.shape.lanes[t].children[i].id];n.offsetX=n.wrapper.offsetX,n.offsetY=n.wrapper.offsetY}}updateContainerPropertiesExtend(e,t,i,n,r){if("ResizeEast"===this.currentAction||"ResizeSouth"===this.currentAction||"SwimLane"===t.shape.type){const s=dp(t);let o=!1;if(e&&e.container&&"Grid"===e.container.type){const s="SwimLane"===e.shape.type,a=s?e.wrapper.children[0]:e.wrapper,l=s?e.shape.padding:void 0,h=e.wrapper.bounds.x,c=e.wrapper.bounds.y;if(void 0!==t.columnIndex&&"Horizontal"===e.container.orientation&&(s&&t.isPhase||!s&&1===t.rowIndex)||"Vertical"===e.container.orientation&&(!s&&t.rowIndex>0&&t.columnIndex>0||s&&t.isLane)){if("Horizontal"===e.container.orientation&&t.isPhase&&t.wrapper.width>t.maxWidth&&(t.maxWidth=t.wrapper.width,t.wrapper.maxWidth=t.wrapper.width),Th(this.diagram,t,e,n),a.updateColumnWidth(t.columnIndex,n.width,!0,l),t.isPhase){const i=this.diagram.nameTable[e.shape.phases[t.columnIndex].header.id];i.maxWidth<n.width&&(i.maxWidth=n.width,i.wrapper.maxWidth=n.width)}"SwimLane"===e.shape.type&&(e.width=e.width?a.width:e.width,Dh(this.diagram,e),e.wrapper.width=e.width,i=vh(this.diagram,a))}else void 0!==t.rowIndex&&(o=!0,Th(this.diagram,t,e,n),a.updateRowHeight(t.rowIndex,n.height,!0,l),"SwimLane"===e.shape.type&&(e.height=e.height?a.height:e.height,e.wrapper.height=e.height,i=vh(this.diagram,a)));"SwimLane"===e.shape.type&&(r.isPreventHistory=!0),this.diagram.nodePropertyChange(e,{},{offsetX:e.offsetX,offsetY:e.offsetY,rotateAngle:e.rotateAngle}),this.diagram.drag(e,h-e.wrapper.bounds.x,c-e.wrapper.bounds.y)}else t&&t.shape&&"UmlClassifier"===t.shape.type&&(t.wrapper.measureChildren=!0),this.diagram.nodePropertyChange(t,{},{offsetX:t.offsetX,offsetY:t.offsetY,width:t.width,height:t.height,rotateAngle:t.rotateAngle}),t.wrapper.measureChildren=!1;if(t.wrapper.measure(new bs(t.wrapper.width,t.wrapper.height)),t.wrapper.arrange(t.wrapper.desiredSize),"ResizeEast"===this.currentAction||"ResizeSouth"===this.currentAction){const e=dp(t);this.diagram.addHistoryEntry({category:"Internal",type:o?"RowHeightChanged":"ColumnWidthChanged",undoObject:s,redoObject:e})}}return Oh(i,this.diagram),r}addUmlNode(){const e=this.diagram.selectedItems.nodes[0];let t=this.diagram.findObjectsUnderMouse({x:this.currentPosition.x+20,y:this.currentPosition.y}),i=this.diagram.findObjectUnderMouse(t,this.action,this.inAction);if(i||(t=this.diagram.findObjectsUnderMouse({x:this.currentPosition.x-20,y:this.currentPosition.y}),i=this.diagram.findObjectUnderMouse(t,this.action,this.inAction)),e&&e.container&&"Stack"===e.container.type&&i&&i.parentId&&i.parentId===e.id){const t=i,n=Bd(this.diagram.element.id);if(n.getElementById(n.id+"_stack_highlighter")){const n=e.wrapper.children.indexOf(i.wrapper)+1;this.diagram.enableServerDataBinding(!1);const r=new Td(this.diagram,"nodes",{style:{fill:e.style.fill,strokeColor:"black"===e.style.strokeColor?"#ffffff00":e.style.strokeColor},annotations:i.annotations,verticalAlignment:"Stretch",horizontalAlignment:"Stretch",constraints:(so.Default|so.HideThumbs)&~(so.Rotate|so.Drag|so.Resize),minHeight:25},!0);r.annotations[0].content=" + Name : Type",t.id.split("_"),r.id=op()+r.id,r.parentId=e.id,r.zIndex=-1,r.umlIndex=n,this.diagram.startGroupAction(),e.wrapper.children.indexOf(r.wrapper),this.diagram.enableServerDataBinding(!0),this.diagram.add(r),this.diagram.updateConnectorEdges(e),this.diagram.clearSelection(),this.diagram.select([this.diagram.nameTable[r.id]]),this.diagram.endGroupAction(),this.diagram.startTextEdit()}}}}class wu{findObjectsUnderMouse(e,t,i,n,r){let s,o,a,l,h=[];n&&n instanceof Ld&&n.nodes.length+n.connectors.length===1&&(n=n.nodes[0]||n.connectors[0]).children&&0===n.children.length&&(i.actualObject=n);const c=n&&n instanceof ol&&(n.constraints&no.ConnectToNearByNode||n.constraints&no.ConnectToNearByPort)&&n.connectionPadding||0,d=t.spatialSearch.findObjects(new Ds(e.x-50-c,e.y-50-c,100+c,100+c)),p={};let u;for(const g of d){let i=e;o=g.wrapper.outerBounds;let r=!g.rotateAngle&&o.containsPoint(i,c);if((g!==n||t.currentDrawingObject instanceof ol)&&g instanceof ol?g!==t.currentDrawingObject:g.wrapper.visible){const h=t.commandHandler.getObjectLayer(g.id);if(h&&!h.lock&&h.visible){if(u=p[h.zIndex]=p[h.zIndex]||[],g.rotateAngle)for(a of(s=g.wrapper,o=hp(s),s.children))l=zs(),ks(l,-(a.rotateAngle+a.parentTransform),a.offsetX,a.offsetY),i=Ms(l,e),hp(a).containsPoint(i,c)&&(r=!0);if((!n||!1===$p(t,g))&&yl(g)&&(g instanceof ol?tc(g,e):r)){const t=g instanceof ol&&g.hitPadding||0;this.findElementUnderMouse(g,e,c||t)&&"helper"!==g.id&&Ic(g,"zIndex",u)}}}}for(const g of t.layers){h=h.concat(p[g.zIndex]||[]);for(const e of h){const i="eventHandler";if("Bpmn"===e.shape.type&&e.processId&&(!(t[i].tool instanceof ru)||t[i].tool instanceof ru&&Il(e))){const i=h.indexOf(t.nameTable[e.processId]);i>-1&&h.splice(i,1)}if("UmlClassifier"===e.shape.type&&e.container&&"Stack"===e.container.type){const i=h.indexOf(t.nameTable[t.nameTable[e.id].wrapper.children[0].id]);i>-1&&h.splice(i,1)}}}for(let g=0;g<h.length;g++){let i=t.nameTable[h[g].parentId];if(i){const t=this.findElementUnderMouse(i,e);for(let e=0;e<i.ports.length;e++)if(t.id.match("_"+i.ports[e].id+"$")){const t=i.ports[e];if(Wl(t)||Bl(t))return h}}for(;i;){const e=h.indexOf(i);if(-1===e)break;h.splice(e,1),i=t.nameTable[i.parentId]}}if(this.checkSwimlane(h,t),i&&!i.source)for(let g=0;g<h.length;g++){const e=t.nameTable[h[g].parentId];if(e&&"SwimLane"===e.shape.type)for(let t=0;t<h.length;t++)h[t]instanceof ol&&h.splice(g,1)}return h}checkSwimlane(e,t){let i;for(let n=0;n<e.length;n++){let r,s,o=e[n];o instanceof Td&&(r=e[n].parentId,s=o),""===r&&(i="SwimLane"!==s.shape.type);let a=t.nameTable[r];if(a&&a.isLane&&t.nameTable[a.parentId].zIndex>o.zIndex&&(e[n]=a),n>0&&i&&s&&(s.isLane||s.isPhase||s.isHeader)&&e[n].zIndex<e[n-1].zIndex){let t=e[n];e[n]=e[n-1],e[n-1]=t}}if(e.length>=2){let i="";for(let n=e.length-1;n>=0;n--)if(e[n].parentId){let r=Fc(e[n],t,i),s=Fc(e[n-1],t,i),o=t.nameTable[r],a=t.nameTable[s];a&&r!==s&&o.zIndex<a.zIndex&&e.splice(n,1)}}}isTarget(e,t,i){const n=t.selectedItems.connectors[0];let r;if(r="ConnectorSourceEnd"===i?t.nameTable[n.targetID]:r=t.nameTable[n.sourceID],!r||(r.processId||e.processId)&&r.processId===e.processId||(r.processId!==e.processId&&(e=null),e&&e.parentId&&"UmlClassifier"===t.nameTable[e.parentId].shape.type&&(e=t.nameTable[e.parentId])),"ConnectorSourceEnd"===i&&n.targetID){const i=t.nameTable[n.targetID];if(i&&i.shape&&"TextAnnotation"===i.shape.shape){const r=n.id.split("_");("Bpmn"===i.shape.type&&"Bpmn"!==e.shape.type||r[0]===e.id||"TextAnnotation"===e.shape.shape)&&(e=null),e.parentId&&"UmlClassifier"===t.nameTable[e.parentId].shape.type&&(e=t.nameTable[e.parentId])}}return e}findObjectUnderMouse(e,t,i,n,r,s,o){let a,l,h=null;if(0!==t.length)if(o&&o instanceof Ld&&o.nodes.length+o.connectors.length===1&&(o=o.nodes[0]||o.connectors[0]),"ConnectorSourceEnd"===i&&o||"PortDraw"===i||(kl(e)||Ml(e))&&Lc(e.drawingObject)===ol){const n=e.selectedItems.connectors[0];for(let o=t.length-1;o>=0;o--){l=Oc(t[o],!1),a=Oc(t[o],!0);const c=e.eventHandler.tool,d=this.findTargetElement(t[o].wrapper,s,void 0);if("Draw"===i&&d&&t[o]instanceof Td&&!Nc(t[o],d)&&(c&&"ConnectorSourceEnd"===c.endPoint&&!Tl(t[o])||c&&"ConnectorTargetEnd"===c.endPoint&&!Pl(t[o])))return h;if(t[o]instanceof Td&&(Tl(t[o])||El(l)||Pl(t[o])||Ol(a)||"PortDraw"===i&&c instanceof nu&&"ConnectorTargetEnd"===c.endPoint&&(Pl(t[o])||Ol(a))))return h=t[o],n&&(h=this.isTarget(h,e,i)),r.actualObject=h,h}}else if("ConnectorTargetEnd"===i&&o){for(let c=t.length-1;c>=0;c--)if(a=Oc(t[c],!0),t[c]instanceof Td&&(Pl(t[c])||Ol(a)))return h=t[c],h=this.isTarget(h,e,i),r.actualObject=h,h}else{if(o&&("Drag"===i||e.eventHandler.tool instanceof ru)){let i=0;for(let e=0;e<t.length;e++){const n=t[e];o!==n&&(n instanceof ol||!s||n.wrapper.bounds.containsPoint(s))&&Il(n)&&(h?(h=i>=n.zIndex?h:n,i=Math.max(i,n.zIndex)):(h=n,i=h.zIndex))}return h&&"Bpmn"===h.shape.type&&(h=e.selectedItems.nodes.length>0&&"Bpmn"===e.selectedItems.nodes[0].shape.type?h:null),h&&(r.actualObject=h),h}if("Select"!==i&&"Pan"!==i||!e.eventHandler.tool)if("Pan"===i||"LayoutAnimation"===i){for(let e=t.length-1;e>=0;e--)if(t[e]instanceof Td||t[e]instanceof ol){const n=this.findTargetElement(t[e].wrapper,s,void 0);if("Pan"===i||n&&(n.id.match("_icon_content_shape$")||n.id.match("_icon_content_rect$")))return t[e]}}else h=t[t.length-1],r&&h&&(r.actualObject=h);else{for(let e=t.length-1;e>=0;e--)if(t[e]instanceof ol){const i=t[e-1];if(t[e-1]instanceof Td&&i.ports){const e=this.findTargetElement(i.wrapper,s,void 0);if(e&&(e.id.match("_icon_content_shape$")||e.id.match("_icon_content_rect$")))return i;for(let t=0;t<i.ports.length;t++)if(e&&e.id.match("_"+i.ports[t].id+"$")&&Bl(i.ports[t]))return i}}if(h=t[t.length-1],r.actualObject=h,!e.eventHandler.itemClick(h,!0)&&h.parentId){let t=h;const i=$p(e,t);for(;t&&(!$p(e,t)||i);)h=t,t=e.nameTable[t.parentId]}}}return h}findElementUnderSelectedItem(e,t,i){return e instanceof Ld?1!==e.nodes.length||e.connectors&&e.connectors.length?e.nodes&&!e.nodes.length||1!==e.connectors.length?null:this.findElementUnderMouse(e.connectors[0],t):this.findElementUnderMouse(e.nodes[0],t):this.findElementUnderMouse(e,t,i)}findElementUnderMouse(e,t,i){return this.findTargetElement(e.wrapper,t,i)}findTargetElement(e,t,i){for(let n=e.children.length-1;n>=0;n--){const r=e.children[n];if(r&&r.outerBounds.containsPoint(t,i||0)){if(r instanceof So){const e=this.findTargetElement(r,t);if(e)return e}if(r.bounds.containsPoint(t,i||0))return r}}return e.bounds.containsPoint(t,i)&&"none"!==e.style.fill?e:null}}var xu=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Su=(()=>{class e extends Ht{constructor(e,t,i,n){super(e,t,i,n),this.objectZIndex=-1,this.zIndexTable={},this.objects=[]}}return xu([xt("")],e.prototype,"id",void 0),xu([xt(!0)],e.prototype,"visible",void 0),xu([xt(!1)],e.prototype,"lock",void 0),xu([xt()],e.prototype,"objects",void 0),xu([xt()],e.prototype,"addInfo",void 0),xu([xt(-1)],e.prototype,"zIndex",void 0),e})();var Cu=function(e,t,i,n){return new(i||(i=Promise))(function(r,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(o,a)}l((n=n.apply(e,t||[])).next())})};class Pu{constructor(e){this.clipboardData={},this.diagramObject={},this.newSelectedObjects={},this.oldSelectedObjects={},this.connectorsTable=[],this.processTable={},this.deepDiffer=new Jp,this.isContainer=!1,this.childTable={},this.parentTable={},this.blazor="Blazor",this.blazorInterop="sfBlazor",this.cloneGroupChildCollection=[],this.diagram=e}get snappingModule(){return this.diagram.snappingModule}get layoutAnimateModule(){return this.diagram.layoutAnimateModule}startTransaction(e){this.state={element:this.diagram.selectedItems,backup:null},e&&this.diagram.protectPropertyChange(!0),Ud(this.diagram.element.id).style.pointerEvents="none"}endTransaction(e){this.state=null,e&&this.diagram.protectPropertyChange(!1),Ud(this.diagram.element.id).style.pointerEvents="all"}setFocus(){document.getElementById(this.diagram.element.id).focus()}showTooltip(e,t,i,n,r){let s,o,a=!1;if(e instanceof Ld?1==e.nodes.length&&0==e.connectors.length?(s=e.nodes[0].id,e.nodes[0].shape&&e.nodes[0].shape instanceof td&&(a=!0)):0==e.nodes.length&&1==e.connectors.length?s=e.connectors[0].id:o=document.getElementById(this.diagram.element.id+"_SelectorElement"):e instanceof Td?(s=e.id,e.shape&&e.shape instanceof td&&(a=!0)):s=e.id,d(o)&&!d(s)&&(o=document.getElementById(s+(a?"_content_native_element":"_groupElement"))),r&&(this.diagram.tooltipObject.position="BottomCenter",this.diagram.tooltipObject.animation={open:{delay:0,duration:0}},this.diagram.tooltipObject.openDelay=0,this.diagram.tooltipObject.closeDelay=0),this.diagram.selectedItems.setTooltipTemplate){let t;const n=Cp(this.diagram.selectedItems.setTooltipTemplate);n&&(t=n(e,this.diagram)),i=t instanceof HTMLElement?t.cloneNode(!0):t||i}e.tooltip&&(this.diagram.tooltipObject.openOn=e.tooltip.openOn),this.diagram.tooltipObject.content=i,this.diagram.tooltipObject.offsetX=0,this.diagram.tooltipObject.offsetY=0,this.diagram.tooltipObject.refresh(o),r&&setTimeout(()=>{this.diagram.tooltipObject.open(o)},1)}closeTooltip(){this.diagram.tooltipObject.close()}canEnableDefaultTooltip(){return!!(this.diagram.selectedItems.constraints&io.ToolTip)}updateSelector(){this.diagram.updateSelector()}updateConnectorValue(e){if(e.cancel){this.enableCloneObject(!0),this.ismouseEvents(!0),this.insertBlazorObject(e.connector);const t={},i={},n=this.diagram.nameTable[e.connector.id],r="ConnectorSourceEnd"===e.connectorEnd?"sourceID":"targetID",s="ConnectorSourceEnd"===e.connectorEnd?"sourcePortID":"targetPortID",o="ConnectorTargetEnd"===e.connectorEnd,a=o?e.newValue.connectorTargetValue:e.newValue.connectorSourceValue,l=o?e.oldValue.connectorTargetValue:e.oldValue.connectorSourceValue;i[r]=a.nodeId,i[s]=a.portId,t[r]=l.nodeId,t[s]=l.portId,e.cancel&&"ConnectorTargetEnd"!==e.connectorEnd&&(n.sourceID=l.nodeId,e.connector.sourcePortID&&(n.sourcePortID=l.portId),this.diagram.connectorPropertyChange(n,i,t)),e.cancel&&"ConnectorTargetEnd"===e.connectorEnd&&(e.connector.targetPortID&&(n.targetPortID=l.portId),n.targetID=l.nodeId,this.diagram.connectorPropertyChange(n,i,t))}}triggerEvent(e,t){return Cu(this,void 0,void 0,function*(){if(e===vo.drop||e===vo.positionChange||e===vo.connectionChange){if(this.diagram.currentSymbol)return;if(e===vo.drop&&(t.source=this.diagram),this.diagram.currentDrawingObject&&e!==vo.positionChange)return}return yield this.diagram.triggerEvent(e,t)})}dragOverElement(e,t){this.diagram.currentSymbol&&this.triggerEvent(vo.dragOver,{element:e.source,target:e.target,mousePosition:t,diagram:this.diagram})}disConnect(e,t,i){let n,r,s,o={},a={};if(e instanceof Ld?(r=e,s=r.connectors[0]):e instanceof ol&&this.diagram.currentDrawingObject&&(s=this.diagram.currentDrawingObject),e&&s&&(Zp(this.diagram)||this.diagram.currentDrawingObject))if(!t||"ConnectorSourceEnd"!==t&&"ConnectorTargetEnd"!==t){if("OrthoThumb"!==t&&"SegmentEnd"!==t&&(s.sourceID||s.targetID)){o={sourceID:s.sourceID,sourcePortID:s.sourcePortID,targetID:s.targetID,targetPortID:s.targetPortID},s.sourceID="",s.sourcePortID="",s.targetID="",s.targetPortID="",a={sourceID:s.sourceID,sourcePortID:s.sourcePortID,targetID:s.targetID,targetPortID:s.targetPortID};let e={connector:s,oldValue:o,newValue:a,cancel:!1,state:"Changing",connectorEnd:t};this.triggerEvent(vo.connectionChange,e),e.cancel?(s.sourceID=o.sourceID,s.sourcePortID=o.sourcePortID,s.targetID=o.targetID,s.targetPortID=o.targetPortID):(this.diagram.connectorPropertyChange(s,o,a),this.diagram.updateDiagramObject(s),e={connector:s,oldValue:o,newValue:a,cancel:!1,state:"Changed",connectorEnd:t},this.triggerEvent(vo.connectionChange,e))}}else{const e="ConnectorSourceEnd"===t?"sourceID":"targetID",r="ConnectorSourceEnd"===t?"sourcePortID":"targetPortID";s[e]&&(o[e]=s[e],s[e]="",a[e]=s[e],(s.sourcePortID||s.targetPortID)&&(o[r]=s[r],s[r]="",a[r]=s[r]),n=this.connectionEventChange(s,o,a,t,i))}return n}connectionEventChange(e,t,i,n,r){const s="ConnectorSourceEnd"===n?"sourceID":"targetID",o="ConnectorSourceEnd"===n?"sourcePortID":"targetPortID";let a;if(this.enableCloneObject){a=this.diagram.nameTable[i[s]];const e=dp(a);this.diagram.insertValue(e,!0)}let l={cancel:!1,state:"Changing",connectorEnd:n,connector:e,oldValue:{nodeId:t[s],portId:t[o]},newValue:{nodeId:i[s],portId:i[o]}};if(this.triggerEvent(vo.connectionChange,l),l.cancel?(e[s]=t[s],e[o]=t[o],i=t):(this.diagram.connectorPropertyChange(e,t,i),this.diagram.updateDiagramObject(e),l={connector:e,oldValue:{nodeId:t[s],portId:t[o]},newValue:{nodeId:i[s],portId:i[o]},cancel:!1,state:"Changing",connectorEnd:n}),this.enableCloneObject&&void 0===a){a=this.diagram.nameTable[t[s]];const e=dp(a);this.diagram.insertValue(e,!0)}}insertBlazorObject(e,t){let i,n;if(e instanceof Ld){this.oldSelectedObjects=jc(this.diagram);for(let t=0;t<e.nodes.length;t++)i=this.diagram.getObject(e.nodes[t].id),this.diagram.insertValue(dp(i),!0);for(let t=0;t<e.connectors.length;t++)n=this.diagram.getObject(e.connectors[t].id),this.diagram.insertValue(dp(n),!1)}else e=this.diagram.getObject(e.id),this.diagram.insertValue(dp(e),e instanceof Td)}updatePropertiesToBlazor(e,t){this.enableCloneObject(!1),this.ismouseEvents(!1),this.getBlazorOldValues(e,t),this.updateBlazorSelector()}insertSelectedObjects(){this.oldSelectedObjects=jc(this.diagram)}findTarget(e,t,i,n){if(t instanceof Td){if(e&&e.id===t.id+"_content")return t;if(i&&"Bpmn"===t.shape.type&&"Activity"===t.shape.shape&&"Transaction"===t.shape.activity.subProcess.type){const i=t.shape.activity.subProcess.transaction;if(i.success.visible&&0===e.id.indexOf(t.id+"_success"))return i.success;if(i.cancel.visible&&0===e.id.indexOf(t.id+"_cancel"))return i.cancel;if(i.failure.visible&&0===e.id.indexOf(t.id+"_failure"))return i.failure}if(e instanceof Eo)for(let i=0;i<t.ports.length;i++){const n=t.ports[i];if(e.id===t.id+"_"+n.id)return n}}if(!n){let i;for(let n=0;n<t.annotations.length;n++)if(i=t.annotations[n],e.id===t.id+"_"+i.id)return i}return t}canDisconnect(e,t,i,n){let r,s;return t.source instanceof Ld?(r=t.source,s=r.connectors[0]):t.source instanceof ol&&this.diagram.currentDrawingObject&&(s=this.diagram.currentDrawingObject),this.findTarget(t.targetWrapper,t.target,"ConnectorSourceEnd"===e,!0),s["ConnectorSourceEnd"===e?"sourceID":"targetID"]!==n||s["ConnectorSourceEnd"===e?"sourcePortID":"targetPortID"]!==i}changeAnnotationDrag(e){let t,i;if(e.source&&e.source.connectors&&e.source.connectors.length&&this.diagram.bpmnModule&&this.diagram.bpmnModule.textAnnotationConnectors.indexOf(e.source.connectors[0])>-1){e.source instanceof Ld&&(t=e.source,i=t.connectors[0]);const n=i.id.split("_"),r=n[n.length-3]||n[0];if(e.target&&e.target.id!==r&&"TextAnnotation"!==e.target.shape.shape){this.diagram.startGroupAction();const t=this.getAnnotation(this.diagram.nameTable[n[0]],n[1]),r={id:n[1]+op(),angle:ws.findAngle(i.intermediatePoints[0],i.intermediatePoints[1]),text:t.text,length:ws.distancePoints(i.intermediatePoints[0],i.intermediatePoints[1]),shape:{shape:"TextAnnotation",type:"Bpmn"},nodeId:t.nodeId},s=new md(e.target.shape,"annotations",r,!0);this.diagram.bpmnModule.checkAndRemoveAnnotations(this.diagram.nameTable[i.targetID],this.diagram),this.diagram.refreshCanvasLayers(),s.id=n[1],this.diagram.addTextAnnotation(s,e.target),this.diagram.endGroupAction()}else i&&(i.sourceID=r,this.diagram.connectorPropertyChange(i,{},{sourceID:r}),this.diagram.updateDiagramObject(i))}}connect(e,t,i){const n={},r={};let s,o,a,l,h;t.source instanceof Ld?(a=t.source,l=a.connectors[0]):t.source instanceof ol&&this.diagram.currentDrawingObject&&(l=this.diagram.currentDrawingObject);const c=this.findTarget(t.targetWrapper||t.sourceWrapper,t.target||t.actualObject,"ConnectorSourceEnd"===e,!0),d="ConnectorSourceEnd"===e?"sourceID":"targetID",p="ConnectorSourceEnd"===e?"sourcePortID":"targetPortID";if(c instanceof Td)r[d]=l[d],l[d]=c.id,n[d]=l[d],r[p]=l[p],h=this.connectionEventChange(l,r,n,e,i);else{s=l[d],o=l[p],l[p]=c.id,l[d]=t.target&&t.target.id||t.actualObject.id,n[d]=l[d],n[p]=l[p];let i={connector:l,oldValue:{nodeId:s,portId:o},newValue:{nodeId:n[d],portId:n[p]},cancel:!1,state:"Changing",connectorEnd:e};this.triggerEvent(vo.connectionChange,i),i.cancel?(l[d]=s,l[p]=o,n[d]=s,n[p]=o):(this.diagram.connectorPropertyChange(l,r,n),this.diagram.updateDiagramObject(l),i={connector:l,oldValue:{nodeId:s,portId:o},newValue:{nodeId:n[d],portId:n[p]},cancel:!1,state:"Changing",connectorEnd:e})}return this.renderHighlighter(t,void 0,"ConnectorSourceEnd"===e),h}cut(){this.clipboardData.pasteIndex=0,this.diagram.undoRedoModule&&this.diagram.historyManager.startGroupAction(),this.clipboardData.clipObject=this.copyObjects(),this.diagram.undoRedoModule&&this.diagram.historyManager.endGroupAction(),"SVG"!==this.diagram.mode&&this.diagram.refreshDiagramLayer()}UpdateBlazorDiagramModelLayers(e,t){if(window&&window.Blazor){const i={methodName:"UpdateBlazorDiagramModelLayers",diagramobj:JSON.stringify(e),isRemove:t};this.diagram.isLoading||window.sfBlazor.updateBlazorProperties(i,this.diagram)}}addLayer(e,t,i=!0){e.id=e.id||op(),e.zIndex=this.diagram.layers.length;let n=this.diagram.allowServerDataBinding;if(this.diagram.enableServerDataBinding(!1),e=new Su(this.diagram,"layers",e,!0),this.diagram.enableServerDataBinding(n),e.objectZIndex=-1,e.zIndexTable={},this.diagram.layers.push(e),i&&this.UpdateBlazorDiagramModelLayers(e,!1),this.diagram.layerZIndexTable[e.zIndex]=e.id,this.diagram.activeLayer=e,t)for(let r=0;r<t.length;r++)this.diagram.add(t[r])}getObjectLayer(e){const t=this.diagram.layers;for(let i=0;i<t.length;i++)if(t[i].objects.indexOf(e)>-1)return t[i];return this.diagram.activeLayer}getLayer(e){const t=this.diagram.layers;for(let i=0;i<t.length;i++)if(t[i].id===e)return t[i]}removeLayer(e,t=!0){const i=this.getLayer(e);if(i){const n=this.diagram.layers.indexOf(i),r=i.objects;for(let t=r.length-1;t>=0;t--)this.diagram.unSelect(this.diagram.nameTable[r[t]]),this.diagram.remove(this.diagram.nameTable[r[t]]),"default_layer"!==i.id&&this.diagram.activeLayer.id===e&&(this.diagram.activeLayer=this.diagram.layers[this.diagram.layers.length-1]);t&&this.UpdateBlazorDiagramModelLayers(this.diagram.layers[n],!0),delete this.diagram.layerZIndexTable[i.zIndex],this.diagram.layers.splice(n,1),"SVG"!==this.diagram.mode&&this.diagram.refreshDiagramLayer()}}moveObjects(e,t){const i=this.getLayer(t)||this.diagram.activeLayer;let n;this.diagram.setActiveLayer(i.id);for(const r of e)this.getObjectLayer(r).objects.indexOf(r)>-1&&(n=this.diagram.nameTable[r],this.diagram.unSelect(n),this.diagram.remove(this.diagram.nameTable[r]),this.diagram.add(n))}cloneLayer(e){const t=this.getLayer(e);if(t){const i=[],n={id:e+"_"+op(),objects:[],visible:!0,lock:!1};this.addLayer(n,null,!0),n.zIndex=this.diagram.layers.length-1;for(const e of t.objects)i.push(this.diagram.nameTable[e]);this.paste(i)}}copy(){return this.clipboardData.pasteIndex=1,this.clipboardData.clipObject=this.copyObjects(),this.clipboardData.clipObject}copyObjects(){let e=[];const t=[];if(this.clipboardData.childTable={},this.diagram.selectedItems.connectors.length>0){e=this.diagram.selectedItems.connectors;for(let i=0;i<e.length;i++){let n;n=this.diagram.bpmnModule&&this.diagram.bpmnModule.textAnnotationConnectors.indexOf(e[i])>-1?dp(this.diagram.nameTable[e[i].targetID]):dp(e[i]),t.push(n)}}if(this.diagram.selectedItems.nodes.length>0){e=e.concat(this.diagram.selectedItems.nodes);for(let i=0;i<this.diagram.selectedItems.nodes.length;i++)if(!e[i].isPhase){const e=dp(this.diagram.selectedItems.nodes[i]);e.wrapper&&e.offsetX!==e.wrapper.offsetX&&(e.offsetX=e.wrapper.offsetX),e.wrapper&&e.offsetY!==e.wrapper.offsetY&&(e.offsetY=e.wrapper.offsetY),this.copyProcesses(e),t.push(dp(e));const n=zs();if(ks(n,-e.rotateAngle,e.offsetX,e.offsetY),e.children){const t=this.clipboardData.childTable;let i;const r=this.getAllDescendants(e,[],!0);for(let s=0;s<r.length;s++){i=this.diagram.nameTable[r[s].id];const o=t[i.id]=dp(i),a=Ms(n,{x:o.wrapper.offsetX,y:o.wrapper.offsetY});i instanceof Td&&(o.offsetX=a.x,o.offsetY=a.y,o.rotateAngle-=e.rotateAngle)}this.clipboardData.childTable=t}if("SwimLane"===e.shape.type){const e=this.diagram.getObject(this.diagram.selectedItems.nodes[i].id),t=this.clipboardData.childTable,n=vh(this.diagram,e.wrapper.children[0]);for(let i=0;i<n.length;i++){const e=this.diagram.getObject(n[i]);t[e.id]=dp(e)}}if(e&&e.isLane){const t=this.clipboardData.childTable,i=this.diagram.getObject(e.parentId),n=Vh(e,this.diagram);t[e.id]=dp(n),t[e.id].width=i.wrapper.actualSize.width}}}if(0===this.clipboardData.pasteIndex){this.startGroupAction();for(const t of e)this.diagram.nameTable[t.id]&&(this.diagram.bpmnModule&&this.diagram.bpmnModule.textAnnotationConnectors.indexOf(t)>-1?this.diagram.remove(this.diagram.nameTable[t.targetID]):this.diagram.remove(t));this.endGroupAction()}return this.sortByZIndex(t,"zIndex"),t}copyProcesses(e){if("Bpmn"===e.shape.type&&e.shape.activity&&e.shape.activity.subProcess.processes&&e.shape.activity.subProcess.processes.length>0){const t=e.shape.activity.subProcess.processes;for(const e of t)this.processTable[e]=dp(this.diagram.nameTable[e]),this.processTable[e].shape.activity.subProcess.processes&&this.processTable[e].shape.activity.subProcess.processes.length>0&&this.copyProcesses(this.processTable[e]);this.clipboardData.processTable=this.processTable}}group(){this.oldSelectedObjects=jc(this.diagram);const e=this.diagram.isProtectedOnChange;this.diagram.protectPropertyChange(!0),this.diagram.diagramActions=this.diagram.diagramActions|go.Group;let t=[],i={};i.id="group"+op(),i=new Td(this.diagram,"nodes",i,!0),i.children=[],t=this.diagram.selectedItems.nodes,t=t.concat(this.diagram.selectedItems.connectors);for(let r=0;r<t.length;r++)t[r].parentId||i.children.push(t[r].id);const n=this.diagram.add(i);n&&this.select(n),this.addHistoryEntry({type:"Group",undoObject:i,redoObject:i,category:"Internal"}),this.diagram.diagramActions=this.diagram.diagramActions&~go.Group,this.diagram.protectPropertyChange(e),this.updateBlazorSelector()}unGroup(e){const t=this.diagram.isProtectedOnChange;this.diagram.protectPropertyChange(!0),this.diagram.diagramActions=this.diagram.diagramActions|go.Group;let i=[];e?i.push(e):i=this.diagram.selectedItems.nodes,this.diagram.startGroupAction();for(let n=0;n<i.length;n++){const e=i[n],t=dp(e),r=[];for(let i=0;i<e.children.length;i++)r.push(e.children[i]);if(e.children){e.ports&&e.ports.length>0&&this.diagram.removePorts(e,e.ports),e.annotations&&e.annotations.length>0&&this.diagram.removeLabels(e,e.annotations);const i=this.diagram.nameTable[e.parentId];for(let t=e.children.length-1;t>=0;t--)this.diagram.nameTable[e.children[t]].parentId="",this.diagram.deleteChild(this.diagram.nameTable[e.children[t]],e),e.parentId&&e.children[t]&&this.diagram.addChild(i,e.children[t]);this.resetDependentConnectors(e.inEdges,!0),this.resetDependentConnectors(e.outEdges,!1);const n={type:"UnGroup",undoObject:t,redoObject:t,category:"Internal"};this.diagram.diagramActions&go.UndoRedo||this.addHistoryEntry(n),e.parentId&&this.diagram.deleteChild(e,i)}this.diagram.removeNode(e,r),this.clearSelection()}this.diagram.endGroupAction(),this.diagram.diagramActions=this.diagram.diagramActions&~go.Group,this.diagram.protectPropertyChange(t)}resetDependentConnectors(e,t){for(let i=0;i<e.length;i++){const n=this.diagram.nameTable[e[i]],r=dp(n);let s;t?(n.targetID="",n.targetPortID="",s={targetID:n.targetID,targetPortID:n.targetPortID}):(n.sourceID="",n.sourcePortID="",s={sourceID:n.sourceID,sourcePortID:n.sourcePortID}),this.diagram.connectorPropertyChange(n,{},s);const o={type:"ConnectionChanged",undoObject:{connectors:[r],nodes:[]},redoObject:{connectors:[dp(n)],nodes:[]},category:"Internal"};this.diagram.diagramActions&go.UndoRedo||this.addHistoryEntry(o)}}paste(e){if(e||this.clipboardData.clipObject){this.diagram.protectPropertyChange(!0);const t=e?this.getNewObject(e):this.clipboardData.clipObject;if(t){const e=1!==t.length;let i=!1;const n={},r={};0!==this.clipboardData.pasteIndex&&this.clearSelection(),this.diagram.undoRedoModule&&(i=!0,this.diagram.historyManager.startGroupAction());for(const o of t)n[o.id]=o;let s=[];e&&(this.diagram.isServerUpdate=!0);for(let o=0;o<t.length;o++){const i=t[o];if(Lc(i)===ol){const t=dp(i);let o=t.sourceID;t.sourceID="",n[o]&&r[o]&&(t.sourceID=r[o]),o=t.targetID,t.targetID="",n[o]&&r[o]&&(t.targetID=r[o]);const a=this.cloneConnector(t,e);s.push(a),r[i.id]=a.id}else{const t=this.cloneNode(i,e);if(s.push(t),t){r[i.id]=t.id;let e=i.inEdges;if(e)for(const t of e)if(n[t]&&r[t]){const e=this.diagram.nameTable[r[t]];e.targetID=r[i.id],this.diagram.connectorPropertyChange(e,{targetID:"",targetPortID:""},{targetID:e.targetID,targetPortID:e.targetPortID})}if(e=i.outEdges,e)for(const t of e)if(n[t]&&r[t]){const e=this.diagram.nameTable[r[t]];e.sourceID=r[i.id],this.diagram.connectorPropertyChange(e,{sourceID:"",sourcePortID:""},{sourceID:e.sourceID,sourcePortID:e.sourcePortID})}}}}e&&(this.diagram.isServerUpdate=!1,this.diagram.UpdateBlazorDiagramModelCollection(t[0],s),this.getBlazorOldValues(),this.diagram.select(s,!0)),!0===i&&(this.diagram.historyManager.endGroupAction(),i=!1),"SVG"!==this.diagram.mode&&this.diagram.refreshDiagramLayer(),this.clipboardData.pasteIndex++,this.diagram.protectPropertyChange(!1)}}}getNewObject(e){let t;const i=[];this.clipboardData.pasteIndex=1;for(let n=0;n<e.length;n++)t=dp(e[n]),i.push(t);return i}cloneConnector(e,t){const i=dp(e);this.translateObject(i),i.zIndex=-1;const n=this.diagram.add(i);return this.diagram.isServerUpdate||this.selectObjects([n],t),n}cloneNode(e,t,i,n){let r;const s={},o=dp(e);let a;const l=this.diagram.nameTable[e.parentId];if(e.shape&&"Bpmn"===e.shape.type&&e.shape.activity&&e.shape.activity.subProcess.processes&&e.shape.activity.subProcess.processes.length&&(a=o.shape.activity.subProcess.processes,o.zIndex=-1,o.shape.activity.subProcess.processes=void 0),e.shape&&"SwimLane"===e.shape.type)jh(e,this.diagram,this.clipboardData);else if(l&&"SwimLane"===l.shape.type)jh(dp(l),this.diagram,this.clipboardData,e,!0);else if(!e.children||!e.children.length||i&&i.length)if(e.shape&&"TextAnnotation"===e.shape.shape&&-1!==e.id.indexOf("_textannotation_")&&this.diagram.nameTable[e.id]){const t=e.id.split("_textannotation_"),i=this.diagram.nameTable[e.id];for(let e=0;e<i.inEdges.length;e++){const n=this.diagram.nameTable[i.inEdges[e]];if(n){const e=this.diagram.nameTable[n.sourceID],i=this.getAnnotation(e,t[1]),r={id:t[1]+op(),angle:i.angle,text:i.text,length:i.length,shape:{shape:"TextAnnotation",type:"Bpmn"},nodeId:i.nodeId};this.diagram.addTextAnnotation(r,e)}}}else this.translateObject(o,n),o.zIndex=-1,i&&(o.children=i),r=this.diagram.add(o);else r=this.cloneGroup(e,t);for(const h of Object.keys(s))this.diagram.add(s[h]);return a&&a.length&&(r.shape.activity.subProcess.processes=a,this.cloneSubProcesses(r)),r&&!this.diagram.isServerUpdate&&this.selectObjects([r],t),r}getAnnotation(e,t){const i=e.shape.annotations;if(i&&i.length)for(let n=0;n<=i.length;n++)if(i[n].id===t)return i[n]}cloneSubProcesses(e){const t=[],i={};if("Bpmn"===e.shape.type&&e.shape.activity&&e.shape.activity.subProcess.processes&&e.shape.activity.subProcess.processes.length){const n=e.shape.activity.subProcess.processes;for(let r=0;r<n.length;r++){const s=this.diagram.nameTable[n[r]]||this.clipboardData.processTable[n[r]];for(const e of s.outEdges)t.indexOf(e)<0&&t.push(e);for(const e of s.inEdges)t.indexOf(e)<0&&t.push(e);const o=dp(this.clipboardData.processTable[n[r]]);o.processId=e.id;const a=this.cloneNode(o,!1);i[n[r]]=a.id,n[r]=a.id,this.diagram.addProcess(a,e.id);for(const e of t){const n=dp(this.diagram.nameTable[e]||this.diagram.connectorTable[e]);i[n.sourceID]&&i[n.targetID]&&(n.zIndex=-1,n.id+=op(),n.sourceID=i[n.sourceID],n.targetID=i[n.targetID],t.splice(t.indexOf(e),1),this.diagram.add(n))}}}}cloneGroup(e,t){const i=[];let n=[];const r=[];let s;const o=[];n=n.concat(e.children);const a=op(),l=[];if(this.diagram.blazorActions|=Ks.GroupClipboardInProcess,this.clipboardData.childTable||e.children.length>0)for(let c=0;c<n.length;c++){let e;e=this.clipboardData.childTable?this.clipboardData.childTable[n[c]]:this.diagram.nameTable[n[c]],e.parentId="",e&&(Lc(e)===ol?r.push(e):(s=this.cloneNode(e,t,void 0,a),o.push(e.id),i.push(s.id),l.push(s)))}for(let c=0;c<r.length;c++){if(r[c].sourceID||r[c].targetID)for(let e=0;e<o.length;e++)r[c].sourceID===o[e]&&(r[c].sourceID+=a),r[c].targetID===o[e]&&(r[c].targetID+=a);s=this.cloneConnector(r[c],t),i.push(s.id),l.push(s)}const h=this.cloneNode(e,t,i);return l.push(h),h&&h.container&&h.shape&&"UmlClassifier"===h.shape.type&&(this.diagram.updateDiagramObject(h),h.wrapper.measure(new bs)),this.diagram.blazorActions&=~Ks.GroupClipboardInProcess,this.diagram.isServerUpdate?this.cloneGroupChildCollection=l:this.diagram.UpdateBlazorDiagramModelCollection(void 0,l,void 0,!0),h}translateObject(e,t){e.id+=t||op();const i=10*this.clipboardData.pasteIndex;if(Lc(e)===ol){if(e.sourcePoint={x:e.sourcePoint.x+i,y:e.sourcePoint.y+i},e.targetPoint={x:e.targetPoint.x+i,y:e.targetPoint.y+i},"Bezier"===e.type){const t=e.segments;for(let e=0;e<t.length;e++)ws.isEmptyPoint(t[e].point1)||(t[e].point1={x:t[e].point1.x+i,y:t[e].point1.y+i}),ws.isEmptyPoint(t[e].point2)||(t[e].point2={x:t[e].point2.x+i,y:t[e].point2.y+i})}if(("Straight"===e.type||"Bezier"===e.type)&&e.segments&&e.segments.length>0){const t=e.segments;for(let e=0;e<t.length-1;e++)t[e].point.x+=i,t[e].point.y+=i}}else e.offsetX+=i,e.offsetY+=i}drawObject(e){let t;e&&e.shape&&"Text"===e.shape.type&&(e.width=this.diagram.drawingObject.width?this.diagram.drawingObject.width:50,e.height=this.diagram.drawingObject.height?this.diagram.drawingObject.height:20);const i=dp(this.diagram.drawingObject);for(const n of Object.keys(e))i[n]=e[n];return Lc(this.diagram.drawingObject)===Td?(t=new Td(this.diagram,"nodes",i,!0),t.id=(this.diagram.drawingObject.id||"node")+op()):(t=new ol(this.diagram,"connectors",i,!0),t.id=(this.diagram.drawingObject.id||"connector")+op()),this.diagram.initObject(t),this.diagram.updateDiagramObject(t),this.diagram.currentDrawingObject=t,t}addObjectToDiagram(e){this.diagram.removeFromAQuad(e),this.diagram.removeObjectsFromLayer(this.diagram.nameTable[e.id]),delete this.diagram.nameTable[e.id];const t=this.diagram.add(e);"SVG"!==this.diagram.mode&&this.diagram.refreshDiagramLayer(),this.selectObjects([t]),e&&!Ml(this.diagram)&&(this.diagram.tool&=~ho.DrawOnce,this.diagram.currentDrawingObject=void 0)}enableServerDataBinding(e){this.diagram.enableServerDataBinding(e)}addText(e,t){const i=this.diagram.findElementUnderMouse(e,t);this.diagram.startTextEdit(e,i instanceof Co?i.id.split("_")[1]:void 0)}updateArgsObject(e,t,i){if(e){let t;for(let n=0;n<e.length;n++)t=Lc(e[n])===ol,t?i.connectorCollection.push(e[n].id):i.nodeCollection.push(e[n].id)}}updateSelectionChangeEventArgs(e,t,i){return e}isUserHandle(e){const t=this.diagram.selectedItems;if(t.wrapper&&Sc(t.constraints,"UserHandle"))for(const i of t.userHandles)if(i.visible&&Gp(e,wc(t,i,this.diagram.scroller.transform),i.size/(2*this.diagram.scroller.transform.scale)))return!0;return!1}selectObjects(e,t,i){return Cu(this,void 0,void 0,function*(){let n={oldValue:i||this.getSelectedObject(),newValue:e,cause:this.diagram.diagramActions,state:"Changing",type:"Addition",cancel:!1};this.diagram.enableServerDataBinding(!1);let r=!0;this.diagram.triggerEvent(vo.selectionChange,n);const s=Ll(this.diagram),o=Rl(this.diagram);if(o||s){if(!s&&(e.length>1||t&&1===e.length)){if(1!==e.length)return;this.clearSelection()}if(!(o||1!==e.length||t&&qp(this.diagram)))return void this.clearSelection()}if(!n.cancel){for(let i=0;i<e.length;i++){const n=e[i];if(n)if(r=!0,qp(this.diagram)){if((i>0||t)&&n.children&&!n.parentId)for(let e=0;e<this.diagram.selectedItems.nodes.length;e++){let t=this.diagram.nameTable[this.diagram.selectedItems.nodes[e].parentId];t&&(t=this.findParent(t),t&&n.id===t.id&&this.selectGroup(n))}this.selectProcesses(n),r=this.selectBpmnSubProcesses(n),r&&this.select(n,i>0||t,!0)}else this.select(n,i>0||t,!0)}n={oldValue:i||[],newValue:this.getSelectedObject(),cause:this.diagram.diagramActions,state:"Changed",type:"Addition",cancel:!1},this.diagram.renderSelector(t||e&&e.length>1),this.updateBlazorSelectorModel(i),this.diagram.triggerEvent(vo.selectionChange,n),this.diagram.enableServerDataBinding(!0),this.updateBlazorSelector()}})}updateBlazorSelector(){}findParent(e){return e.parentId&&this.findParent(e=this.diagram.nameTable[e.parentId]),e}selectProcesses(e){if(this.hasProcesses(e)){const t=e.shape.activity.subProcess.processes;for(let e=0;e<t.length;e++){const i=this.diagram.nameTable[t[e]];this.hasProcesses(i)&&this.selectObjects([i],!0),this.unSelect(i)}}}selectGroup(e){for(let t=0;t<e.children.length;t++){const i=this.diagram.nameTable[e.children[t]];i.children&&this.selectGroup(i),this.unSelect(this.diagram.nameTable[e.children[t]])}}selectBpmnSubProcesses(e){let t,i=!0;if(e.processId)i=!$p(this.diagram,this.diagram.nameTable[e.processId])&&this.selectBpmnSubProcesses(this.diagram.nameTable[e.processId]);else if(e instanceof ol){if(e.sourceID&&this.diagram.nameTable[e.sourceID]&&this.diagram.nameTable[e.sourceID].processId&&(t=this.diagram.nameTable[e.sourceID].processId),e.targetID&&this.diagram.nameTable[e.targetID]&&this.diagram.nameTable[e.targetID].processId&&(t=this.diagram.nameTable[e.targetID].processId),t){if($p(this.diagram,this.diagram.nameTable[t]))return!1;i=this.selectBpmnSubProcesses(this.diagram.nameTable[t])}}else e.parentId&&this.diagram.nameTable[e.parentId]&&"UmlClassifier"===this.diagram.nameTable[e.parentId].shape.type&&$p(this.diagram,this.diagram.nameTable[e.parentId])&&(i=!1);return i}hasProcesses(e){return!!(e&&"Bpmn"===e.shape.type&&e.shape.activity&&e.shape.activity.subProcess.processes&&e.shape.activity.subProcess.processes.length>0)}select(e,t,i){const n=this.getObjectLayer(e.id);if(ml(e)&&!(e instanceof Ld)&&!$p(this.diagram,e)&&n&&!n.lock&&n.visible&&e.wrapper.visible){(t=!!qp(this.diagram)&&t)||this.clearSelection(),this.diagram.enableServerDataBinding(!1);const n=this.diagram.selectedItems;if(e instanceof Td?n.nodes.push(e.isHeader?this.diagram.nameTable[e.parentId]:e):n.connectors.push(e),t)n.wrapper.rotateAngle=n.rotateAngle=0,n.wrapper.children.push(e.wrapper);else if(n.init(this.diagram),1===n.nodes.length&&0===n.connectors.length){const e=Hh(this.diagram,n);e&&(n.wrapper.children[0]=e),n.rotateAngle=n.nodes[0].rotateAngle,n.wrapper.rotateAngle=n.nodes[0].rotateAngle,n.wrapper.pivot=n.nodes[0].pivot}i||this.diagram.renderSelector(t),this.diagram.enableServerDataBinding(!0)}}getObjectCollectionId(e,t){const i=[];let n=0;const r=e?this.diagram.selectedItems.nodes:this.diagram.selectedItems.connectors;for(;!t&&n<r.length;)i[n]=r[n].id,n++;return i}updateBlazorSelectorModel(e,t){if(window&&window.sfBlazor){let i=0,n=[],r=[];const s=[];for(;e&&i<e.length;)s[i]=e[i].id,i++;i=0,n=this.getObjectCollectionId(!0,t),r=this.getObjectCollectionId(!1,t);const o={nodes:n,connectors:r};window.sfBlazor.updateDiagramCollection&&window.sfBlazor.updateDiagramCollection.call(this.diagram,"selectedItems",o,s,!1,!0)}}labelSelect(e,t){this.oldSelectedObjects=jc(this.diagram);const i=this.diagram.selectedItems,n=this.diagram.allowServerDataBinding;this.diagram.allowServerDataBinding=!1,i.nodes=i.connectors=[],this.diagram.allowServerDataBinding=n,e instanceof Td?i.nodes[0]=e:i.connectors[0]=e,i.annotation=this.findTarget(t,e),i.init(this.diagram),this.diagram.renderSelector(!1),this.updateBlazorSelector()}unSelect(e){const t=[];t.push(e);let i={oldValue:t,newValue:[],cause:this.diagram.diagramActions,state:"Changing",type:"Removal",cancel:!1};if(this.diagram.currentSymbol||this.diagram.triggerEvent(vo.selectionChange,i),$p(this.diagram,e)){const n=this.diagram.selectedItems;let r;e instanceof Td?(r=n.nodes.indexOf(e,0),n.nodes.splice(r,1)):(r=n.connectors.indexOf(e,0),n.connectors.splice(r,1)),i={oldValue:t,newValue:[],cause:this.diagram.diagramActions,state:"Changed",type:"Removal",cancel:!1},this.updateBlazorSelectorModel(t),i={oldValue:t,newValue:[],cause:this.diagram.diagramActions,state:"Changed",type:"Removal",cancel:i.cancel},i.cancel||(r=n.wrapper.children.indexOf(e.wrapper,0),n.wrapper.children.splice(r,1),this.diagram.updateSelector(),this.diagram.currentSymbol)||this.diagram.triggerEvent(vo.selectionChange,i)}}getChildElements(e){const t=[];for(let i=0;i<e.length;i++){const n=e[i];n.children&&n.children.length>0?t.concat(this.getChildElements(n.children)):(t.push(n.id),n instanceof Co&&t.push(n.id+"_text"))}return t}moveSvgNode(e,t){const i=Nd(t+"_groupElement",this.diagram.element.id),n=Nd(e+"_groupElement",this.diagram.element.id);i.parentNode.insertBefore(n,i)}sendLayerBackward(e){const t=this.getLayer(e);if(t&&0!==t.zIndex){const e=t.zIndex;if("SVG"===this.diagram.mode){const i=t.objects,n=this.getLayer(this.diagram.layerZIndexTable[e-1]).objects[0];if(n)for(const e of i)this.moveSvgNode(e,n)}const i=this.getLayer(this.diagram.layerZIndexTable[e-1]);i.zIndex=i.zIndex+1,t.zIndex=t.zIndex-1;const n=this.diagram.layerZIndexTable[e];this.diagram.layerZIndexTable[e]=this.diagram.layerZIndexTable[e-1],this.diagram.layerZIndexTable[e-1]=n,"Canvas"===this.diagram.mode&&this.diagram.refreshDiagramLayer()}}bringLayerForward(e){const t=this.getLayer(e);if(t&&t.zIndex<this.diagram.layers.length-1){const e=t.zIndex,i=this.getLayer(this.diagram.layerZIndexTable[e+1]);if("SVG"===this.diagram.mode){const e=t.objects[0],n=i.objects;for(const t of n)t&&this.moveSvgNode(t,e)}i.zIndex=i.zIndex-1,t.zIndex=t.zIndex+1;const n=this.diagram.layerZIndexTable[e];this.diagram.layerZIndexTable[e]=this.diagram.layerZIndexTable[e+1],this.diagram.layerZIndexTable[e+1]=n,"Canvas"===this.diagram.mode&&this.diagram.refreshDiagramLayer()}}sendToBack(e){if(this.diagram.protectPropertyChange(!0),qp(this.diagram)||e){let t=e&&e.id;t=t||(this.diagram.selectedItems.nodes.length?this.diagram.selectedItems.nodes[0].id:this.diagram.selectedItems.connectors[0].id);const i=this.diagram.nameTable[t].zIndex,n=this.diagram.layers.indexOf(this.getObjectLayer(t)),r=this.diagram.layers[n].zIndexTable,s=JSON.parse(JSON.stringify(r)),o=dp(this.diagram.selectedItems);let a=0;if(1!==this.diagram.nodes.length&&(void 0===this.diagram.nameTable[t].children||this.checkObjectBehind(t,r,i))){let e=this.diagram.nameTable[t];for(let t=i;t>0;t--)r[t]&&(r[t-1]?(r[t]=r[t-1],this.diagram.nameTable[r[t]].zIndex=t):(r[t-1]=r[t],this.diagram.nameTable[r[t-1]].zIndex=t,delete r[t]));for(let t=i;t>0;t--)r[t]&&(this.diagram.nameTable[r[t]].zIndex=t);if("SwimLane"!==e.shape.type?(r[0]=this.diagram.nameTable[t].id,this.diagram.nameTable[t].zIndex=0):a=this.swapZIndexObjects(i,r,t,s),"SVG"===this.diagram.mode){let e=this.diagram.nameTable[t],n="SwimLane"!==e.shape.type?1:a;n!==a&&(n=e.children&&e.children.length>0?i:1);let s=r[n];for(;!s&&n<i;)s=r[++n];s=this.resetTargetNode(t,s,n,r),s=this.diagram.nameTable[s].parentId?this.checkParentExist(s):s,this.moveSvgNode(t,s),this.updateNativeNodeIndex(t)}else this.diagram.refreshCanvasLayers();const n={type:"SendToBack",category:"Internal",undoObject:o,redoObject:dp(this.diagram.selectedItems)};this.diagram.diagramActions&go.UndoRedo||this.addHistoryEntry(n)}}this.diagram.protectPropertyChange(!1)}swapZIndexObjects(e,t,i,n){let r=0,s=0,o=-1,a=1;for(let h=0;h<=e;h++)t[h]&&this.diagram.nameTable[t[h]].parentId===i&&(-1===o&&(o=h),s++);for(let h=0;h<=e;h++)if(t[h]&&a<=s){for(;!t[o];)o++;t[h]=t[o],this.diagram.nameTable[t[h]].zIndex=h,o++,a++}let l=0;for(let h=0;h<s;h++){for(;!t[l];)l++;r=this.diagram.nameTable[t[l]].zIndex,l++}for(r+=1;!t[r];)++r;l=0,t[r]=this.diagram.nameTable[i].id,this.diagram.nameTable[i].zIndex=r,r+=1;for(let h=r;h<=e;h++)if(t[h]){for(;!n[l];)l++;t[h]=n[l],this.diagram.nameTable[t[h]].zIndex=h,l++}return r}resetTargetNode(e,t,i,n){return"SwimLane"===this.diagram.nameTable[e].shape.type&&null!=this.diagram.nameTable[t].parentId&&""!=this.diagram.nameTable[t].parentId&&this.diagram.nameTable[this.diagram.nameTable[t].parentId].isLane&&n[i+=1]?this.resetTargetNode(e,t=n[i],i,n):t}getZIndexObjects(){const e=[];let t,i;for(t=0;t<this.diagram.nodes.length;t++)e.push(this.diagram.nodes[t]);for(i=0;i<this.diagram.connectors.length;i++)e.push(this.diagram.connectors[i]);this.updateBlazorZIndex(e)}updateBlazorZIndex(e){let t={};const i=[],n=[];let r;if(e&&e.length>0)for(r=0;r<e.length;r++){const t=e[r];t instanceof Td?i.push(this.getBlazorObject(t)):t instanceof ol&&n.push(this.getBlazorObject(t))}t={nodes:i,connectors:n},window&&window.Blazor&&window.sfBlazor.updateBlazorProperties({methodName:"UpdateBlazorProperties",diagramobj:t},this.diagram)}getBlazorObject(e){return{sfIndex:ap(this.diagram,e.id),zIndex:e.zIndex}}checkParentExist(e){let t=e;for(;this.diagram.nameTable[t].parentId;)t=this.diagram.nameTable[t].parentId;return t}checkObjectBehind(e,t,i){for(let n=0;n<i;n++)if(e!==this.diagram.nameTable[t[n]].parentId)return!0;return!1}bringToFront(e){if(this.diagram.protectPropertyChange(!0),qp(this.diagram)||e){let t=e&&e.id;t=t||(this.diagram.selectedItems.nodes.length?this.diagram.selectedItems.nodes[0].id:this.diagram.selectedItems.connectors[0].id);const i=this.diagram.layers.indexOf(this.getObjectLayer(t)),n=this.diagram.layers[i].zIndexTable,r=dp(this.diagram.selectedItems);let s=JSON.parse(JSON.stringify(n)),o=Number(Object.keys(n).sort((e,t)=>Number(e)-Number(t)).reverse()[0]);const a=this.diagram.nameTable[t].zIndex,l=[];let h=0;for(let e=0;e<=o;e++)l.push(n[e]);let c=this.diagram.nameTable[t];if("SwimLane"===c.shape.type)for(let e=o;e>=a;e--)if(n[e]&&this.diagram.nameTable[n[e]].parentId!==t){h=e,o=h;break}for(let e=a;e<o;e++)n[e]&&(n[e+1]?(n[e]=n[e+1],this.diagram.nameTable[n[e]].zIndex=e):(n[e+1]=n[e],this.diagram.nameTable[n[e+1]].zIndex=e,delete n[e]));for(let e=a;e<o;e++)n[e]&&(this.diagram.nameTable[n[e]].zIndex=e);if("SwimLane"!==c.shape.type)n[o]=this.diagram.nameTable[t].id,this.diagram.nameTable[t].zIndex=o;else{let e=0,i=-1,r=0,l=0,h=JSON.parse(JSON.stringify(n));for(let s=0;s<=a;s++)if(n[s]&&this.diagram.nameTable[n[s]].parentId===t&&-1===i){i=s,r=s;break}for(let n=0;n<=o;n++)s[n]&&s[n]!==t&&this.diagram.nameTable[s[n]].parentId!==t&&this.diagram.nameTable[s[n]].zIndex>=this.diagram.nameTable[t].zIndex&&e++;let c=i;for(let t=0;t<=e;t++){for(;!n[c];)c++;l=this.diagram.nameTable[n[c]].zIndex,c++}for(let t=l;t<=o;t++){for(;!h[i];)i++;for(;!n[t];)t++;n[t]=h[i],this.diagram.nameTable[n[t]].zIndex=t,i++}n[o]=this.diagram.nameTable[t].id,this.diagram.nameTable[t].zIndex=o,c=a+1;let d=r;for(let o=0;o<e;o++){for(;!s[c];)c++;for(;this.diagram.nameTable[s[c]].parentId===t;)c++;for(;!n[d];)d++;n[d]=s[c],this.diagram.nameTable[n[d]].zIndex=d,c++,d++}}if("SVG"===this.diagram.mode){const e=this.diagram.diagramLayer;let i=Nd(t+"_groupElement",this.diagram.element.id);const r=this.diagram.selectedItems.nodes;if(r.length>0&&("Native"===r[0].shape.type||"HTML"===r[0].shape.type)){i.parentNode.removeChild(i);for(let e=0;e<this.diagram.views.length;e++){i=Nd(t+("HTML"===r[0].shape.type?"_html_element":"_content_groupElement"),this.diagram.views[e]);const n=i.parentNode.lastChild;n.parentNode.insertBefore(i,n.nextSibling)}const n=qd(this.diagram.element.id);this.diagram.diagramRenderer.renderElement(this.diagram.nameTable[t].wrapper,e,n)}else Object.keys(n).forEach(e=>{let i=n[e];if(i!==t&&this.diagram.nameTable[i].parentId!==t&&void 0!==i&&l.indexOf(t)<l.indexOf(i)){let e=this.diagram.nameTable[t],n=this.diagram.nameTable[i];(""===e.parentId&&""===n.parentId&&void 0===n.parentId&&e.parentId!==n.id||this.checkGroupNode(t,i,this.diagram.nameTable))&&(this.moveSvgNode(i,t),this.updateNativeNodeIndex(t))}})}else this.diagram.refreshCanvasLayers();const d={type:"BringToFront",category:"Internal",undoObject:r,redoObject:dp(this.diagram.selectedItems)};this.diagram.diagramActions&go.UndoRedo||this.addHistoryEntry(d)}this.diagram.protectPropertyChange(!1)}checkGroupNode(e,t,i){return i[t].parentId===i[e].parentId}sortByZIndex(e,t){const i=t||"zIndex";return e.sort((e,t)=>e[i]-t[i])}orderCommands(e,t,i){let n=t.nodes;if(n=n.concat(t.connectors),e)"SendBackward"===i?this.sendBackward(n[0]):"SendForward"===i?this.sendForward(n[0]):"BringToFront"===i?this.bringToFront(n[0]):"SendToBack"===i&&this.sendToBack(n[0]);else{const e=n[0].zIndex,t=this.diagram.nameTable[n[0].id].zIndex,r=n[0],s=this.getObjectLayer(r.id),o=s.zIndex,a=s.zIndexTable;if("SendBackward"===i||"SendForward"===i)for(let i=0;i<n.length;i++){const e=n[i],t=this.diagram.layers.indexOf(this.getObjectLayer(e.id));this.diagram.nameTable[n[i].id].zIndex=e.zIndex,this.diagram.layers[t].zIndexTable[e.zIndex]=e.id}else if("BringToFront"===i)if("SwimLane"===n[0].shape.type)this.sendToBack(n[0]);else{const i=1;for(let n=t;n>e;n--)a[n]&&(a[n-i]?(a[n]=a[n-i],this.diagram.nameTable[a[n]].zIndex=n):(a[n-i]=a[n],this.diagram.nameTable[a[n-i]].zIndex=n,delete a[n]))}else if("SendToBack"===i)if("SwimLane"===n[0].shape.type)this.bringToFront(n[0]);else for(let i=t;i<e;i++)a[i]&&(a[i+1]?(a[i]=a[i+1],this.diagram.nameTable[a[i]].zIndex=i):(a[i+1]=a[i],this.diagram.nameTable[a[i+1]].zIndex=i,delete a[i]));if("BringToFront"!==i&&"SendToBack"!==i||(this.diagram.nameTable[n[0].id].zIndex=r.zIndex,this.diagram.layers[o].zIndexTable[r.zIndex]=r.id),"SVG"===this.diagram.mode){if("SendBackward"===i)this.moveObject(n[1].id,n[0].id);else if("SendForward"===i)this.moveObject(n[0].id,n[1].id);else if("BringToFront"===i)"SwimLane"!==n[0].shape.type&&this.moveObject(n[0].id,a[n[0].zIndex+1]);else if("SendToBack"===i&&"SwimLane"!==n[0].shape.type){const e=this.getObjectLayer(n[0].id);for(let t=0;t<=n[0].zIndex;t++)e.objects[t]!==n[0].id&&(this.moveSvgNode(e.objects[t],n[0].id),this.updateNativeNodeIndex(n[0].id))}}else this.diagram.refreshCanvasLayers()}}moveObject(e,t){t&&(this.moveSvgNode(e,t),this.updateNativeNodeIndex(e,t))}sendForward(e){if(this.diagram.protectPropertyChange(!0),qp(this.diagram)||e){let t=e&&e.id;t=t||(this.diagram.selectedItems.nodes.length?this.diagram.selectedItems.nodes[0].id:this.diagram.selectedItems.connectors[0].id);const i=this.diagram.layers.indexOf(this.getObjectLayer(t)),n=this.diagram.layers[i].zIndexTable,r=this.diagram.nameTable[t],s=[];let o=this.diagram.spatialSearch.findObjects(r.wrapper.bounds);o.length>2&&(o=this.sortByZIndex(o));for(const e of o)if(r.id!==e.id&&i===this.getObjectLayer(e.id).zIndex&&Number(this.diagram.nameTable[t].zIndex)<Number(e.zIndex)&&r.wrapper.bounds.intersects(e.wrapper.bounds)){s.push(e);break}if(s.length>0){let e=this.diagram.nameTable[n[Number(s[0].zIndex)]];if(e.parentId){let i=Fc(e,this.diagram,""),n=this.diagram.nameTable[i];n.id!==t&&(s[0]=n)}const i=s[0].zIndex,o=r.zIndex,a=n[i],l=dp(this.diagram.selectedItems);this.diagram.nameTable[a]instanceof Td?l.nodes.push(dp(this.diagram.nameTable[a])):l.connectors.push(dp(this.diagram.nameTable[a])),this.diagram.layers[0].zIndexTable[i]=r.id,this.diagram.nameTable[n[i]].zIndex=i,this.diagram.layers[0].zIndexTable[o]=s[0].id,this.diagram.nameTable[n[o]].zIndex=o,"SVG"===this.diagram.mode?(this.moveSvgNode(n[Number(s[0].zIndex)],t),this.updateNativeNodeIndex(n[Number(s[0].zIndex)],t)):this.diagram.refreshCanvasLayers();const h=dp(this.diagram.selectedItems);this.diagram.nameTable[a]instanceof Td?h.nodes.push(dp(this.diagram.nameTable[a])):h.connectors.push(dp(this.diagram.nameTable[a]));const c={type:"SendForward",category:"Internal",undoObject:l,redoObject:h};this.diagram.diagramActions&go.UndoRedo||this.addHistoryEntry(c)}}this.diagram.protectPropertyChange(!1)}sendBackward(e){if(this.diagram.protectPropertyChange(!0),qp(this.diagram)||e){let t=e&&e.id;t=t||(this.diagram.selectedItems.nodes.length?this.diagram.selectedItems.nodes[0].id:this.diagram.selectedItems.connectors[0].id);const i=this.diagram.layers.indexOf(this.getObjectLayer(t)),n=this.diagram.layers[i].zIndexTable,r=this.diagram.nameTable[t],s=[];let o=this.diagram.spatialSearch.findObjects(r.wrapper.bounds);o.length>2&&(o=this.sortByZIndex(o));for(const e of o)r.id!==e.id&&i===this.getObjectLayer(e.id).zIndex&&Number(this.diagram.nameTable[t].zIndex)>Number(e.zIndex)&&r.wrapper.bounds.intersects(e.wrapper.bounds)&&s.push(e);for(let e=s.length-1;e>=0;e--)this.diagram.nameTable[s[e].id].parentId===t&&s.splice(e,1);if(s.length>0){let e=this.diagram.nameTable[s[s.length-1].id];if(e.parentId){let i=Fc(e,this.diagram,""),n=this.diagram.nameTable[i];t!==n.id&&(s[s.length-1]=n)}const i=s[s.length-1].zIndex,o=r.zIndex,a=n[i],l=dp(this.diagram.selectedItems);if(this.diagram.nameTable[a]instanceof Td?l.nodes.push(dp(this.diagram.nameTable[a])):l.connectors.push(dp(this.diagram.nameTable[a])),n[i]=r.id,this.diagram.nameTable[n[i]].zIndex=i,n[o]=s[s.length-1].id,this.diagram.nameTable[n[o]].zIndex=o,"SVG"===this.diagram.mode){this.moveSvgNode(t,n[s[s.length-1].zIndex]);let e=this.diagram.nameTable[n[s[s.length-1].zIndex]];e.children&&e.children.length>0?this.updateNativeNodeIndex(t):this.updateNativeNodeIndex(t,n[s[s.length-1].zIndex])}else this.diagram.refreshCanvasLayers();const h=dp(this.diagram.selectedItems);this.diagram.nameTable[a]instanceof Td?h.nodes.push(dp(this.diagram.nameTable[a])):h.connectors.push(dp(this.diagram.nameTable[a]));const c={type:"SendBackward",category:"Internal",undoObject:l,redoObject:h};this.diagram.diagramActions&go.UndoRedo||this.addHistoryEntry(c)}}this.diagram.protectPropertyChange(!1)}updateNativeNodeIndex(e,t){const i=this.diagram.selectedItems.nodes[0]||this.diagram.getObject(t);for(let n=0;n<this.diagram.views.length;n++)if(i&&("HTML"===i.shape.type||"Native"===i.shape.type)){const r="HTML"===i.shape.type?"_html_element":"_content_groupElement",s=Nd(e+r,this.diagram.views[n]),o=t?Nd(t+r,this.diagram.views[n]):s.parentElement.firstChild;s.parentNode.id===o.parentNode.id&&o.parentNode.insertBefore(s,o)}}initSelectorWrapper(){const e=this.diagram.selectedItems;e.init(this.diagram),1===e.nodes.length&&0===e.connectors.length&&(e.rotateAngle=e.nodes[0].rotateAngle,e.wrapper.rotateAngle=e.nodes[0].rotateAngle,e.wrapper.pivot=e.nodes[0].pivot)}doRubberBandSelection(e){this.clearSelectionRectangle();let t=[],i=[];t=this.diagram.getNodesConnectors(t),i="CompleteIntersect"===this.diagram.selectedItems.rubberBandSelectionMode?function(e,t){const i=[];for(let n=0;n<t.length;n++){const r=t[n];e.containsRect(r.wrapper.bounds)&&i.push(r)}return i}(e,t):this.diagram.spatialSearch.findObjects(e),i.length&&this.selectObjects(i,!0)}clearSelectionRectangle(){const e=Bd(this.diagram.element.id).getElementById(this.diagram.element.id+"_diagramAdorner_selected_region");e&&Qe(e)}dragConnectorEnds(e,t,i,n,r,s){let o,a,l,h,c=!1;return t instanceof Ld?(o=t,a=o.connectors[0]):t instanceof ol&&this.diagram.currentDrawingObject&&(this.clearSelection(),a=this.diagram.currentDrawingObject),"BezierSourceThumb"!==e&&"BezierTargetThumb"!==e||(c=!0),"ConnectorSourceEnd"===e||"BezierSourceThumb"===e?(l=i.x-(c?n.bezierPoint1.x:a.sourcePoint.x),h=i.y-(c?n.bezierPoint1.y:a.sourcePoint.y),this.dragSourceEnd(a,l,h,null,i,e,void 0,r,s,void 0,n)):(l=i.x-(c?n.bezierPoint2.x:a.targetPoint.x),h=i.y-(c?n.bezierPoint2.y:a.targetPoint.y),this.dragTargetEnd(a,l,h,null,i,e,void 0,n))}getSelectedObject(){const e=this.diagram.selectedItems;return e.nodes.concat(e.connectors)}updateBlazorProperties(e){if(e){if(window&&window.Blazor&&"{}"!==JSON.stringify(this.deepDiffer.diagramObject)){const e={methodName:"UpdateBlazorProperties",diagramobj:this.deepDiffer.diagramObject};this.diagram.isLoading||window.sfBlazor.updateBlazorProperties(e,this.diagram)}}else window&&window.Blazor&&window.sfBlazor.updateBlazorProperties({methodName:"UpdateBlazorProperties",diagramobj:this.diagramObject},this.diagram);this.deepDiffer.newNodeObject=[],this.deepDiffer.newConnectorObject=[],this.diagramObject=[],this.diagram.oldNodeObjects=[],this.diagram.oldConnectorObjects=[]}enableCloneObject(e){this.diagram.lineRoutingModule&&this.diagram.constraints&lo.LineRouting||(this.diagram.canEnableBlazorObject=e)}ismouseEvents(e){this.diagram.blazorActions=e?this.diagram.addConstraints(this.diagram.blazorActions,Ks.interaction):this.diagram.removeConstraints(this.diagram.blazorActions,Ks.interaction)}updateLayerObject(e,t){}getDiagramOldValues(e,t){const i={};for(let a=0;a<t.length;a++)i[t[a]]=dp(this.diagram[t[a]]);const n=dp(i),r=this.deepDiffer.map(n,e),s=this.deepDiffer.frameObject({},r);let o=this.deepDiffer.removeEmptyValues(s);o=this.deepDiffer.changeSegments(o,n),this.diagramObject=o,this.diagram.blazorActions&Ks.ClearObject||this.updateBlazorProperties()}getBlazorOldValues(e,t){}getObjectChanges(e,t,i){for(let n=0;n<e.length;n++){const r=this.deepDiffer.map(t[n],e[n]),s=this.deepDiffer.frameObject({},r);let o=this.deepDiffer.removeEmptyValues(s);o.children&&(o.children=dp(t[n]).children),o=this.deepDiffer.changeSegments(o,t[n]),o.sfIndex=ap(this.diagram,t[n].id),i.push(o)}}clearObjectSelection(e){const t=this.diagram.selectedItems;let i=[];i=i.concat(t.nodes,t.connectors),-1===i.indexOf(e)&&(this.clearSelection(i.length>0),this.selectObjects([e],!0))}clearSelection(e,t){return Cu(this,void 0,void 0,function*(){const t=this.diagram.allowServerDataBinding;if(this.diagram.enableServerDataBinding(!1),qp(this.diagram)){const i=this.diagram.selectedItems,n=this.getSelectedObject();this.diagram.currentSymbol&&(this.diagram.previousSelectedObject=n);let r={oldValue:n,newValue:[],cause:this.diagram.diagramActions,state:"Changing",type:"Removal",cancel:!1};this.updateBlazorSelectorModel(n,!0),e&&this.diagram.triggerEvent(vo.selectionChange,r),!r.cancel&&(i.offsetX=0,i.offsetY=0,i.width=0,i.height=0,i.rotateAngle=0,i.nodes=[],i.connectors=[],i.wrapper=null,i.annotation=void 0,this.diagram.clearSelectorLayer(),e)&&(r={oldValue:n,newValue:[],cause:this.diagram.diagramActions,state:"Changed",type:"Removal",cancel:!1},this.diagram.triggerEvent(vo.selectionChange,r)),this.updateBlazorSelector(),this.diagram.enableServerDataBinding(t)}})}clearSelectedItems(){this.clearSelection((this.diagram.selectedItems.nodes?this.diagram.selectedItems.nodes.length:0)+(this.diagram.selectedItems.connectors?this.diagram.selectedItems.connectors.length:0)>0)}removeStackHighlighter(){const e=Bd(this.diagram.element.id),t=e.getElementById(e.id+"_stack_highlighter");t&&t.parentNode.removeChild(t)}renderStackHighlighter(e,t){const i=this.diagram.selectedItems.nodes[0];let n,r,s;if(!t){const i=this.diagram.findObjectsUnderMouse(e.position);if((t=this.diagram.findObjectUnderMouse(i,"Drag",!0))&&!(t.isLane||t.isPhase||t.isHeader))for(let e=0;e<i.length;e++){const n=this.diagram.nameTable[i[e].id];(!n.isLane||n.isPhase||n.isHeader)&&(this.diagram.parentObject=t=n)}}if(i&&t&&t.isLane&&i.shape&&!i.shape.isPhase&&(r=this.diagram.nameTable[t.parentId],this.diagram.currentSymbol&&"SwimLane"===r.shape.type&&(n=!0),i&&!i.parentId&&"SwimLane"!==i.shape.type||i&&i.parentId&&this.diagram.nameTable[i.parentId]&&this.diagram.nameTable[i.parentId].isLane&&i.parentId!==t.parentId&&i.parentId!==t.id)){s=this.diagram.selectedItems;const e=Hh(this.diagram,s,t.id,!0);e&&(s.wrapper.children[0]=e),this.diagram.renderSelector(!1,!0),s.wrapper.children[0]=s.nodes[0].wrapper}if(i&&t&&t.parentId&&i.shape&&i.shape.isPhase&&"SwimLane"===this.diagram.nameTable[t.parentId].shape.type&&(this.diagram.selectedItems.wrapper.children[0]=this.diagram.nameTable[t.parentId].wrapper,this.diagram.renderSelector(!1,!0)),n&&this.diagram.currentSymbol.shape.isLane||i&&t&&i.parentId&&t.parentId&&!i.isPhase&&i.parentId===t.parentId&&i.id!==t.id&&r&&r.container&&("Stack"===r.container.type||"Grid"===r.container.type)){let o;const a="Vertical"===r.container.orientation,l="Stack"===r.container?a:!a;"Grid"===r.container.type&&t.isLane&&(!this.diagram.currentSymbol&&"Horizontal"===r.shape.orientation&&t.rowIndex!==i.rowIndex||"Vertical"===r.shape.orientation&&t.columnIndex!==i.columnIndex||this.diagram.currentSymbol&&this.diagram.currentSymbol.shape.orientation===r.container.orientation)&&(s=this.diagram.selectedItems,(i.isLane&&Xh(i,this.diagram)||!i.isLane)&&(o=Hh(this.diagram,s,t.id,n)));const h="Stack"===r.container.type?t.wrapper:o;h&&uh(h,l,e.position,this.diagram,!1,!0)}}insertBlazorConnector(e){if(e instanceof Ld)for(let t=0;t<e.connectors.length;t++)this.diagram.insertBlazorConnector(e.connectors[t]);else this.diagram.insertBlazorConnector(e)}drag(e,t,i){let n;const r=[];if(fl(e)&&this.checkBoundaryConstraints(t,i,e.wrapper.bounds)&&_l(this.diagram))if(e instanceof Td){const s={offsetX:e.offsetX,offsetY:e.offsetY};if(e.offsetX+=t,e.offsetY+=i,e.children&&!e.container){ah(this.diagram,e,!0)||(this.diagram.diagramActions=this.diagram.diagramActions|go.isGroupDragging);const s=this.getAllDescendants(e,r);for(let e=0;e<s.length;e++)n=this.diagram.nameTable[s[e].id],this.drag(n,t,i);this.updateInnerParentProperties(e),this.diagram.diagramActions=this.diagram.diagramActions&~go.isGroupDragging}ah(this.diagram,e,!0)?lh(this.diagram,e):(e&&e.shape&&"UmlClassifier"===e.shape.type&&(e.wrapper.measureChildren=!0),this.diagram.nodePropertyChange(e,s,{offsetX:e.offsetX,offsetY:e.offsetY},void 0,void 0,!1),e.wrapper.measureChildren=!1),"SwimLane"!==e.shape.type||this.diagram.currentSymbol||Oh(vh(this.diagram,e.wrapper.children[0]),this.diagram)}else{const n=e,r={sourcePoint:n.sourcePoint,targetPoint:n.targetPoint},s="Bezier"===n.type;let o=!1;n.sourceWrapper?o=!0:this.dragSourceEnd(n,t,i,!0,null,"",s),n.targetWrapper?o=!0:this.dragTargetEnd(n,t,i,!0,null,"",s);let a=!1;e instanceof ol&&(a=!0),(!o||a)&&(this.dragControlPoint(n,t,i,!0),this.diagram.connectorPropertyChange(n,r,{sourcePoint:n.sourcePoint,targetPoint:n.targetPoint}))}}connectorSegmentChange(e,t,i){let n,r,s=!0;if(!1===t.equals(t,e.wrapper.bounds)&&e.outEdges.length>0)for(let o=0;o<e.outEdges.length;o++){const a=this.diagram.nameTable[e.outEdges[o]];if(s=""!==a.targetID?!this.isSelected(this.diagram.nameTable[a.targetID]):!this.isSelected(this.diagram.nameTable[a.id]),"Orthogonal"===a.type&&a.segments&&a.segments.length>1)if(i){const t=a.segments[0],i=a.segments[1];let n=ha(Ko(e.wrapper,e.wrapper.corners,e.wrapper.bounds),t.direction);n=da(a,0,n,{x:a.sourceWrapper.offsetX,y:a.sourceWrapper.offsetY},!1);const r=ya({corners:void 0,point:n,margin:void 0,direction:t.direction},{corners:void 0,point:i.points[1],margin:void 0,direction:void 0});t.length=ws.distancePoints(r[0],r[1]),i.direction&&i.length&&(i.length=ws.distancePoints(r[1],r[2]))}else if(s){switch(a.segments[0].direction){case"Bottom":n=e.wrapper.bounds.bottomCenter.x-t.bottomCenter.x,r=e.wrapper.bounds.bottomCenter.y-t.bottomCenter.y;break;case"Top":n=e.wrapper.bounds.topCenter.x-t.topCenter.x,r=e.wrapper.bounds.topCenter.y-t.topCenter.y;break;case"Left":n=e.wrapper.bounds.middleLeft.x-t.middleLeft.x,r=e.wrapper.bounds.middleLeft.y-t.middleLeft.y;break;case"Right":n=e.wrapper.bounds.middleRight.x-t.middleRight.x,r=e.wrapper.bounds.middleRight.y-t.middleRight.y}this.dragSourceEnd(a,n,r,!0,null,"ConnectorSourceEnd",void 0,void 0,void 0,!(e.parentId&&this.diagram.diagramActions&go.isGroupDragging))}}}updateEndPoint(e,t){const i={sourcePoint:e.sourcePoint,targetPoint:e.targetPoint};e.sourceID&&(i.sourceID=e.sourceID),e.targetID&&(i.targetID=e.targetID),e.sourcePortID&&(i.sourcePortID=e.sourcePortID),e.targetPortID&&(i.targetPortID=e.targetPortID),e.segments&&(i.segments=e.segments),this.diagram.connectorPropertyChange(e,t||{},i),this.diagram.updateSelector()}dragSourceEnd(e,t,i,n,r,s,o,a,l,h,c){const d=this.diagram.nameTable[e.id];let p={};const u=this.checkBoundaryConstraints(t,i,d.wrapper.bounds);if(vl(d)&&u&&"BezierSourceThumb"!==s&&_l(this.diagram)&&(p={sourcePoint:d.sourcePoint},d.sourcePoint.x+=t,d.sourcePoint.y+=i,"ConnectorSourceEnd"===s&&"Orthogonal"===d.type&&this.changeSegmentLength(d,a,l,h),"Bpmn"===d.shape.type&&"Default"===d.shape.sequence&&this.updatePathElementOffset(d)),"Bezier"===d.type)if(p={sourcePoint:d.sourcePoint},c)this.translateBezierPoints(e,""===s?"ConnectorSourceEnd":s,t,i,c,r,!o);else for(let g=0;g<e.segments.length;g++)this.translateBezierPoints(e,""===s?"ConnectorSourceEnd":s,t,i,e.segments[g],r,!o);return n||this.updateEndPoint(d,p),this.diagram.realActions&fo.AnimationClick||this.diagram.refreshCanvasLayers(),u}updatePathElementOffset(e){e.wrapper.children.splice(3,1);let t=new Eo;t=Hc(e.intermediatePoints,e),e.wrapper.children.splice(3,0,t)}changeSegmentLength(e,t,i,n){if(e.segments&&null!==e.segments[0].direction&&(!t&&""===e.sourceID||n)){const t=e.segments[0],i=e.segments[1],n=this.diagram.nameTable[e.sourceID];let r;if(t.points[0]=e.sourcePoint,"Top"===t.direction||"Bottom"===t.direction?(t.points[t.points.length-1].x=e.sourcePoint.x,i.points[0].y=t.points[t.points.length-1].y):(t.points[t.points.length-1].y=e.sourcePoint.y,i.points[0].x=t.points[t.points.length-1].x),t.direction&&(t.length||0===t.length)&&(t.length=ws.distancePoints(t.points[0],t.points[t.points.length-1])),i.direction&&(i.length||0===i.length)&&(i.length=ws.distancePoints(t.points[t.points.length-1],i.points[i.points.length-1]),i.direction=ws.direction(t.points[t.points.length-1],i.points[i.points.length-1])),""!==e.sourcePortID&&t.length<10)if(e.segments.length>2){const i=e.segments[2],r=ws.direction(i.points[0],i.points[1]);t.direction===Ca(r)?("Right"===t.direction?i.points[0].x=t.points[t.points.length-1].x=n.wrapper.corners.middleRight.x+20:"Left"===t.direction?i.points[0].x=t.points[t.points.length-1].x=n.wrapper.corners.middleLeft.x-20:i.points[0].y=t.points[t.points.length-1].y="Top"===t.direction?n.wrapper.corners.topCenter.y-20:n.wrapper.corners.bottomCenter.y+20,i.direction&&i.length&&(i.length=ws.distancePoints(i.points[0],i.points[i.points.length-1])),t.length=ws.distancePoints(t.points[0],t.points[t.points.length-1])):t.direction===r&&i.direction&&i.length?("Top"===t.direction||"Bottom"===t.direction?(i.points[0]=t.points[0],i.points[i.points.length-1].x=i.points[0].x):(i.points[0]=t.points[0],i.points[i.points.length-1].y=i.points[0].y),i.length=ws.distancePoints(i.points[0],i.points[i.points.length-1]),e.segments.splice(0,2)):t.length=20}else t.length=20;else if(t.length<1)if(""!==e.sourceID){if("Right"===i.direction?(r=n.wrapper.corners.middleRight,i.points[i.points.length-1].y=r.y):"Left"===i.direction?(r=n.wrapper.corners.middleLeft,i.points[i.points.length-1].y=r.y):"Top"===i.direction?(r=n.wrapper.corners.topCenter,i.points[i.points.length-1].x=r.x):(r=n.wrapper.corners.bottomCenter,i.points[i.points.length-1].x=r.x),i.length=ws.distancePoints(r,i.points[i.points.length-1]),e.segments.length>2){const t=e.segments[2];t.direction&&t.length&&(t.length=ws.distancePoints(i.points[i.points.length-1],t.points[t.points.length-1]))}e.segments.splice(0,1)}else e.segments.splice(0,1)}else t&&!i&&e.sourceID!==t.id&&e.segments&&null!==e.segments[0].direction&&t&&t instanceof Td&&this.changeSourceEndToNode(e,t),t&&i&&e.sourcePortID!==i&&e.segments&&null!==e.segments[0].direction&&t&&t instanceof Td&&this.changeSourceEndToPort(e,t,i)}changeSourceEndToPort(e,t,i){const n=this.diagram.getWrapper(t.wrapper,i),r={x:n.offsetX,y:n.offsetY},s=Sa(r,hp(t.wrapper),t.wrapper.bounds),o=e.segments[0],a=e.segments[1];if(o.direction!==s){const t=[];let i={};if(o.direction===Ca(s)){let n;i={},"Top"===s||"Bottom"===s?(n="Top"===s?{type:"Orthogonal",isTerminal:!0,direction:s,length:Math.abs(o.points[0].y-r.y)}:{type:"Orthogonal",isTerminal:!0,direction:s,length:Math.abs(r.y-o.points[0].y)},i=o.points[0].x>r.x?{type:"Orthogonal",isTerminal:!0,direction:"Right",length:o.points[0].x-r.x}:{type:"Orthogonal",isTerminal:!0,direction:"Left",length:r.x-o.points[0].x}):(n="Right"===s?{type:"Orthogonal",isTerminal:!0,direction:s,length:Math.abs(o.points[0].x-r.x)}:{type:"Orthogonal",isTerminal:!0,direction:s,length:Math.abs(r.x-o.points[0].x)},i=o.points[0].y>r.y?{type:"Orthogonal",direction:"Top",isTerminal:!0,length:o.points[0].y-r.y}:{type:"Orthogonal",direction:"Bottom",isTerminal:!0,length:r.y-o.points[0].y}),t.push(new Qa(e,"segments",n,!0)),t.push(new Qa(e,"segments",i,!0))}else i={type:"Orthogonal",direction:s,length:20,isTerminal:!0},t.push(new Qa(e,"segments",i,!0));o.direction!==Ca(s)&&("Top"===s||"Bottom"===s?(o.points[0].x=r.x,o.points[0].y=o.points[o.points.length-1].y="Top"===s?r.y-20:r.y+20):(o.points[0].y=r.y,o.points[0].x=o.points[o.points.length-1].x="Right"===s?r.x+20:r.x-20),o.length=ws.distancePoints(o.points[0],o.points[o.points.length-1]),a.length=ws.distancePoints(o.points[o.points.length-1],a.points[a.points.length-1])),e.segments=t.concat(e.segments)}else o.points[0]=r,"Top"===s||"Bottom"===s?o.points[o.points.length-1].x=r.x:o.points[o.points.length-1].y=r.y,o.length=ws.distancePoints(o.points[0],o.points[o.points.length-1]),a.length=ws.distancePoints(o.points[o.points.length-1],a.points[a.points.length-1])}removeTerminalSegment(e,t){for(let i=0;i<e.segments.length-2;i++){const n=e.segments[0];n.isTerminal&&(t?n.isTerminal=!1:(e.segments.splice(i,1),i--))}}changeSourceEndToNode(e,t){this.removeTerminalSegment(e);const i=t.wrapper.children[0].corners;let n,r;const s=e.segments[0],o=e.segments[1],a=[];if("Right"===s.direction||"Left"===s.direction)if(n="Left"===s.direction?i.middleLeft:i.middleRight,s.length>i.width||"Left"===s.direction&&n.x>=s.points[0].x||"Right"===s.direction&&n.x<=s.points[0].x)s.points[0].y=s.points[s.points.length-1].y=n.y,s.points[0].x=n.x,s.length=ws.distancePoints(s.points[0],s.points[s.points.length-1]),o.length=ws.distancePoints(s.points[s.points.length-1],o.points[o.points.length-1]);else{let t;t=o.direction?o.direction:ws.direction(o.points[0],o.points[o.points.length-1]),r="Bottom"===t?i.bottomCenter:i.topCenter,o.length&&o.direction&&(o.length="Top"===t?s.points[s.points.length-1].y-(r.y+20):r.y+20-s.points[s.points.length-1].y),s.length=s.points[s.points.length-1].x-r.x,s.direction=s.length>0?"Right":"Left",a.push(new Qa(e,"segments",{type:"Orthogonal",direction:t,length:20},!0)),e.segments=a.concat(e.segments)}else if(n="Bottom"===s.direction?i.bottomCenter:i.topCenter,s.length>i.height||"Top"===s.direction&&n.y>=s.points[0].y||"Bottom"===s.direction&&n.y<=s.points[0].y)s.points[0].x=s.points[s.points.length-1].x=n.x,s.points[0].y=n.y,s.length=ws.distancePoints(s.points[0],s.points[s.points.length-1]),o.length=ws.distancePoints(s.points[s.points.length-1],o.points[o.points.length-1]);else{let t;r="Left"===o.direction?i.middleLeft:i.middleRight,t=o.direction?o.direction:ws.direction(o.points[0],o.points[o.points.length-1]),o.length&&o.direction&&(o.length="Left"===t?s.points[s.points.length-1].x-(r.x+20):r.x+20-s.points[s.points.length-1].x),s.length=s.points[s.points.length-1].y-r.y,s.direction=s.length>0?"Bottom":"Top",a.push(new Qa(e,"segments",{type:"Orthogonal",direction:t,length:20},!0)),e.segments=a.concat(e.segments)}}translateBezierPoints(e,t,i,n,r,s,o){const a=e.segments.indexOf(r),l=e.segments[a];l&&("BezierSourceThumb"===t&&(l.vector1.angle||l.vector1.distance)?l.vector1={distance:e.distance(e.sourcePoint,s),angle:ws.findAngle(e.sourcePoint,s)}:"BezierTargetThumb"===t&&(l.vector2.angle||l.vector2.distance)?l.vector2={distance:e.distance(e.targetPoint,s),angle:ws.findAngle(e.targetPoint,s)}:("ConnectorSourceEnd"===t&&!e.sourceID||"ConnectorTargetEnd"===t&&!e.targetID)&&o&&Ka(l.vector1)&&Ka(l.vector2)?(ws.isEmptyPoint(l.point1)&&(l.bezierPoint1=el(e.sourcePoint,e.targetPoint)),ws.isEmptyPoint(l.point2)&&(l.bezierPoint2=el(e.targetPoint,e.sourcePoint))):"BezierSourceThumb"===t||"ConnectorSourceEnd"===t&&!o&&Ka(l.vector1)?(l.bezierPoint1.x+=i,l.bezierPoint1.y+=n,ws.isEmptyPoint(l.point1)&&!o||(l.point1={x:l.bezierPoint1.x,y:l.bezierPoint1.y})):("BezierTargetThumb"===t||"ConnectorTargetEnd"===t&&!o&&Ka(l.vector2))&&(l.bezierPoint2.x+=i,l.bezierPoint2.y+=n,ws.isEmptyPoint(l.point2)&&!o||(l.point2={x:l.bezierPoint2.x,y:l.bezierPoint2.y})))}dragTargetEnd(e,t,i,n,r,s,o,a){const l=this.diagram.nameTable[e.id];let h;const c=this.checkBoundaryConstraints(t,i,l.wrapper.bounds);if(wl(l)&&"BezierTargetThumb"!==s&&c&&_l(this.diagram)){if(h={targetPoint:l.targetPoint},l.targetPoint.x+=t,l.targetPoint.y+=i,"ConnectorTargetEnd"===s&&"Orthogonal"===l.type&&l.segments&&l.segments.length>0){const e=l.segments[l.segments.length-2];e&&2===l.segments[l.segments.length-1].points.length&&("Left"===e.direction||"Right"===e.direction?e.points[e.points.length-1].x=l.targetPoint.x:e.points[e.points.length-1].y=l.targetPoint.y,e.length=ws.distancePoints(e.points[0],e.points[e.points.length-1]),e.direction=ws.direction(e.points[0],e.points[e.points.length-1]))}"Bpmn"===l.shape.type&&"Default"===l.shape.sequence&&this.updatePathElementOffset(l)}if("Bezier"===l.type)if(h={targetPoint:l.targetPoint},a)this.translateBezierPoints(e,""===s?"ConnectorTargetEnd":s,t,i,a,r,!o);else for(let d=0;d<e.segments.length;d++)this.translateBezierPoints(e,""===s?"ConnectorTargetEnd":s,t,i,e.segments[d],r,!o);return n||this.updateEndPoint(l,h),this.diagram.realActions&fo.AnimationClick||this.diagram.refreshCanvasLayers(),c}dragControlPoint(e,t,i,n,r){const s=this.diagram.nameTable[e.id];if(("Straight"===s.type||"Bezier"===s.type)&&s.segments.length>0){if(void 0!==r&&s.segments[r])s.segments[r].point.x+=t,s.segments[r].point.y+=i;else for(let e=0;e<s.segments.length-1;e++)s.segments[e].point.x+=t,s.segments[e].point.y+=i;n||this.updateEndPoint(s)}return!0}rotatePropertyChnage(e){const t=this.diagram.selectedItems;let i=[];i=i.concat(t.nodes),i=i.concat(t.connectors),this.rotateObjects(t,i,e-t.rotateAngle,{x:t.offsetX,y:t.offsetY}),t.wrapper.rotateAngle=t.rotateAngle=e,this.diagram.updateSelector()}rotateObjects(e,t,i,n,r){n=n||{};const s=zs();let o;ks(s,i,n.x,n.y);for(const a of t){if(a instanceof Td){if(Sl(a)&&_l(this.diagram)){if(!1!==r||e!==a){o={rotateAngle:a.rotateAngle},a.rotateAngle+=i,a.rotateAngle=(a.rotateAngle+360)%360;const e=Ms(s,{x:a.offsetX,y:a.offsetY});a.offsetX=e.x,a.offsetY=e.y,this.diagram.nodePropertyChange(a,{},{offsetX:a.offsetX,offsetY:a.offsetY,rotateAngle:a.rotateAngle})}if(a.processId){const e=this.diagram.bpmnModule.getChildrenBound(this.diagram.nameTable[a.processId],a.id,this.diagram);this.diagram.bpmnModule.updateSubProcessess(e,a,this.diagram)}a.children&&a.children.length&&!a.container&&this.getChildren(a,t)}}else this.rotatePoints(a,i,n||{x:a.wrapper.offsetX,y:a.wrapper.offsetY});this.diagram.updateDiagramObject(a)}this.diagram.refreshCanvasLayers(),this.diagram.updateSelector()}snapConnectorEnd(e){return this.diagram.snapSettings.constraints&to.SnapToLines&&this.snappingModule&&this.diagram.snappingModule.snapConnectorEnd(e),e}snapAngle(e){return this.diagram.snapSettings.constraints&to.SnapToLines&&this.snappingModule?this.snappingModule.snapAngle(this.diagram,e):0}rotatePoints(e,t,i){if(!e.sourceWrapper||!e.targetWrapper){const n=zs();ks(n,t,i.x,i.y),e.sourcePoint=Ms(n,e.sourcePoint),e.targetPoint=Ms(n,e.targetPoint),"Bpmn"===e.shape.type&&"Default"===e.shape.sequence&&this.updatePathElementOffset(e),this.diagram.connectorPropertyChange(e,{},{sourcePoint:e.sourcePoint,targetPoint:e.targetPoint})}}updateInnerParentProperties(e){const t=this.diagram.isProtectedOnChange;this.diagram.protectPropertyChange(!0);const i=this.getAllDescendants(e,[],!1,!0);for(let n=0;n<i.length;n++){const e=this.diagram.nameTable[i[n].id];e.offsetX=e.wrapper.offsetX,e.offsetY=e.wrapper.offsetY,e.width=e.wrapper.width,e.height=e.wrapper.height}this.diagram.protectPropertyChange(t)}scale(e,t,i,n,r,s){const o=this.diagram.nameTable[e.id],a=o,l=[],h=o.wrapper;r||(r=e);const c=r.wrapper,d=function(e,t,i,n,r,s,o,a){let l={x:0,y:0};const h=zs();switch(ks(h,r,s,o),a.x){case 0:switch(a.y){case 0:l=Ms(h,{x:e,y:t});break;case.5:l=Ms(h,{x:e,y:t+n/2});break;case 1:l=Ms(h,{x:e,y:t+n})}break;case.5:switch(a.y){case 0:l=Ms(h,{x:e+i/2,y:t});break;case.5:l=Ms(h,{x:e+i/2,y:t+n/2});break;case 1:l=Ms(h,{x:e+i/2,y:t+n})}break;case 1:switch(a.y){case 0:l=Ms(h,{x:e+i,y:t});break;case.5:l=Ms(h,{x:e+i,y:t+n/2});break;case 1:l=Ms(h,{x:e+i,y:t+n})}}return{x:l.x,y:l.y}}(c.offsetX-c.actualSize.width*c.pivot.x,c.offsetY-c.actualSize.height*c.pivot.y,c.actualSize.width,c.actualSize.height,c.rotateAngle,c.offsetX,c.offsetY,n);if(void 0!==h.actualSize.width&&void 0!==h.actualSize.height&&_l(this.diagram)){if(a.children&&!a.container){const n=this.getAllDescendants(a,l);for(const e of n)this.scaleObject(t,i,d,e,h,r);e.wrapper.measure(new bs),e.wrapper.arrange(e.wrapper.desiredSize),this.diagram.updateGroupOffset(o),this.updateInnerParentProperties(a)}else this.scaleObject(t,i,d,o,h,r);const c=cp(e.wrapper);if(!this.checkBoundaryConstraints(void 0,void 0,c)&&s)return this.scale(e,1/t,1/i,n,void 0,!0),!1;this.diagram.updateDiagramObject(e)}return!0}getAllDescendants(e,t,i,n){const r=e,s=[];for(let o=0;o<r.children.length;o++)(e=this.diagram.nameTable[r.children[o]])&&(e.children?(i&&t.push(e),n&&s.push(e),t=this.getAllDescendants(e,t)):t.push(e));return n?s:t}getChildren(e,t){const i=e;if(e.children)for(let n=0;n<i.children.length;n++)t.push(e=this.diagram.nameTable[i.children[n]]);return t}cloneChild(e){return this.diagram.nameTable[e]}scaleObject(e,t,i,n,r,s){t=t<0?1:t;let o={};if(1!==(e=e<0?1:e)||1!==t){let r,a;if(n instanceof Td){const i=n;let s,l;o={width:n.wrapper.actualSize.width,height:n.wrapper.actualSize.height,offsetX:n.wrapper.offsetX,offsetY:n.wrapper.offsetY,margin:{top:i.margin.top,left:i.margin.left}},"Bpmn"===i.shape.type&&i.shape.activity.subProcess.processes&&i.shape.activity.subProcess.processes.length>0&&(l=this.diagram.bpmnModule.getChildrenBound(i,i.id,this.diagram),s=i.wrapper.bounds.containsRect(l)),r=i.wrapper.actualSize.width*e,a=i.wrapper.actualSize.height*t,void 0!==i.maxWidth&&0!==i.maxWidth&&(r=Math.min(i.maxWidth,r)),void 0!==i.minWidth&&0!==i.minWidth&&(r=Math.max(i.minWidth,r)),void 0!==i.maxHeight&&0!==i.maxHeight&&(a=Math.min(i.maxHeight,a)),void 0!==i.minHeight&&0!==i.minHeight&&(a=Math.max(i.minHeight,a)),s&&(r=Math.max(r,l.right-i.wrapper.bounds.x),a=Math.max(a,l.bottom-i.wrapper.bounds.y)),e=r/i.actualSize.width,t=a/i.actualSize.height}const l=zs();s||(s=n);const h=s.wrapper;if(ks(l,-h.rotateAngle,i.x,i.y),js(l,e,t,i.x,i.y),ks(l,h.rotateAngle,i.x,i.y),n instanceof Td){const e=n,t=Ms(l,{x:e.wrapper.offsetX,y:e.wrapper.offsetY}),i=e.wrapper.offsetX-e.wrapper.actualSize.width*e.pivot.x,s=e.wrapper.offsetY-e.wrapper.actualSize.height*e.pivot.y;if(r>0)if(e.processId){const i=this.diagram.nameTable[e.processId];(!i.maxWidth||e.margin.left+r<i.maxWidth)&&(e.width=r,e.offsetX=t.x)}else e.width=r,e.offsetX=t.x;if(a>0)if(e.processId){const i=this.diagram.nameTable[e.processId];(!i.maxHeight||e.margin.top+a<i.maxHeight)&&(e.height=a,e.offsetY=t.y)}else e.height=a,e.offsetY=t.y;const h=e.wrapper.offsetX-e.wrapper.actualSize.width*e.pivot.x,c=e.wrapper.offsetY-e.wrapper.actualSize.height*e.pivot.y;this.diagram.nameTable[e.processId]&&(e.margin.top+(c-s)<=0||e.margin.left+(h-i)<=0)?this.diagram.nodePropertyChange(n,{},{margin:{top:e.margin.top,left:e.margin.left}}):ah(this.diagram,n,!0)?lh(this.diagram,n):this.diagram.nodePropertyChange(n,o,{width:e.width,height:e.height,offsetX:e.offsetX,offsetY:e.offsetY,margin:{top:e.margin.top+(c-s),left:e.margin.left+(h-i)}})}else{const e=n,t={sourcePoint:e.sourcePoint,targetPoint:e.targetPoint};e.sourceWrapper&&e.targetWrapper||this.scaleConnector(e,l,t)}const c=this.diagram.nameTable[n.processId];if(c){const e=this.diagram.bpmnModule.getChildrenBound(c,n.id,this.diagram);this.diagram.bpmnModule.updateSubProcessess(e,n,this.diagram)}}}scaleConnector(e,t,i){e.sourcePoint=Ms(t,e.sourcePoint),e.targetPoint=Ms(t,e.targetPoint),"Bpmn"===e.shape.type&&"Default"===e.shape.sequence&&this.updatePathElementOffset(e),this.diagram.connectorPropertyChange(e,i,{sourcePoint:e.sourcePoint,targetPoint:e.targetPoint})}portDrag(e,t,i,n){let r,s;const o=this.findTarget(t,e),a=cp(e.wrapper);o&&Wl(o)&&(r=this.getPortChanges(e,o),o.offset.x+=i/a.width,o.offset.y+=n/a.height,s=this.getPortChanges(e,o),this.diagram.nodePropertyChange(e,r,s),this.diagram.updateDiagramObject(e))}labelDrag(e,t,i,n){const r=this.findTarget(t,e),s=hp(e.wrapper),o=this.getAnnotationChanges(e,r);r instanceof jo?(r.offset.x+=i/s.width,r.offset.y+=n/s.height):(this.updatePathAnnotationOffset(e,r,i,n),r instanceof Ho&&(r.alignment="Center"));const a=this.getAnnotationChanges(e,r);e instanceof Td?this.diagram.nodePropertyChange(e,o,a):this.diagram.connectorPropertyChange(e,o,a),this.diagram.updateDiagramObject(e),$p(this.diagram,r,!1,t)||this.labelSelect(e,t)}updatePathAnnotationOffset(e,t,i,n,r,s){const o=this.diagram.getWrapper(e.wrapper,t.id);let a;const l=e.intermediatePoints;let h,c,d=0,p=0;const u=r||{x:o.offsetX+i,y:o.offsetY+n},g=this.getInterceptWithSegment(u,l);let m=l[l.length-1];if(p=ws.getLengthFromListOfPoints(l),g.length>0){if(t.dragLimit.top||t.dragLimit.bottom||t.dragLimit.left||t.dragLimit.right){const i={minDistance:null};m=this.getRelativeOffset(u,l,i);const n={minDistance:null};c=this.getRelativeOffset(u,g,n),m=null!=i&&n.minDistance<i.minDistance?c:lc(e.intermediatePoints,t).point}else c=g[g.length-1],m=c;if(m){let e,t;for(e=0;e<l.length;e++){if(null!=h){if(t=Ds.toBounds([h,l[e]]),t.containsPoint(m)){d+=ws.findLength(h,m);break}d+=ws.findLength(h,l[e])}h=l[e]}a={x:d/p,y:0}}this.updateLabelMargin(e,t,a,u,s,i,n)}else this.updateLabelMargin(e,t,null,u,s,i,n)}getRelativeOffset(e,t,i){let n,r,s,o;for(o=0;o<t.length;o++)s=t[o],r=Math.round(Math.sqrt(Math.pow(e.x-s.x,2)+Math.pow(e.y-s.y,2))),null!==i.minDistance&&Math.min(Math.abs(i.minDistance),Math.abs(r))!==Math.abs(r)||(n=s,i.minDistance=r);return n}dragLimitValue(e,t,i,n){let r=!1,s=!1;return i.x>=t.x-e.dragLimit.left-n.width/2&&i.x<=t.x+e.dragLimit.right+n.width/2&&(r=!0),i.y>=t.y-e.dragLimit.top-n.height/2&&i.y<=t.y+e.dragLimit.bottom+n.height/2&&(s=!0),{x:r,y:s}}updateLabelMargin(e,t,i,n,r,s,o){if(i=i||{x:t.offset,y:0},t&&i&&i.x>0&&i.x<1){const a=ws.getLengthFromListOfPoints(e.intermediatePoints),l=this.getPointAtLength(a*i.x,e.intermediatePoints,0),h=this.diagram.scrollSettings.currentZoom,c=t.dragLimit;if(c.top||c.bottom||c.left||c.right){this.diagram.getWrapper(e.wrapper,t.id);const i=new Ds(0,0,0,0),r=this.diagram.getWrapper(e.wrapper,t.id);i.x=r.offsetX/h+s,i.y=r.offsetY/h+o,i.width=r.bounds.width/h,i.height=r.bounds.height/h;const a=new Ds(l.x-(c.left||0)-i.width/2,l.y-(c.top||0)-i.height/2,(c.left||0)+(c.right||0)+i.width,(c.top||0)+(c.bottom||0)+i.height);if(a.containsPoint(n))n=n;else{let e;e=this.boundsInterSects([l,n],a,!1);for(const t of e)n=t}const d=this.dragLimitValue(t,l,n,i);t.margin={left:d.x?n.x-l.x:t.margin.left,top:d.y?n.y-l.y:t.margin.top,right:0,bottom:0}}else t.margin={left:n.x-l.x,top:n.y-l.y,right:0,bottom:0};t.offset=i.x,r&&(t.width=r.width,t.height=r.height)}}boundsInterSects(e,t,i){let n;return t&&(n=this.intersect(e,[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height},{x:t.x,y:t.y}],i)),n}intersect(e,t,i){const n=[];for(let r=0;r<e.length-1;r++)for(let i=0;i<t.length-1;i++){const s=nc(e[r],e[r+1],t[i],t[i+1]);0!==s.x&&0!==s.y&&n.push(s)}return n}getPointAtLength(e,t,i){let n,r,s=0,o={x:0,y:0};for(let a=0;a<t.length;a++)if(r=t[a],n){{const t=ws.findLength(n,r);let i,a,l,h;if(s+t>=e){i=e-s,a=ws.findAngle(n,r),l=i*Math.cos(a*Math.PI/180),h=i*Math.sin(a*Math.PI/180),o={x:n.x+l,y:n.y+h};break}s+=t}n=r}else n=r;return o}getInterceptWithSegment(e,t){const i=[];let n,r,s=[],o=[];const a=ws.findLength({x:0,y:0},{x:this.diagram.scroller.viewPortWidth,y:this.diagram.scroller.viewPortHeight});for(let l=1;l<t.length;l++){o=[t[l-1],t[l]],s=[],r=Math.round(ws.findAngle(o[0],o[1])%360),n=Math.round(ws.findAngle(o[1],o[0])%360);const h=r>0&&r<=90||r>180&&r<=270?90:-90;s.push(ws.transform(e,r+h,a)),s.push(ws.transform(e,n+h,a));const c=ic({x1:o[0].x,y1:o[0].y,x2:o[1].x,y2:o[1].y},{x1:s[0].x,y1:s[0].y,x2:s[1].x,y2:s[1].y});c.enabled&&i.push(c.intersectPt)}return i}getAnnotationChanges(e,t){const i={};return i[Tc(e,t.id,!0)]={width:t.width,height:t.height,offset:e instanceof Td?{x:t.offset.x,y:t.offset.y}:t.offset,rotateAngle:t.rotateAngle,margin:{left:t.margin.left,right:t.margin.right,top:t.margin.top,bottom:t.margin.bottom},horizontalAlignment:t.horizontalAlignment,verticalAlignment:t.verticalAlignment,alignment:e instanceof ol?t.alignment:void 0},{annotations:i}}getPortChanges(e,t){const i={};return i[Tc(e,t.id,!1)]={offset:t.offset},{ports:i}}labelRotate(e,t,i,n){let r,s;r=this.getAnnotationChanges(e,t),zs();const o=this.diagram.getWrapper(e.wrapper,t.id);let a=la({x:o.offsetX,y:o.offsetY},i)+90;const l=this.snapAngle(a);a=0!==l?l:a,t instanceof Ho&&t.segmentAngle&&(a-=ac(e.intermediatePoints,t).angle),a=(a+360)%360,t.rotateAngle+=a-(t.rotateAngle+o.parentTransform),t.margin.bottom+="Top"===o.verticalAlignment?-t.height/2:"Bottom"===o.verticalAlignment?t.height/2:0,t.margin.right+="Left"===o.horizontalAlignment?-t.width/2:"Right"===o.horizontalAlignment?t.width/2:0,t instanceof Ho?t.alignment="Center":t.horizontalAlignment=t.verticalAlignment="Center",n.wrapper.rotateAngle=n.rotateAngle=t.rotateAngle,s=this.getAnnotationChanges(e,t),e instanceof Td?this.diagram.nodePropertyChange(e,r,s):this.diagram.connectorPropertyChange(e,r,s),this.diagram.updateDiagramObject(e)}labelResize(e,t,i,n,r,s){let o,a,l;o=this.getAnnotationChanges(e,t);const h=s.wrapper.children[0];if(i&&1!==i||n&&1!==n){const s=zs(),o=zs();ks(s,-e.rotateAngle,e.offsetX,e.offsetY),l=(h.rotateAngle+(e instanceof Td?e.rotateAngle:0)+360)%360,ks(o,-l,r.x,r.y),js(o,i,n,r.x,r.y),ks(o,l,r.x,r.y);let a=Ms(o,{x:h.offsetX,y:h.offsetY});const c=h.actualSize.height*n,d=h.actualSize.width*i,p=this.findTarget(h,e);if(p instanceof Ho)this.updatePathAnnotationOffset(e,t,0,0,a,new bs(d,c));else{const t=hp(e.wrapper);a=Ms(s,a),a.x=a.x-h.margin.left+h.margin.right,a.y=a.y-h.margin.top+h.margin.bottom,a.y+="Top"===p.verticalAlignment?-c/2:"Bottom"===p.verticalAlignment?c/2:0,a.x+="Left"===p.horizontalAlignment?-d/2:"Right"===p.horizontalAlignment?d/2:0;const i=t.width/(a.x-t.x),n=t.height/(a.y-t.y);d>1&&(p.width=d,p.offset.x=1/i),c>1&&(p.height=c,p.offset.y=1/n)}}t instanceof Ho&&(t.alignment="Center"),a=this.getAnnotationChanges(e,t),e instanceof Td?this.diagram.nodePropertyChange(e,o,a):this.diagram.connectorPropertyChange(e,o,a),this.diagram.updateDiagramObject(e)}getSubProcess(e){const t={nodes:[],connectors:[]};let i;return e instanceof Td?i=e.processId:e&&e.nodes&&e.nodes.length&&e.nodes[0].processId&&(i=e.nodes[0].processId),i?(t.nodes.push(dp(this.diagram.nameTable[i])),t):t}checkBoundaryConstraints(e,t,i){const n=this.diagram.pageSettings,r=this.diagram.pageSettings.boundaryConstraints,s=this.diagram.scroller;if("Page"===r||"Diagram"===r){const o=i?void 0:this.diagram.selectedItems.wrapper.bounds,a="Page"===r?n.height:s.viewPortHeight,l=i,h=(i?l.left:o.left)+(e||0),c=(i?l.top:o.top)+(t||0),d=(i?l.bottom:o.bottom)+(t||0);return(i?l.right:o.right)+(e||0)<=("Page"===r?n.width:s.viewPortWidth)&&h>=0&&d<=a&&c>=0}return!0}dragSelectedObjects(e,t){let i=this.diagram.selectedItems;if(this.state&&!this.state.backup&&(this.state.backup={},this.state.backup.offsetX=i.offsetX,this.state.backup.offsetY=i.offsetY),i=oh(this.diagram,i)||i,this.checkBoundaryConstraints(e,t)){this.diagram.diagramActions=this.diagram.diagramActions|go.PreventZIndexOnDragging|go.DragUsingMouse;const n=this.diagram.selectedObject.actualObject;return(n&&n instanceof Td&&n.isLane&&Xh(n,this.diagram)||!n||!n.isLane)&&this.diagram.drag(i,e,t),this.diagram.diagramActions=this.diagram.diagramActions&~(go.PreventZIndexOnDragging|go.DragUsingMouse),this.diagram.refreshCanvasLayers(),!0}return!1}scaleSelectedItems(e,t,i){let n=this.diagram.selectedItems;return this.state&&!this.state.backup&&(this.state.backup={},this.state.backup.offsetX=n.offsetX,this.state.backup.offsetY=n.offsetY,this.state.backup.width=n.width,this.state.backup.height=n.height,this.state.backup.pivot=i),n=oh(this.diagram,n)||n,this.diagram.scale(n,e,t,i)}rotateSelectedItems(e){let t=this.diagram.selectedItems;return this.state&&!this.state.backup&&(this.state.backup={},this.state.backup.angle=t.rotateAngle),t=oh(this.diagram,t)||t,this.diagram.rotate(t,e)}hasSelection(){return qp(this.diagram)}isSelected(e){return $p(this.diagram,e)}initExpand(e){const t=this.diagram.isProtectedOnChange;this.diagram.protectPropertyChange(!0);const i=e.target||e.source,n={isExpanded:i.isExpanded};i.isExpanded=!i.isExpanded,this.diagram.preventNodesUpdate=!0,this.diagram.diagramActions|=go.PreventIconsUpdate,this.diagram.nodePropertyChange(i,n,{isExpanded:i.isExpanded}),this.diagram.diagramActions=this.diagram.diagramActions&~go.PreventIconsUpdate,this.diagram.preventNodesUpdate=!1;for(const r of this.diagram.views){const e=this.diagram.views[r];e instanceof Mu||this.diagram.refreshCanvasDiagramLayer(e)}this.diagram.protectPropertyChange(t)}expandNode(e,t,i){const n=this.diagram.preventNodesUpdate,r=e.isExpanded;this.diagram.preventNodesUpdate=!0,this.diagram.preventConnectorsUpdate=!0,this.expandCollapse(e,r,this.diagram),e.isExpanded=r;const s=this.diagram.layout.fixedNode;this.diagram.layout.fixedNode=e.id,this.diagram.diagramActions!=go.Render&&this.diagram.layoutAnimateModule&&this.diagram.layout.enableAnimation&&this.diagram.organizationalChartModule&&(this.diagram.organizationalChartModule.isAnimation=!0),this.diagram.blazorActions|=Ks.expandNode;let o={};if(i||(o=this.diagram.doLayout()),this.diagram.blazorActions&=~Ks.expandNode,this.diagram.preventNodesUpdate=n,this.diagram.preventConnectorsUpdate=!1,this.diagram.layoutAnimateModule&&this.diagram.organizationalChartModule&&!i)this.diagram.allowServerDataBinding=!1,this.layoutAnimateModule.expand(this.diagram.layout.enableAnimation,o,e,this.diagram),this.diagram.allowServerDataBinding=!0;else{const t={element:dp(e),state:!!e.isExpanded};this.triggerEvent(vo.expandStateChange,t),this.diagram.lineRoutingModule&&this.diagram.constraints&lo.LineRouting&&this.diagram.resetSegments()}return this.diagram.layout.fixedNode=""===s?"":this.diagram.layout.fixedNode,o}getparentexpand(e,t,i,n){let r;for(let s=0;s<e.inEdges.length;s++){const o=t.nameTable[e.inEdges[s]],a=t.nameTable[o.sourceID];if(a.isExpanded&&!i&&a.id!==n.sourceID&&o.visible)return!1;r=!0}return r}expandCollapse(e,t,i){for(let n=0;n<e.outEdges.length;n++){const r=i.nameTable[e.outEdges[n]],s=i.nameTable[r.targetID],o=this.getparentexpand(s,i,t,r);r.visible=t;const a={visible:s.visible,style:{opacity:s.wrapper.style.opacity}},l={visible:s.visible,style:{opacity:s.wrapper.style.opacity}};o&&(s.isExpanded&&this.expandCollapse(s,t,i),s.visible=t,s.style.opacity=this.diagram.layoutAnimateModule&&this.diagram.layout.enableAnimation&&t?.1:s.style.opacity,i.nodePropertyChange(s,a,l)),i.connectorPropertyChange(r,a,l)}}updateNodeDimension(e,t){e instanceof Td&&(e.offsetX=t.x+t.width/2,e.offsetY=t.y+t.height/2,e.width=t.width,e.height=t.height,e.wrapper.children[0].canMeasurePath=!0,this.diagram.nodePropertyChange(e,{},{width:t.width,height:t.height,offsetX:e.offsetX,offsetY:e.offsetY}),"SVG"!==this.diagram.mode&&this.diagram.refreshDiagramLayer())}updateConnectorPoints(e,t){e instanceof ol&&(this.diagram.connectorPropertyChange(e,{},{targetPoint:e.targetPoint}),this.diagram.updateDiagramObject(e))}updateSelectedNodeProperties(e){if(this.diagram.lineRoutingModule&&this.diagram.constraints&lo.LineRouting){this.diagram.protectPropertyChange(!0);let t=[];const i=[],n=this.diagram.selectedObject.actualObject,r=this.diagram.selectedObject.helperObject;if(r&&n){const e=r.offsetX-n.offsetX,i=r.offsetY-n.offsetY,s=r.width-n.width,o=r.height-n.height,a=r.rotateAngle-n.rotateAngle;if(this.diagram.selectedItems.nodes.length+this.diagram.selectedItems.connectors.length>0&&(this.diagram.selectedItems.wrapper.rotateAngle=this.diagram.selectedItems.rotateAngle=r.rotateAngle),n instanceof Td&&"SwimLane"!==n.shape.type&&!n.isLane&&!n.isPhase&&!n.isHeader)n.offsetX===n.wrapper.offsetX&&n.offsetY===n.wrapper.offsetY&&n.width===n.wrapper.width&&n.height===n.wrapper.height&&n.rotateAngle===n.wrapper.rotateAngle||(n.offsetX+=e,n.offsetY+=i,n.width+=s,n.height+=o,n.rotateAngle+=a,this.diagram.nodePropertyChange(n,{},{offsetX:n.offsetX,offsetY:n.offsetY,width:n.width,height:n.height,rotateAngle:n.rotateAngle})),t=this.diagram.spatialSearch.findObjects(n.wrapper.outerBounds);else if(n instanceof Ld)for(let r=0;r<n.nodes.length;r++){const l=n.nodes[r];l instanceof Td&&"SwimLane"!==l.shape.type&&!l.isLane&&!l.isPhase&&!l.isHeader&&(l.offsetX+=e,l.offsetY+=i,l.width+=s,l.height+=o,l.rotateAngle+=a,this.diagram.nodePropertyChange(l,{},{offsetX:l.offsetX,offsetY:l.offsetY,width:l.width,height:l.height,rotateAngle:l.rotateAngle}),t=t.concat(this.diagram.spatialSearch.findObjects(n.wrapper.outerBounds)))}}else e instanceof ol?t.push(e):e instanceof Ld&&e.connectors.length&&(t=t.concat(e.connectors));for(let e=0;e<t.length;e++)t[e]instanceof ol&&-1===i.indexOf(t[e].id)&&i.push(t[e].id);this.diagram.lineRoutingModule.renderVirtualRegion(this.diagram,!0);for(let e=0;e<i.length;e++){const t=this.diagram.nameTable[i[e]];t instanceof ol&&"Orthogonal"===t.type&&this.diagram.lineRoutingModule.refreshConnectorSegments(this.diagram,t,!0)}this.updateSelector(),this.diagram.protectPropertyChange(!1)}}drawSelectionRectangle(e,t,i,n){this.diagram.drawSelectionRectangle(e,t,i,n)}startGroupAction(){this.diagram.startGroupAction()}endGroupAction(){this.diagram.endGroupAction()}removeChildFromBPmn(e,t,i){const n=this.diagram.nameTable[e.id]||e.nodes[0];if(i&&n&&n.processId&&n.processId===i.wrapper.id){const e=dp(n);e.processId=n.processId,this.diagram.startGroupAction();let t=[];t=t.concat(n.outEdges,n.inEdges);for(let n=t.length-1;n>=0;n--){const e=this.diagram.nameTable[t[n]];e&&this.diagram.remove(e)}const i=this.diagram.nameTable[n.processId].shape.activity.subProcess.processes||[];i.splice(i.indexOf(n.id),1),this.diagram.bpmnModule.removeChildFromBPMN(this.diagram.nameTable[n.processId].wrapper,n.id),this.diagram.nameTable[n.id].processId="",n.offsetX=n.wrapper.offsetX,n.offsetY=n.wrapper.offsetY;const r=dp(n);this.addHistoryEntry({type:"PositionChanged",redoObject:{nodes:[r]},undoObject:{nodes:[e]},category:"Internal"}),this.diagram.endGroupAction()}}isDroppable(e,t){const i=this.diagram.nameTable[e.id]||e.nodes[0];return!(!i||"TextAnnotation"!==i.shape.shape&&i&&"Bpmn"===i.shape.type&&(i.processId===t.id||i.id===t.processId||"Bpmn"===t.shape.type&&t.shape.activity.subProcess.collapsed))}renderHighlighter(e,t,i){if(new Ds,e.target instanceof Td||t&&e.source instanceof Td){const n=this.findTarget(t?e.sourceWrapper:e.targetWrapper,t?e.source:e.target,i,!0);let r;if(n instanceof dd){const t=n.id,i=e.target,s=i.wrapper.children[0].children[0].children[2];for(const e of s.children)if(e.id===i.id+"_"+t){r=e.children[0];break}}else r=n instanceof Td?n.wrapper:t?e.sourceWrapper:e.targetWrapper;this.diagram.renderHighlighter(r)}}mouseOver(e,t,i){return!0}snapPoint(e,t,i,n){let r;r={x:i,y:n};let s=r;return this.snappingModule&&(s=this.diagram.snappingModule.snapPoint(this.diagram,this.diagram.selectedItems,t.x<e.x,t.y<e.y,r,e,t)),s}removeSnap(){this.diagram.snapSettings.constraints&to.SnapToObject&&this.snappingModule&&this.snappingModule.removeGuidelines(this.diagram)}dropAnnotation(e,t){const i=e instanceof Td?e:e.nodes[0];this.diagram.bpmnModule&&"Bpmn"===t.shape.type&&"TextAnnotation"===i.shape.shape&&(i.hasTarget=t.id,i.shape.annotation.nodeId=t.id,this.diagram.currentSymbol||(this.diagram.addTextAnnotation(i.shape.annotation,t),i.shape.annotation.nodeId="",this.diagram.remove(i)),this.diagram.refreshDiagramLayer())}drop(e,t,i){if(this.diagram.bpmnModule){const i=e instanceof Td?e:e.nodes[0];i&&"Bpmn"===i.shape.type&&"Bpmn"===t.shape.type&&(this.diagram.bpmnModule.dropBPMNchild(t,e instanceof Td?e:e.nodes[0],this.diagram),this.diagram.refreshDiagramLayer())}}addHistoryEntry(e){this.diagram.addHistoryEntry(e)}align(e,t,i){if(e.length>0){let n=0;e[0]=this.diagram.nameTable[e[0].id]||e[0];const r="Object"===i?cp(e[0].wrapper):this.diagram.selectedItems.wrapper.bounds;let s={nodes:[],connectors:[]},o={nodes:[],connectors:[]};for(n="Object"===i?n+1:n;n<e.length;n++){let i=0,a=0;e[n]=this.diagram.nameTable[e[n].id]||e[n];const l=cp(e[n].wrapper);"Left"===t?i=r.left+l.width/2-l.center.x:"Right"===t?i=r.right-l.width/2-l.center.x:"Top"===t?a=r.top+l.height/2-l.center.y:"Bottom"===t?a=r.bottom-l.height/2-l.center.y:"Center"===t?i=r.center.x-l.center.x:"Middle"===t&&(a=r.center.y-l.center.y),s=this.storeObject(s,e[n]),this.drag(e[n],i,a),this.diagram.updateSelector(),o=this.storeObject(o,e[n])}s=dp(s),o=dp(o);const a={type:"Align",category:"Internal",undoObject:dp(s),redoObject:dp(o)};this.addHistoryEntry(a)}}distribute(e,t){if(e.length>0){let i=0,n=0,r=0,s=0,o=0,a=0,l=0,h=0,c={nodes:[],connectors:[]},d={nodes:[],connectors:[]};for(i=0;i<e.length;i++)e[i]=this.diagram.nameTable[e[i].id]||e[i];for(e=function(e,t){let i,n=0,r=0;for(n=0;n<e.length;n++){const s=cp(e[n].wrapper);for(r=0;r<e.length;r++){const o=cp(e[r].wrapper);"Top"===t||"Bottom"===t||"BottomToTop"===t||"Middle"===t?s.center.y>o.center.y&&(i=e[n],e[n]=e[r],e[r]=i):s.center.x>o.center.x&&(i=e[n],e[n]=e[r],e[r]=i)}}return e}(e,t),i=1;i<e.length;i++)n=n+e[i].wrapper.bounds.topRight.x-e[i-1].wrapper.bounds.topRight.x,r=r+e[i].wrapper.bounds.topLeft.x-e[i-1].wrapper.bounds.topLeft.x,s=s+e[i].wrapper.bounds.topRight.y-e[i-1].wrapper.bounds.topRight.y,o=o+e[i].wrapper.bounds.bottomRight.y-e[i-1].wrapper.bounds.bottomRight.y,a=a+e[i].wrapper.bounds.center.x-e[i-1].wrapper.bounds.center.x,l=l+e[i].wrapper.bounds.center.y-e[i-1].wrapper.bounds.center.y,h=h+e[i].wrapper.bounds.topRight.y-e[i-1].wrapper.bounds.bottomRight.y;for(i=1;i<e.length-1;i++){let p=0,u=0;const g=cp(e[i-1].wrapper),m=cp(e[i].wrapper);"RightToLeft"===t||"Center"===t?p=g.center.x-m.center.x+a/(e.length-1):"Right"===t?p=g.topRight.x-m.topRight.x+n/(e.length-1):"Left"===t?p=g.topLeft.x-m.topLeft.x+r/(e.length-1):"Middle"===t?u=g.center.y-m.center.y+l/(e.length-1):"Top"===t?u=g.topRight.y-m.topRight.y+s/(e.length-1):"Bottom"===t?u=g.bottomRight.y-m.bottomRight.y+o/(e.length-1):"BottomToTop"===t&&(u=g.bottomRight.y-m.topRight.y+h/(e.length-1)),c=this.storeObject(c,e[i]),this.drag(e[i],p,u),this.diagram.updateSelector(),d=this.storeObject(d,e[i])}c=dp(c),d=dp(d);const p={type:"Distribute",category:"Internal",undoObject:dp(c),redoObject:dp(d)};this.addHistoryEntry(p)}}sameSize(e,t){if(e.length>0){let i=0;const n={x:.5,y:.5};e[0]=this.diagram.nameTable[e[0].id]||e[0];const r=cp(e[0].wrapper);let s={nodes:[],connectors:[]},o={nodes:[],connectors:[]};for(i=1;i<e.length;i++){e[i]=this.diagram.nameTable[e[i].id]||e[0];const a=cp(e[i].wrapper);let l=1,h=1;"Width"===t?l=r.width/a.width:"Height"===t?h=r.height/a.height:"Size"===t&&(l=r.width/a.width,h=r.height/a.height),s=this.storeObject(s,e[i]),this.scale(e[i],l,h,n),o=this.storeObject(o,e[i])}this.diagram.updateSelector(),s=dp(s),o=dp(o);const a={type:"Sizing",category:"Internal",undoObject:dp(s),redoObject:dp(o)};this.addHistoryEntry(a)}}storeObject(e,t){return t instanceof Td?e.nodes.push(dp(t)):e.connectors.push(dp(t)),e}updatePanState(e){if(e)this.diagram.realActions=this.diagram.realActions|fo.PanInProgress;else{this.diagram.dataBind();const e=this.diagram.scrollSettings;this.diagram.realActions=this.diagram.realActions&~fo.PanInProgress;const t={VerticalOffset:e.verticalOffset,HorizontalOffset:e.horizontalOffset,ViewportHeight:e.viewPortHeight,ViewportWidth:e.viewPortWidth,CurrentZoom:e.currentZoom};this.triggerEvent(vo.scrollChange,{oldValue:t,newValue:t,source:this.diagram,panState:"Completed"})}}dataBinding(){this.diagram.dataBind()}setBlazorDiagramProps(e){this.diagram.setBlazorDiagramProps(e)}scroll(e,t,i){this.diagram.pan((e=this.diagram.constraints&lo.PanX?e:0)*this.diagram.scroller.currentZoom,(t=this.diagram.constraints&lo.PanY?t:0)*this.diagram.scroller.currentZoom,i)}drawHighlighter(e){this.diagram.renderHighlighter(e.wrapper)}removeHighlighter(){this.diagram.clearHighlighter()}renderContainerHelper(e){return oh(this.diagram,e)}isParentAsContainer(e,t){return ah(this.diagram,e,t)}dropChildToContainer(e,t){this.diagram.diagramActions&go.PreventLaneContainerUpdate||ch(this.diagram,e,t)}updateLaneChildrenZindex(e,t){let i=this.findLeastIndexObject(e,t),n=this.diagram.nameTable[t.parentId];if(n.zIndex>i.zIndex){let e=this.diagram.layers.indexOf(this.diagram.getActiveLayer());const s=this.diagram.layers[e].zIndexTable,o=JSON.parse(JSON.stringify(s));let a=i.zIndex,l=n.zIndex;for(var r=l;r>=a;r--)a!==r?s[r-1]?(s[r]=s[r-1],this.diagram.nameTable[s[r]].zIndex=r):(s[r-1]=s[r],this.diagram.nameTable[s[r-1]].zIndex=r,delete s[r]):this.swapZIndexObjects(l,s,n.id,o);"SVG"===this.diagram.mode?(this.moveSvgNode(t.parentId,i.id),this.updateNativeNodeIndex(t.parentId,i.id)):this.diagram.refreshCanvasLayers()}}findLeastIndexConnector(e,t,i){for(let n=0;n<e.length;n++){let t=this.diagram.nameTable[e[n]];i.zIndex>t.zIndex&&(i=t)}return i}findLeastIndexObject(e,t){let i=e;return e instanceof Td&&(i=this.findLeastIndexConnector(e.inEdges,t,i),i=this.findLeastIndexConnector(e.outEdges,t,i)),i}checkSelection(e,t){let i;if(1===e.nodes.length&&0===e.connectors.length)if(ah(this.diagram,e.nodes[0],!0)){i="SwimLane"===e.nodes[0].shape?e.nodes[0]:this.diagram.nameTable[e.nodes[0].parentId];const n=e.nodes[0];if("SwimLane"===i.shape.type){const e="Horizontal"===i.shape.orientation;(n.isPhase&&(e&&"ResizeSouth"===t||!e&&"ResizeEast"===t)||n.isLane&&(e&&"ResizeEast"===t||!e&&"ResizeSouth"===t))&&kh(this.diagram,i,t)}else if("Grid"===i.container.type)if("Horizontal"===i.container.orientation&&1===n.rowIndex||"Vertical"===i.container.orientation&&n.rowIndex>0&&n.columnIndex>0){if("ResizeSouth"===t)for(let e=0;e<this.diagram.nodes.length;e++){const t=this.diagram.nodes[e];if(t.rowIndex===i.rows.length-1&&0===t.columnIndex){this.select(t);break}}}else if("ResizeEast"===t)for(let e=0;e<this.diagram.nodes.length;e++){const t=this.diagram.nodes[e];if(1===t.rowIndex&&t.columnIndex===i.columns.length-1){this.select(t);break}}}else kh(this.diagram,e.nodes[0],t)}zoom(e,t,i,n){this.diagram.scroller.zoom(e,t*this.diagram.scroller.currentZoom,i*this.diagram.scroller.currentZoom,n)}}class Ou{constructor(e){this.transform={tx:0,ty:0,scale:1},this.oldCollectionObjects=[],this.removeCollection=[],this.vPortWidth=0,this.vPortHeight=0,this.currentZoomFActor=1,this.hOffset=0,this.vOffset=0,this.scrolled=!1,this.hScrollSize=0,this.vScrollSize=0,this.diagram=e,this.objects=[],this.transform=e.scroller?e.scroller.transform:{tx:0,ty:0,scale:1},this.vPortWidth=e.scrollSettings.viewPortWidth,this.vPortHeight=e.scrollSettings.viewPortHeight,this.currentZoomFActor=e.scrollSettings.currentZoom,this.hOffset=e.scrollSettings.horizontalOffset,this.vOffset=e.scrollSettings.verticalOffset}get viewPortHeight(){return this.vPortHeight}set viewPortHeight(e){this.vPortHeight=e,this.diagram.scrollSettings.viewPortHeight=e}get currentZoom(){return this.currentZoomFActor}set currentZoom(e){this.currentZoomFActor=e,this.diagram.scrollSettings.currentZoom=e}get viewPortWidth(){return this.vPortWidth}set viewPortWidth(e){this.vPortWidth=e,this.diagram.scrollSettings.viewPortWidth=e}get horizontalOffset(){return this.hOffset}set horizontalOffset(e){this.hOffset=e,Math.abs(this.hOffset-this.diagram.scrollSettings.horizontalOffset)>1&&(this.diagram.realActions=this.diagram.realActions|fo.hScrollbarMoved,this.scrolled=!0),this.diagram.scrollSettings.horizontalOffset=e}get verticalOffset(){return this.vOffset}set verticalOffset(e){this.vOffset=e,Math.abs(this.vOffset-this.diagram.scrollSettings.verticalOffset)>1&&(this.diagram.realActions=this.diagram.realActions|fo.vScrollbarMoved,this.scrolled=!0),this.diagram.scrollSettings.verticalOffset=e}updateScrollOffsets(e,t){let i=0,n=0;const r=this.getPageBounds(void 0,void 0,!0);r.x*=this.currentZoom,r.y*=this.currentZoom,r.width*=this.currentZoom,r.height*=this.currentZoom,i=Math.max(0,e-r.left),n=Math.max(0,t-r.top),void 0!==e&&void 0!==t?(this.horizontalOffset=i,this.verticalOffset=n,this.diagram.setOffset(i,n)):this.diagram.setOffset(-this.horizontalOffset-r.x,-this.verticalOffset-r.y),this.transform={tx:Math.max(this.horizontalOffset,-r.left)/this.currentZoom,ty:Math.max(this.verticalOffset,-r.top)/this.currentZoom,scale:this.currentZoom}}setScrollOffset(e,t){this.scrolled=!1;const i=this.getPageBounds(void 0,void 0,!0);i.x*=this.currentZoom,i.y*=this.currentZoom,i.width*=this.currentZoom,i.height*=this.currentZoom;const n=-i.left,r=-i.top;let s=!1;const o=this.viewPortWidth*this.currentZoom,a=this.viewPortHeight*this.currentZoom,l=n-e;if(l!==this.horizontalOffset){n<this.horizontalOffset&&(this.horizontalOffset>l?this.horizontalOffset-=e:this.horizontalOffset=l,s=!0);const t=Math.max(i.right+this.vScrollSize,o);if(!s&&t<-l+this.viewPortWidth){const e=-l+o-this.vScrollSize,t=-this.horizontalOffset+o-this.vScrollSize;this.horizontalOffset=e<t||e-i.right>e-t?l:-(i.right+this.vScrollSize-o),s=!0}s||(this.horizontalOffset=n-e)}s=!1;const h=r-t;if(h!==this.verticalOffset){r<this.verticalOffset&&(this.verticalOffset>h?this.verticalOffset-=t:this.verticalOffset=h,s=!0);const e=Math.max(i.bottom+this.hScrollSize,a);if(!s&&e<-h+a){const e=-h+a-this.hScrollSize,t=-this.verticalOffset+a-this.hScrollSize;this.verticalOffset=e<t||e-i.bottom>e-t?h:-(i.bottom+this.hScrollSize-a),s=!0}s||(this.verticalOffset=r-t)}this.transform={tx:Math.max(this.horizontalOffset,-i.left)/this.currentZoom,ty:Math.max(this.verticalOffset,-i.top)/this.currentZoom,scale:this.currentZoom},this.setSize()}getObjects(e,t){const i=[];for(let n=0;n<e.length;n++){let r=!1;for(let i=0;i<t.length;i++)if(e[n]===t[i]){r=!0;break}r||i.push(e[n])}return i}virtualizeElements(){const e=this.diagram.spatialSearch.findObjects(new Ds(-this.horizontalOffset/this.currentZoom,-this.verticalOffset/this.currentZoom,this.viewPortWidth/this.currentZoom,this.viewPortHeight/this.currentZoom)),t=[];for(let r=0;r<e.length;r++)t.push(e[r].id);const i=this.getObjects(t,this.oldCollectionObjects);0===this.oldCollectionObjects.length&&(this.oldCollectionObjects=t);const n=this.getObjects(this.oldCollectionObjects,t);this.diagram.updateVirtualObjects(i,!1,n),this.oldCollectionObjects=t}setSize(e){const t=this.getPageBounds(void 0,void 0,!0);t.x*=this.currentZoom,t.y*=this.currentZoom,t.width*=this.currentZoom,t.height*=this.currentZoom;const i=Math.min(t.x,-this.horizontalOffset),n=Math.min(t.y,-this.verticalOffset);let r=this.scrollerWidth,s=this.scrollerWidth;-this.verticalOffset<=t.y&&-this.verticalOffset+this.viewPortHeight>=t.bottom&&(s=0),-this.horizontalOffset<=t.x&&-this.horizontalOffset+this.viewPortWidth>=t.right&&(r=0),this.hScrollSize=r,this.vScrollSize=s;const o=this.diagramWidth,a=this.diagramHeight;this.diagramWidth=Math.max(t.right,-this.horizontalOffset+this.viewPortWidth-s)-i,this.diagramHeight=Math.max(t.bottom,-this.verticalOffset+this.viewPortHeight-r)-n,o===this.diagramWidth&&a===this.diagramHeight||"Diagram"===this.diagram.scrollSettings.scrollLimit||this.diagram.setSize(this.diagramWidth,this.diagramHeight),"Diagram"===this.diagram.scrollSettings.scrollLimit&&(o===this.diagramWidth&&a===this.diagramHeight&&1===this.currentZoom||this.diagram.diagramActions&&e&&(!this.diagram.diagramActions||!e||0===this.verticalOffset&&this.verticalOffset!==e.y||0===this.horizontalOffset&&this.horizontalOffset!==e.x)?e&&o===this.diagramWidth&&a===this.diagramHeight&&(this.diagram.diagramCanvas.scrollHeight>this.viewPortHeight&&e.y<0&&this.horizontalOffset===e.x&&0===this.verticalOffset||this.diagram.diagramCanvas.scrollWidth>this.viewPortWidth&&e.x<0&&this.verticalOffset===e.y&&0===this.horizontalOffset)&&(this.verticalOffset=e.y,this.horizontalOffset=e.x,this.transform={tx:Math.max(e.x,-t.left)/this.currentZoom,ty:Math.max(e.y,-t.top)/this.currentZoom,scale:this.currentZoom}):(this.diagram.scrollActions&yo.Interaction&&e&&(this.transform={tx:Math.max(e.x,-t.left/this.currentZoom)/this.currentZoom,ty:Math.max(e.y,-t.top/this.currentZoom)/this.currentZoom,scale:this.currentZoom},this.horizontalOffset=e.x,this.verticalOffset=e.y),this.diagram.setSize(this.diagramWidth,this.diagramHeight),this.diagram.scrollActions&yo.PropertyChange||!e||(this.horizontalOffset=e.x,this.verticalOffset=e.y,this.transform={tx:Math.max(e.x,-t.left)/this.currentZoom,ty:Math.max(e.y,-t.top)/this.currentZoom,scale:this.currentZoom}))),this.diagram.transformLayers(),this.diagram.element.style.overflow="hidden"}setViewPortSize(e,t){this.viewPortWidth=e,this.viewPortHeight=t}getPageBounds(e,t,i){let n,r=new Ds;if("Content"!==t&&null!==this.diagram.pageSettings.width&&null!==this.diagram.pageSettings.height){let e=this.diagram.pageSettings.width,t=this.diagram.pageSettings.height,i=0,s=0;if(this.diagram.pageSettings.multiplePage){if(r=this.diagram.spatialSearch.getPageBounds(0,0),r.right>e&&(e*=Math.ceil(r.right/e)),r.bottom>t&&(t*=Math.ceil(r.bottom/t)),r.left<0&&Math.abs(r.left)>i){const e=Math.ceil(Math.abs(r.left)/this.diagram.pageSettings.width);i=this.diagram.pageSettings.width*e}if(r.top<0&&Math.abs(r.top)>s){const e=Math.ceil(Math.abs(r.top)/this.diagram.pageSettings.height);s=this.diagram.pageSettings.height*e}}n=new Ds(-i,-s,e+i,t+s)}else{const t=e?void 0:0;n=this.diagram.spatialSearch.getPageBounds(t,t)}if(i){const e=this.diagram.scrollSettings.padding;n.x-=e.left,n.y-=e.top,n.width+=e.left+e.right,n.height+=e.top+e.bottom}return n}getPageBreak(e){let t=0,i=0,n=-1;const r=[];let s=0,o=0,a=0,l=0;const h=this.diagram.pageSettings.margin.left,c=this.diagram.pageSettings.margin.right,d=this.diagram.pageSettings.margin.top,p=this.diagram.pageSettings.margin.bottom;let u=1,g=1,m={x1:s,y1:a,x2:o,y2:l};for(;e.width>t;)t+=this.diagram.pageSettings.width?this.diagram.pageSettings.width:e.width,t===this.diagram.pageSettings.width&&(m={x1:e.left+h,y1:e.top+d,x2:e.left+h,y2:e.bottom-p},r[++n]=m),t<e.width&&(s=e.topLeft.x+this.diagram.pageSettings.width*u,a=e.topLeft.y+d,o=e.bottomLeft.x+this.diagram.pageSettings.width*u,l=e.bottomLeft.y-p,m={x1:s,y1:a,x2:o,y2:l},r[++n]=m,u++),e.width===t&&(m={x1:e.right-c,y1:e.top+d,x2:e.right-c,y2:e.bottom-p},r[++n]=m);for(;e.height>i;)i+=this.diagram.pageSettings.height?this.diagram.pageSettings.height:e.height,i===this.diagram.pageSettings.height&&(m={x1:e.left+h,y1:e.top+d,x2:e.right-c,y2:e.top+d},r[++n]=m),i<e.height&&(s=e.topLeft.x+h,a=e.topLeft.y+this.diagram.pageSettings.height*g,o=e.topRight.x-c,l=e.topRight.y+this.diagram.pageSettings.height*g,m={x1:s,y1:a,x2:o,y2:l},r[++n]=m,g++),e.height===i&&(m={x1:e.left+h,y1:e.bottom-p,x2:e.right-c,y2:e.bottom-p},r[++n]=m);return r}zoom(e,t,i,n){if(this.diagram.constraints&lo.Zoom&&1!==e||this.diagram.constraints&lo.Pan&&1===e){const r=zs();if(js(r,this.currentZoom,this.currentZoom),Hs(r,this.horizontalOffset,this.verticalOffset),n=Ms(r,n=n||{x:(this.viewPortWidth/2-this.horizontalOffset)/this.currentZoom,y:(this.viewPortHeight/2-this.verticalOffset)/this.currentZoom}),this.currentZoom*e>=this.diagram.scrollSettings.minZoom&&this.currentZoom*e<=this.diagram.scrollSettings.maxZoom){this.currentZoom*=e;const s=this.getPageBounds(void 0,void 0,!0);s.x*=this.currentZoom,s.y*=this.currentZoom;const o=zs();js(o,e,e,n.x,n.y),Hs(o,t||0,i||0),Ns(r,o);let a=Ms(r,{x:0,y:0});1===e&&(a=this.applyScrollLimit(a.x,a.y)),!(this.diagram.scrollActions&yo.PropertyChange)&&this.diagram.scrollActions&yo.Interaction&&"Diagram"===this.diagram.scrollSettings.scrollLimit||(this.transform={tx:Math.max(a.x,-s.left)/this.currentZoom,ty:Math.max(a.y,-s.top)/this.currentZoom,scale:this.currentZoom},this.horizontalOffset=a.x,this.verticalOffset=a.y),this.setSize(a),"SVG"!==this.diagram.mode&&Dl(this.diagram)&&this.diagram.scroller.virtualizeElements(),"SVG"===this.diagram.mode||Dl(this.diagram)||this.diagram.refreshDiagramLayer(),this.diagram.setOffset(-this.horizontalOffset-s.x,-this.verticalOffset-s.y),cl(this.diagram)}}}fitToPage(e){let t=(e=e||{}).mode,i=e.region;const n=e.margin||{},r=e.canZoomIn,s=e.customBounds;n.bottom=n.bottom||25,n.top=n.top||25,n.left=n.left||25,n.right=n.right||25;let o,a=s,l=-this.horizontalOffset,h=-this.verticalOffset;if(i=i||"PageSettings","PageSettings"===i&&this.diagram.pageSettings.width&&this.diagram.pageSettings.height||this.diagram.nodes.length>0||this.diagram.connectors.length>0){t=t||"Page","CustomBounds"!==i&&(a=this.getPageBounds(!0,i,!0));const e={x:0,y:0};let s,c,d;switch(e.x=(this.viewPortWidth-(n.left+n.right))/a.width,e.y=(this.viewPortHeight-(n.top+n.bottom))/a.height,!r&&a.width-this.horizontalOffset<this.viewPortWidth&&a.height-this.verticalOffset<this.viewPortHeight&&(e.x=Math.min(this.currentZoom,e.x),e.y=Math.min(this.currentZoom,e.y)),t){case"Width":s=e.x,o=s/this.currentZoom,c=(this.viewPortWidth-a.width*s)/2-a.x*s,l+=c+(n.left-n.right)/2*s,h-=-this.verticalOffset*o,h="CustomBounds"!==i?h:h-this.verticalOffset*o;break;case"Height":s=e.y,o=s/this.currentZoom,c=(this.viewPortWidth-a.width*s)/2-a.x*s,d=(this.viewPortHeight-a.height*s)/2-a.y*s,l+=c+(n.left-n.right)/2*s,h+=d+(n.top-n.bottom)/2*s;break;case"Page":s=Math.min(e.x,e.y),o=s/this.currentZoom,c=(this.viewPortWidth-a.width*s)/2-a.x*s,d=(this.viewPortHeight-a.height*s)/2-a.y*s,l+=c+(n.left-n.right)/2*s,h+=d+(n.top-n.bottom)/2*s}this.zoom(o,l,h,{x:0,y:0})}else o=1/this.currentZoom,this.zoom(o,l,h,{x:0,y:0})}bringIntoView(e){let t=0,i=0;const n=this.currentZoom;let r=e;const s=-this.horizontalOffset,o=-this.verticalOffset;r=new Ds(r.x*n,r.y*n,r.width*n,r.height*n),new Ds(s,o,this.viewPortWidth,this.viewPortHeight).containsRect(r)||(r.right>-s+this.viewPortWidth&&(t=r.right-this.viewPortWidth),r.x<-s&&(t=r.x),r.bottom>-o+this.viewPortHeight&&(i=r.bottom-this.viewPortHeight),r.y<-o&&(i=r.y),this.zoom(1,-this.horizontalOffset-t,-this.verticalOffset-i,null))}bringToCenter(e){const t=this.currentZoom,i=new Ds(e.x*t,e.y*t,e.width*t,e.height*t);this.zoom(1,-this.horizontalOffset-(i.x+i.width/2-this.viewPortWidth/2),-this.verticalOffset-(i.y+i.height/2-this.viewPortHeight/2),null)}applyScrollLimit(e,t){if("Infinity"!==this.diagram.scrollSettings.scrollLimit){let i;if("Limited"===this.diagram.scrollSettings.scrollLimit){const e=this.diagram.scrollSettings.scrollableArea;i=new Ds(e.x,e.y,e.width,e.height)}i=i||this.getPageBounds(!0),i.x*=this.currentZoom,i.y*=this.currentZoom,i.width*=this.currentZoom,i.height*=this.currentZoom,e*=-1,t*=-1;const n=Math.max(i.right,this.viewPortWidth);e<=i.x&&(e+this.viewPortWidth>=i.right||e>=i.right-this.viewPortWidth)||e>=i.x&&e+this.viewPortWidth<=n||(e=e>=i.x?Math.max(i.x,Math.min(e,e-(e+this.viewPortWidth-this.vScrollSize-n))):Math.min(i.right-this.viewPortWidth,i.x));const r=Math.max(i.bottom,this.viewPortHeight);t<=i.y&&t+this.viewPortHeight>=i.bottom||t>=i.y&&t+this.viewPortHeight<=r||(t=t>=i.y?Math.max(i.y,Math.min(t,t-(t+this.viewPortHeight-this.hScrollSize-r))):Math.min(i.y,i.bottom-this.viewPortHeight)),e*=-1,t*=-1}return{x:e,y:t}}}class Tu{constructor(e,t,i,n,r){this.objects=[],this.left=e,this.top=t,this.width=i,this.height=n,this.spatialSearch=r}findQuads(e,t){null!=this.first&&this.first.isIntersect(e)&&this.first.findQuads(e,t),null!=this.second&&this.second.isIntersect(e)&&this.second.findQuads(e,t),null!=this.third&&this.third.isIntersect(e)&&this.third.findQuads(e,t),null!=this.fourth&&this.fourth.isIntersect(e)&&this.fourth.findQuads(e,t),this.objects.length>0&&t.push(this)}isIntersect(e){return!(this.left+this.width<e.left||this.top+this.height<e.top||this.left>e.right||this.top>e.bottom)}selectQuad(){let e,t=null,i=this;for(;null!=i;)e=i.getQuad(t),i=e.source,t=e.target||t;return t}getQuad(e){const t=this.width/2,i=this.height/2;if(t>=1e3&&i>=1e3){const e=this.left+t,n=this.top+i;if(this.spatialSearch.childRight<=e){if(this.spatialSearch.childBottom<=n){if(!this.first){const e=new Tu(this.left,this.top,t,i,this.spatialSearch);e.parent=this,this.first=e}return{source:this.first}}if(this.spatialSearch.childTop>=n){if(!this.third){const e=new Tu(this.left,n,t,i,this.spatialSearch);e.parent=this,this.third=e}return{source:this.third}}}else if(this.spatialSearch.childLeft>=e){if(this.spatialSearch.childBottom<=n){if(!this.second){const n=new Tu(e,this.top,t,i,this.spatialSearch);n.parent=this,this.second=n}return{source:this.second}}if(this.spatialSearch.childTop>=n){if(!this.fourth){const r=new Tu(e,n,t,i,this.spatialSearch);r.parent=this,this.fourth=r}return{source:this.fourth}}}}return this.objects.push(this.spatialSearch.childNode),{target:this}}isContained(){return this.spatialSearch.childLeft>=this.left&&this.spatialSearch.childRight<=this.left+this.width&&this.spatialSearch.childTop>=this.top&&this.spatialSearch.childBottom<=this.top+this.height}addIntoAQuad(e){let t={};this.spatialSearch.setCurrentNode(e);let i=null;for(;!t.isAdded;)t=this.spatialSearch.parentQuad.add(i),i=t.quad;return i}add(e){if(e=null,this.isContained())return{isAdded:!0,quad:e=this.selectQuad()};{let t;const i=!(0!==this.objects.length||this.first||this.second||this.third||this.fourth),n=2*this.width,r=2*this.height;return this.spatialSearch.childLeft<this.left?this.spatialSearch.childTop<this.top?(t=new Tu(this.left-this.width,this.top-this.height,n,r,this.spatialSearch),i||(t.fourth=this)):(t=new Tu(this.left-this.width,this.top,n,r,this.spatialSearch),i||(t.second=this)):this.spatialSearch.childTop<this.top?(t=new Tu(this.left,this.top-this.height,n,r,this.spatialSearch),i||(t.third=this)):(t=new Tu(this.left,this.top,n,r,this.spatialSearch),i||(t.first=this)),this.parent=t,this.spatialSearch.parentQuad=t,{isAdded:!1,quad:e}}}}class Eu{constructor(e){this.quadSize=500,this.objectTable=e,this.parentQuad=new Tu(0,0,2*this.quadSize,2*this.quadSize,this),this.pageLeft=Number.MAX_VALUE,this.pageRight=-Number.MAX_VALUE,this.pageTop=Number.MAX_VALUE,this.pageBottom=-Number.MAX_VALUE,this.quadTable={}}removeFromAQuad(e){if(this.quadTable[e.id]){const t=this.quadTable[e.id],i=this.objectIndex(t.objects,e);-1!==i&&(t.objects.splice(i,1),this.update(t),delete this.quadTable[e.id])}}update(e){if(e.parent&&0===e.objects.length&&e.first&&e.second&&e.third&&e.fourth){const t=e.parent;t.first===e?t.first=null:t.second===e?t.second=null:t.third===e?t.third=null:t.fourth===e&&(t.fourth=null),this.update(e.parent)}else e!==this.parentQuad||e.first||e.second||e.third||e.fourth||(e.left=0,e.width=1e3,e.top=0,e.height=1e3)}addIntoAQuad(e){const t=this.parentQuad.addIntoAQuad(e);this.quadTable[e.id]=t}objectIndex(e,t){for(let i=0;i<e.length;i++)if(e[i].id===t.id)return i;return-1}updateQuad(e){this.setCurrentNode(e);const t=e.outerBounds;if(isNaN(t.x)||isNaN(t.y)||isNaN(t.width)||isNaN(t.height))return!1;if(this.quadTable[e.id]?this.quadTable[e.id].isContained()||(this.removeFromAQuad(e),this.addIntoAQuad(e)):this.addIntoAQuad(e),!this.isWithinPageBounds(t)||this.leftElement===e||this.topElement===e||this.rightElement===e||this.bottomElement===e){let t=!1;return this.pageLeft===this.childLeft&&e===this.leftElement||(this.pageLeft>=this.childLeft?(this.pageLeft=this.childLeft,this.leftElement=e,t=!0):e===this.leftElement&&(this.pageLeft=Number.MAX_VALUE,this.findLeft(this.parentQuad),t=!0)),this.pageTop===this.childTop&&e===this.topElement||(this.pageTop>=this.childTop?(this.pageTop=this.childTop,this.topElement=e,t=!0):e===this.topElement&&(this.pageTop=Number.MAX_VALUE,this.findTop(this.parentQuad),t=!0)),this.pageBottom===this.childBottom&&e===this.bottomElement||(this.pageBottom<=this.childBottom?(t=!0,this.pageBottom=this.childBottom,this.bottomElement=e):e===this.bottomElement&&(this.pageBottom=-Number.MAX_VALUE,this.findBottom(this.parentQuad),t=!0)),this.pageRight===this.childRight&&e===this.rightElement||(this.pageRight<=this.childRight?(this.pageRight=this.childRight,this.rightElement=e,t=!0):e===this.rightElement&&(this.pageRight=-Number.MAX_VALUE,this.findRight(this.parentQuad),t=!0)),t}return this.setCurrentNode(null),!1}isWithinPageBounds(e){return e.left>=this.pageLeft&&e.right<=this.pageRight&&e.top>=this.pageTop&&e.bottom<=this.pageBottom}findQuads(e){const t=[];return this.parentQuad.findQuads(e,t),t}findObjects(e){const t=this.findQuads(e),i=[];for(const n of t)for(const t of n.objects)t.outerBounds.intersects(e)&&i.push(this.objectTable[t.id]);return i}updateBounds(e){let t=!1;return e===this.topElement&&(this.pageTop=Number.MAX_VALUE,this.topElement=null,this.findTop(this.parentQuad),t=!0),e===this.leftElement&&(this.pageLeft=Number.MAX_VALUE,this.leftElement=null,this.findLeft(this.parentQuad),t=!0),e===this.rightElement&&(this.pageRight=-Number.MAX_VALUE,this.rightElement=null,this.findRight(this.parentQuad),t=!0),e===this.bottomElement&&(this.pageBottom=-Number.MAX_VALUE,this.bottomElement=null,this.findBottom(this.parentQuad),t=!0),t}findBottom(e){e.third||e.fourth?(e.third&&this.findBottom(e.third),e.fourth&&this.findBottom(e.fourth)):(e.second&&this.findBottom(e.second),e.first&&this.findBottom(e.first));for(const t of e.objects)this.pageBottom<=t.outerBounds.bottom&&(this.pageBottom=t.outerBounds.bottom,this.bottomElement=t)}findRight(e){e.second||e.fourth?(e.second&&this.findRight(e.second),e.fourth&&this.findRight(e.fourth)):(e.first&&this.findRight(e.first),e.third&&this.findRight(e.third));for(const t of e.objects)this.pageRight<=t.outerBounds.right&&(this.pageRight=t.outerBounds.right,this.rightElement=t)}findLeft(e){e.first||e.third?(e.first&&this.findLeft(e.first),e.third&&this.findLeft(e.third)):(e.second&&this.findLeft(e.second),e.fourth&&this.findLeft(e.fourth));for(const t of e.objects)this.pageLeft>=t.outerBounds.left&&(this.pageLeft=t.outerBounds.left,this.leftElement=t)}findTop(e){e.first||e.second?(e.first&&this.findTop(e.first),e.second&&this.findTop(e.second)):(e.third&&this.findTop(e.third),e.fourth&&this.findTop(e.fourth));for(const t of e.objects)this.pageTop>=t.outerBounds.top&&(this.pageTop=t.outerBounds.top,this.topElement=t)}setCurrentNode(e){if(this.childNode=e,e){const t=e.outerBounds;this.childLeft=Number(t.left),this.childTop=Number(t.top),this.childRight=Number(t.right),this.childBottom=Number(t.bottom)}else this.childLeft=Number.MAX_VALUE,this.childTop=Number.MAX_VALUE,this.childRight=-Number.MAX_VALUE,this.childBottom=-Number.MAX_VALUE}getPageBounds(e,t){if(this.pageLeft===Number.MAX_VALUE)return new Ds(0,0,0,0);const i=void 0!==e?Math.min(this.pageLeft,0):this.pageLeft,n=void 0!==t?Math.min(this.pageTop,0):this.pageTop;return new Ds(Math.round(i),Math.round(n),Math.round(this.pageRight-i),Math.round(this.pageBottom-n))}getQuad(e){return this.quadTable[e.id]}}let Au=(()=>{class e extends Ht{}return function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);s>3&&o&&Object.defineProperty(t,i,o)}([xt(!1)],e.prototype,"preventDefaults",void 0),e})();var Iu=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let Du=(()=>{class e extends Ht{}return Iu([xt("")],e.prototype,"action",void 0),Iu([xt("")],e.prototype,"cursor",void 0),e})(),Ru=(()=>{class e extends Ht{}return function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);s>3&&o&&Object.defineProperty(t,i,o)}([xt(!0)],e.prototype,"inversedAlignment",void 0),e})();var Lu=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},zu=function(e,t,i,n){return new(i||(i=Promise))(function(r,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(o,a)}l((n=n.apply(e,t||[])).next())})};let Mu=(()=>{class e extends Ut{constructor(e,t){let i,n;super(e,t),this.version=17.1,this.checkMenu=!1,this.isServerUpdate=!1,this.oldNodeObjects=[],this.oldDiagramObject={},this.oldConnectorObjects=[],this.canEnableBlazorObject=!1,this.connectorTable={},this.groupTable={},this.scrollActions=yo.None,this.blazorActions=Ks.Default,this.activeLabel={id:"",parentId:"",isGroup:!1,text:void 0},this.textEditing=!1,this.isTriggerEvent=!1,this.preventNodesUpdate=!1,this.preventConnectorsUpdate=!1,this.callBlazorModel=!0,this.selectionConnectorsList=[],this.deleteVirtualObject=!1,this.canLayout=!0,this.swimlaneChildTable={},this.swimlaneZIndexTable={},this.changedConnectorCollection=[],this.changedNodesCollection=[],this.previousNodeCollection=[],this.previousConnectorCollection=[],this.crudDeleteNodes=[],this.blazorAddorRemoveCollection=[],this.blazorRemoveIndexCollection=[],this.diagramid=88123,this.selectedObject={helperObject:void 0,actualObject:void 0},this.renderTimer=null,this.ignoreCollectionWatch=!0;for(let r=0;e&&e.nodes&&r<e.nodes.length;r++)i=e.nodes[r],n=this.nodes[r],i.children&&i.children.length>0&&(i.style&&i.style.fill||(n.style.fill="transparent"),i.style&&i.style.strokeColor||(n.style.strokeColor="transparent")),i.shape&&"UmlActivity"===i.shape.type&&$h(i,n),i.shape&&"SwimLane"===i.shape.type&&Gh(i,n),this.nodeDefaults&&ec(n,i,this.nodeDefaults),this.updateAnnotationText(n.annotations);if(e&&e.connectors)for(let r=0;e&&e.connectors&&r<e.connectors.length;r++)i=e.connectors[r],n=this.connectors[r],this.connectorDefaults&&ec(n,i,this.connectorDefaults),this.updateAnnotationText(n.annotations);for(let r=0;e&&e.connectors&&r<e.connectors.length;r++){const t=e.connectors[r],i=this.connectors[r];t.shape&&"None"!==t.shape.type&&Qh(t,i)}}updateAnnotationText(e){}callFromServer(e){if("getParentID"===e.methodName)return this.nameTable[e.id].parentId;if("getEdges"===e.methodName){const t=e.id;return e.outEdge?this.nameTable[t].outEdges:this.nameTable[t].inEdges}if("updateDiagramObjects"===e.methodName){const t="IsAdding",i=e.obj;this.isServerUpdate=!0,e[t]?this.add.apply(this,i):this.remove.apply(this,i),this.isServerUpdate=!1}else"invokeLoadDiagramMethod"===e.methodName&&this.loadDiagram(e.data)}clearCollection(e){const t=[];let i;for(const n of Object.keys(this.nameTable))i=this.nameTable[n],i&&(e&&i instanceof ol||!e&&i instanceof Td)&&t.push(i);this.clearObjects(t)}onPropertyChanged(t,i){let n=!0,r=!1,s=!1;if(this.diagramActions&go.Render){for(const a of Object.keys(t))switch(a){case"width":case"height":this.element.style.width=this.getSizeValue(this.width),this.element.style.height=this.getSizeValue(this.height),this.eventHandler.updateViewPortSize(this.element);for(const t of this.views){const i=this.views[t];i instanceof e||i.updateView(i)}break;case"nodes":if(t.nodes.length>0&&0===i.nodes.length)this.clearCollection(),s=!0;else{for(const e of Object.keys(t.nodes)){const s=Number(e),o=this.nodes[s],a=t.nodes[s];t.nodes[s].style&&t.nodes[s].style.gradient&&(this.updateGradient(t.nodes[s],i.nodes[s],this.nodes[s]),this.nodes[s].oldGradientValue=dp(t.nodes[s].style.gradient)),r=r||void 0!==a.excludeFromLayout,this.nodePropertyChange(o,i.nodes[s],a,void 0,!0,!0);this.triggerEvent(vo.propertyChange,{element:o,cause:this.diagramActions,oldValue:i.nodes[s],newValue:t.nodes[s]}),n&&(n=!1)}"Canvas"===this.mode&&this.refreshDiagramLayer()}break;case"connectors":if(t.connectors.length>0&&0===i.connectors.length)this.clearCollection(!0),s=!0;else{for(const e of Object.keys(t.connectors)){const r=Number(e),s=this.connectors[r],o=t.connectors[r];o&&(o.sourceDecorator||o.targetDecorator)&&(this.diagramActions|=go.DecoratorPropertyChange),this.connectorPropertyChange(s,i.connectors[r],o,!0,!0),o&&(o.sourceDecorator||o.targetDecorator)&&(this.diagramActions=this.diagramActions&~go.DecoratorPropertyChange);this.triggerEvent(vo.propertyChange,{element:s,cause:this.diagramActions,oldValue:i.connectors[r],newValue:t.connectors[r]}),s&&s.parentId&&"UmlClassifier"===this.nameTable[s.parentId].shape.type&&this.updateConnectorEdges(this.nameTable[s.parentId]||s),n&&(n=!1)}this.updateBridging(),"Canvas"===this.mode&&this.refreshDiagramLayer()}break;case"bridgeDirection":this.updateBridging(),"Canvas"===this.mode&&this.refreshDiagramLayer();break;case"backgroundColor":this.intOffPageBackground();break;case"pageSettings":this.validatePageSize(),this.updatePage();break;case"selectedItems":if(t.selectedItems.userHandles&&this.selectedItems.wrapper&&this.selectedItems.userHandles&&this.selectedItems.userHandles.length>0){this.renderSelector(!0);break}if(t.selectedItems.constraints){this.renderSelector(!0);break}break;case"snapSettings":this.updateSnapSettings(t);break;case"commandManager":this.initCommands();break;case"layout":r=!0;break;case"dataSourceSettings":this.clear(),this.initObjects(),"None"===this.layout.type?s=!0:r=!0;break;case"tooltip":Ta(this);break;case"rulerSettings":this.updateRulerSettings(t);break;case"layers":this.updateLayer(t);break;case"scrollSettings":this.scrollActions|=yo.PropertyChange,this.updateScrollSettings(t),this.scrollActions&=~yo.PropertyChange;break;case"locale":t.locale!==i.locale&&(this.realActions|=fo.PreventDataInit,super.refresh(),this.realActions&=~fo.PreventDataInit);break;case"contextMenuSettings":if(void 0!==t.contextMenuSettings.showCustomMenuOnly&&(this.contextMenuSettings.showCustomMenuOnly=t.contextMenuSettings.showCustomMenuOnly),void 0!==t.contextMenuSettings.show&&(this.contextMenuSettings.show=t.contextMenuSettings.show),t.contextMenuSettings.items){const e=t.contextMenuSettings.items;for(const t of Object.keys(e)){const i=Number(t);this.contextMenuSettings.items[i]=e[i]}this.contextMenuModule&&this.contextMenuModule.refreshItems()}break;case"serializationSettings":void 0!==t.serializationSettings.preventDefaults&&(this.serializationSettings.preventDefaults=t.serializationSettings.preventDefaults)}if(r&&!s){if(i.layout&&"DifferentPoint"===i.layout.connectionPointOrigin&&"SamePoint"===t.layout.connectionPointOrigin||i.layout&&t.layout&&!t.layout.enableRouting&&i.layout.enableRouting){for(let e=0;e<this.nodes.length;e++){const t=this.nodes[e];if(t.ports&&t.ports.length>0){const e=[];for(let i=t.ports.length-1;i>=0;i--)"LineDistribution"===t.ports[i].id.split("_")[1]&&e.push(t.ports[i]);this.removePorts(t,e)}}for(let e=0;e<this.connectors.length;e++){const t=this.connectors[e],i=t.sourcePortID,n=t.targetPortID;t.sourcePortID="",t.targetPortID="",t.sourcePortWrapper=void 0,t.targetPortWrapper=void 0,t.segments=[],this.connectorPropertyChange(t,{sourcePortID:i,targetPortID:n},{sourcePortID:"",targetPortID:""})}}this.doLayout(),this.renderReactTemplates()}if(n&&this.propertyChange){this.triggerEvent(vo.propertyChange,{element:this,cause:this.diagramActions,oldValue:i,newValue:t})}if(!s&&this.canLogChange()&&this.modelChanged(t,i)){const e={type:"PropertyChanged",undoObject:i,redoObject:t,category:"Internal"};this.historyManager&&this.addHistoryEntry(e)}this.resetDiagramActions(),s&&(this.initObjects(!0),this.refreshDiagramLayer(),r&&this.doLayout());const o=1===Object.keys(t).length&&void 0!==t.scrollSettings;if(!s)for(const n of this.views){const r=this.views[n];r instanceof e||(t.scrollSettings&&t.scrollSettings.currentZoom!==i.scrollSettings.currentZoom&&r.updateHtmlLayer(r),o||this.refreshCanvasDiagramLayer(r))}}}updateSnapSettings(e){(void 0!==e.snapSettings.constraints||e.snapSettings.horizontalGridlines||e.snapSettings.verticalGridlines||e.snapSettings.gridType)&&this.diagramRenderer.updateGrid(this.snapSettings,Xd(this.element.id),this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler)}updateGradient(e,t,i){if(i.oldGradientValue){let n=i,r=i,s=t.style.gradient,o=t.style.gradient;for(const a of Object.keys(e.style.gradient))switch(a){case"type":n.type&&(s.type=n.type);break;case"x1":n.x1&&(s.x1=n.x1);break;case"x2":n.x2&&(s.x2=n.x2);break;case"y1":n.y1&&(s.y1=n.y1);break;case"y2":n.y2&&(s.y2=n.y2);break;case"cx":r.cx&&(o.cx=r.cx);break;case"cy":r.cy&&(o.cy=r.cy);break;case"fx":r.fx&&(o.fx=r.fx);break;case"fy":r.fy&&(o.fy=r.fy);break;case"r":r.r&&(o.r=r.r);break;case"stops":if(i.oldGradientValue.stops){let e=Object.values(dp(i.oldGradientValue.stops));e.pop(),t.style.gradient.stops=e}}}}updateRulerSettings(e){void 0!==e.rulerSettings.dynamicGrid&&this.diagramRenderer.updateGrid(this.snapSettings,Xd(this.element.id),this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler),void 0!==e.rulerSettings.showRulers?(this.intOffPageBackground(),this.scroller.setSize(),this.renderRulers()):void 0===e.rulerSettings.horizontalRuler&&void 0===e.rulerSettings.verticalRuler||(void 0!==e.rulerSettings.horizontalRuler.thickness||void 0!==e.rulerSettings.verticalRuler.thickness?(dl(this),this.intOffPageBackground(),this.scroller.setSize(),this.renderRulers()):cl(this)),this.diagramRenderer.updateGrid(this.snapSettings,Xd(this.element.id),this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler)}getPersistData(){return this.addOnPersist(["loaded"])}preRender(){this.initializePrivateVariables(),this.isProtectedOnChange=!0,this.serviceLocator=new Lp,this.initializeServices(),this.setCulture(),window.measureElement&&(window.measureElement=null),this.initDiagram(),this.initViews(),this.unWireEvents(),this.wireEvents(),this.element.classList.add("e-diagram")}initializePrivateVariables(){if(""===this.element.id){const e=document.getElementsByClassName("e-diagram").length;this.element.id="diagram_"+this.diagramid+"_"+e}this.defaultLocale={Copy:"Copy",Cut:"Cut",Paste:"Paste",Undo:"Undo",Redo:"Redo",SelectAll:"Select All",Grouping:"Grouping",Group:"Group",UnGroup:"Un Group",Order:"Order",BringToFront:"Bring To Front",MoveForward:"Move Forward",SendToBack:"Send To Back",SendBackward:"Send Backward"},this.layerZIndex=-1,this.layerZIndexTable={},this.nameTable={},this.pathTable={},this.groupTable={},this.commands={},this.isLoading||(this.views=[]),this.commandHandler=new Pu(this),this.eventHandler=new vu(this,this.commandHandler),this.spatialSearch=new Eu(this.nameTable),this.scroller=new Ou(this)}initializeServices(){this.serviceLocator.register("localization",this.localeObj=new Qt(this.getModuleName(),this.defaultLocale,this.locale))}setCulture(){this.localeObj=new Qt(this.getModuleName(),this.defaultLocale,this.locale)}render(){this.refreshing&&this.dataSourceSettings.dataSource&&!this.isLoading&&(this.nodes=[],this.connectors=[]),this.ignoreCollectionWatch=!0,window.domTable={};const e=[];this.dataSourceSettings.crudAction.read&&this.renderInitialCrud(),this.initHistory(),this.diagramRenderer=new Tp(this.element.id,new Op,"SVG"===this.mode),this.initLayers(),this.initializeDiagramLayers(),this.diagramRenderer.setLayers(),this.initObjects(!0);const t=this.nodes;for(let n=0;n<t.length;n++)t[n].isExpanded||e.push(t[n]);if(e.length)for(let n=e.length-1;n>=0;n--)this.commandHandler.expandNode(e[n],this,0!==n);this.canLayout&&this.doLayout(),this.lineRoutingModule&&this.lineRoutingModule.lineRouting(this),this.validatePageSize(),this.renderPageBreaks(),this.diagramRenderer.renderSvgGridlines(this.snapSettings,Xd(this.element.id),this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler),this.commandHandler.initSelectorWrapper(),this.notify("initial-load",{}),this.trigger("load"),this.scroller.setSize(),this.scroller.updateScrollOffsets(),this.refreshDiagramLayer(),(this.scrollSettings.verticalOffset>0||this.scrollSettings.horizontalOffset>0)&&this.updateScrollOffset(),Z.isDevice&&(this.tool=ho.ZoomPan|ho.SingleSelect),this.notify("initial-end",{}),this.isProtectedOnChange=!1,this.tooltipObject=Ta(this),this.diagramActions=go.Render,this.initCommands();const i=document.getElementsByClassName(this.element.id+"_hiddenUserHandleTemplate");!function(e,t,i,n){let r,s,o,a,l,h=document.getElementById(n).ej2_instances[0];if(e&&t)for(s of(r=lp(e),i.userHandles))if(r){for(o=r(dp(s),h,"userHandleTemplate_"+s.name,void 0,void 0,!1),a=0;a<o.length;a++)l=Zd("div",{style:"height: 100%; width: 100%; pointer-events: all",id:s.name+"_template_hiddenUserHandle"}),l.appendChild(o[a]);t[0].appendChild(l)}}(this.userHandleTemplate,i,this.selectedItems,this.element.id),this.isLoading=!1,this.renderComplete(),this.updateFitToPage(),this.refreshing&&this.renderReactTemplates()}updateFitToPage(){this.pageSettings&&this.pageSettings.fitOptions&&this.pageSettings.fitOptions.canFit&&this.fitToPage(this.pageSettings.fitOptions)}updateTemplate(){let e,t,i;for(let n=0;n<this.nodes.length&&(e=this.nodes[n],"HTML"!==e.shape.type&&"Native"!==e.shape.type);n++);for(let n=0;n<this.nodes.length&&(e=this.nodes[n],t=e.annotations[0],!t||"Template"!==t.annotationType);n++);for(let n=0;n<this.connectors.length&&(i=this.connectors[n].annotations[0],!i||"Template"!==i.annotationType);n++);for(let n=0;n<this.selectedItems.userHandles.length&&!this.selectedItems.userHandles[n].template;n++);}resetTemplate(){let e,t,i;for(let n=0;n<this.nodes.length;n++)if(e=this.nodes[n],"HTML"===e.shape.type&&""===e.shape.content){Ce("diagramsf_node_template");break}for(let n=0;n<this.nodes.length;n++)if(e=this.nodes[n],t=e.annotations[0],t&&"Template"===t.annotationType&&t.content instanceof HTMLElement){Ce("diagramsf_annotation_template");break}for(let n=0;n<this.connectors.length;n++)if(i=this.connectors[n].annotations[0],i&&"Template"===i.annotationType&&i.content instanceof HTMLElement){Ce("diagramsf_annotation_template");break}for(let n=0;n<this.selectedItems.userHandles.length&&!this.selectedItems.userHandles[n].template;n++);}renderInitialCrud(){const e=this;if(e.dataSourceSettings.crudAction.read){const t=new _(e.dataSourceSettings.crudAction.read,"GET",!1);t.onSuccess=t=>{e.dataSourceSettings.dataManager?e.dataSourceSettings.dataManager=JSON.parse(t):e.dataSourceSettings.dataSource=JSON.parse(t),e.dataBind()},t.send().then()}if(e.dataSourceSettings.connectionDataSource.crudAction.read){const t=new _(e.dataSourceSettings.connectionDataSource.crudAction.read,"GET",!1);t.onSuccess=t=>{e.dataSourceSettings.connectionDataSource.dataManager=JSON.parse(t),e.dataBind()},t.send().then()}}getModuleName(){return"diagram"}getClassName(){return"Diagram"}requiredModules(){const e=[];return e.push({member:"Bpmn",args:[]}),e.push({member:"Bridging",args:[]}),e.push({member:"ConnectorEditingTool",args:[]}),this.constraints&lo.UndoRedo&&e.push({member:"UndoRedo",args:[]}),("OrganizationalChart"===this.layout.type||"HierarchicalTree"===this.layout.type||this.layout.enableAnimation)&&e.push({member:"LayoutAnimate",args:[]}),this.snapSettings.constraints&&e.push({member:"Snapping",args:[this]}),e.push({member:"PrintandExport",args:[this]}),this.contextMenuSettings.show&&e.push({member:"contextMenu",args:[this,this.serviceLocator]}),"OrganizationalChart"!==this.layout.type&&"HierarchicalTree"!==this.layout.type||e.push({member:"OrganizationalChart",args:[this]}),"ComplexHierarchicalTree"===this.layout.type&&e.push({member:"ComplexHierarchicalTree",args:[]}),"MindMap"===this.layout.type&&e.push({member:"MindMapChart",args:[]}),"RadialTree"===this.layout.type&&e.push({member:"RadialTree",args:[]}),"SymmetricalLayout"===this.layout.type&&e.push({member:"SymmetricalLayout",args:[]}),(this.dataSourceSettings.dataManager||this.dataSourceSettings.dataSource||this.dataSourceSettings.crudAction.read||this.dataSourceSettings.connectionDataSource.crudAction.read)&&e.push({member:"DataBinding",args:[]}),this.constraints&lo.LineRouting&&e.push({member:"LineRouting",args:[]}),(this.layout&&"DifferentPoint"===this.layout.connectionPointOrigin||"Linear"===this.layout.arrangement||this.layout.enableRouting)&&e.push({member:"LineDistribution",args:[]}),e}removeUserHandlesTemplate(){if(this.selectedItems.userHandles.length)for(let e=0;e<this.selectedItems.userHandles.length;e++)for(const t of this.views)Kd(this.selectedItems.userHandles[e].name+"_template_hiddenUserHandle",t)}destroy(){if(clearInterval(this.renderTimer),this.renderTimer=null,this.hRuler&&this.vRuler&&(this.hRuler.destroy(),this.vRuler.destroy()),this.tooltipObject.destroy(),this.droppable.destroy(),this.unWireEvents(),this.notify("destroy",{}),super.destroy(),this.removeUserHandlesTemplate(),this.clearTemplate(),document.getElementById(this.element.id)){this.element.classList.remove("e-diagram");const e=document.getElementsByClassName("e-diagram-tooltip");for(;e.length>0;)e[0].parentNode.removeChild(e[0]);const t=document.getElementById(this.element.id+"content");t&&this.element.removeChild(t);const i="measureElement";if(window[i]){window[i].usageCount-=1;const e="measureElementCount";window[e]--,0===window[e]&&(window[i].parentNode.removeChild(window[i]),window[i]=null)}}window.domTable={};for(let e=0;e<this.layers.length;e++)this.layers[e].zIndexTable={};this.diagramActions=void 0}wireEvents(){const e=Z.touchEndEvent,t=Z.touchMoveEvent,i=Z.isPointer?"pointerleave":"mouseleave",n="mozilla"===Z.info.name?Z.isPointer?"mousewheel":"DOMMouseScroll":"mousewheel";$.add(this.diagramCanvas,Z.touchStartEvent,this.eventHandler.mouseDown,this.eventHandler),$.add(this.diagramCanvas,t,this.eventHandler.mouseMove,this.eventHandler),$.add(this.diagramCanvas,e,this.eventHandler.mouseUp,this.eventHandler),$.add(this.diagramCanvas,i,this.eventHandler.mouseLeave,this.eventHandler),$.add(this.diagramCanvas,"keydown",this.eventHandler.keyDown,this.eventHandler),$.add(this.diagramCanvas,"keyup",this.eventHandler.keyUp,this.eventHandler),$.add(this.diagramCanvas,"dblclick",this.eventHandler.doubleClick,this.eventHandler),$.add(this.diagramCanvas,"scroll",this.eventHandler.scrolled,this.eventHandler),$.add(this.diagramCanvas,n,this.eventHandler.mouseWheel,this.eventHandler),$.add(window,"resize",this.eventHandler.windowResize,this.eventHandler),this.initDroppables()}unWireEvents(){const e=Z.touchMoveEvent,t=Z.isPointer?"pointerleave":"mouseleave",i="mozilla"===Z.info.name?Z.isPointer?"mousewheel":"DOMMouseScroll":"mousewheel",n=Z.touchEndEvent;$.remove(this.diagramCanvas,Z.touchStartEvent,this.eventHandler.mouseDown),$.remove(this.diagramCanvas,e,this.eventHandler.mouseMove),$.remove(this.diagramCanvas,n,this.eventHandler.mouseUp),$.remove(this.diagramCanvas,t,this.eventHandler.mouseLeave),$.remove(this.diagramCanvas,"keydown",this.eventHandler.keyDown),$.remove(this.diagramCanvas,"keyup",this.eventHandler.keyUp),$.remove(this.diagramCanvas,"dblclick",this.eventHandler.doubleClick),$.remove(this.diagramCanvas,"scroll",this.eventHandler.scrolled),$.remove(this.diagramCanvas,i,this.eventHandler.mouseWheel),$.remove(window,"resize",this.eventHandler.windowResize)}select(e,t){null!=e&&this.commandHandler.selectObjects(e,t)}selectAll(){let e=[];e=this.getObjectsOfLayer(this.activeLayer.objects),this.select(e)}unSelect(e){e&&$p(this,e)&&(this.commandHandler.unSelect(e),this.commandHandler.updateBlazorSelector())}clearSelection(){this.commandHandler.clearSelection(!0)}updateViewPort(){const e=this.getZoomingAttribute();this.updateBlazorDiagramProperties(e),this.eventHandler.updateViewPortSize(this.element),this.updateBlazorDiagramProperties(e,!0)}cutCommand(){this.cut()}cut(){this.commandHandler.cut()}addProcess(e,t){this.bpmnModule&&this.bpmnModule.addProcess(e,t,this)}removeProcess(e){this.bpmnModule&&this.bpmnModule.removeProcess(e,this)}pasteCommand(){this.paste()}paste(e){this.commandHandler.paste(e)}fitToPage(e){const t=this.getZoomingAttribute();this.updateBlazorDiagramProperties(t),this.scroller.fitToPage(e),this.updateBlazorDiagramProperties(t,!0)}bringIntoView(e){const t=this.getZoomingAttribute();this.updateBlazorDiagramProperties(t),this.scroller.bringIntoView(e),this.updateBlazorDiagramProperties(t,!0)}bringToCenter(e){const t=this.getZoomingAttribute();this.updateBlazorDiagramProperties(t),this.scroller.bringToCenter(e),this.updateBlazorDiagramProperties(t,!0)}copyCommand(){this.copy()}copy(){return this.commandHandler.copy()}group(){let e=[];e=this.selectedItems.nodes,e=e.concat(this.selectedItems.connectors),e.length>1&&(this.callBlazorModel=!1,this.insertBlazorDiagramObjects(this.selectedItems),this.commandHandler.group(),this.callBlazorModel=!0,this.commandHandler.getBlazorOldValues())}unGroup(){this.callBlazorModel=!1,this.insertBlazorDiagramObjects(this.selectedItems),this.commandHandler.unGroup(),this.callBlazorModel=!0,this.commandHandler.getBlazorOldValues()}sendToBack(){this.commandHandler.sendToBack()}setActiveLayer(e){const t=this.commandHandler.getLayer(e);this.activeLayer=t}addLayer(e,t){this.commandHandler.addLayer(e,t)}addDiagramLayer(e,t){this.commandHandler.addLayer(e,t,!1)}removeLayer(e){this.commandHandler.removeLayer(e,!1)}removeDiagramLayer(e){this.commandHandler.removeLayer(e,!1)}moveObjects(e,t){const i=dp(this.layers);this.enableServerDataBinding(!1),this.commandHandler.moveObjects(e,t);const n=this.commandHandler.deepDiffer.map(i,dp(this.layers)),r=this.commandHandler.deepDiffer.frameObject({},n);this.oldDiagramObject={layers:r},this.commandHandler.updateBlazorProperties()}layerObjectUpdate(){}sendLayerBackward(e){this.layerObjectUpdate(),this.commandHandler.sendLayerBackward(e),this.commandHandler.updateLayerObject(this.oldDiagramObject,!0)}bringLayerForward(e){this.layerObjectUpdate(),this.commandHandler.bringLayerForward(e),this.commandHandler.updateLayerObject(this.oldDiagramObject)}cloneLayer(e){this.commandHandler.cloneLayer(e)}bringToFront(){this.commandHandler.bringToFront()}moveForward(){this.commandHandler.sendForward()}sendBackward(){this.commandHandler.sendBackward()}getObject(e){return this.nameTable[e]}getNodeObject(e){return dp(this.nameTable[e])}getConnectorObject(e){return dp(this.nameTable[e])}getActiveLayer(){return this.activeLayer}nudgeCommand(e,t,i){"object"!=typeof e&&(this.selectedItems.nodes.length||this.selectedItems.connectors.length)>0&&this.nudge(e)}nudge(e,t,i){let n,r=0,s=0;"Left"===e||"Right"===e?(n="Left"===e,r=(n?-1:1)*(t||1)):(n="Up"===e,s=(n?-1:1)*(i||1));const o=this.selectedItems,a=this.selectedItems.wrapper.children[0];if(a instanceof Co)this.commandHandler.labelDrag(o.nodes[0],a,r,s);else{const e=dp(this.selectedItems);this.protectPropertyChange(!0),this.drag(o,r,s),this.protectPropertyChange(!1);const t={type:"PositionChanged",redoObject:dp(this.selectedItems),undoObject:e,category:"Internal"};this.addHistoryEntry(t)}this.refreshCanvasLayers()}insertBlazorDiagramObjects(e){}drag(e,t,i){if(this.insertBlazorDiagramObjects(e),!(this.bpmnModule&&e instanceof Td&&this.bpmnModule.updateAnnotationDrag(e,this,t,i))){if(e instanceof Ld){if(this.preventConnectorsUpdate=!0,e.nodes&&e.nodes.length){for(const n of e.nodes)if(this.callBlazorModel=!1,this.drag(n,t,i),n.parentId){const e=this.nameTable[n.parentId];e.isLane&&ph(e,this.nameTable[e.parentId],n,this)}this.callBlazorModel=!0}if(e.connectors&&e.connectors.length){this.callBlazorModel=!1;for(const n of e.connectors)this.drag(n,t,i),-1===this.selectionConnectorsList.indexOf(n)&&this.selectionConnectorsList.push(n);this.callBlazorModel=!0}this.updateSelector(),this.diagramActions&go.DragUsingMouse&&this.updatePage()}else e instanceof Td&&this.bpmnModule&&this.bpmnModule.updateAnnotationDrag(e,this,t,i),this.commandHandler.drag(e,t,i);if(e instanceof Ld){this.preventConnectorsUpdate=!1;for(const e of this.selectionConnectorsList)this.updateConnectorProperties(this.nameTable[e.id]),"Bpmn"===e.shape.type&&"Default"===e.shape.sequence&&this.commandHandler.updatePathElementOffset(e);this.selectionConnectorsList=[]}this.diagramActions&go.ToolAction||this.diagramActions&go.DragUsingMouse||this.updateSelector(),!this.callBlazorModel||this.blazorActions&Ks.interaction||this.blazorActions&Ks.GroupClipboardInProcess||this.commandHandler.getBlazorOldValues()}}disableStackContainerPadding(e,t){if(e instanceof Yc&&(e.considerPadding=t),e.children)for(const i of e.children)this.disableStackContainerPadding(i,!1)}scale(e,t,i,n){this.disableStackContainerPadding(e.wrapper,!1),this.insertBlazorDiagramObjects(e);let r=!0;if(e.id&&(e=this.nameTable[e.id]||e),e instanceof Ld){if(e.nodes&&e.nodes.length){this.callBlazorModel=!1;for(const s of e.nodes)r=this.commandHandler.scale(s,t,i,n,e),this.commandHandler.checkBoundaryConstraints(void 0,void 0,e.wrapper.bounds)||this.commandHandler.scale(s,1/t,1/i,n,e);this.callBlazorModel=!0}if(e.connectors&&e.connectors.length){this.callBlazorModel=!1;for(const r of e.connectors)this.commandHandler.scale(r,t,i,n,e),this.commandHandler.checkBoundaryConstraints(void 0,void 0,e.wrapper.bounds)||this.commandHandler.scale(r,1/t,1/i,n,e);this.callBlazorModel=!0}this.updateSelector(),this.refreshCanvasLayers()}else this.commandHandler.scale(e,t,i,n,e.children?e:void 0);return!this.callBlazorModel||this.blazorActions&Ks.interaction||this.blazorActions&Ks.GroupClipboardInProcess||this.commandHandler.getBlazorOldValues(),this.disableStackContainerPadding(e.wrapper,!0),r}rotate(e,t,i){let n;if(this.insertBlazorDiagramObjects(e),e.id&&(e=this.nameTable[e.id]||e),e)if(i=i||{x:e.wrapper.offsetX,y:e.wrapper.offsetY},e instanceof Ld){this.callBlazorModel=!1,e.rotateAngle+=t,e.wrapper.rotateAngle+=t;const r=cp(e.wrapper);if(n=this.commandHandler.checkBoundaryConstraints(void 0,void 0,r),!n)return e.rotateAngle-=t,e.wrapper.rotateAngle-=t,n;let s=[];s=s.concat(e.nodes),s=s.concat(e.connectors),this.commandHandler.rotateObjects(e,s,t,i),this.callBlazorModel=!0}else this.commandHandler.rotateObjects(e,[e],t,i);return!this.callBlazorModel||this.blazorActions&Ks.interaction||this.commandHandler.getBlazorOldValues(),n}dragSourceEnd(e,t,i){this.insertBlazorDiagramObjects(e),this.commandHandler.dragSourceEnd(e,t,i),this.callBlazorModel&&this.commandHandler.getBlazorOldValues()}dragTargetEnd(e,t,i){this.insertBlazorDiagramObjects(e),this.commandHandler.dragTargetEnd(e,t,i),this.callBlazorModel&&this.commandHandler.getBlazorOldValues()}findObjectsUnderMouse(e,t){return this.eventHandler.findObjectsUnderMouse(e,t)}findObjectUnderMouse(e,t,i){return this.eventHandler.findObjectUnderMouse(e,t,i)}findTargetObjectUnderMouse(e,t,i,n,r){return this.eventHandler.findTargetUnderMouse(e,t,i,n,r)}findElementUnderMouse(e,t,i){return this.eventHandler.findElementUnderMouse(e,t,i)}findActionToBeDone(e,t,i,n){return this.eventHandler.findActionToBeDone(e,t,i,n)}getTool(e){let t;const i=Cp(this.getCustomTool);return i&&(t=i(e),t)?t:this.eventHandler.getTool(e)}getCursor(e,t){let i;const n=Cp(this.getCustomCursor);if(n&&(i=n(e,t),i))return i;if(this.customCursor.length)for(let r=0;r<this.customCursor.length;r++)if(this.customCursor[r].action===e)return this.customCursor[r].cursor;return this.eventHandler.getCursor(e)}initHistory(){this.undoRedoModule&&this.undoRedoModule.initHistory(this)}addHistoryEntry(e){if(this.undoRedoModule&&this.constraints&lo.UndoRedo&&(!this.currentSymbol||this.checkCurrentSymbol(this.currentSymbol,e))){if(e.undoObject&&"helper"===e.undoObject.id)return;this.undoRedoModule.addHistoryEntry(e,this),"StartGroup"!==e.type&&"EndGroup"!==e.type&&this.historyChangeTrigger(e,"CustomAction")}}checkCurrentSymbol(e,t){if(t.undoObject&&t.redoObject){const i=t.undoObject,n=t.undoObject;return!(!n.id||!i.id||n.id===e.id||i.id===e.id)||!1}return!1}addCustomHistoryEntry(e){}historyChangeTrigger(e,t){const i={};let n=[];if("Internal"===e.category){switch(e&&e.redoObject&&e.redoObject.nodes instanceof Array&&e.redoObject.connectors instanceof Array?n=e.redoObject.nodes.concat(e.redoObject.connectors):e.redoObject&&n.push(e.redoObject),i.type=e.type,e.type){case"PositionChanged":i.oldValue={offsetX:e.undoObject.offsetX,offsetY:e.undoObject.offsetY},i.newValue={offsetX:e.redoObject.offsetX,offsetY:e.redoObject.offsetY};break;case"RotationChanged":i.oldValue={rotateAngle:e.undoObject.rotateAngle},i.newValue={rotateAngle:e.redoObject.rotateAngle};break;case"SizeChanged":i.oldValue={offsetX:e.undoObject.offsetX,offsetY:e.undoObject.offsetY,width:e.undoObject.width,height:e.undoObject.height},i.newValue={offsetX:e.redoObject.offsetX,offsetY:e.redoObject.offsetY,width:e.redoObject.width,height:e.redoObject.height};break;case"CollectionChanged":i[e.changeType]=n;break;case"ConnectionChanged":i.oldValue={offsetX:e.undoObject.offsetX,offsetY:e.undoObject.offsetY},i.newValue={offsetX:e.redoObject.offsetX,offsetY:e.redoObject.offsetY}}let r;r={cause:e.category,source:n,change:i,action:t},n.length&&this.triggerEvent(vo.historyChange,r)}}startGroupAction(){this.diagramActions&go.UndoRedo||this.addHistoryEntry({type:"StartGroup",category:"Internal"})}endGroupAction(){this.diagramActions&go.UndoRedo||this.addHistoryEntry({type:"EndGroup",category:"Internal"})}undo(){this.canEnableBlazorObject=!0,this.callBlazorModel=!1,this.undoRedoModule&&this.constraints&lo.UndoRedo&&this.undoRedoModule.undo(this),this.commandHandler.getBlazorOldValues(),this.callBlazorModel=!0,this.canEnableBlazorObject=!1}redo(){this.canEnableBlazorObject=!0,this.callBlazorModel=!1,this.undoRedoModule&&this.constraints&lo.UndoRedo&&this.undoRedoModule.redo(this),this.commandHandler.getBlazorOldValues(),this.callBlazorModel=!0,this.canEnableBlazorObject=!1}getBlazorDiagramObjects(e){if(e)for(let t=0;t<e.length;t++)this.insertBlazorDiagramObjects(e[t]);else this.insertBlazorDiagramObjects(this.selectedItems);this.callBlazorModel=!1,this.canEnableBlazorObject=!0}align(e,t,i){this.getBlazorDiagramObjects(t),t||(t=(t=[]).concat(this.selectedItems.nodes,this.selectedItems.connectors)),this.diagramActions=this.diagramActions|go.PublicMethod,this.commandHandler.align(t,e,i||"Object"),this.commandHandler.getBlazorOldValues(),this.callBlazorModel=!0,this.canEnableBlazorObject=!1}distribute(e,t){this.getBlazorDiagramObjects(t),t||(t=(t=[]).concat(this.selectedItems.nodes,this.selectedItems.connectors)),this.diagramActions=this.diagramActions|go.PublicMethod,this.commandHandler.distribute(t,e),this.commandHandler.getBlazorOldValues(),this.canEnableBlazorObject=!1,this.callBlazorModel=!0}sameSize(e,t){this.getBlazorDiagramObjects(t),t||(t=(t=[]).concat(this.selectedItems.nodes,this.selectedItems.connectors)),this.diagramActions=this.diagramActions|go.PublicMethod,this.commandHandler.sameSize(t,e),this.commandHandler.getBlazorOldValues(),this.canEnableBlazorObject=!1,this.callBlazorModel=!0}updateBlazorDiagramProperties(e,t){t&&this.commandHandler.getDiagramOldValues(this.oldDiagramObject,e)}getZoomingAttribute(){const e=[];return e.push("scrollSettings"),e.push("snapSettings"),e}zoom(e,t){const i=this.getZoomingAttribute();this.updateBlazorDiagramProperties(i),this.scroller.zoom(e,0,0,t),this.blazorActions&Ks.interaction||this.updateBlazorDiagramProperties(i,!0)}zoomTo(e){const t=this.getZoomingAttribute();this.updateBlazorDiagramProperties(t);let i=e.zoomFactor?e.zoomFactor:.2;i="ZoomOut"===e.type?1/(1+i):1+i,this.scroller.zoom(i,0,0,e.focusPoint),this.updateBlazorDiagramProperties(t,!0)}pan(e,t,i){const n=this.getZoomingAttribute();this.updateBlazorDiagramProperties(n),this.setCursor("grabbing"),this.scroller.zoom(1,e,t,i),this.updateBlazorDiagramProperties(n,!0)}reset(){const e=this.getZoomingAttribute();this.updateBlazorDiagramProperties(e),this.scroller.zoom(1/this.scroller.currentZoom,-this.scroller.horizontalOffset,-this.scroller.verticalOffset,{x:0,y:0}),this.updateBlazorDiagramProperties(e,!0)}resetSegments(){if(this.constraints&lo.LineRouting&&this.lineRoutingModule)this.lineRoutingModule.lineRouting(this);else{let e;this.protectPropertyChange(!0);for(let t=0;t<this.connectors.length;t++)e=this.connectors[t],e.segments=[],this.connectorPropertyChange(e,{},{segments:e.segments});this.protectPropertyChange(!1)}}setBlazorDiagramProps(e){const t=this.getZoomingAttribute();e?this.updateBlazorDiagramProperties(t):this.updateBlazorDiagramProperties(t,!0)}triggerEvent(e,t){return zu(this,void 0,void 0,function*(){return t&&this.updateEventValue(t),yield this.trigger(vo[e],t)})}updateEventValue(e){const t=e.element;e.element&&t instanceof Ld&&t.nodes.length+t.connectors.length===1&&(e.element=1===t.nodes.length?t.nodes[0]:t.connectors[0])}addNodeToLane(e,t,i){if(this.nameTable[t]){const n=this.nameTable[t];if(this.protectPropertyChange(!0),this.undoRedoModule&&this.historyManager.startGroupAction(),this.nameTable[e.id]||(e.offsetX=n.wrapper.bounds.width+n.wrapper.bounds.x,e.offsetY=n.wrapper.bounds.height+n.wrapper.bounds.y,e=this.add(e)),e.parentId="",n.shape.phases.length)for(let r=0;r<n.shape.phases.length;r++){const s=t+i+r;if(this.nameTable[s]&&this.nameTable[s].isLane){const r=this.nameTable[s].wrapper.bounds,o={x:r.x+(r.x-n.wrapper.bounds.x+e.margin.left+e.wrapper.bounds.width/2),y:r.y+n.wrapper.bounds.y-e.margin.top};if("Horizontal"===n.shape.orientation?o.y=r.y:(o.x=r.x,o.y=r.y+(n.wrapper.bounds.y-this.nameTable[this.nameTable[s].parentId+n.shape.lanes[0].id+"_0_header"].wrapper.bounds.height+e.margin.top+e.wrapper.bounds.height/2)),r.containsPoint(o)||s===t+i+(n.shape.phases.length-1)){ch(this,this.nameTable[s],e,void 0,!0),ph(this.nameTable[s],n,e,this);break}}}else{const r=t+i+"0";this.nameTable[r]&&(ch(this,this.nameTable[r],e,void 0,!0),ph(this.nameTable[r],n,e,this))}this.undoRedoModule&&this.historyManager.endGroupAction(),this.protectPropertyChange(!1)}this.updateDiagramElementQuad()}showTooltip(e){e&&e.id&&!e.wrapper&&(e=this.nameTable[e.id]);const t=cp(e.wrapper);let i={x:0,y:0};const n=e.tooltip.content?e.tooltip.content:"X:"+Math.round(t.x)+" Y:"+Math.round(t.y);e&&"Custom"===e.tooltip.openOn&&(i=e instanceof Td?{x:e.offsetX+e.width/2,y:e.offsetY+e.height/2}:{x:e.targetPoint.x,y:e.targetPoint.x},this.commandHandler.showTooltip(e,i,n,"SelectTool",!0))}hideTooltip(e){e&&"Custom"===e.tooltip.openOn&&this.tooltipObject.close()}addNode(e,t){return this.add(e,t)}addChildToGroup(e,t){const i=this.allowServerDataBinding;this.enableServerDataBinding(!1);const n=this.isProtectedOnChange;this.protectPropertyChange(!0),e=this.getObject(e.id);const r=!(this.diagramActions&go.UndoRedo||this.diagramActions&go.Group||this.diagramActions&go.PreventHistory);r&&this.startGroupAction();const s=this.addChild(e,t);if(r){const t={};t[s]=dp(this.getObject(s));const i={type:"AddChildToGroupNode",changeType:"Insert",undoObject:dp(e),redoObject:dp(e),category:"Internal",objectId:s,childTable:t};this.addHistoryEntry(i),this.endGroupAction()}this.protectPropertyChange(n),this.enableServerDataBinding(i),this.updateSelector()}getHistoryStack(e){let t=[];const i=e?this.historyManager.undoStack:this.historyManager.redoStack;if(void 0!==this.historyManager.stackLimit){for(let n=i.length-1;n>=0;n--)if(t.push(i[n]),t.length>this.historyManager.stackLimit)return t}else t=i;return t}getEdges(e){return e.outEdge?this.nameTable[e.id].outEdges:this.nameTable[e.id].inEdges}getParentId(e){return this.nameTable[e].parentId}addConnector(e){return this.add(e)}UpdateBlazorDiagramModelCollection(e,t,i,n){if(!(this.blazorActions&Ks.ClearObject)){const r="sfBlazor",s="Blazor";if(window&&window[s]){let s;const o=[],a=[],l=[];let h=[];if(n&&!t)for(let e=0;e<this.blazorAddorRemoveCollection.length;e++)l.push(Lc(this.blazorAddorRemoveCollection[e])===ol?"Connector":"Node"),s=this.blazorAddorRemoveCollection[e],a.push(s),h=this.blazorRemoveIndexCollection;else if(!this.isServerUpdate||i){this.isServerUpdate=!0;let n=e;const r=[];let s,c=[];if(!t){c=i||this.commandHandler.getChildren(e,r);for(let e=0;e<c.length;e++)n=c[e],a.push(n),s=Lc(c[e])===ol?this.connectors.indexOf(c[e]):this.nodes.indexOf(c[e]),h.push(s),l.push(Lc(c[e])===ol?"Connector":"Node");i||(a.push(e),h.push(this.nodes.indexOf(e)),l.push(Lc(e)===ol?"Connector":"Node"))}if(t&&t.length>0)for(let e=0;e<t.length;e++)n=t[e],t[e]instanceof Td?a.push(n):o.push(n),l.push(Lc(t[e])===ol?"Connector":"Node");this.isServerUpdate=!1}const c={methodName:"UpdateBlazorDiagramObjects",diagramobj:{nodeObj:JSON.stringify(a),ObjectType:l,removalIndex:t?void 0:h,isMultipleObjects:!0,annotationIndex:void 0,connectorObj:JSON.stringify(o)}};window[r].updateBlazorProperties(c,this),n&&!t&&(this.blazorAddorRemoveCollection=[],this.blazorRemoveIndexCollection=[])}}}UpdateBlazorDiagramModel(e,t,i,n){if(!(this.blazorActions&Ks.GroupClipboardInProcess)){const r="sfBlazor",s="Blazor";if(window&&window[s]&&!this.isServerUpdate&&!(this.diagramActions&go.Clear)){const s={methodName:"UpdateBlazorDiagramObjects",diagramobj:{nodeObj:JSON.stringify(e),ObjectType:t,removalIndex:i,isMultipleObjects:!1,annotationIndex:n,connectorObj:void 0}};window[r].updateBlazorProperties(s,this)}}}UpdateBlazorLabelOrPortObjects(e,t,i,n){if(window&&window.Blazor&&e.length>0&&!this.isServerUpdate&&!(this.diagramActions&go.Clear)){const r=[],s=[],o=[];for(let i=0;i<e.length;i++)r.push(e[i]),s.push(t),o.push(n);const a={methodName:"UpdateBlazorDiagramObjects",diagramobj:{nodeObj:JSON.stringify(r),ObjectType:s,removalIndex:i,isMultipleObjects:!0,annotationIndex:o,connectorObj:null,portIndex:"Port"===t?o:[]}};window.sfBlazor.updateBlazorProperties(a,this)}}addBlazorDiagramObjects(){const e=[],t=[];if(this.dataBindingModule&&!(this.realActions&fo.PreventDataInit)){for(let t=0;t<this.nodes.length;t++)e.push(dp(this.nodes[t],void 0,void 0,!0));for(let e=0;e<this.connectors.length;e++)t.push(dp(this.connectors[e],void 0,void 0,!0))}if(window&&window.Blazor){let i={methodName:"AddBlazorObjects",diagramobj:{nodeObj:JSON.stringify(e),isConnector:!1}};window.sfBlazor.updateBlazorProperties(i,this),i={methodName:"AddBlazorObjects",diagramobj:{nodeObj:JSON.stringify(t),isConnector:!0}},window.sfBlazor.updateBlazorProperties(i,this)}}removeNodeEdges(e,t,i){const n=this.nameTable[e],r=i?n.outEdges:n.inEdges;if(r.length>0)for(let s=0;s<r.length;s++)r[s]===t&&r.splice(s,1)}insertBlazorConnector(e){}add(t,i){let n;const r=this.isProtectedOnChange;if(this.protectPropertyChange(!0),t){let e;if(e={element:t=dp(t),cause:this.diagramActions,state:"Changing",type:"Addition",cancel:!1},this.parentObject&&(e.parentId=this.parentObject.id),"helper"===t.id||this.diagramActions&go.PreventCollectionChangeOnDragOver||this.triggerEvent(vo.collectionChange,e),e.cancel&&this.drawingObject){this.removeElements(e.element),this.tooltipObject.close();let t,i=this.getObject(e.element.sourceID);if(Lc(e.element)===ol){if(e.element.sourceID&&(this.removeNodeEdges(e.element.sourceID,e.element.id,!0),i.ports.length>0)){for(let n=0;n<i.ports.length;n++){const r=i.ports[n];r.id===e.element.sourcePortID&&(t=!(r.outEdges.length>0))}this.removePortEdges(i,e.element.sourcePortID,e.element.id,t)}e.element.targetID&&this.removeNodeEdges(e.element.targetID,e.element.id,!1)}}this.diagramActions=this.diagramActions|go.PublicMethod,t.id=t.id||op();const r=this.activeLayer;if(!e.cancel&&!r.lock){if(r.objects.indexOf(t.id)<0&&!r.lock&&(r.visible||(r.visible=!0,this.dataBind()),r.objects.push(t.id)),Lc(t)===ol)n=new ol(this,"connectors",t,!0),n.status="New",ec(n,t,this.connectorDefaults),this.connectors.push(n),this.initObject(n),!1===t.visible&&this.updateElementVisibility(n.wrapper,n,t.visible),this.updateEdges(n),this.insertBlazorConnector(n);else{if(n=new Td(this,"nodes",t,!0),ec(n,t,this.nodeDefaults),n.parentId=t.parentId?t.parentId:n.parentId,n.umlIndex=t.umlIndex,n.status="New",this.nodes.push(n),this.initObject(n,r,void 0,i),this.updateTemplate(),this.bpmnModule){if(n.shape.annotations&&0!==n.shape.annotations.length)for(const e of this.bpmnModule.getTextAnnotationConn(n))this.initConnectors(e,r,!1);n.shape.activity&&n.shape.activity.subProcess.processes&&n.shape.activity.subProcess.processes.length&&this.bpmnModule.updateDocks(n,this)}if(this.lineRoutingModule&&this.constraints&lo.LineRouting){const e=this.spatialSearch.findObjects(n.wrapper.outerBounds);for(let t=0;t<e.length;t++){const i=e[t];i instanceof ol&&this.connectorPropertyChange(i,{},{sourceID:i.sourceID,targetID:i.targetID,sourcePortID:i.sourcePortID,targetPortID:i.targetPortID,sourcePoint:i.sourcePoint,targetPoint:i.targetPoint})}}if(n.umlIndex>-1&&t.parentId&&this.nameTable[t.parentId]&&"UmlClassifier"===this.nameTable[t.parentId].shape.type){const e=this.nameTable[t.parentId];e.children.splice(n.umlIndex,0,n.id),e.wrapper.children.splice(n.umlIndex,0,n.wrapper),e.wrapper.measure(new bs),e.wrapper.arrange(e.wrapper.desiredSize),this.updateDiagramObject(e)}}if(e={element:n,cause:this.diagramActions,state:"Changed",type:"Addition",cancel:!1},this.parentObject&&(e.parentId=this.parentObject.id),"helper"===t.id||this.diagramActions&go.PreventCollectionChangeOnDragOver||this.triggerEvent(vo.collectionChange,e),!(this.diagramActions&go.UndoRedo||this.diagramActions&go.Group||this.diagramActions&go.PreventHistory)){const e={type:"CollectionChanged",changeType:"Insert",undoObject:dp(t),redoObject:dp(t),category:"Internal"};this.addHistoryEntry(e)}this.parentObject=void 0,"SVG"===this.mode&&(this.updateSvgNodes(n),this.updateTextElementValue(n),this.updateDiagramObject(n),n.shape.activity&&n.shape.activity.subProcess.processes&&n.shape.activity.subProcess.processes.length&&this.updateProcesses(n),this.updateBridging())}}this.protectPropertyChange(r),this.resetDiagramActions(go.PublicMethod),n&&this.layers.length>1&&this.moveNode(n);for(const s of this.views){const t=this.views[s];t instanceof e||this.refreshCanvasDiagramLayer(t)}return this.renderReactTemplates(),n}updateSvgNodes(e){if(e.children)for(const t of e.children)if(this.nameTable[t]&&this.nameTable[t].parentId){const e=Nd(t+"_groupElement",this.element.id);e&&e.parentNode.removeChild(e)}}updateProcesses(e){if(this.bpmnModule&&e&&e.shape&&e.shape.activity&&e.shape.activity.subProcess.processes&&e.shape.activity.subProcess.processes.length){const t=e.shape.activity.subProcess.processes;this.moveSvgNode(e.id);for(const e of t){this.moveSvgNode(e);let t=[];t=t.concat(this.nameTable[e].outEdges,this.nameTable[e].inEdges);for(let e=t.length-1;e>=0;e--)this.moveSvgNode(t[e])}for(const e of t)this.nameTable[e].shape.activity.subProcess.processes&&this.nameTable[e].shape.activity.subProcess.processes.length&&this.updateProcesses(this.nameTable[e])}else this.moveSvgNode(e.id)}moveSvgNode(e){const t=Nd(e+"_groupElement",this.element.id),i=t.parentElement;t.parentNode.removeChild(t),i.appendChild(t)}addTextAnnotation(e,t){if(this.bpmnModule){const i=this.bpmnModule.addAnnotation(t,e,this);if(this.initConnectors(i,this.commandHandler.getObjectLayer(t.id),!1),this.updateDiagramObject(t),!(this.diagramActions&go.UndoRedo||this.diagramActions&go.Group)){const t={type:"CollectionChanged",changeType:"Insert",undoObject:dp(e),redoObject:dp(e),category:"Internal"};this.addHistoryEntry(t)}}}spliceConnectorEdges(e,t){let i=[];const n=t?this.nameTable[e.sourceID]:this.nameTable[e.targetID];if(n){i=t?n.outEdges:n.inEdges;for(let t=i.length-1;t>=0;t--)i[t]===e.id&&i.splice(t,1);for(let i=0;n.ports&&i<n.ports.length;i++)this.removePortEdges(n,n.ports[i].id,e.id,!t)}}removeDependentConnector(e){let t,i=[];i=i.concat(e.outEdges,e.inEdges);for(let n=i.length-1;n>=0;n--)t=this.nameTable[i[n]],t&&(this.connectorTable[t.id]=dp(t),this.remove(t))}removeObjectsFromLayer(e){if(e.children)for(let n=0;n<e.children.length;n++){const t=this.nameTable[e.children[n]];t&&this.removeObjectsFromLayer(t)}const t=this.layers.indexOf(this.commandHandler.getObjectLayer(e.id)),i=this.layers[t].objects.indexOf(e.id);i>-1&&($p(this,e)&&this.unSelect(e),this.layers[t].objects.splice(i,1),delete this.layers[t].zIndexTable[this.nameTable[e.id].zIndex])}removeElements(e){if("SVG"===this.mode||"Canvas"===this.mode&&"Native"===e.shape.type){const t=Nd(e.id+"_groupElement",this.element.id),i=e;if(i.ports&&i.ports.length>0)for(let e=0;e<i.ports.length;e++){const t=Nd(i.id+"_"+i.ports[e].id+"_groupElement",this.element.id);t&&t.parentNode.removeChild(t)}t&&t.parentNode.removeChild(t)}if(this.refreshCanvasLayers(),e.wrapper){const t=e.wrapper.children;let i;if(t)for(let n=0;n<t.length;n++){if(t[n]instanceof Io||t[n].id&&t[n].id.indexOf("icon_content")>0){t[n].id.indexOf("icon_content")>0&&"SVG"===this.mode&&(i=Nd(t[n].id+"_shape_groupElement",this.element.id),i&&i.parentNode.removeChild(i),i=Nd(t[n].id+"_rect_groupElement",this.element.id),i&&i.parentNode.removeChild(i));for(const i of this.views){Kd(t[n].id+"_groupElement",i);const r=this.scroller.removeCollection.indexOf(e.id);this.scroller.removeCollection.splice(r,1)}}else if(t[n]instanceof ka)for(const i of this.views)Kd(e.id+"_html_element",i),Kd(t[n].id+"_html_element",i),this.clearTemplate(["nodeTemplate_"+e.id]),t[n].annotationId&&this.clearTemplate(["annotationTemplate_"+e.id+t[n].annotationId]);yc(t[n].id)}}}removeCommand(){this.remove()}remove(e){let t,i=[];i=i.concat(this.selectedItems.nodes,this.selectedItems.connectors);let n=!1;if(e){if(this.insertBlazorConnector(e=this.nameTable[e.id]),e&&(bl(e)||this.diagramActions&go.Clear)&&(t={element:e,cause:this.diagramActions,state:"Changing",type:"Removal",cancel:!1},this.diagramActions&go.Clear||"helper"===e.id||this.triggerEvent(vo.collectionChange,t),!t.cancel)){if(bl(e)&&e&&e.shape&&"SwimLane"===e.shape.type&&function(e,t){const i=t.wrapper.children[0].rows;let n,r,s,o,a,l;for(r=0;r<i.length;r++)for(s=0;s<i[r].cells.length;s++){if(a=_h(i[r].cells[s]),a&&a.children)for(o=a.children.length-1;o>=0;o--)a.children[o].children&&(l=e.nameTable[a.children[o].id],l&&(l.isLane?Bh(e,l):(e.removeDependentConnector(l),e.diagramActions|=go.PreventHistory,l.constraints&so.Delete?e.remove(l):sh(e,l,{},!1),e.diagramActions&=~go.PreventHistory)));a&&(n=e.nameTable[a.id],n&&Bh(e,n))}}(this,e),this.bpmnModule&&this.bpmnModule.checkAndRemoveAnnotations(e,this))return void this.refreshCanvasLayers();if(!(this.diagramActions&go.UndoRedo||this.diagramActions&go.PreventHistory)&&(e instanceof Td||e instanceof ol)){const t={type:"CollectionChanged",changeType:"Remove",undoObject:dp(e),redoObject:dp(e),category:"Internal"};this.diagramActions&go.Clear||e.children&&!e.isLane&&!e.isPhase&&e.children.length>0&&this.undoRedoModule&&"None"===this.layout.type&&(this.historyManager.startGroupAction(),n=!0),e instanceof Td&&this.removeDependentConnector(e),e.isLane||e.isPhase||this.diagramActions&go.Clear||this.isStackChild(e)||this.addHistoryEntry(t)}let r;!e.children||e.isLane||e.isPhase||this.deleteGroup(e),e.parentId&&(this.deleteChild(e),this.nameTable[e.parentId]&&"UmlClassifier"===this.nameTable[e.parentId].shape.type&&(this.updateDiagramObject(this.nameTable[e.parentId]),this.updateConnectorEdges(this.nameTable[e.parentId]))),this.diagramActions=this.diagramActions|go.PublicMethod;const s=this.nameTable[e.id];if(s instanceof Td){if("Bpmn"===s.shape.type&&this.bpmnModule&&this.bpmnModule.removeBpmnProcesses(s,this),s.isLane||s.isPhase||"SwimLane"===s.shape.type){const e=s.isLane||s.isPhase?this.nameTable[s.parentId]:this.nameTable[s.id];s.isLane?Wh(this,s,e):s.isPhase&&Fh(this,s,e)}r=this.nodes.indexOf(s),-1!==r&&(this.crudDeleteNodes.push(this.nameTable[s.id]),this.nodes.splice(r,1),this.updateNodeEdges(s))}else r=this.connectors.indexOf(s),-1!==r&&(this.crudDeleteNodes.push(this.nameTable[s.id]),this.connectors.splice(r,1)),this.updateEdges(s),this.spliceConnectorEdges(e,!0),this.spliceConnectorEdges(e,!1);if(this.isServerUpdate||this.blazorActions&Ks.GroupClipboardInProcess||this.commandHandler.getBlazorOldValues(),n&&this.historyManager.endGroupAction(),$p(this,s)&&this.unSelect(s),!s.isPhase){if(this.removeObjectsFromLayer(e),this.currentDrawingObject&&(this.currentDrawingObject.wrapper=void 0),delete this.nameTable[e.id],i.length>0&&i[0].id===s.id&&s.parentId){const e=this.nameTable[s.parentId];e&&e.isLane&&"SwimLane"===this.nameTable[e.parentId].shape.type&&Nh(this,this.nameTable[e.parentId],e,s)}this.removeElements(s),this.updateBridging(),"SVG"!==this.mode&&this.refreshDiagramLayer(),this.diagramActions&go.Clear||(this.removeFromAQuad(s),t={element:e,cause:this.diagramActions,state:"Changed",type:"Removal",cancel:!1},"helper"!==e.id&&this.triggerEvent(vo.collectionChange,t),this.resetTool())}}}else if(i.length>0){this.undoRedoModule&&(this.historyManager.startGroupAction(),this.blazorActions|=Ks.GroupingInProgress,n=!0);for(let e=0;e<i.length;e++)if(this.nameTable[i[e].id]){if(i[e]instanceof ol&&this.bpmnModule&&this.bpmnModule.textAnnotationConnectors.indexOf(i[e])>-1)return void this.remove(this.nameTable[i[e].targetID]);this.remove(i[e])}n&&(this.blazorActions&=~Ks.GroupingInProgress,this.isServerUpdate=!0,this.commandHandler.getBlazorOldValues(),this.UpdateBlazorDiagramModelCollection(void 0,void 0,void 0,!0),this.historyManager.endGroupAction(),this.isServerUpdate=!1),this.clearSelection()}this.tooltipObject.close()}isStackChild(e){let t;const i=this.nameTable[e.parentId];if(e&&e.parentId&&i.container&&"Stack"===i.container.type&&"UmlClassifier"!==this.nameTable[e.parentId].shape.type){t=!0;const n={type:"StackChildPositionChanged",redoObject:{sourceIndex:void 0,source:e,target:void 0,targetIndex:void 0},undoObject:{sourceIndex:i.wrapper.children.indexOf(e.wrapper),source:e,target:void 0,targetIndex:void 0},category:"Internal"};this.diagramActions&go.UndoRedo||this.addHistoryEntry(n)}return t}deleteChild(e,t){let i;if(i="string"==typeof e?e:e.id,(t=t?this.nameTable[t.id]:this.nameTable[e.parentId])&&t.children){for(let e=0;e<t.children.length;e++)if(t.children[e]===i){t.children.splice(e,1);for(let e=0;e<t.wrapper.children.length;e++)t.wrapper.children[e].id===i&&t.wrapper.children.splice(e,1)}t.wrapper.measure(new bs),t.wrapper.arrange(t.wrapper.desiredSize)}}addChild(e,t,i){let n;const r=this.nameTable[e.id];if(r.children||(r.children=[]),r.children&&("string"==typeof t?this.nameTable[t]&&(n=t):(n=t.id=t.id||op(),this.add(t)),n&&(!t.umlIndex||-1===t.umlIndex))){const t=this.nameTable[n];t.parentId=r.id,r.container&&"Stack"===r.container.type&&this.updateStackProperty(r,t),i?(r.children.splice(i,0,n),r.wrapper.children.splice(i,0,t.wrapper)):(r.children.push(n),r.wrapper.children.push(t.wrapper)),r.wrapper.measure(new bs),r.wrapper.arrange(r.wrapper.desiredSize),r.isLane||(this.nameTable[e.id].width=r.wrapper.actualSize.width,this.nameTable[e.id].height=r.wrapper.actualSize.height,this.nameTable[e.id].offsetX=r.wrapper.offsetX,this.nameTable[e.id].offsetY=r.wrapper.offsetY),void 0!==r.container&&(t.offsetX=t.wrapper.offsetX,t.offsetY=t.wrapper.offsetY),(!r.parentId||this.nameTable[r.parentId]&&"SwimLane"!==this.nameTable[r.parentId].shape.type)&&this.updateDiagramObject(r)}return n}clear(){this.clearObjects()}clearObjects(e){let t=[];e?t=e:(t=t.concat(this.nodes),t=t.concat(this.connectors)),this.diagramActions=this.diagramActions|go.Clear;for(const i of t)this.nameTable[i.id]&&this.remove(i);this.diagramActions=this.diagramActions&~go.Clear,this.spatialSearch=new Eu(this.nameTable),this.initHistory()}startEditCommad(){let e;const t=this.selectedItems.nodes[0]?this.selectedItems.nodes[0]:void 0;if(t&&t instanceof Td)if(t.isLane&&t.parentId){const i=this.nameTable[t.parentId],n=i.shape.lanes,r=t.id.slice(i.id.length),s=r.substring(0,r.length-1);for(let o=0;o<n.length;o++)t.isLane&&s===n[o].id&&(e=this.nameTable[n[o].header.id])}else"SwimLane"===t.shape.type&&t.shape.header&&t.shape.hasHeader&&(e=this.nameTable[t.wrapper.children[0].rows[0].cells[0].children[0].id]);this.startTextEdit(e)}startTextEdit(e,t){if(!zl(this)&&!Ll(this)||Rl(this)){this.textEditing=!0;const i=this.scroller.transform,n=Nl(this)?i.scale:1,r=90;let s,o,a,l,h,c;if(e||(e=this.selectedItems.nodes[0]?this.selectedItems.nodes[0]:this.selectedItems.connectors[0]),e){e.shape&&"UmlClassifier"===e.shape.type&&(e=this.nameTable[e.children[0]]);let d=!1;if(this.bpmnModule&&(c=this.bpmnModule.getTextAnnotationWrapper(e,t),c&&(e=this.nameTable[e.id.split("_textannotation_")[0]])),c?d=!0:("Text"!==e.shape.type&&0===e.annotations.length&&(e.constraints&so.ReadOnly||(this.activeLabel.isGroup=!0,this.startGroupAction(),this.addLabels(e,[{id:op(),content:""}]))),!t&&("Text"!==e.shape.type&&e.annotations.length>0||"Text"===e.shape.type)&&(t="Text"===e.shape.type?e.wrapper.children[0].id.split("_")[1]:e.annotations[0].id),t&&(c=this.getWrapper(e.wrapper,t))),e&&c&&!(c instanceof ka)&&(!function(e,t){let i=0;return i=t instanceof ol?no.ReadOnly:so.ReadOnly,"Text"===t.shape.type?t.constraints&so.ReadOnly:t.constraints&i?e.constraints&ro.InheritReadOnly?1:0:e.constraints&ro.ReadOnly?1:0}(c,e)||d)){const d=c.style;let p;p=c.bounds.width<e.wrapper.bounds.width?c.bounds.width:e.wrapper.bounds.width,p=r>p?r:p;let u=document.getElementById(this.element.id+"_editTextBoxDiv"),g=document.getElementById(this.element.id+"_editBox");s=g?g.value:c.content,this.activeLabel.text=s,u||g||(u=Zd("div",{}),g=Zd("textarea",{}),this.diagramCanvas.appendChild(u),u.appendChild(g),g.appendChild(document.createTextNode(s))),o=kd(c.style,s,void 0,void 0,p),o.isEmpty()&&(o=new bs("Text"!==e.shape.type?Pc(e,c.id.split(e.id+"_")[1]).width||50:e.width>50?50:e.width,c.style.fontSize)),e.parentId&&"UmlClassifier"===this.nameTable[e.parentId].shape.type?(o.width=e.wrapper.bounds.width-20,l=(e.wrapper.bounds.center.x+i.tx)*i.scale-o.width/2*n-2.5,h=(e.wrapper.bounds.center.y+i.ty)*i.scale-o.height/2*n-3,c.style.textAlign="Left"):(o.width=Math.max(o.width,50),l=(c.bounds.center.x+i.tx)*i.scale-o.width/2*n-2.5,h=(c.bounds.center.y+i.ty)*i.scale-o.height/2*n-3),a={id:this.element.id+"_editTextBoxDiv",style:"position: absolute;left:"+l+"px;top:"+h+"px;width:"+(o.width+1)*n+"px;height:"+o.height*n+"px; containerName:"+e.id+";"},np(u,a),a={id:this.element.id+"_editBox",style:"width:"+(o.width+1)*n+"px;height:"+o.height*n+"px;resize: none;outline: none;overflow: hidden;;font-family:"+d.fontFamily+";font-size:"+d.fontSize*n+"px;text-align:"+c.style.textAlign.toLocaleLowerCase()+";",class:"e-diagram-text-edit"},np(g,a),g.style.fontWeight=d.bold?"bold":"",g.style.fontStyle=d.italic?"italic":"",g.style.lineHeight=(1.2*d.fontSize+"px;").toString(),g.style.textDecoration=d.textDecoration?d.textDecoration:"",this.activeLabel.parentId=e.id,this.activeLabel.id=t,c.visible=!1,this.updateDiagramObject(e),this.diagramActions=this.diagramActions|go.TextEdit,this.isTriggerEvent||($.add(g,"input",this.eventHandler.inputChange,this.eventHandler),$.add(g,"focusout",this.focusOutEdit,this),g.select())}}}}updateConnectorfixedUserHandles(e){if(e.fixedUserHandles.length){let t;for(const i of e.fixedUserHandles)t=this.getWrapper(e.wrapper,i.id),e.updateAnnotation(i,e.intermediatePoints,e.wrapper.bounds,t)}e.wrapper.measure(new bs(e.wrapper.width,e.wrapper.height)),e.wrapper.arrange(e.wrapper.desiredSize)}updateNodeExpand(e,t){for(let i=0;i<e.outEdges.length;i++){const n=this.nameTable[e.outEdges[i]],r=this.nameTable[n.targetID];n.visible=t,t||(this.updateElementVisibility(n.wrapper,n,!1),r.isExpanded=t),this.updateNodeExpand(r,r.isExpanded),r.visible=t,t||this.updateElementVisibility(r.wrapper,r,!1)}}updateConnectorAnnotation(e){if(e.annotations.length){let t;for(const i of e.annotations)t=this.getWrapper(e.wrapper,i.id),e.updateAnnotation(i,e.intermediatePoints,e.wrapper.bounds,t,this.diagramActions&go.Interactions)}e.wrapper.measure(new bs(e.wrapper.width,e.wrapper.height)),e.wrapper.arrange(e.wrapper.desiredSize)}removeChildrenFromLayout(e){const t=[];let i;for(let n=0;n<e.length;n++)i=e[n],i.parentId||i.processId||t.push(i);return t}doLayout(){let e,t=!1;const i="ComplexHierarchicalTree"===this.layout.type||"HierarchicalTree"===this.layout.type,n=this.isProtectedOnChange;this.protectPropertyChange(!0);const r=this.removeChildrenFromLayout(this.nodes),s=this.layout.enableRouting&&"ComplexHierarchicalTree"===this.layout.type,o={x:this.scroller.viewPortWidth,y:this.scroller.viewPortHeight};if("None"!==this.layout.type){if((s||"DifferentPoint"===this.layout.connectionPointOrigin&&this.lineDistributionModule&&i||"Linear"===this.layout.arrangement)&&this.lineDistributionModule.initLineDistribution(this.layout,this),this.organizationalChartModule)e=this.organizationalChartModule.updateLayout(r,this.nameTable,this.layout,o,this.dataSourceSettings.id,this.diagramActions),t=!0,this.layoutAnimateModule&&e.rootNode&&!this.diagramActions&&this.updateNodeExpand(e.rootNode,e.rootNode.isExpanded);else if(this.mindMapChartModule)r&&r.length>0&&this.mindMapChartModule.updateLayout(r,this.nameTable,this.layout,o,this.dataSourceSettings.id,this.dataSourceSettings.root),t=!0;else if(this.radialTreeModule)this.radialTreeModule.updateLayout(r,this.nameTable,this.layout,o),t=!0;else if(this.symmetricalLayoutModule)this.symmetricalLayoutModule.maxIteration=this.layout.maxIteration,this.symmetricalLayoutModule.springLength=this.layout.springLength,this.symmetricalLayoutModule.springFactor=this.layout.springFactor,this.symmetricalLayoutModule.updateLayout(r,this.connectors,this.symmetricalLayoutModule,this.nameTable,this.layout,o),t=!0;else if(this.complexHierarchicalTreeModule){const e=this.complexHierarchicalTreeModule.getLayoutNodesCollection(this.nodes);e.length>0&&this.complexHierarchicalTreeModule.doLayout(e,this.nameTable,this.layout,o,this.lineDistributionModule),t=!0}if(t){this.preventDiagramUpdate=!0;const e={},t=r;for(const i of t){const t=i;if(this.preventNodesUpdate||this.diagramActions&&this.diagramActions&go.PreventIconsUpdate||(this.updateIcon(t),this.updateDefaultLayoutIcons(t)),this.preventNodesUpdate=!0,this.nodePropertyChange(t,{},{offsetX:t.offsetX,offsetY:t.offsetY},!0),this.preventNodesUpdate=!1,t.wrapper.measure(new bs(t.wrapper.width,t.wrapper.height)),t.wrapper.arrange(t.wrapper.desiredSize),this.updateDiagramObject(t,!0),t.inEdges.length>0)for(let i=0;i<t.inEdges.length;i++){const n=this.nameTable[t.inEdges[i]];e[n.id]=n}if(t.outEdges.length>0)for(let i=0;i<t.outEdges.length;i++){const n=this.nameTable[t.outEdges[i]];e[n.id]=n}}for(const i of Object.keys(e)){s&&this.lineDistributionModule.resetConnectorSegments(this.nameTable[i]);const t=e[i],n=this.getPoints(t);s&&this.lineDistributionModule.resetRoutingSegments(t,this,n),vc(t,n),"Bpmn"===t.shape.type&&"Default"===t.shape.sequence&&this.commandHandler.updatePathElementOffset(t),t.wrapper.measure(new bs(void 0,void 0)),t.wrapper.arrange(t.wrapper.desiredSize),this.updateConnectorAnnotation(t),this.updateConnectorfixedUserHandles(t),this.updateQuad(t),this.updateDiagramObject(t,!0)}(s||"DifferentPoint"===this.layout.connectionPointOrigin&&this.lineDistributionModule&&i)&&this.lineDistributionModule.distributeLines(this.layout,this),this.preventDiagramUpdate=!1,this.updatePage(),this.diagramActions&go.Render&&"Canvas"!==this.mode||this.refreshDiagramLayer()}n||this.protectPropertyChange(n)}return t&&this.updateDiagramElementQuad(),!(this.blazorActions&Ks.expandNode)||e}saveDiagram(){let e,t,i,n,r=[];for(let s=0;s<this.nodes.length;s++)if(e=this.nodes[s],"SwimLane"===e.shape.type){t=e.wrapper.children[0],i=t.childTable;for(const e of Object.keys(i))n=i[e],r=cc(n,r);for(let e=0;e<r.length;e++)this.nameTable[r[e]]&&(this.swimlaneChildTable[r[e]]=this.nameTable[r[e]].zIndex);this.swimlaneZIndexTable[e.id]=e.zIndex}return function(e){const t=function(e){let t,i,n,r,s=[];for(let o=0;o<e.length;o++)if(t=e[o],"SwimLane"===t.shape.type){i=t.wrapper.children[0],n=i.childTable;for(const e of Object.keys(n))r=n[e],s=cc(r,s)}return s}(e.nodes);let i=dp(e,e.getCustomProperty);return i.selectedItems.nodes=[],i.selectedItems.connectors=[],i.selectedItems.wrapper=null,e.serializationSettings.preventDefaults&&(i=dc(i,e)),function(e,t){const i=t.nodes;if(i)for(let n=0;n<i.length;n++)-1!==e.indexOf(i[n].id)&&(i.splice(n,1),n--)}(t,i),JSON.stringify(i)}(this)}loadDiagram(e){return function(e,t){t.enableServerDataBinding(!1);const i=t.blazorActions;t.blazorActions=t.addConstraints(i,Ks.ClearObject),t.clear(),t.blazorActions=t.removeConstraints(i,Ks.ClearObject),t.protectPropertyChange(!0);const n=t.dataSourceSettings.doBinding,r=t.setNodeTemplate,s=t.getDescription,o=t.getCustomProperty,a={};for(let f of t.commandManager.commands)a[f.name]={execute:f.execute,canExecute:f.canExecute};const l=t.rulerSettings.horizontalRuler.arrangeTick,h=t.rulerSettings.verticalRuler.arrangeTick,c=t.layout.getLayoutInfo,d=t.layout.getBranch,p=t.getNodeDefaults,u=t.getConnectorDefaults;let g,m=JSON.parse(e);m=function(e){if(e&&(void 0===e.version||e.version<17.1)&&e.nodes){const t=e.nodes;for(const e of t)if(e&&e.ports&&e.ports.length>0)for(const t of e.ports)t&&t.constraints&&t.constraints===wo.None&&(t.constraints=wo.Default)}return e}(m),t.contextMenuSettings=m.contextMenuSettings||{},t.constraints=m.constraints||lo.Default,t.tool=m.tool||ho.Default,t.bridgeDirection=m.bridgeDirection||"Top",t.pageSettings=m.pageSettings||{},t.drawingObject=m.drawingObject||void 0,t.tooltip=m.tooltip||{},t.addInfo=m.addInfo||void 0,t.getDescription=s,t.scrollSettings=m.scrollSettings||{},t.commandManager=m.commandManager||{},t.layers=m.layers||[],t.rulerSettings.horizontalRuler.arrangeTick=l,t.rulerSettings.verticalRuler.arrangeTick=h;for(const f of t.commandManager.commands)a[f.name]&&(f.execute=a[f.name].execute,f.canExecute=a[f.name].canExecute);if(t.backgroundColor=m.backgroundColor||"transparent",t.basicElements=m.basicElements||[],t.connectors=m.connectors||[],t.dataSourceSettings=m.dataSourceSettings||{},t.dataSourceSettings.doBinding=n,t.height=m.height||"100%",t.setNodeTemplate=r,t.getConnectorDefaults=u,t.getNodeDefaults=p,t.getCustomProperty=o,t.mode=m.mode||"SVG",m.nodes)for(let f=0;f<m.nodes.length;f++)m.nodes[f].shape&&"SwimLane"===m.nodes[f].shape.type&&(null==m.nodes[f].wrapper&&(m.nodes[f].wrapper={actualSize:{width:m.nodes[f].width,height:m.nodes[f].height},offsetX:m.nodes[f].offsetX,offsetY:m.nodes[f].offsetY}),jh(m.nodes[f],void 0,void 0,void 0,void 0,!0));t.nodes=m.nodes||[],t.rulerSettings=m.rulerSettings||{},t.snapSettings=m.snapSettings||{},t.width=m.width||"100%",t.layout=m.layout||{},m.layout&&"None"!==m.layout.type&&(t.canLayout=!1),t.layout.getLayoutInfo=Cp(c),t.layout.getBranch=Cp(d),t.diagramActions=0,t.isLoading=!0,t.protectPropertyChange(!1);for(let f=0;f<t.views.length;f++)g=t.views[t.views[f]],t.blazorActions=t.addConstraints(i,Ks.ClearObject),g.refresh(),t.blazorActions=t.removeConstraints(i,Ks.ClearObject),g instanceof Mu&&t.element.classList.add("e-diagram");return m.selectedItems&&(m.selectedItems.nodes=[],m.selectedItems.connectors=[]),t.selectedItems=m.selectedItems,t.enableServerDataBinding(!0),t.canLayout=!0,t.swimlaneChildTable={},t.swimlaneZIndexTable={},m}(e,this)}getDiagramContent(e){return this.printandExportModule?this.printandExportModule.getDiagramContent(e):""}exportImage(e,t){this.printandExportModule&&this.printandExportModule.exportImages(e,t)}printImage(e,t){this.printandExportModule&&(t.printOptions=!0,this.printandExportModule.exportImages(e,t))}setStackLimit(e){this.undoRedoModule&&e&&(this.historyManager.stackLimit=e,this.undoRedoModule.applyLimit(this.historyManager.currentEntry,e,this,!0))}clearHistory(){this.undoRedoModule&&this.undoRedoModule.clearHistory(this)}getDiagramBounds(){if(this.printandExportModule){const e=this.printandExportModule.getDiagramBounds("",{});return e.width=e.width>this.scrollSettings.viewPortWidth?e.width+(e.x>0?e.x:0):this.scrollSettings.viewPortWidth,e.height=e.height>this.scrollSettings.viewPortHeight?e.height+(e.y>0?e.y:0):this.scrollSettings.viewPortHeight,e.x=e.x>0?0:e.x,e.y=e.y>0?0:e.y,e}return new Ds}exportDiagram(e){return this.printandExportModule?this.printandExportModule.exportDiagram(e):""}print(e){this.printandExportModule&&this.printandExportModule.print(e)}addPorts(e,t){let i;this.protectPropertyChange(!0),e=this.nameTable[e.id]||e,t.length>1&&this.startGroupAction();for(let n=0;n<t.length;n++)if(i=new Lo(e,"ports",t[n],!0),e.ports.push(i),e.children?e.initPort(this.getDescription,e.wrapper.children[e.wrapper.children.length-1],i):e.wrapper.children.push(e.initPortWrapper(e.ports[e.ports.length-1])),!(this.diagramActions&go.UndoRedo||this.diagramActions&go.Group)){const t={type:"PortCollectionChanged",changeType:"Insert",undoObject:dp(i),redoObject:dp(e),category:"Internal"};this.addHistoryEntry(t)}t.length>1&&this.endGroupAction(),e.wrapper.measure(new bs(e.width,e.height)),e.wrapper.arrange(e.wrapper.desiredSize),this.updateDiagramObject(e),this.protectPropertyChange(!1)}addConstraints(e,t){return e|t}removeConstraints(e,t){return e&~t}addNodeLabels(e,t){this.addLabels(e,t)}addConnectorLabels(e,t){this.addLabels(e,t)}addLabels(e,t){this.protectPropertyChange(!0);const i=(e=this.nameTable[e.id]||e).wrapper;let n;t.length>1&&this.startGroupAction();for(let r=0;r<t.length;r++){if(e instanceof Td)if(n=new jo(e,"annotations",t[r],!0),e.annotations.push(n),e.children){const t=e;for(let i=0;i<t.wrapper.children.length;i++)t.wrapper.children[i].id===t.id+"group_container"&&t.wrapper.children[i].children.push(e.initAnnotationWrapper(e.annotations[e.annotations.length-1],this.element.id))}else i.children.push(e.initAnnotationWrapper(e.annotations[e.annotations.length-1],this.element.id));else if(e instanceof ol){n=new Ho(e,"annotations",t[r],!0),e.annotations.push(n);const s=i.children[0],o=new Ds(s.offsetX-s.width/2,s.offsetY-s.height/2,s.width,s.height);i.children.push(e.getAnnotationElement(e.annotations[e.annotations.length-1],e.intermediatePoints,o,this.getDescription,this.element.id))}if(!(this.diagramActions&go.UndoRedo||this.diagramActions&go.Group)){const t={type:"LabelCollectionChanged",changeType:"Insert",undoObject:dp(n),redoObject:dp(e),category:"Internal"};this.addHistoryEntry(t)}}t.length>1&&this.endGroupAction(),e.wrapper.measure(new bs(i.width,i.height)),e.wrapper.arrange(i.desiredSize),this.updateDiagramObject(e),this.protectPropertyChange(!1)}addLanes(e,t,i){e=this.nameTable[e.id]||e;for(let n=0;n<t.length;n++)Rh(this,e,t[n],i),void 0!==i&&(i+=1);this.updateDiagramElementQuad()}addPhases(e,t){e=this.nameTable[e.id]||e;for(let i=0;i<t.length;i++)zh(this,e,t[i]);this.updateDiagramElementQuad()}removeLane(e,t){Wh(this,void 0,e,t),this.updateDiagramElementQuad()}removePhase(e,t){Fh(this,void 0,e,t),this.updateDiagramElementQuad()}removelabelExtension(e,t,i,n){for(let r=0;r<n.children.length;r++){const s=n.children[r];if((s instanceof Co||s instanceof ka)&&s.id.match("_"+t[i].id+"$")){for(let t=0;t<e.annotations.length;t++)if(s.id.match("_"+e.annotations[t].id+"$")){if(!(this.diagramActions&go.UndoRedo)){const i={type:"LabelCollectionChanged",changeType:"Remove",undoObject:dp(e.annotations[t]),redoObject:dp(e),category:"Internal"};this.addHistoryEntry(i)}e.annotations.splice(t,1)}if(n.children.splice(r,1),"SVG"===this.mode){let e=Nd(s.id,this.element.id);if(e){const e=Nd(s.id,this.element.id);e.parentNode.removeChild(e)}Nd(s.id+"_text",this.element.id)&&(e=Nd(s.id+"_text",this.element.id),e.parentNode.removeChild(e));const t=Nd(s.id+"_html_element",this.element.id);t&&t.parentNode.removeChild(t)}else this.refreshCanvasLayers()}}}removeLabels(e,t){e=this.nameTable[e.id]||e,t.length>1&&this.startGroupAction();for(let i=t.length-1;i>=0;i--)if(e.children&&e.children.length>0)for(let n=0;n<e.wrapper.children.length;n++)this.removelabelExtension(e,t,i,e.wrapper.children[n]);else this.removelabelExtension(e,t,i,e.wrapper);t.length>1&&this.endGroupAction()}removePortsExtenion(e,t,i,n){for(let r=0;r<n.children.length;r++){const s=n.children[r];if(s instanceof Eo&&s.id.match("_"+t[i].id+"$")){for(let t=0;t<e.ports.length;t++)if(s.id.match("_"+e.ports[t].id+"$")){if(!(this.diagramActions&go.UndoRedo)){const i={type:"PortCollectionChanged",changeType:"Remove",undoObject:dp(e.ports[t]),redoObject:dp(e),category:"Internal"};this.addHistoryEntry(i)}e.ports.splice(t,1)}if(n.children.splice(r,1),"SVG"===this.mode){const e=Nd(s.id,this.element.id);e.parentNode.removeChild(e)}else this.refreshCanvasLayers()}}}removePorts(e,t){e=this.nameTable[e.id]||e,t.length>1&&this.startGroupAction();for(let i=t.length-1;i>=0;i--)if(e.children&&e.children.length>0)for(let n=0;n<e.wrapper.children.length;n++)this.removePortsExtenion(e,t,i,e.wrapper.children[n]);else this.removePortsExtenion(e,t,i,e.wrapper);t.length>1&&this.endGroupAction()}getSizeValue(e,t){let i;return i=e.toString().indexOf("px")>0?e.toString():e.toString().indexOf("%")>0?void 0!==t?"100%":e.toString():e.toString()+"px",t&&(pl(this),i="calc("+i+" - "+t+"px)"),i}renderRulers(){this.rulerSettings.showRulers?(function(e){const t=pl(e),i=Zd("div",{id:e.element.id+"_overlapRuler",style:"height:"+t.height+"px;width:"+t.width+"px;position:absolute;left:0;top:0",class:"e-ruler-overlap"});e.element.insertBefore(i,e.element.firstChild)}(this),hl(this,!0),hl(this,!1)):dl(this)}intOffPageBackground(){let e=new bs;e=pl(this);const t=document.getElementById(this.element.id+"content"),i=this.getSizeValue(this.width,e.width),n=this.getSizeValue(this.height,e.height),r=this.rulerSettings.showRulers?"width:"+i+"; height:"+n+";top:"+e.height+"px;left:"+e.width+"px;overflow: scroll;position:absolute;overflow:auto;":"width:"+i+"; height:"+n+";position:absolute; left:0px;  top:0px;overflow: auto;",s={id:this.element.id+"content",tabindex:"0",style:r};t?(this.diagramCanvas=t,ip(this.diagramCanvas,r)):(this.diagramCanvas=Zd("div",s),this.element.appendChild(this.diagramCanvas)),this.diagramCanvas.style.background=this.backgroundColor}initDiagram(){this.intOffPageBackground(),np(this.element,{style:"width:"+this.getSizeValue(this.width)+"; height:"+this.getSizeValue(this.height)+";position:relative;overflow:hidden;"})}renderHiddenUserHandleTemplateLayer(e){const t=Zd("div",{class:this.element.id+"_hiddenUserHandleTemplate",style:"width:"+e.width+"px; height:"+e.height+"px;visibility:hidden ;  overflow: hidden;"});this.element.appendChild(t)}renderBackgroundLayer(e,t){const i=this.createSvg(this.element.id+"_backgroundLayer_svg",e.width,e.height);ip(i,t);const n=$d("g",{id:this.element.id+"_backgroundImageLayer",class:"e-background-image-layer"});i.appendChild(n);const r=$d("g",{id:this.element.id+"_backgroundLayer",class:"e-background-layer"});i.appendChild(r),this.diagramCanvas.appendChild(i)}renderGridLayer(e,t){const i=this.createSvg(this.element.id+"_gridline_svg",e.width,e.height);i.setAttribute("class","e-grid-layer");const n=$d("g",{id:this.element.id+"_gridline"}),r=$d("rect",{id:this.element.id+"_grid_rect",x:"0",y:"0",width:"100%",height:"100%"});Wc()?r.setAttribute("fill","url("+location.protocol+"//"+location.host+location.pathname+"#"+this.element.id+"_pattern)"):r.setAttribute("fill","url(#"+this.element.id+"_pattern)"),n.appendChild(r),i.appendChild(n),this.diagramCanvas.appendChild(i),tp(i,{style:t})}renderDiagramLayer(e,t){if(this.diagramLayerDiv=Zd("div",{id:this.element.id+"_diagramLayer_div",style:"width:"+e.width+"px; height:"+e.height+"px;"+t}),"SVG"===this.mode){const t=this.createSvg(this.element.id+"_diagramLayer_svg",e.width,e.height);t.style["pointer-events"]="none",t.setAttribute("class","e-diagram-layer");const i=$d("g",{id:this.element.id+"_diagramLayer"}),n=$d("g",{});this.diagramLayer=i,t.style["pointer-events"]="all",n.appendChild(i),t.appendChild(n),this.diagramLayerDiv.appendChild(t)}else this.diagramLayer=Pp.createCanvas(this.element.id+"_diagram",e.width,e.height),ip(this.diagramLayer,"position:absolute;left:0px;top:0px;"),this.diagramLayerDiv.appendChild(this.diagramLayer);this.diagramCanvas.appendChild(this.diagramLayerDiv)}initLayers(){const e="position:absolute;top:0px;left:0px;overflow:hidden;pointer-events:none;",t=document.getElementById(this.element.id).getBoundingClientRect(),i=function(){const e=Zd("div",{style:"visibility:hidden; width: 100px"});document.body.appendChild(e);const t=e.getBoundingClientRect().width;e.style.overflow="scroll";const i=Zd("div",{style:"width:100%"});e.appendChild(i);const n=i.getBoundingClientRect().width;return e.parentNode.removeChild(e),t-n}();this.scroller.scrollerWidth=i,this.scroller.setViewPortSize(t.width,t.height),this.renderRulers(),window.measureElement&&(window.measureElement=null,document.getElementById("measureElement").remove()),function(){if(window.measureElement)window.measureElement.usageCount+=1;else{const e=Zd("div",{id:"measureElement",style:"visibility:hidden ; height: 0px ; width: 0px; overflow: hidden;"}),t=Zd("span",{style:"display:inline-block ; line-height: normal"});e.appendChild(t);const i=Zd("img",{});e.appendChild(i);const n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttribute("xlink","http://www.w3.org/1999/xlink"),e.appendChild(n);const r=document.createElementNS("http://www.w3.org/2000/svg","path");n.appendChild(r),document.createTextNode("");const s=document.createElementNS("http://www.w3.org/2000/svg","text");s.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),n.appendChild(s),window.measureElement=e,window.measureElement.usageCount=1,document.body.appendChild(e);const o="measureElementCount";window[o]?window[o]++:window[o]=1}}(),this.renderBackgroundLayer(t,e),this.renderGridLayer(t,e),this.renderDiagramLayer(t,e),this.renderHTMLLayer(t,e),this.renderPortsExpandLayer(t,e),this.renderNativeLayer(t,e),this.renderAdornerLayer(t,e),this.renderHiddenUserHandleTemplateLayer(t)}renderAdornerLayer(e,t){const i=Zd("div",{id:this.element.id+"_diagramAdornerLayer",style:"width:"+e.width+"px;height:"+e.height+"px;"+t}),n=Zd("div",{id:this.element.id+"_diagramUserHandleLayer",style:"width:"+e.width+"px;height:"+e.height+"px;"+t});n.setAttribute("class","e-userHandle-layer"),i.appendChild(n);const r=this.createSvg(this.element.id+"_diagramAdorner_svg",e.width,e.height);r.setAttribute("class","e-adorner-layer"),r.style["pointer-events"]="none",this.adornerLayer=$d("g",{id:this.element.id+"_diagramAdorner"}),this.adornerLayer.style[" pointer-events"]="all",r.appendChild(this.adornerLayer),i.appendChild(r),this.diagramCanvas.appendChild(i);const s=$d("g",{id:this.element.id+"_SelectorElement"});this.adornerLayer.appendChild(s),tp(r,{style:"pointer-events:none;"})}renderPortsExpandLayer(e,t){const i=this.createSvg(this.element.id+"_diagramPorts_svg",e.width,e.height);i.setAttribute("class","e-ports-expand-layer");const n=$d("g",{id:this.element.id+"_diagramPorts",class:"e-ports-layer",style:"pointer-events: all;"});i.appendChild(n);const r=$d("g",{id:this.element.id+"_diagramExpander",class:"e-expand-layer",style:"pointer-events: all;"});i.appendChild(r),this.diagramCanvas.appendChild(i),tp(i,{style:t})}renderHTMLLayer(e,t){this.htmlLayer=Zd("div",{id:this.element.id+"_htmlLayer",style:"width:"+e.width+"px; height:"+e.height+"px;position:absolute;top:0px;left:0px;overflow:hidden;pointer-events:none;",class:"e-html-layer"});const i=Zd("div",{id:this.element.id+"_htmlLayer_div",style:"position:absolute;top:0px;left:0px;pointer-events:all;"});this.htmlLayer.appendChild(i),this.diagramCanvas.appendChild(this.htmlLayer)}renderNativeLayer(e,t){const i=this.createSvg(this.element.id+"_nativeLayer_svg",e.width,e.height),n=$d("g",{id:this.element.id+"_nativeLayer",style:"pointer-events:all;"});i.appendChild(n),this.diagramLayerDiv.appendChild(i),tp(i,{class:"e-native-layer",style:t})}createSvg(e,t,i){const n=document.createElementNS("http://www.w3.org/2000/svg","svg");return tp(n,{id:e,width:t,height:i}),n}updateBazorShape(){for(let e=0;e<this.nodes.length;e++){const t=this.nodes[e];switch(t.shape.type){case"Bpmn":t.shape.bpmnShape=t.shape.shape?t.shape.shape:t.shape.bpmnShape;break;case"UmlActivity":t.shape.umlActivityShape=t.shape.shape?t.shape.shape:t.shape.umlActivityShape;break;case"Flow":t.shape.flowShape=t.shape.shape?t.shape.shape:t.shape.flowShape;break;case"Basic":t.shape.basicShape=t.shape.shape?t.shape.shape:t.shape.basicShape;break;case"Text":t.shape.textContent=t.shape.content?t.shape.content:t.shape.textContent}}}initObjects(e){this.updateBazorShape(),this.isLoading||this.initData(),this.initLayerObjects(),this.updateBridging(e)}initLayerObjects(){const e=this.layers.length>1,t=[],i=(window&&window,{}),n={},r=[];for(const o of this.nodes)o.id=o.id||op(),this.addToLayer(o,e),i[o.id]=o;for(const o of this.connectors)o.id=o.id||op(),this.addToLayer(o,e),i[o.id]=o;for(const o of this.layers){for(const e of o.objects)if(i[e])if(i[e]instanceof ol){const n=i[e];if(n.sourceID&&n.targetID){const r=i[n.sourceID],s=i[n.targetID];let a=!0;this.isLoading&&(r&&r.children&&r.children.length>0||s&&s.children&&s.children.length>0)&&(a=!1),r&&r.wrapper&&s&&s.wrapper&&a?this.initConnectors(i[e],o):t.push(i[e])}else this.initConnectors(i[e],o)}else i[e].children?r.push(e):i[e].shape instanceof fd&&i[e].shape.activity.subProcess.processes&&i[e].shape.activity.subProcess.processes.length>0?n[i[e].id]=e:this.initNodes(i[e],o);if(this.bpmnModule)for(const e of this.bpmnModule.textAnnotationConnectors)this.initConnectors(e,o,!1)}for(const o of Object.keys(n))this.initObject(i[o]),this.bpmnModule.updateDocks(i[o],this);const s=this.alignGroup(r,i);for(const o of s){const e=this.commandHandler.getObjectLayer(o);this.initNodes(i[o],e)}for(const o of t){const e=this.commandHandler.getObjectLayer(o.id);this.initConnectors(o,e)}}alignGroup(e,t){let i=[];const n=[];let r,s,o,a;for(o=0;o<e.length;o++){let l;if(r=e[o],s=t[r],s&&s.children.length)for(a=0;a<s.children.length;a++)l=s.children[a],e.indexOf(l)>-1&&-1===i.indexOf(l)&&-1===n.indexOf(l)&&i.splice(0,0,l);-1===i.indexOf(r)&&n.push(r)}return i=i.concat(n),i}addToLayer(e,t){let i;if(t&&(i=this.commandHandler.getObjectLayer(e.id)),t&&i||-1===this.activeLayer.objects.indexOf(e.id)&&this.activeLayer.objects.push(e.id),(e instanceof Td||e instanceof ol)&&("SwimLane"!==e.shape.type||e.children&&e.children.length>0)){if(e.parentId){let t=this.swimlaneZIndexTable[e.parentId];t&&-1!==t&&(e.zIndex=this.swimlaneChildTable[e.id])}e instanceof ol&&e.sourceID&&e.targetID&&this.findNodeInLane(e.sourceID)&&this.findNodeInLane(e.targetID)?-1!==this.activeLayer.objects.indexOf(e.sourceID)&&-1!==this.activeLayer.objects.indexOf(e.targetID)&&this.setZIndex(i||this.activeLayer,e):this.setZIndex(i||this.activeLayer,e)}}findNodeInLane(e){let t=!1;for(let i=0;i<this.nodes.length;i++)if("SwimLane"!==this.nodes[i].shape.type){if(this.nodes[i].id===e){t=!0;break}}else{let n=this.nodes[i].shape;if(n.lanes&&n.lanes.length>0)for(let i=0;i<n.lanes.length;i++)if(n.lanes[i].children&&n.lanes[i].children.length>0)for(let r=0;r<n.lanes[i].children.length;r++)if(n.lanes[i].children[r].id===e){t=!0;break}}return!!t}updateLayer(e){for(const t of Object.keys(e.layers)){const i=this.layers[t].objects;for(const n of i){const i=this.nameTable[n];void 0!==e.layers[t].visible?this.updateElementVisibility(i.wrapper,i,e.layers[t].visible):!0===e.layers[t].lock&&this.unSelect(i)}void 0!==e.layers[t].lock&&(this.layers[t].lock=e.layers[t].lock)}"SVG"!==this.mode&&this.refreshDiagramLayer()}updateScrollSettings(e){const t=-this.scroller.horizontalOffset+e.scrollSettings.horizontalOffset||0,i=this.scroller.verticalOffset-e.scrollSettings.verticalOffset||0,n={VerticalOffset:this.scrollSettings.verticalOffset,HorizontalOffset:this.scrollSettings.horizontalOffset,ViewportHeight:this.scrollSettings.viewPortHeight,ViewportWidth:this.scrollSettings.viewPortWidth,CurrentZoom:this.scroller.currentZoom};0===t&&0===i||this.pan(t,i);let r="Start";this.realActions&fo.PanInProgress&&(r="Progress"),this.triggerEvent(vo.scrollChange,{oldValue:n,newValue:{VerticalOffset:this.scrollSettings.verticalOffset,HorizontalOffset:this.scrollSettings.horizontalOffset,ViewportHeight:this.scrollSettings.viewPortHeight,ViewportWidth:this.scrollSettings.viewPortWidth,CurrentZoom:this.scroller.currentZoom},source:this,panState:r}),this.commandHandler.updatePanState(!0),"Canvas"===this.mode&&this.constraints&lo.Virtualization&&this.refreshDiagramLayer()}initData(){const e=this.dataSourceSettings.dataManager||this.dataSourceSettings.dataSource;!this.dataBindingModule||this.realActions&fo.PreventDataInit||(e&&this.dataSourceSettings.connectionDataSource.dataManager?(this.nodes=this.generateData(this.dataSourceSettings.dataManager||this.dataSourceSettings.dataSource,!0),this.connectors=this.generateData(this.dataSourceSettings.connectionDataSource.dataManager,!1)):e&&e.dataSource&&(e.dataSource.url||"BlazorAdaptor"===e.adaptorName&&!e.dataSource.url)?this.dataBindingModule.initSource(this.dataSourceSettings,this):this.dataBindingModule.initData(this.dataSourceSettings,this))}generateData(e,t){const i=[];let n;for(n=0;n<e.length;n++){const r=this.makeData(e[n],!!t);!r||!r.id||Yh(i,r.id)&&Yh(i,r.id)||i.push(r)}return i}makeData(e,t){let i;const n=t?this.dataSourceSettings:this.dataSourceSettings.connectionDataSource,r={};if(r.id=e[n.id]?e[n.id]:op(),n.sourceID&&(r.sourceID=e[n.sourceID]),n.targetID&&(r.targetID=e[n.targetID]),e[n.sourcePointX]&&e[n.sourcePointY]&&(r.sourcePoint={x:Number(e[n.sourcePointX]),y:Number(e[n.sourcePointY])}),e[n.targetPointX]&&e[n.targetPointY]&&(r.targetPoint={x:Number(e[n.targetPointX]),y:Number(e[n.targetPointY])}),n.crudAction.customFields&&n.crudAction.customFields.length>0)for(i=0;i<n.crudAction.customFields.length;i++)r[n.crudAction.customFields[i]]=e[n.crudAction.customFields[i]];return r}initNodes(e,t){this.preventDiagramUpdate=!0,this.initObject(e,t),this.preventDiagramUpdate=!1}initConnectors(e,t,i){this.preventDiagramUpdate=!0,this.initObject(e,t,i),this.updateEdges(e),this.preventDiagramUpdate=!1}setZIndex(e,t){const i=e;if(-1===t.zIndex){for(;i.zIndexTable[i.objectZIndex+1];)e.objectZIndex++;t.zIndex=++i.objectZIndex}else{const e=t.zIndex;if(i.zIndexTable[e]){const n=Object.keys(i.zIndexTable).length;for(let r=0;r<n;r++)if(r===e){for(let t=n;t>e;t--)i.zIndexTable[t]=i.zIndexTable[t-1],this.nameTable[i.zIndexTable[t]]&&(this.nameTable[i.zIndexTable[t]].zIndex=t);i.zIndexTable[r]=t.id}}}}initializeDiagramLayers(){for(let e=0;e<this.layers.length;e++)if(-1!==this.layers[e].zIndex){const t=this.layers[e];this.layers[e]=this.layers[this.layers[e].zIndex],this.layers[t.zIndex]=t}for(const e of this.layers)e.zIndex=-1!==e.zIndex?e.zIndex:this.layers.indexOf(e),this.layerZIndexTable[e.zIndex]=e.id;for(let e=0;e<this.layers.length;e++)for(let t=e+1;t<this.layers.length;t++)if(this.layers[e].zIndex>this.layers[t].zIndex){const i=this.layers[e];this.layers[e]=this.layers[t],this.layers[t]=i}0===this.layers.length&&this.commandHandler.addLayer({id:"default_layer",visible:!0,lock:!1,objects:[],zIndex:0,objectZIndex:-1,zIndexTable:{}},null,!0),this.setActiveLayer(this.layers[this.layers.length-1].id)}resetTool(){this.eventHandler.resetTool()}initObjectExtend(e,t,i){if(i){const i=this.commandHandler.checkBoundaryConstraints(void 0,void 0,e.wrapper.bounds);for(let n=0,r=Object.keys(t.zIndexTable);n<r.length;n++)t.zIndexTable[r[n]]&&t.zIndexTable[r[n]]===e.id&&delete t.zIndexTable[r[n]];if(t.zIndexTable[e.zIndex]=e.id,!i){const i=e instanceof Td?this.nodes:this.connectors;for(let t=0;t<=i.length;t++)i[t]&&e.id===i[t].id&&i.splice(t,1);delete t.zIndexTable[e.zIndex]}}}initObject(e,t,i=!0,n){if(void 0!==e){if(i&&(t||(this.addToLayer(e,!1),t=this.activeLayer),(e instanceof Td||e instanceof ol)&&("SwimLane"!==e.shape.type||e.children&&e.children.length>0)&&this.setZIndex(t,e)),e instanceof Td){if(i){if("helper"!==e.id){const t=Cp(this.getNodeDefaults);if(t){const i=t(e,this);if(i&&i.ports)for(let e=0;e<i.ports.length;e++)i.ports[e].inEdges=[],i.ports[e].outEdges=[];i&&i!==e&&up(i,e)}}this.initNode(e,this.element.id)}}else if(e instanceof ol){const t=Cp(this.getConnectorDefaults);if(t){const i=t(e,this);i&&i!==e&&up(i,e),e.segments.length&&e.type!==e.segments[0].type&&(e.segments=[])}const n=this.nameTable[e.sourceID],r=this.nameTable[e.targetID],s=this.getConnectedPort(n,e,!0),o=this.getConnectedPort(r,e),a=this.findInOutConnectPorts(n,!1),l=this.findInOutConnectPorts(r,!0);if((void 0!==n&&Tl(n)||""!==e.sourcePortID&&El(a))&&(e.sourceWrapper=this.getEndNodeWrapper(n,e,!0),e.sourcePortID&&s&&s.constraints&&!(s.constraints&wo.None)&&s.constraints&wo.OutConnect&&(e.sourcePortWrapper=this.getWrapper(n.wrapper,e.sourcePortID))),(void 0!==r&&Pl(r)||""!==e.targetPortID&&Ol(l))&&(e.targetWrapper=this.getEndNodeWrapper(r,e,!1),e.targetPortID&&o&&o.constraints&&!(o.constraints&wo.None)&&o.constraints&wo.InConnect&&(e.targetPortWrapper=this.getWrapper(r.wrapper,e.targetPortID))),!i){const t=e.getConnectorPoints(e.type);vc(e,t)}i&&e.init(this);for(let i=0;i<e.wrapper.children.length;i++)this.pathTable[e.wrapper.children[i].data]&&(e.wrapper.children[i].absoluteBounds=this.pathTable[e.wrapper.children[i].data].absoluteBounds);e.wrapper.measure(new bs(void 0,void 0)),e.wrapper.arrange(e.wrapper.desiredSize),e instanceof ol&&"Bezier"===e.type&&(this.updateConnectorAnnotation(e),this.updateConnectorfixedUserHandles(e));for(let i=0;i<e.wrapper.children.length;i++)this.pathTable[e.wrapper.children[i].data]={},this.pathTable[e.wrapper.children[i].data].absoluteBounds=e.wrapper.children[i].absoluteBounds}if(e instanceof Td&&e.children&&e.container)for(let t=0;t<e.children.length;t++)this.nameTable[e.children[t]].offsetX=this.nameTable[e.children[t]].wrapper.offsetX,this.nameTable[e.children[t]].offsetY=this.nameTable[e.children[t]].wrapper.offsetY;if(this.bpmnModule&&e instanceof Td&&"Bpmn"===e.shape.type&&e.shape.annotations.length>0&&this.bpmnModule.updateQuad(e,this),this.initObjectExtend(e,t,i),this.nameTable[e.id]=e,e instanceof Td&&e.children){this.preventNodesUpdate=!0,this.preventConnectorsUpdate=!0,n||e.container||this.updateGroupOffset(e,!0),this.groupTable[e.id]=e.children;for(let t=0;t<e.children.length;t++){const i=this.nameTable[e.children[t]];i&&(i.parentId=e.id)}this.isLoading||!e.rotateAngle||e.container||this.commandHandler.rotateObjects(e,[e],e.rotateAngle,{x:e.offsetX,y:e.offsetY},!1),this.preventNodesUpdate=!1,this.preventConnectorsUpdate=!1}void 0===this.enterObject&&this.updateQuad(e)}!1===e.visible&&this.updateElementVisibility(e.wrapper,e,!1)}getConnectedPort(e,t,i){if(e&&e.ports)for(const n of e.ports){if(n.id===t.sourcePortID&&i)return n;if(n.id===t.targetPortID&&!i)return n}return null}scaleObject(e,t,i){const n=i?e.wrapper.actualSize.width:e.wrapper.actualSize.height,r=i?1+(t-n)/n:1,s=i?1:1+(t-n)/n;this.realActions|=fo.PreventDrag,this.scale(e,r,s,{x:.5,y:.5}),this.realActions&=~fo.PreventDrag}updateDefaultLayoutIcons(e){"OrganizationalChart"!==this.layout.type&&"HierarchicalTree"!==this.layout.type&&"ComplexHierarchicalTree"!==this.layout.type||(this.updateDefaultLayoutIcon(e,e.expandIcon),this.updateDefaultLayoutIcon(e,e.collapseIcon))}updateDefaultLayoutIcon(e,t){if("None"!==t.shape&&"Auto"===t.horizontalAlignment&&"Auto"===t.verticalAlignment&&.5===t.offset.x&&1===t.offset.y){const t=this.getWrapper(e.wrapper,"icon_content");let i,n;"TopToBottom"===this.layout.orientation||"BottomToTop"===this.layout.orientation?(i=.5,n="TopToBottom"===this.layout.orientation?1:0):"RightToLeft"!==this.layout.orientation&&"LeftToRight"!==this.layout.orientation||(i="LeftToRight"===this.layout.orientation?1:0,n=.5),t.setOffsetWithRespectToBounds(i,n,"Fraction"),t.horizontalAlignment="Center",t.verticalAlignment="Center",e.wrapper.measure(new bs(e.wrapper.width,e.wrapper.height)),e.wrapper.arrange(e.wrapper.desiredSize)}}updateGroupOffset(e,t){if(e.children&&e.children.length>0&&!e.container||e.processId){const t=this.nameTable[e.id];if(!(this.realActions&fo.PreventScale||this.realActions&fo.PreventDrag)){if(t.offsetX&&(this.realActions&fo.EnableGroupAction||!(this.diagramActions&go.UndoRedo||this.diagramActions&go.ToolAction||this.diagramActions&go.PublicMethod))){this.realActions|=fo.PreventScale;const i=t.offsetX-e.wrapper.offsetX;t.offsetX=e.wrapper.offsetX;const n=t.offsetY-e.wrapper.offsetY;t.offsetY=e.wrapper.offsetY,"None"===e.flip&&i+n!==0&&this.drag(t,i,n),this.realActions&=~fo.PreventScale}else t.offsetX=e.wrapper.offsetX;if(t.offsetY&&(this.realActions&fo.EnableGroupAction||!(this.diagramActions&go.UndoRedo||this.diagramActions&go.ToolAction||this.diagramActions&go.PublicMethod))){this.realActions|=fo.PreventScale;const i=t.offsetY-e.wrapper.offsetY;t.offsetY=e.wrapper.offsetY,"None"===e.flip&&this.drag(t,0,i),this.realActions&=~fo.PreventScale}else t.offsetY=e.wrapper.offsetY;this.diagramActions&&(t.width=e.wrapper.actualSize.width,t.height=e.wrapper.actualSize.height)}}t&&e.children&&e.children.length>0&&(void 0!==this.nameTable[e.id].width?this.scaleObject(e,this.nameTable[e.id].width,!0):this.nameTable[e.id].width=e.wrapper.actualSize.width,void 0!==this.nameTable[e.id].height?this.scaleObject(e,this.nameTable[e.id].height,!1):this.nameTable[e.id].height=e.wrapper.actualSize.height)}initNode(e,t,i){const n=e.initContainer(),r=new Po;let s,o;if(this.diagramSettings.inversedAlignment||(n.inversedAlignment=!1),n.children||(n.children=[]),e.children){n.measureChildren=!1,r.id=e.id+"group_container",r.style.fill="none",r.style.strokeColor="none",r.horizontalAlignment="Stretch",r.verticalAlignment="Stretch",n.style=e.style,r.children=[],r.preventContainer=!0,e.container&&(r.relativeMode="Object");let t=!!(e.ports&&e.ports.length>0);if(d(e.container)&&!t&&n.children.push(r),e.container&&"Grid"===e.container.type)for(let i=0;i<e.children.length;i++){const t=new Po,r=this.nameTable[e.children[i]];t.children=[],t.children.push(r.wrapper),r&&n.addObject(r.wrapper,r.rowIndex,r.columnIndex,r.rowSpan,r.columnSpan)}else for(let i=0;i<e.children.length;i++)if(this.nameTable[e.children[i]]){const t=this.nameTable[e.children[i]];this.updateStackProperty(e,t,i),n.children.push(t.wrapper),n.elementActions=n.elementActions|oo.ElementIsGroup,t.wrapper.flip="None"===t.wrapper.flip?e.wrapper.flip:t.wrapper.flip}(t||e.container&&"Grid"!==e.container.type)&&n.children.push(r)}else{const t=Cp(this.setNodeTemplate);t&&"helper"!==e.id&&(s=t(e,this)),s||(s=e.init(this)),n.children.push(s)}o=Cp(this.getDescription),(e.children?n:s).description=o||(e.annotations.length?e.annotations[0].content:e.id);const a=e.children?r:n;e.initAnnotations(this.getDescription,a,this.element.id,!!Dl(this),this.annotationTemplate),e.initPorts(this.getDescription,a),e.initIcons(this.getDescription,this.layout,a,t);for(let l=0;l<e.fixedUserHandles.length;l++){const t=e.initfixedUserHandles(e.fixedUserHandles[l]);a.children.push(t)}if("SwimLane"===e.shape.type&&e.wrapper&&e.wrapper.children.length>0&&e.wrapper.children[0]instanceof Kl){if(this.setZIndex(this.activeLayer,e),this.connectors.length>0)for(let e=0;e<this.connectors.length;e++){let t=this.connectors[e];t.sourceID&&t.targetID&&-1===this.activeLayer.objects.indexOf(t.sourceID)&&-1===this.activeLayer.objects.indexOf(t.targetID)&&this.setZIndex(this.activeLayer,t)}wh(e),function(e,t){const i=t.wrapper.children[0],n=t.shape,r=n.padding,s=n.lanes;let o,a,l=i.bounds.y;const h=n.phaseSize>0?n.phases.length:0;let c,d,p,u,g,m;const f="Horizontal"===n.orientation,y=f?n.phases.length||1:s.length+1;let b=f?(n.header&&n.hasHeader?1:0)+(n.phases.length>0?1:0)+n.lanes.length:(n.header&&n.hasHeader?1:0)+n.phases.length;if(0===h&&!f&&n.lanes.length&&(b+=1),f?(o=(n.header&&n.hasHeader?1:0)+(h>0?1:0),a=0):(o=n.header&&n.hasHeader?1:0,a=h>0?1:0),s.length>0)for(l+=n.header&&n.hasHeader?n.header.height:0,u=0;u<s.length;u++){for(g=0;g<s[u].children.length;g++)if(c=s[u].children[g],c.offsetX=s[u].width,c.offsetY=s[u].height,e.initObject(c),e.nodes.push(c),d=c.wrapper,f){for(m=a;m<y;m++)if(p=i.rows[o].cells[m],d.margin.left<p.bounds.right-i.bounds.x){c.parentId=p.children[0].id,m>a?d.margin.left=d.margin.left-(p.bounds.left-i.bounds.left):p.children[0].children[1].actualSize.width+r>=d.margin.left&&(d.margin.left=p.children[0].children[1].actualSize.width+r),d.margin.left<r&&(d.margin.left=r),d.margin.top<r&&(d.margin.top=r),Sh(d,c,e);break}}else for(let t=o;t<b;t++)if(p=i.rows[t].cells[a],d.margin.top<p.bounds.bottom-l){c.parentId=p.children[0].id,t>o?d.margin.top=d.margin.top-(p.bounds.top-l):p.children[0].children[1].actualSize.height+r>=d.margin.top&&(d.margin.top=p.children[0].children[1].actualSize.height+r),d.margin.left<r&&(d.margin.left=r),d.margin.top<r&&(d.margin.top=r),Sh(d,c,e);break}f?o++:a++}i.measure(new bs(t.width,t.height)),i.arrange(i.desiredSize),function(e,t){const i=e.columnDefinitions(),n=e.rowDefinitions();let r,s,o,a,l,h,c=Ah(t);"Vertical"===t.shape.orientation&&0===c&&(c=t.shape.header&&t.shape.hasHeader?1:0);const d=t.shape.padding;for(r=0;r<i.length;r++)e.updateColumnWidth(r,i[r].width,!0,d);for(r=c;r<n.length;r++)e.updateRowHeight(r,n[r].height,!0,d);for(s=0;s<n.length;s++)for(h=e.rows[s],r=0;r<i.length;r++)if(a=h.cells[r],a.children&&a.children.length>0)for(o=0;o<a.children.length;o++)l=a.children[o],l.maxWidth&&(l.maxWidth=a.actualSize.width),l.maxHeight&&(l.maxHeight=a.actualSize.height)}(i,t),t.width=t.wrapper.width=i.width,t.height=t.wrapper.height=i.height,Dh(e,t),t.wrapper.measure(new bs(t.width,t.height)),t.wrapper.arrange(i.desiredSize),function(e){if("SwimLane"===e.shape.type){const t=e.shape.lanes;let i,n;for(let e=0;e<t.length;e++){i=t[e];for(let e=0;e<i.children.length;e++)n=i.children[e],n.offsetX=n.wrapper.offsetX,n.offsetY=n.wrapper.offsetY}}}(t),Ph(t,e),Ch(t)}(this,e),this.updateDiagramElementQuad()}else n.measure(new bs(e.width,e.height),e.id,this.onLoadImageSize.bind(this)),n instanceof Kl?n.arrange(n.desiredSize,!0):n.arrange(n.desiredSize);"None"!==e.wrapper.flip&&e.wrapper.elementActions&oo.ElementIsGroup&&kc(e.wrapper,e.wrapper.offsetX,e.wrapper.offsetY,this,e.wrapper.flip),e instanceof Td&&e.container&&(e.width<n.outerBounds.width||e.height<n.outerBounds.height)&&n.bounds.x<=n.outerBounds.x&&n.bounds.y<=n.outerBounds.y&&(e.width=n.width=n.outerBounds.width,e.height=n.height=n.outerBounds.height,n.measure(new bs(e.width,e.height)),n.arrange(n.desiredSize)),e.container&&"Grid"===e.container.type&&e.children&&e.children.length>0&&this.updateChildPosition(e)}updateDiagramElementQuad(){for(let e=0;e<this.nodes.length;e++)this.nodes[e].wrapper&&this.nodes[e].wrapper instanceof So&&this.updateQuad(this.nodes[e])}onLoadImageSize(e,t){const i=this.getObject(e),n=document.getElementById(e+"sf-imageNode");n&&n.parentNode.removeChild(n),this.nodePropertyChange(i,{},{width:t.width,height:t.height});const r={element:dp(i),size:t};this.triggerEvent(vo.onImageLoad,r)}updateChildPosition(e){for(let t=0;t<e.children.length;t++){const i=this.getObject(e.children[t]);i.offsetX=i.wrapper.offsetX,i.offsetY=i.wrapper.offsetY,i.children&&i.children.length>0&&this.updateChildPosition(i)}}canExecute(){return!0}updateStackProperty(e,t,i){e.container&&"Stack"===e.container.type&&(t.width||(t.wrapper.horizontalAlignment="Stretch",t.horizontalAlignment="Stretch"),t.height||(t.verticalAlignment="Stretch",t.wrapper.verticalAlignment="Stretch"),i&&"UmlClassifier"===e.shape.type&&(t.umlIndex=i))}initViews(){this.isLoading||(this.views.push(this.element.id),this.views[this.element.id]=this)}initCommands(){const e=this.commandManager.commands,t={copy:{execute:this.copyCommand.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:uo.C,keyModifiers:po.Control}},paste:{execute:this.pasteCommand.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:uo.V,keyModifiers:po.Control}},cut:{execute:this.cutCommand.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:uo.X,keyModifiers:po.Control}},delete:{execute:this.removeCommand.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:uo.Delete}},selectAll:{execute:this.selectAll.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:uo.A,keyModifiers:po.Control}},undo:{execute:this.undo.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:uo.Z,keyModifiers:po.Control}},redo:{execute:this.redo.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:uo.Y,keyModifiers:po.Control}},nudgeUp:{execute:this.nudgeCommand.bind(this,"Up"),canExecute:this.canExecute.bind(this),gesture:{key:uo.Up},parameter:"up"},nudgeRight:{execute:this.nudgeCommand.bind(this,"Right"),canExecute:this.canExecute.bind(this),gesture:{key:uo.Right},parameter:"right"},nudgeDown:{execute:this.nudgeCommand.bind(this,"Down"),canExecute:this.canExecute.bind(this),gesture:{key:uo.Down},parameter:"down"},nudgeLeft:{execute:this.nudgeCommand.bind(this,"Left"),canExecute:this.canExecute.bind(this),gesture:{key:uo.Left},parameter:"left"},startEdit:{execute:this.startEditCommad.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:uo.F2}},endEdit:{execute:this.endEditCommand.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:uo.Escape}},focusToNextItem:{canExecute:this.canExecute.bind(this),gesture:{key:uo.Tab}},focusToPreviousItem:{canExecute:this.canExecute.bind(this),gesture:{key:uo.Tab,keyModifiers:po.Control}},selectFocusedItem:{execute:this.startEditCommad.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:uo.Enter}}};this.initCommandManager(e,t)}overrideCommands(e,t){let i;for(const n of Object.keys(t))if(i=t[n],e.gesture.key===i.gesture.key&&e.gesture.keyModifiers===i.gesture.keyModifiers){delete t[n];break}}initCommandManager(e,t){let i=0;if(e)for(i=0;i<e.length;i++)t[e[i].name]&&e[i]?(e[i].canExecute&&(t[e[i].name].canExecute=e[i].canExecute),e[i].execute&&(t[e[i].name].execute=e[i].execute),(e[i].gesture.key||e[i].gesture.keyModifiers)&&(t[e[i].name].gesture=e[i].gesture),""!==e[i].parameter&&(t[e[i].name].parameter=e[i].parameter)):(this.overrideCommands(e[i],t),t[e[i].name]={execute:e[i].execute,canExecute:e[i].canExecute,gesture:e[i].gesture,parameter:e[i].parameter});this.commands=t}updateNodeEdges(e){for(const t of e.inEdges)this.nameTable[t]&&(this.nameTable[t].targetID="");for(const t of e.outEdges)this.nameTable[t]&&(this.nameTable[t].sourceID="");e.inEdges=[],e.outEdges=[]}updateIconVisibility(e,t){for(let i=0;i<e.wrapper.children.length;i++){const n=e.wrapper.children[i];if(n.id){const i=n.id.split(e.id)[1];i&&i.match("^_icon")&&(n.visible=t,this.updateDiagramContainerVisibility(n,t))}}}updateEdges(e){if(void 0!==e.sourceID&&""!==e.sourceID){const t=this.nameTable[e.sourceID];t&&t.outEdges&&0===t.outEdges.length&&(t.outEdges=[]),t&&t.outEdges&&-1===t.outEdges.indexOf(e.id)&&t.outEdges.push(e.id),this.updatePortEdges(t,e,!1)}if(void 0!==e.targetID&&""!==e.targetID){const t=this.nameTable[e.targetID];t&&t.inEdges&&0===t.inEdges.length&&(t.inEdges=[]),t&&t.inEdges&&-1===t.inEdges.indexOf(e.id)&&t.inEdges.push(e.id),this.updatePortEdges(t,e,!0),t&&t.visible&&t.outEdges&&this.updateIconVisibility(t,0!==t.outEdges.length)}}updatePortEdges(e,t,i){if(e)for(let n=0;n<e.ports.length;n++){const r=e.ports[n];if(r.id===(i?t.targetPortID:t.sourcePortID)){const e=i?r.inEdges:r.outEdges;-1===e.indexOf(t.id)&&e.push(t.id)}}}refreshDiagram(){this.initLayerObjects(),this.doLayout(),this.updateBridging(),this.scroller.setSize(),this.addBlazorDiagramObjects(),this.updateFitToPage()}updateCanupdateStyle(e,t){for(let i=0;i<e.length;i++)e[i].children&&this.updateCanupdateStyle(e[i].children,t),e[i].canApplyStyle=t}getZindexPosition(e,t){let i,n,r=[];if(r=r.concat(this.nodes),r=r.concat(this.connectors),-1!==e.zIndex)for(let s=0;s<r.length;s++)if(r[s].zIndex>e.zIndex){"HTML"!==e.shape.type&&"Native"!==e.shape.type||(n="HTML"===e.shape.type?"html":"native"),i=_d(t,r[s].id,n);break}return i}updateDiagramObject(e,t,i){let n;for(const r of this.views)if(n=this.views[r],this.diagramActions&&"SVG"===n.mode){let r;if(this.layers.length>1&&(r=this.commandHandler.getObjectLayer(e.id)),void 0===r||r&&r.visible||i){const i=qd(this.element.id);window.domTable[n.element.id+"_diagramLayer"]||(window.domTable[n.element.id+"_diagramLayer"]=document.getElementById(n.element.id+"_diagramLayer"));const r=window.domTable[n.element.id+"_diagramLayer"];this.diagramActions&go.Interactions&&this.updateCanupdateStyle(e.wrapper.children,!0),this.diagramRenderer.updateNode(e.wrapper,r,i,void 0,t?void 0:this.getZindexPosition(e,n.element.id)),this.updateCanupdateStyle(e.wrapper.children,!0)}}}updateGridContainer(e){let t;const i=qd(this.element.id);for(const n of this.views)if(t=this.views[n],"SVG"===t.mode&&this.diagramActions){const n=document.getElementById(t.element.id+"_diagramLayer");this.diagramRenderer.updateNode(e,n,i,void 0)}else this.refreshCanvasDiagramLayer(t)}getObjectsOfLayer(e){const t=[];for(const i of e)this.nameTable[i]&&t.push(this.nameTable[i]);return t}refreshDiagramLayer(){let e;for(const t of this.views)switch(e=this.views[t],e.mode){case"SVG":this.refreshSvgDiagramLayer(e);break;case"Canvas":this.refreshCanvasLayers(e)}}refreshCanvasLayers(e){if(e)this.refreshCanvasDiagramLayer(e);else for(const t of this.views)this.refreshCanvasDiagramLayer(this.views[t])}renderBasicElement(e){const t=qd(e.element.id);for(let i=0;i<this.basicElements.length;i++){const n=this.basicElements[i];n instanceof So&&(n.prevRotateAngle=0),n.measure(new bs(n.width,n.height)),n.arrange(n.desiredSize),e.diagramRenderer.renderElement(n,e.diagramLayer,t)}}refreshElements(t){if(!this.isDestroyed){this.clearCanvas(t),t instanceof e?(t.diagramLayer.getContext("2d").setTransform(t.scroller.currentZoom,0,0,t.scroller.currentZoom,0,0),t.diagramLayer.getContext("2d").scale(1.5,1.5)):document.getElementById(t.element.id+"_nativeLayer").children.length>0&&t.updateView(t);const i=qd(t.element.id);this.renderDiagramElements(t.diagramLayer,t.diagramRenderer,i);for(let e=0;e<this.basicElements.length;e++){const n=this.basicElements[e];n.measure(new bs(n.width,n.height)),n.arrange(n.desiredSize),t.diagramRenderer.renderElement(n,t.diagramLayer,i)}t instanceof e&&(t.diagramLayer.style.transform="scale("+2/3+")",t.diagramLayer.style.transformOrigin="0 0"),this.renderTimer=null}}refreshCanvasDiagramLayer(e){"SVG"===e.mode||this.isDestroyed||(this.basicElements.length>0&&this.renderBasicElement(e),!this.diagramActions||0==(this.diagramActions&go.Render)||go.ToolAction&this.diagramActions||Dl(this)||1!==this.scroller.currentZoom?this.refreshElements(e):this.renderTimer||(this.renderTimer=setTimeout(()=>{this.refreshElements(e)},40)))}updatePortVisibility(e,t,i){let n;if(e instanceof Td&&(!this.drawingObject||!this.drawingObject.shape)&&fl(e)){const r=e.ports;let s=!1;for(let o=0;o<r.length;o++)n=this.getWrapper(e.wrapper,r[o].id),(t&eo.Hover||t&eo.Connect)&&Cc(r[o],t)&&(n.visible=!i,s=!0);s&&this.updateDiagramObject(e)}}refreshSvgDiagramLayer(e){let t;const i=document.getElementById(e.element.id+"_diagramLayer"),n=qd(e.element.id);if(Dl(this))this.scroller.virtualizeElements();else{for(let e=0;e<this.basicElements.length;e++)t=this.basicElements[e],t.measure(new bs(t.width,t.height)),t.arrange(t.desiredSize,!(this.diagramActions&go.Render)),this.diagramRenderer.renderElement(t,i,n);this.renderDiagramElements(i,this.diagramRenderer,n)}}removeVirtualObjects(e){if(this.deleteVirtualObject){for(let e=0;e<this.scroller.removeCollection.length;e++)this.removeElements(this.nameTable[this.scroller.removeCollection[e]]);this.deleteVirtualObject=!1}clearInterval(e)}updateTextElementValue(e){for(let t=0;t<e.wrapper.children.length;t++){const i=e.wrapper.children[t];i instanceof Co&&(i.canMeasure=!0,i.measure(new bs(e.width,e.height)),i.arrange(i.desiredSize))}}updateVirtualObjects(e,t,i){const n=document.getElementById(this.element.id+"_diagramLayer"),r=qd(this.element.id);if("SVG"===this.mode){for(let t=0;t<e.length;t++){const i=this.scroller.removeCollection.indexOf(e[t]);i>=0&&this.scroller.removeCollection.splice(i,1);const s=this.nameTable[e[t]];this.updateTextElementValue(s),this.diagramRenderer.renderElement(s.wrapper,n,r,void 0,void 0,void 0,void 0,s.zIndex)}for(let e=0;e<i.length;e++)this.scroller.removeCollection.push(i[e]);1!==this.scroller.currentZoom&&this.eventHandler.updateVirtualization()}else this.diagramActions&&this.refreshDiagramLayer()}renderDiagramElements(e,t,i,n=!0,r,s){const o=this.scroller.getPageBounds();o.x*=this.scroller.currentZoom,o.y*=this.scroller.currentZoom,o.width*=this.scroller.currentZoom,o.height*=this.scroller.currentZoom;const a=-this.scroller.horizontalOffset-o.x,l=-this.scroller.verticalOffset-o.y;for(const h of Object.keys(this.layerZIndexTable)){const c=this.commandHandler.getLayer(this.layerZIndexTable[h]);let d,p;"Canvas"===this.mode&&Dl(this)&&!this.diagramActions&&this.scroller.virtualizeElements();const u="Canvas"===this.mode&&Dl(this)&&this.scroller.oldCollectionObjects.length>0?this.scroller.oldCollectionObjects:void 0;for(const h of Object.keys(u||c.zIndexTable)){const g=u?this.nameTable[u[h]]:this.nameTable[c.zIndexTable[h]];if(g&&!g.parentId&&c.visible&&(!g.processId||this.refreshing)){const h={tx:this.scroller.transform.tx,ty:this.scroller.transform.ty,scale:this.scroller.transform.scale};if(Dl(this)){if(this.scroller.currentZoom<1){if(o.x<0||this.scroller.horizontalOffset<0){const e=this.scroller.verticalOffset<0?this.scroller.verticalOffset:0;d=(a>0?a:0)+"px",p=(this.realActions&fo.vScrollbarMoved?0:-e)+"px"}else d="0px",p="0px";this.realActions&fo.hScrollbarMoved&&(this.realActions=this.realActions&~fo.hScrollbarMoved),this.realActions&fo.vScrollbarMoved&&(this.realActions=this.realActions&~fo.vScrollbarMoved)}else d=(o.x<0?a:-this.scroller.horizontalOffset)+"px",p=(o.y<0?l:-this.scroller.verticalOffset)+"px";this.diagramLayer.style.left=d,this.diagramLayer.style.top=p,h.tx=this.scroller.horizontalOffset/h.scale,h.ty=this.scroller.verticalOffset/h.scale}let c=!0;if(r&&(c=!1),this.updateTextElementValue(g),this.refreshing&&g.shape.activity&&g.shape.activity.subProcess&&g.shape.activity.subProcess.processes){for(let e=0;e<g.shape.activity.subProcess.processes.length;e++)g.wrapper.children.push(this.nameTable[g.shape.activity.subProcess.processes[e]].wrapper);g.wrapper.measure(new bs(g.wrapper.bounds.width,g.wrapper.bounds.height)),g.wrapper.arrange(g.wrapper.desiredSize)}t.renderElement(g.wrapper,e,i,!t.isSvgMode&&n?h:void 0,void 0,void 0,c&&(!this.diagramActions||s))}}}}updateBridging(e){if(this.bridgingModule)for(let t=0;t<this.connectors.length;t++){const i=this.connectors[t];this.bridgingModule.updateBridging(i,this);const n=this.connectors[t].wrapper;if(n){const t=n.children[0],r=t.data;i.getSegmentElement(i,t,"ComplexHierarchicalTree"===this.layout.type||"HierarchicalTree"===this.layout.type?this.layout.orientation:void 0,void 0,!1),t.data!==r&&(n.measure(new bs),n.arrange(n.desiredSize),"SVG"!==this.mode||e||this.updateDiagramObject(i))}}}setCursor(e){this.diagramRenderer.setCursor(this.diagramCanvas,e)}clearCanvas(e){const t=e.contentWidth||e.diagramLayer.width/this.scroller.currentZoom,i=e.contentHeight||e.diagramLayer.height/this.scroller.currentZoom;"SVG"!==e.mode&&Pp.getContext(e.diagramLayer).clearRect(0,0,t,i)}updateScrollOffset(){this.scroller.setScrollOffset(this.diagramCanvas.scrollLeft,this.diagramCanvas.scrollTop),cl(this),Dl(this)&&this.scroller.virtualizeElements()}setOffset(e,t){window.domTable[this.element.id+"content"]||(window.domTable[this.element.id+"content"]=document.getElementById(this.element.id+"content"));const i=window.domTable[this.element.id+"content"];i&&(i.scrollLeft=e,i.scrollTop=t)}setSize(e,t){if(this.diagramLayer&&!this.preventDiagramUpdate){const i=pl(this);e-=i.width,t-=i.height;const n=this.spatialSearch.getPageBounds();n.x*=this.scroller.currentZoom,n.y*=this.scroller.currentZoom,n.width*=this.scroller.currentZoom,n.height*=this.scroller.currentZoom;const r="SVG"===this.mode?1:1.5,s="SVG"===this.mode?Hd(this.element.id):this.diagramLayer,o="Canvas"===this.mode&&this.constraints&lo.Virtualization?this.scroller.viewPortHeight:t;s.setAttribute("width",(r*("Canvas"===this.mode&&this.constraints&lo.Virtualization?this.scroller.viewPortWidth:e)).toString()),s.setAttribute("height",(r*o).toString());const a=document.getElementById(this.element.id+"_diagramUserHandleLayer");a&&(a.style.width=e+"px",a.style.height=t+"px");const l={width:e.toString(),height:t.toString()};this.diagramLayerDiv.style.width=e+"px",this.diagramLayerDiv.style.height=t+"px",tp(Vd(this.element.id),l),tp(function(e){let t=null;return t=Nd(e).getElementsByClassName("e-ports-expand-layer")[0],t}(this.element.id),l);const h=Bd(this.element.id);tp(h,l),h.parentNode.style.width=e+"px",h.parentNode.style.height=t+"px";const c=Xd(this.element.id);tp(c,l),this.diagramRenderer.updateGrid(this.snapSettings,c,this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler),tp(Yd(this.element.id),l),this.htmlLayer.style.width=e+"px",this.htmlLayer.style.height=t+"px","SVG"===this.mode||Dl(this)||this.refreshDiagramLayer(),"SVG"===this.mode&&Dl(this)&&this.scroller.virtualizeElements()}}transformLayers(){const e=this.spatialSearch.getPageBounds();e.x*=this.scroller.currentZoom,e.y*=this.scroller.currentZoom,e.width*=this.scroller.currentZoom,e.height*=this.scroller.currentZoom,this.diagramRenderer.updateGrid(this.snapSettings,Xd(this.element.id),this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler),this.diagramRenderer.transformLayers(this.scroller.transform,"SVG"===this.mode),this.diagramActions&go.DragUsingMouse||this.updateSelector(),this.renderPageBreaks(e)}removePageBreaks(){if(this.diagramLayer){const e=Gd(this.element.id);if(e&&e.childNodes){const t=e.childNodes.length;for(let i=0;i<t;i++)e.removeChild(e.childNodes[0])}}}renderPageBreaks(e){this.removePageBreaks();const t=Gd(this.element.id);if(t){let i=0;e=this.scroller.getPageBounds(!0);const n=(this.scroller.transform.tx+e.x)*this.scroller.currentZoom,r=(this.scroller.transform.ty+e.y)*this.scroller.currentZoom,s=e.height*this.scroller.currentZoom,o=e.width*this.scroller.currentZoom;if(Tp.renderSvgBackGroundImage(this.pageSettings.background,this.element,n,r,o,s),this.diagramRenderer.drawRect(t,{id:t.id+"rect",x:n,y:r,height:s,width:o,angle:0,stroke:"",strokeWidth:1,fill:this.pageSettings.background.color,opacity:1,pivotX:0,pivotY:0,visible:!0,dashArray:"0"}),this.pageSettings.showPageBreaks){const n=this.scroller.getPageBreak(e);for(i=0;i<n.length;i++)this.diagramRenderer.drawLine(t,{class:"e-diagram-page-break",fill:"none",stroke:"#aaaaaa",strokeWidth:1,dashArray:"10 10",opacity:2,x:0,y:0,width:0,height:0,angle:0,pivotX:0,pivotY:0,visible:!0,startPoint:{x:(n[i].x1+this.scroller.transform.tx)*this.scroller.currentZoom,y:(n[i].y1+this.scroller.transform.ty)*this.scroller.currentZoom},endPoint:{x:(n[i].x2+this.scroller.transform.tx)*this.scroller.currentZoom,y:(n[i].y2+this.scroller.transform.ty)*this.scroller.currentZoom},id:n[i].y1===n[i].y2?"HorizontalLines":"VerticalLines"})}}}validatePageSize(){let e=0;"Portrait"===this.pageSettings.orientation?this.pageSettings.width>this.pageSettings.height&&(e=this.pageSettings.height,this.pageSettings.height=this.pageSettings.width,this.pageSettings.width=e):this.pageSettings.height>this.pageSettings.width&&(e=this.pageSettings.width,this.pageSettings.width=this.pageSettings.height,this.pageSettings.height=e)}setOverview(e,t){if(e)e&&(this.views.push(e.id),this.views[e.id]=e,e.renderDocument(e),e.diagramRenderer.setLayers(),e.updateView(e),this.renderNodes(e));else{for(let n=0;n<this.views.length;n++)this.views[n]===t&&(e=this.views[t]);this.views[t]=void 0;const i=this.views.indexOf(t);this.views.splice(i,1)}}renderNodes(e){if(e){const t=new Tp(e.id,new Op,!1),i=document.getElementById(e.element.id+"_diagramLayer"),n=qd(e.element.id);this.renderDiagramElements(i,e.diagramRenderer||t,n,void 0,void 0,!0)}}updateThumbConstraints(e,t,i){const n=e.length;for(let r=0;r<n;r++){const n=e[r];let s=!1,o=!1,a=t.thumbsConstraints;n instanceof Td?(s="Bpmn"===n.shape.type&&"Activity"===n.shape.shape&&!1===n.shape.activity.subProcess.collapsed||"TextAnnotation"===n.shape.shape,o="Bpmn"===n.shape.type&&"TextAnnotation"===n.shape.shape,Sl(n)&&a&ao.Rotate&&!s||(a&=~ao.Rotate),Al(n,"SouthEast")&&a&ao.ResizeSouthEast&&!o||(a&=~ao.ResizeSouthEast),Al(n,"NorthWest")&&a&ao.ResizeNorthWest&&!o||(a&=~ao.ResizeNorthWest),Al(n,"East")&&a&ao.ResizeEast&&!o||(a&=~ao.ResizeEast),Al(n,"West")&&a&ao.ResizeWest&&!o||(a&=~ao.ResizeWest),Al(n,"North")&&a&ao.ResizeNorth&&!o||(a&=~ao.ResizeNorth),Al(n,"South")&&a&ao.ResizeSouth&&!o||(a&=~ao.ResizeSouth),Al(n,"NorthEast")&&a&ao.ResizeNorthEast&&!o||(a&=~ao.ResizeNorthEast),Al(n,"SouthWest")&&a&ao.ResizeSouthWest&&!o||(a&=~ao.ResizeSouthWest)):n instanceof ol?(i||(a|=ao.Default),vl(n)?a|=ao.ConnectorSource:a&=~ao.ConnectorSource,wl(n)?a|=ao.ConnectorTarget:a&=~ao.ConnectorTarget):(i||(a|=ao.Default),Al(n)||(a&=~(ao.ResizeSouthEast|ao.ResizeSouthWest|ao.ResizeSouth|ao.ResizeEast|ao.ResizeWest|ao.ResizeNorth|ao.ResizeNorthEast|ao.ResizeNorthWest)),Sl(n)||(a&=~ao.Rotate)),t.thumbsConstraints=a}}renderSelector(e,t){const i=this.isProtectedOnChange,n=new bs,r=this.selectedItems,s=this.diagramRenderer.rendererActions;let o,a;if(document.getElementsByClassName("blazor-inner-template"),this.diagramRenderer.rendererActions=this.currentSymbol?this.addConstraints(s,mo.DrawSelectorBorder):this.removeConstraints(s,mo.DrawSelectorBorder),this.clearSelectorLayer(),this.commandHandler.hasSelection()){if(1===r.nodes.length&&0===r.connectors.length&&(r.rotateAngle=r.nodes[0].rotateAngle,r.pivot=r.nodes[0].pivot),r.wrapper.measure(n),r.wrapper.arrange(r.wrapper.desiredSize),r.width=r.wrapper.actualSize.width,r.height=r.wrapper.actualSize.height,r.offsetX=r.wrapper.offsetX,r.offsetY=r.wrapper.offsetY,0!==r.rotateAngle){for(const e of r.nodes)e.offsetX=e.wrapper.offsetX,e.offsetY=e.wrapper.offsetY;for(const e of r.connectors);}this.spatialSearch.getPageBounds();const e=Wd(this.element.id),i=Fd(this.element.id);if(r.thumbsConstraints=ao.Default,r.annotation?this.updateThumbConstraints([r.annotation],r):(this.updateThumbConstraints(r.nodes,r),this.updateThumbConstraints(r.connectors,r,!0)),r.annotation)this.renderSelectorForAnnotation(r,e);else if(r.nodes.length+r.connectors.length===1||this.nameTable.helper){if(r.nodes[0]instanceof Td){const i=r.nodes[0];ah(this,i)&&(t||"UmlClassifier"===i.shape.type||i.parentId&&this.nameTable[i.parentId]&&"UmlClassifier"===this.nameTable[i.parentId].shape.type||((!i.container||"Canvas"!==i.container.type&&"Grid"!==i.container.type)&&(r.nodes[0].constraints&=~(so.Rotate|so.HideThumbs)),r.thumbsConstraints&=~ao.Rotate));const n=!!t||!!(i.constraints&so.HideThumbs),s=!!("SwimLane"===i.shape.type||i.isLane||i.isPhase||t);this.diagramRenderer.renderResizeHandle(r.wrapper.children[0],e,r.thumbsConstraints,this.scroller.currentZoom,r.constraints,this.scroller.transform,void 0,fl(i),n,s)}else if(r.connectors[0]instanceof ol&&Ul(this.diagramRenderer.rendererActions)){const t=r.connectors[0];this.diagramRenderer.renderEndPointHandle(t,e,r.thumbsConstraints,r.constraints,this.scroller.transform,void 0!==t.sourceWrapper,void 0!==t.targetWrapper,!(!this.connectorEditingToolModule||!xl(t)))}}else this.diagramRenderer.renderResizeHandle(r.wrapper,e,r.thumbsConstraints,this.scroller.currentZoom,r.constraints,this.scroller.transform,void 0,fl(r));if(!r.annotation&&!this.currentSymbol&&(this.diagramRenderer.renderUserHandler(r,e,this.scroller.transform,i),0))for(o=0;o<this.selectedItems.userHandles.length;o++)a=document.getElementById(this.selectedItems.userHandles[o].name+"_html_element"),a.style.display="block"}this.isProtectedOnChange=i}updateSelector(){const e=this.allowServerDataBinding;this.enableServerDataBinding(!1);const t=new bs,i=this.selectedItems,n=i.constraints;let r,s;if(document.getElementsByClassName("blazor-inner-template"),this.diagramActions&go.ToolAction||1!==this.selectedItems.nodes.length||(this.selectedItems.rotateAngle=this.selectedItems.nodes[0].rotateAngle,this.selectedItems.wrapper.rotateAngle=this.selectedItems.nodes[0].rotateAngle),void 0!==this.selectedItems&&(this.clearSelectorLayer(),null!==i.wrapper&&i.wrapper.children&&i.wrapper.children.length)){if(i.wrapper.measure(t),i.wrapper.arrange(i.wrapper.desiredSize),0!==i.rotateAngle||i.rotateAngle!==i.wrapper.prevRotateAngle)for(const t of i.nodes)t.offsetX=t.wrapper.offsetX,t.offsetY=t.wrapper.offsetY;i.width=i.wrapper.actualSize.width,i.height=i.wrapper.actualSize.height,i.offsetX=i.wrapper.offsetX,i.offsetY=i.wrapper.offsetY;const e=Wd(this.element.id),o=Fd(this.element.id),a=this.eventHandler.canHideResizers();if(i.thumbsConstraints=ao.Default,i.annotation?this.updateThumbConstraints([i.annotation],i):(this.updateThumbConstraints(i.nodes,i),this.updateThumbConstraints(i.connectors,i,!0)),this.selectedItems.constraints&io.UserHandle&&!i.annotation&&!this.currentSymbol&&(this.diagramRenderer.renderUserHandler(i,e,this.scroller.transform,o),0))for(r=0;r<this.selectedItems.userHandles.length;r++)s=document.getElementById(this.selectedItems.userHandles[r].name+"_html_element"),s.style.display="block";if(i.annotation)this.renderSelectorForAnnotation(i,e);else if(i.nodes.length+i.connectors.length===1){if(i.connectors[0]instanceof ol&&Ul(this.diagramRenderer.rendererActions)){const t=i.connectors[0];this.diagramRenderer.renderEndPointHandle(t,e,i.thumbsConstraints,n,this.scroller.transform,void 0!==t.sourceWrapper,void 0!==t.targetWrapper,!(!this.connectorEditingToolModule||!xl(t)))}else if(i.nodes[0]instanceof Td){const t=i.nodes[0];ah(this,i.nodes[0])&&("UmlClassifier"===t.shape.type||t.parentId&&this.nameTable[t.parentId]&&"UmlClassifier"===this.nameTable[t.parentId].shape.type||((!t.container||"Canvas"!==t.container.type&&"Grid"!==t.container.type)&&(i.nodes[0].constraints&=~(so.HideThumbs|so.Rotate)),i.thumbsConstraints&=~ao.Rotate));const n=!("SwimLane"!==t.shape.type&&!t.isLane&&!t.isPhase);this.diagramRenderer.renderResizeHandle(i.wrapper.children[0],e,i.thumbsConstraints,this.scroller.currentZoom,i.constraints,this.scroller.transform,a,fl(i.nodes[0]),!!(i.nodes[0].constraints&so.HideThumbs),n)}}else this.diagramActions&go.Interactions&&(this.diagramRenderer.rendererActions=this.diagramRenderer.rendererActions|mo.PreventRenderSelector),this.diagramRenderer.renderResizeHandle(i.wrapper,e,i.thumbsConstraints,this.scroller.currentZoom,i.constraints,this.scroller.transform,a,fl(i)),this.diagramRenderer.rendererActions=this.diagramRenderer.rendererActions&~mo.PreventRenderSelector}this.enableServerDataBinding(e)}renderSelectorForAnnotation(e,t){this.diagramRenderer.renderResizeHandle(e.wrapper.children[0],t,e.thumbsConstraints,this.scroller.currentZoom,e.constraints,this.scroller.transform,void 0,fl(e.annotation))}drawSelectionRectangle(e,t,i,n){this.clearSelectorLayer(),this.diagramRenderer.drawSelectionRectangle(e,t,i,n,this.adornerLayer,this.scroller.transform)}renderHighlighter(e){const t=Bd(this.element.id);this.diagramRenderer.renderHighlighter(e,t,this.scroller.transform)}clearHighlighter(){const e=Bd(this.element.id),t=e.getElementById(e.id+"_highlighter");t&&t.parentNode.removeChild(t)}getNodesConnectors(e){for(let t=0;t<this.nodes.length;t++)e.push(this.nodes[t]);for(let t=0;t<this.connectors.length;t++)e.push(this.connectors[t]);return e}clearSelectorLayer(){const e=Bd(this.element.id);let t;if(document.getElementsByClassName("blazor-inner-template"),this.currentSymbol){const t=e.getElementById("borderRect_symbol");t&&t.parentNode.removeChild(t)}else{const i=e.getElementById(this.adornerLayer.id+"_selected_region");i&&i.parentNode.removeChild(i),this.clearHighlighter();const n=Wd(this.element.id).childNodes;let r;for(let e=n.length;e>0;e--)r=n[e-1],r.parentNode.removeChild(r);{const e=Fd(this.element.id).childNodes;for(t=e.length;t>0;t--)e[t-1].parentNode.removeChild(e[t-1])}}}getWrapper(e,t){let i;t=e.id+"_"+t;const n=e instanceof Po?e:this.getPortContainer(this.nameTable[e.id]);for(let r=0;r<n.children.length;r++)t===n.children[r].id&&(i=n.children[r]);return i}getEndNodeWrapper(e,t,i){if("Bpmn"===e.shape.type&&e.wrapper.children[0]instanceof Po){if("Activity"===e.shape.shape){if(i&&"Transaction"===e.shape.activity.subProcess.type&&t.sourcePortID){const i=t.sourcePortID,n=e.wrapper.children[0].children[0].children[2];if(n.children)for(const t of n.children)if(t.visible&&t.id===e.id+"_"+i)return t.children[0]}return e.wrapper.children[0].children[0].children[0]}return e.wrapper.children[0].children[0]}return this.containsMargin(e.wrapper.children[0])||e.children?e.wrapper:e.wrapper.children[0]}containsMargin(e){return e.margin&&(0!==e.margin.left||0!==e.margin.top||0!==e.margin.right||0!==e.margin.bottom)}focusOutEdit(){this.endEdit()}endEditCommand(){this.endEdit(),this.textEditing=!1}endEdit(){return zu(this,void 0,void 0,function*(){if(this.diagramActions&go.TextEdit){let e,t;const i={};this.enableServerDataBinding(!1);const n=document.getElementById(this.element.id+"_editBox");{let r=n.value;$.remove(n,"input",this.eventHandler.inputChange),$.remove(n,"focusout",this.focusOutEdit);const s=document.getElementById(this.element.id+"_editTextBoxDiv");let o;o=this.nameTable[this.activeLabel.parentId];const a=Pc(o,this.activeLabel.id);let l,h={oldValue:this.activeLabel.text,newValue:r,cancel:!1,element:o,annotation:a},c=!1;if(s.parentNode.removeChild(s),this.bpmnModule&&(o=this.bpmnModule.isBpmnTextAnnotation(this.activeLabel,this),l=this.bpmnModule.getTextAnnotationWrapper(o,this.activeLabel.id),c=!!o,c&&(s.textContent!==r||r!==this.activeLabel.text))&&(this.triggerEvent(vo.textEdit,h),h.cancel||this.bpmnModule.updateTextAnnotationContent(o,this.activeLabel,r,this)),!c){o=this.nameTable[this.activeLabel.parentId];const n=Pc(o,this.activeLabel.id);!n||n instanceof rd?e={shape:{content:o.shape.content}}:(i[Tc(o,n.id,!0)]={content:n.content},e={annotations:i});const a=this.eventHandler.isAddTextNode(o,!0);if(a||s.textContent===r&&r===this.activeLabel.text||this.triggerEvent(vo.textEdit,h),l||(l=this.getWrapper(o.wrapper,this.activeLabel.id)),n.content!==r&&!h.cancel){if(o.parentId&&"UmlClassifier"===this.nameTable[o.parentId].shape.type&&-1===r.indexOf("+")&&-1===r.indexOf("-")&&-1===r.indexOf("#")&&-1===r.indexOf("~")&&-1===o.id.indexOf("_umlClass_header")&&(r=" + "+r),(o.isLane||o.isPhase)&&this.protectPropertyChange(!0),n instanceof rd)t={shape:{content:r}};else{const e={};e[Tc(o,n.id,!0)]={content:r},t={annotations:e}}const i=this.getIndex(o,o.id);if(i){const n={};n[i]=e;const r={};r[i]=t,Lc(o)===Td?this.onPropertyChanged({nodes:r},{nodes:n}):this.onPropertyChanged({connectors:r},{connectors:n})}this.protectPropertyChange(!0),n.content=r,this.protectPropertyChange(!1),this.updateSelector(),(o.isLane||o.isPhase)&&this.protectPropertyChange(!1)}if(a&&(this.removeObjectsFromLayer(o),this.removeFromAQuad(o),delete this.nameTable[this.activeLabel.parentId],""!==r)){this.clearSelection();const e=dp(o);o=this.add(e),this.updateDiagramObject(o),this.commandHandler.oldSelectedObjects=jc(this),this.commandHandler.select(this.nameTable[o.id]),this.commandHandler.updateBlazorSelector()}}if(this.selectedItems.nodes.length){let e=this.nameTable[this.activeLabel.parentId],t=this.nameTable[e.parentId];if(t&&"SwimLane"===t.shape.type||"SwimLane"===e.shape.type){const i="LaneHeaderParent",n="PhaseHeaderParent";if("SwimLane"===e.shape.type&&(t=this.nameTable[this.activeLabel.parentId],e=o),e.isLane||e.isPhase){const r=e.isLane?t.shape.lanes:t.shape.phases;for(let t=0;t<r.length;t++)r[t].id===(e[i]||e[n])&&(r[t].header.annotation.content=e.annotations[0].content)}else e.isHeader&&t.shape.hasHeader&&(t.shape.header.annotation.content=e.annotations[0].content)}this.dataBind()}l.visible=!0,this.updateDiagramObject(o),this.diagramActions=this.diagramActions&~go.TextEdit,this.activeLabel.isGroup&&this.endGroupAction(),this.activeLabel={id:"",parentId:"",isGroup:!1,text:void 0},this.commandHandler.getBlazorOldValues(),this.enableServerDataBinding(!0)}}})}getIndex(e,t){const i=Lc(e)===Td?this.nodes:this.connectors;for(let n=0;n<i.length;n++)if(i[n].id.toString()===t.toString())return n.toString();return null}getBlazorTextEditArgs(e){const t=Lc(e.element)===ol?{connectorId:e.element.id}:{nodeId:e.element.id},i={};return Lc(e.element)===Td&&"Text"===e.element.shape.type?i.textNode=e.element.shape:i.annotationId=e.element.annotations[0].id,{oldValue:e.oldValue,newValue:e.newValue,cancel:e.cancel,element:t,annotation:i}}canLogChange(){return!(!(this.diagramActions&go.Render)||this.diagramActions&go.ToolAction||this.diagramActions&go.UndoRedo||this.diagramActions&go.PublicMethod)}modelChanged(e,t){return!!(e.connectors||t.connectors||e.nodes||t.connectors||e.pageSettings||t.pageSettings||e.bridgeDirection||t.bridgeDirection)}resetDiagramActions(e){const t=!!e;this.diagramActions&go.UndoRedo&&(!t||e===go.UndoRedo)&&(this.diagramActions=this.diagramActions&~go.UndoRedo),this.diagramActions&go.PublicMethod&&(!t||e===go.PublicMethod)&&(this.diagramActions=this.diagramActions&~go.PublicMethod)}removeNode(e,t){this.removeObjectsFromLayer(e),this.removeFromAQuad(this.nameTable[e.id]);const i=document.getElementById(e.id+"_groupElement");if(delete this.nameTable[e.id],e.children&&delete this.groupTable[e.id],this.nodes.splice(this.nodes.indexOf(e),1),i.children&&i.children.length>0){let e;for(let n=i.children.length-1;n>=0;n--){const r=i.children[n];t.length>0&&-1!==t.indexOf(r.id.split("_")[0])&&(i.parentNode.insertBefore(r,e||i),e=r)}}i&&i.parentNode.removeChild(i)}deleteGroup(e){let t=[];e.children&&(t=this.commandHandler.getChildren(e,[])),this.UpdateBlazorDiagramModelCollection(e);for(const i of t)this.nameTable[i.id]&&this.remove(i)}updateObject(e,t,i){if(!(this.diagramActions&go.ToolAction||this.commandHandler.checkBoundaryConstraints(void 0,void 0,e.wrapper.children[0].bounds)))if(e instanceof Td){const n=t;for(const t of Object.keys(i))switch(t){case"width":e.width=n.width;break;case"height":e.height=n.height;break;case"offsetX":e.offsetX=n.offsetX;break;case"offsetY":e.offsetY=n.offsetY;break;case"rotateAngle":e.rotateAngle=n.rotateAngle}this.nodePropertyChange(e,i,t)}else{for(const n of Object.keys(i)){const i=t,r=e.sourcePoint,s=e.targetPoint;switch(n){case"sourcePoint":r.x=i.sourcePoint.x||r.x,r.y=i.sourcePoint.y||r.y;break;case"targetPoint":s.x=i.targetPoint.x||s.x,s.y=i.targetPoint.y||s.y}}this.connectorPropertyChange(e,i,t)}}nodePropertyChangeExtend(e,t,i,n){return void 0!==i.style&&"Bpmn"!==e.shape.type&&(uc(i.style,e.wrapper.children[0]),n=!0),void 0!==i.shadow&&(this.updateShadow(e.shadow,i.shadow),n=!0),void 0!==i.constraints&&(t.constraints&so.Select&&!(i.constraints&so.Select)&&$p(this,e)?this.clearSelection():(this.updateThumbConstraints(this.selectedItems.nodes,this.selectedItems),this.updateSelector(),n=!0)),this.swimLaneNodePropertyChange(e,t,i,n),n}swimLaneNodePropertyChange(e,t,i,n){if("SwimLane"===e.shape.type&&!this.currentSymbol){if(t.shape){const n=i.shape,r=e.shape,s="Horizontal"===r.orientation,o=r.padding,a=t.shape,l=e.wrapper.children[0];let h,c,d;if(a.lanes||a.phases){if(a.lanes)for(const e of Object.keys(n.lanes)){const t=Number(e),i=a.lanes[t];let p;const u=n.lanes[t];if(u&&u.header&&(d=r.lanes[t].header.id,h=i.header,c=u.header,this.nodePropertyChange(this.nameTable[d],h,c)),i.children)for(const e of Object.keys(i.children)){d=r.lanes[t].children[Number(e)].id;const n=this.nameTable[d];h=i.children[Number(e)],c=u.children[Number(e)],this.nodePropertyChange(n,h,c)}i.width&&!s&&(p=r.phases&&r.phaseSize?t+1:t,l.updateColumnWidth(p,u.width,!0,o),this.updateDiagramElementQuad()),i.height&&s&&(p=r.header&&r.hasHeader?t+1:t,p+=r.phases&&r.phaseSize?1:0,l.updateRowHeight(p,u.height,!0,o),this.updateDiagramElementQuad())}if(n.phases)for(const t of Object.keys(n.phases)){const i=Number(t),p=n.phases[i];let u;const g=r.header&&r.hasHeader?1:0;p&&p.header&&(d=r.phases[i].header.id,h=a.phases[i].header,c=p.header,this.nodePropertyChange(this.nameTable[d],h,c)),p.offset&&(0===i?u=p.offset:(u=p.offset-r.phases[i-1].offset,u<=0&&(u=p.offset)),s?(l.updateColumnWidth(i,u,!0,o),Ih(e,this,l.rows[g].cells[i],i)):l.updateRowHeight(g+i,u,!0,o))}}if(void 0!==n.phaseSize&&r.phases.length)if(0===n.phaseSize||0===a.phaseSize)if(a.phaseSize)s?(l.removeRow(r.header&&r.hasHeader?1:0),e.height=e.wrapper.height=l.height):(r.header&&r.hasHeader&&(l.rows[0].cells[1].children=l.rows[0].cells[0].children,l.rows[0].cells[1].columnSpan=l.rows[0].cells[0].columnSpan-1,l.rows[0].cells[0].children=[]),l.removeColumn(0));else{if(s){const t=new eh;t.height=n.phaseSize,l.addRow(r.header&&r.hasHeader?1:0,t,!0),e.height=e.wrapper.height+=n.phaseSize}else{const e=new th;e.width=n.phaseSize,l.addColumn(0,e,!0),r.header&&r.hasHeader&&(l.rows[0].cells[0].children=l.rows[0].cells[1].children,l.rows[0].cells[1].children=[],l.rows[0].cells[1].columnSpan=1,l.rows[0].cells[1].minWidth=void 0,l.rows[0].cells[0].columnSpan=r.lanes.length+1)}for(let t=0;t<r.phases.length;t++)""===r.phases[t].id&&(r.phases[t].id=op()),mh(l,this,e,r.header&&r.hasHeader?1:0,s,t)}else s?l.updateRowHeight(r.header&&r.hasHeader?1:0,n.phaseSize,!1):l.updateColumnWidth(0,n.phaseSize,!1);r.header&&r.hasHeader&&a.header&&this.nodePropertyChange(this.nameTable[l.rows[0].cells[0].children[0].id],a.header,n.header),e.height=e.wrapper.height=l.height,e.width=e.wrapper.width=l.width}else if(t.constraints){const n=i.constraints&so.Select;if((t.constraints&so.Select)!==n){const t=e.shape,i=this.nameTable[e.id+t.header.id];let r,s,o;if(i.constraints=n?i.constraints|so.Select:i.constraints&~so.Select,t.phaseSize>0)for(let l=0;l<t.phases.length;l++)r=this.nameTable[e.id+t.phases[l].id+"_header"],r.constraints=n?r.constraints|so.Select:r.constraints&~so.Select;const a=t.phases.length||1;for(let l=0;l<t.lanes.length;l++)for(let i=0;i<a;i++)s=this.nameTable[e.id+t.lanes[l].id+i],s.constraints=n?s.constraints|so.Select:s.constraints&~so.Select,0===i&&(o=this.nameTable[e.id+t.lanes[l].id+"_"+i+"_header"],o.constraints=n?o.constraints|so.Select:o.constraints&~so.Select)}}n=!0}return n}insertValue(e,t){if(!(this.blazorActions&Ks.GroupClipboardInProcess)){let i;const n=t?this.oldNodeObjects:this.oldConnectorObjects;for(let t=0;t<n.length;t++)n[t].id===e.id&&(i=!0);i||(t?this.oldNodeObjects.push(e):this.oldConnectorObjects.push(e))}}nodePropertyChange(e,t,i,n,r,s){if(this.canEnableBlazorObject&&"helper"!==e.id){const t=dp(e);this.insertValue(t,!0)}const o=e.wrapper.outerBounds,a=e.wrapper.bounds;let l,h=!1;if(void 0!==i.width&&(e.children?e.container?e.wrapper.width=i.width:this.scaleObject(e,i.width,!0):(e.wrapper.children[0].width=i.width,l=!0,h=!0)),void 0!==i.height&&(e.children?e.container?e.wrapper.height=i.height:this.scaleObject(e,i.height,!1):(e.wrapper.children[0].height=i.height,l=!0,h=!0)),l=this.nodePropertyChangeExtend(e,t,i,l),void 0!==i.constraints&&Cl(t)!==Cl(i)&&(e.wrapper.children[0].shadow=Cl(e)?e.shadow:null),void 0!==i.offsetX){if("None"!==e.wrapper.flip){if(e.offsetX!==e.wrapper.offsetX&&void 0!==t.offsetX){const n=i.offsetX-t.offsetX;e.wrapper.offsetX=e.wrapper.offsetX+n,this.updateFlipOffset(e.wrapper,n,0,e.wrapper.flip)}}else e.wrapper.offsetX=i.offsetX;l=!0,h=!0}if(void 0!==i.offsetY){if("None"!==e.wrapper.flip){if(e.offsetY!==e.wrapper.offsetY&&void 0!==t.offsetY){const n=i.offsetY-t.offsetY;e.wrapper.offsetY=e.wrapper.offsetY+n,this.updateFlipOffset(e.wrapper,0,n,e.wrapper.flip)}}else e.wrapper.offsetY=i.offsetY;l=!0,h=!0}if(void 0!==i.pivot&&(e.wrapper.pivot=i.pivot,l=!0),void 0!==i.minWidth&&(e.wrapper.minWidth=e.wrapper.children[0].minWidth=i.minWidth,l=!0,h=!0),void 0!==i.minHeight&&(e.wrapper.minHeight=e.wrapper.children[0].minHeight=i.minHeight,l=!0,h=!0),void 0!==i.maxWidth&&(e.wrapper.maxWidth=i.maxWidth,l=!0,h=!0),void 0!==i.maxHeight&&(e.wrapper.maxHeight=i.maxHeight,l=!0,h=!0),void 0!==i.flip)if(e.wrapper.flip=i.flip,l=!0,h=!0,e.wrapper.elementActions&oo.ElementIsGroup){if(kc(e.wrapper,e.offsetX,e.offsetY,this,i.flip),e&&e.children)for(const c of e.children){const e=this.nameTable[c];e.wrapper.flip=i.flip,this.updatePorts(e,i.flip)}}else e.wrapper.children[0].flip=i.flip,this.updatePorts(e,i.flip);if(void 0!==i.rotateAngle&&e.constraints&so.Rotate&&(e.children&&r&&this.commandHandler.rotateObjects(e,[e],e.rotateAngle-e.wrapper.rotateAngle,{x:e.offsetX,y:e.offsetY},!1),e.wrapper.rotateAngle=i.rotateAngle,l=!0,h=!0),void 0!==i.backgroundColor&&(e.wrapper.style.fill=i.backgroundColor),void 0!==i.visible&&this.updateElementVisibility(e.wrapper,e,e.visible),void 0!==i.shape&&"Bpmn"!==e.shape.type&&(l=!0,function(e,t,i,n){let r=new xo;switch(e.shape.type){case"Path":const i=new Eo;i.data=t.shape.data,r=i,mc(r,t,n);break;case"Image":const s=new Ao;s.source=t.shape.source,s.imageAlign=t.shape.align,s.imageScale=t.shape.scale,r=s,mc(r,t,n);break;case"Text":r=new Co,mc(r,t,n);break;case"Basic":const o="Rectangle"===t.shape.shape?new xo:new Eo;o.data="Polygon"===t.shape.shape?Ss(t.shape.points):Oo(t.shape.shape),mc(r,t,n),"Rectangle"===t.shape.shape&&(o.cornerRadius=t.shape.cornerRadius),r=o;break;case"Flow":const a=new Eo;a.data=Wo(t.shape.shape),r=a,mc(r,t,n);break;case"Native":const l=new Io(e.id,n.element.id);l.content=t.shape.content,l.scale=t.shape.scale,r=l,mc(r,t,n);break;case"HTML":let h=new ka(t.id,n.element.id);h.content=t.shape.content,r=h,mc(r,t,n)}void 0===e.shape.type||e.shape.type===i.shape.type?function(e,t,i,n){if(Object.keys(e.shape).length>0)if("Path"===t.shape.type&&void 0!==e.shape.data)t.wrapper.children[0].data=e.shape.data;else if("Text"===t.shape.type&&void 0!==e.shape.content)t.wrapper.children[0].content=e.shape.content;else if("Image"===t.shape.type&&void 0!==e.shape.source)t.wrapper.children[0].source=e.shape.source;else if("Native"===t.shape.type){let n;for(let r=0;r<i.views.length;r++)n=Nd(t.wrapper.children[0].id+"_native_element",i.views[r]),void 0!==e.shape.content&&n&&(n.removeChild(n.children[0]),t.wrapper.children[0].content=e.shape.content,n.appendChild(ep(t.wrapper.children[0],!1)));t.wrapper.children[0].scale=e.shape.scale?e.shape.scale:t.wrapper.children[0].scale}else if("HTML"===t.shape.type){let n;for(let r=0;r<i.views.length;r++)n=Nd(t.wrapper.children[0].id+"_html_element",i.views[r]),n&&(n.removeChild(n.children[0]),t.wrapper.children[0].content=e.shape.content,n.appendChild(ep(t.wrapper.children[0],!0)))}else if("Flow"===t.shape.type&&void 0!==e.shape.shape){t.shape.shape=e.shape.shape;const i=Wo(t.shape.shape.toString());t.wrapper.children[0].data=i}else if("UmlActivity"===t.shape.type&&void 0!==e.shape.shape)!function(e,t){e.shape.shape=t.shape.shape;const i=Yl(e.shape.shape.toString());"InitialNode"===e.shape.shape||"ForkNode"===e.shape.shape||"JoinNode"===e.shape.shape?e.wrapper.children[0].style.fill="black":"FinalNode"===e.shape.shape&&e instanceof Td&&(e.wrapper=fc(e)),i&&(e.wrapper.children[0].data=i)}(t,e);else if(void 0!==e.shape.cornerRadius)t.wrapper.children[0].cornerRadius=e.shape.cornerRadius;else if("Basic"===t.shape.type&&n&&"Rectangle"===n.shape.shape){const e=new Eo,n=Oo(t.shape.shape);e.data=n,mc(e,t,i)}else if(void 0!==e.shape.shape){t.shape.shape=e.shape.shape;const i=Oo(t.shape.shape.toString());t.wrapper.children[0].data=i}t.wrapper.children[0].canMeasurePath=!0}(e,t,n,i):(r.width=t.wrapper.children[0].width,r.height=t.wrapper.children[0].height,t.shape instanceof rd&&(r.margin=t.shape.margin),r.style=t.style,t.wrapper.children[0]=r)}(i,e,t,this),h=!0),i.margin&&(l=!0,this.updateMargin(e,i),h=!0),!((void 0===i.shape||void 0!==i.shape.type)&&void 0===i.width&&void 0===i.height&&void 0===i.style||"Bpmn"!==e.shape.type||!this.bpmnModule)&&(l=!0,h=!0,this.bpmnModule.updateBPMN(i,t,e,this)),"UmlActivity"===e.shape.type&&("FinalNode"===e.shape.shape||!1)&&(l=!0,h=!0,this.updateUMLActivity(i,t,e,this)),(e.shape&&"UmlClassifier"===e.shape.type||e.parentId&&this.nameTable[e.parentId]&&"UmlClassifier"===this.nameTable[e.parentId].shape.type)&&(l=!0,h=!0),void 0!==i.ports)for(const c of Object.keys(i.ports)){const t=Number(c);l=!0,this.updatePort(i.ports[c],e.ports[t],e.wrapper),h=!0}if(void 0!==i.annotation||void 0!==i.annotations||void 0!==i.width)for(const c of Object.keys(i.annotations||e.annotations)){const t=Number(c);let n;l=!0,n=i.annotation?i.annotation:i.annotations?i.annotations[c]:e.annotations;const r=e.annotations[t];if(r){this.updateAnnotation(n,r,e.wrapper,e,!!e.width);const t=this.nameTable[e.parentId];if(t&&"SwimLane"===t.shape.type){const i="LaneHeaderParent",n="PhaseHeaderParent";if(e.isLane||e.isPhase){const r=e.isLane?t.shape.lanes:t.shape.phases;for(let t=0;t<r.length;t++)if(r[t].id===(e[i]||e[n])){r[t].header.annotation.content=e.annotations[0].content,r[t].header.annotation.style=e.annotations[0].style;break}}}}}if(void 0===i.expandIcon&&void 0===i.collapseIcon&&void 0===i.isExpanded||(this.updateIcon(e),this.updateDefaultLayoutIcons(e),void 0!==i.isExpanded&&this.commandHandler.expandNode(e,this),l=!0),void 0!==i.fixedUserHandles){let t,n,r;for(const s of Object.keys(i.fixedUserHandles))t=Number(s),l=!0,i.fixedUserHandles[t]&&(n=i.fixedUserHandles[t]),r=e.fixedUserHandles[t],r&&this.updateNodefixedUserHandle(n,r,e.wrapper,e)}if(void 0!==i.tooltip&&this.updateTooltip(e,i),l){if(void 0!==this.bpmnModule&&this.bpmnModule.updateTextAnnotationProp(e,{offsetX:t.offsetX||e.offsetX,offsetY:t.offsetY||e.offsetY},this),this.checkSelectedItem(e)&&e.wrapper.children[0]instanceof Co&&e.wrapper.children[0].refreshTextElement(),e.wrapper.measure(new bs(e.wrapper.bounds.width,e.wrapper.bounds.height),e.id,this.onLoadImageSize.bind(this)),e.wrapper.arrange(e.wrapper.desiredSize),this.updateObject(e,t,i),!("SwimLane"!==e.shape.type||this.currentSymbol||this.diagramActions&go.ToolAction)){Dh(this,e);const t=e.wrapper.children[0],i=e.shape,n=t.columnDefinitions().length;"Horizontal"===i.orientation&&Ih(e,this,t.rows[i.header&&i.hasHeader?1:0].cells[n-1],n-1),e.wrapper.measure(new bs(e.wrapper.bounds.width,e.wrapper.bounds.height)),e.wrapper.arrange(e.wrapper.desiredSize)}if(this.diagramActions&go.ToolAction&&!(this.diagramActions&go.UndoRedo)||this.checkSelectedItem(e)&&this.updateSelector(),!1===o.equals(o,e.wrapper.outerBounds)&&this.updateQuad(e),n?e&&e.visible&&e.outEdges&&this.updateIconVisibility(e,0!==e.outEdges.length):this.commandHandler.connectorSegmentChange(e,a,void 0!==i.rotateAngle),void 0!==this.bpmnModule&&this.bpmnModule.updateDocks(e,this),i.annotations&&e.processId||this.updateGroupOffset(e),e.parentId&&this.nameTable[e.parentId]){const t=this.nameTable[e.parentId];t.wrapper.measure(new bs(t.wrapper.width,e.wrapper.height)),t.wrapper.arrange(t.wrapper.desiredSize),t.offsetX=t.wrapper.offsetX,t.offsetY=t.wrapper.offsetY}if(!1===a.equals(a,e.wrapper.bounds)&&(this.updateGroupSize(e),e.children&&this.updateGroupOffset(e)),"SwimLane"===e.shape.type&&!this.currentSymbol&&this.diagramActions&go.Render&&Oh(vh(this,e.wrapper.children[0]),this),!this.preventNodesUpdate&&((!Dl(this)||Dl(this)&&this.scroller.oldCollectionObjects.indexOf(e.id)>-1)&&(this.diagramActions&go.PreventZIndexOnDragging?this.updateDiagramObject(e,!0):this.updateDiagramObject(e)),!n&&h&&(this.lineRoutingModule&&this.diagramActions&&this.constraints&lo.LineRouting&&"helper"!==e.id&&(this.diagramActions&go.ToolAction||this.lineRoutingModule.renderVirtualRegion(this,!0)),this.updateConnectorEdges(e),"helper"!==e.id&&!(this.diagramActions&go.ToolAction)))){const t=this.spatialSearch.findObjects(e.wrapper.outerBounds);for(let e=0;e<t.length;e++){const i=t[e];i instanceof ol&&this.connectorPropertyChange(t[e],{},{sourceID:i.sourceID,targetID:i.targetID,sourcePortID:i.sourcePortID,targetPortID:i.targetPortID,sourcePoint:i.sourcePoint,targetPoint:i.targetPoint})}}"New"!==e.status&&this.diagramActions&&(e.status="Update")}if(!s){this.triggerEvent(vo.propertyChange,{element:e,cause:this.diagramActions,oldValue:t,newValue:i})}}updatePorts(e,t){if(e&&e.ports.length>0)for(const i of Object.keys(e.ports)){const n=Number(i),r=e.ports[n];let s=this.getWrapper(e.wrapper,r.id);s=Mc(s,t,r),s.relativeMode="Point",s.measure(new bs(s.width,s.height)),s.arrange(s.desiredSize)}}updateFlipOffset(e,t,i,n){if(e.hasChildren())for(const r of e.children)"Horizontal"!==n&&"Both"!==n||(r.flipOffset.x=r.flipOffset.x+t),"Vertical"!==n&&"Both"!==n||(r.flipOffset.y=r.flipOffset.y+i),(r instanceof Po||r instanceof So)&&this.updateFlipOffset(r,t,i,n)}updateUMLActivity(e,t,i,n){if(void 0!==e.width||void 0!==e.height){const t=i.wrapper.children[0].children[0];t.width=e.width,t.height=e.height;const n=i.wrapper.children[0].children[1];n.width=e.width/1.5,n.height=e.height/1.5}}updateConnectorProperties(e){this.preventConnectorsUpdate?-1===this.selectionConnectorsList.indexOf(e)&&this.selectionConnectorsList.push(e):this.connectorPropertyChange(e,{},{sourcePoint:e.sourcePoint,targetPoint:e.targetPoint,sourceID:e.sourceID,targetID:e.targetID,sourcePortID:e.sourcePortID,targetPortID:e.targetPortID},void 0,!0)}updateConnectorEdges(e){if(e.inEdges.length>0)for(let t=0;t<e.inEdges.length;t++)this.updateConnectorProperties(this.nameTable[e.inEdges[t]]);if(e.outEdges.length>0)for(let t=0;t<e.outEdges.length;t++)this.updateConnectorProperties(this.nameTable[e.outEdges[t]]);e.parentId&&this.nameTable[e.parentId]&&this.updateConnectorEdges(this.nameTable[e.parentId])}connectorProprtyChangeExtend(e,t,i,n){return void 0!==i.type&&i.type!==t.type&&e.segments.length>0&&void 0===i.segments&&(e.segments=[]),void 0!==i.shape&&void 0!==e.shape&&e.shape&&"Bpmn"===e.shape.type&&this.bpmnModule&&this.bpmnModule.updateBPMNConnector(e,t,i,this),void 0!==e.constraints?(this.updateThumbConstraints(this.selectedItems.connectors,this.selectedItems),!0):n}connectorPropertyChange(e,t,i,n,r){if(this.canEnableBlazorObject){const t=dp(e);this.insertValue(t,!1)}const s=e.wrapper.bounds;let o,a,l,h,c=!1,d=[];if(c=this.connectorProprtyChangeExtend(e,t,i,c),void 0!==i.visible&&this.updateElementVisibility(e.wrapper,e,e.visible),void 0!==i.sourcePoint||void 0!==i.targetPoint||void 0!==i.sourceID||void 0!==i.targetID||void 0!==i.targetPadding||void 0!==i.sourcePortID||void 0!==i.targetPortID||void 0!==i.sourcePadding||void 0!==i.type||void 0!==i.segments||void 0!==i.flip){if(void 0!==i.sourceID&&i.sourceID!==t.sourceID||i.sourcePortID){const n=this.nameTable[e.sourceID];if(a=this.findInOutConnectPorts(n,!1),(!n||Tl(n)||""!==e.sourcePortID&&El(a))&&(e.sourceWrapper=n?this.getEndNodeWrapper(n,e,!0):void 0,e.sourcePortID&&void 0===i.sourcePortID&&(e.sourcePortWrapper=n?this.getWrapper(n.wrapper,e.sourcePortID):void 0),this.removePortEdges(this.nameTable[t.sourceID]||n,t.sourcePortID||e.sourcePortID,e.id,!1)),void 0!==i.sourceID&&void 0!==t.sourceID&&""!==t.sourceID){const i=this.nameTable[t.sourceID];void 0!==i&&i.outEdges&&-1!==i.outEdges.indexOf(e.id)&&bc(i.outEdges,e.id)}this.updateEdges(e)}if(void 0!==i.targetID&&i.targetID!==t.targetID){const n=this.nameTable[i.targetID];if(o=this.findInOutConnectPorts(n,!0),(!n||Pl(n)||""!==e.targetPortID&&Ol(o))&&(e.targetWrapper=n?this.getEndNodeWrapper(n,e,!1):void 0,e.targetPortID&&void 0===i.targetPortID&&(e.targetPortWrapper=n?this.getWrapper(n.wrapper,e.targetPortID):void 0),this.removePortEdges(this.nameTable[t.targetID]||n,t.targetPortID||e.targetPortID,e.id,!0)),void 0!==t&&void 0!==t.targetID&&""!==t.targetID){const i=this.nameTable[t.targetID];void 0!==i&&i.inEdges&&-1!==i.inEdges.indexOf(e.id)&&bc(i.inEdges,e.id)}this.updateEdges(e)}if(void 0!==i.sourcePortID&&i.sourcePortID!==t.sourcePortID){e.sourceID&&this.nameTable[e.sourceID]&&(l=this.nameTable[e.sourceID].wrapper);const t=this.nameTable[e.sourceID];!t||Tl(t)||""!==e.sourcePortID&&El(a)?e.sourcePortWrapper=l?this.getWrapper(l,i.sourcePortID):void 0:""!==e.sourcePortID||Tl(t)||(e.sourcePortWrapper=void 0)}if(void 0!==i.targetPortID&&i.targetPortID!==t.targetPortID){const t=this.nameTable[e.targetID];e.targetID&&this.nameTable[e.targetID]&&(h=this.nameTable[e.targetID].wrapper),!t||Pl(t)||""!==e.targetPortID&&Ol(o)?e.targetPortWrapper=h?this.getWrapper(h,i.targetPortID):void 0:""!==e.targetPortID||Pl(t)||(e.targetPortWrapper=void 0)}void 0!==i.flip&&(e.flip=i.flip,zc(e)),"Orthogonal"===e.type&&this.lineRoutingModule&&this.diagramActions&&this.constraints&lo.LineRouting&&!(this.diagramActions&go.ToolAction)&&(this.lineRoutingModule.renderVirtualRegion(this,!0),this.lineRoutingModule.refreshConnectorSegments(this,e,!1)),d=this.getPoints(e)}var p;void 0!==i.style&&uc(i.style,e.wrapper.children[0]),(d.length>0||void 0!==i.sourceDecorator||void 0!==i.targetDecorator&&(-1!==(p=Object.keys(i.targetDecorator)).indexOf("shape")||-1!==p.indexOf("pathData")||-1!==p.indexOf("width")||-1!==p.indexOf("height"))||void 0!==i.cornerRadius)&&(vc(e,d.length>0?d:e.intermediatePoints,this.diagramActions),void 0!==i.type&&(c=!0),d.length>0&&(e.wrapper.measure(new bs(e.wrapper.width,e.wrapper.height)),e.wrapper.arrange(e.wrapper.desiredSize),this.updateConnectorAnnotation(e),this.updateConnectorfixedUserHandles(e),this.updateObject(e,t,i))),(i.sourcePoint||i.targetPoint||i.segments)&&this.diagramActions===go.Render&&(c=!0),"Bpmn"===e.shape.type&&"Default"===e.shape.sequence&&this.commandHandler.updatePathElementOffset(e),n||this.updateBridging(),this.updateAnnotations(i,e),this.updatefixedUserHandle(i,e),e.wrapper.measure(new bs(e.wrapper.width,e.wrapper.height)),e.wrapper.arrange(e.wrapper.desiredSize),!1===s.equals(s,e.wrapper.bounds)&&(this.updateQuad(e),this.updateGroupSize(e)),!0!==c||!this.checkSelectedItem(e)||this.diagramActions&go.ToolAction&&!(this.diagramActions&go.UndoRedo)||this.updateSelector(),this.preventConnectorsUpdate||(!Dl(this)||Dl(this)&&this.scroller.oldCollectionObjects.indexOf(e.id)>-1)&&(this.diagramActions&go.PreventZIndexOnDragging?this.updateDiagramObject(e,!0):this.updateDiagramObject(e)),this.diagramActions&&"New"!==e.status&&(e.status="Update"),this.triggerPropertyChange(r,e,t,i)}removePortEdges(e,t,i,n){if(e)for(let r=0;r<e.ports.length;r++){const s=e.ports[r];s.id===t&&bc(n?s.inEdges:s.outEdges,i)}}getpropertyChangeArgs(e,t,i,n){return n.element={connector:e},n.oldValue={connector:t},n.newValue={connector:i},n}triggerPropertyChange(e,t,i,n){if(!e){this.triggerEvent(vo.propertyChange,{element:t,cause:this.diagramActions,oldValue:i,newValue:n})}}findInOutConnectPorts(e,t){let i={};return e&&(i=Oc(e,t)),i}getPoints(e,t){return e.getConnectorPoints(e.type,t,"ComplexHierarchicalTree"===this.layout.type||"HierarchicalTree"===this.layout.type?this.layout.orientation:void 0,!!this.lineDistributionModule)}updateNodeProperty(e,t,i){if(void 0===t)this.updateElementVisibility(e,this.nameTable[e.id],t);else{e.style.opacity=i;for(let t=0;t<e.children.length;t++)e.children[t]instanceof So&&this.updateNodeProperty(e.children[t],void 0,i),e.children[t].style.opacity=i}}checkSelectedItem(e){const t=this.selectedItems;let i=!1,n=[];return n=n.concat(t.nodes,t.connectors),n.length>0&&e.id===n[n.length-1].id&&(i=!0),i}updateDiagramContainerVisibility(e,t){if(e instanceof So)for(let i=0;i<e.children.length;i++)this.updateDiagramContainerVisibility(e.children[i],t);e.visible=t}updateElementVisibility(e,t,i){if(void 0!==i){if(e.visible=i,t instanceof Td){if(t.children)for(const e of t.children)this.updateElementVisibility(this.nameTable[e].wrapper,this.nameTable[e],i);else e.children[0].visible=i,this.updateDiagramContainerVisibility(e.children[0],i),"Bpmn"===t.shape.type&&this.bpmnModule&&this.bpmnModule.updateElementVisibility(t,i,this);if(t.ports)for(const n of t.ports)n.visibility&eo.Visible&&(this.getWrapper(e,n.id).visible=i);if(t.annotations)for(const n of t.annotations)this.getWrapper(e,n.id).visible=i}else for(let t=0;t<3;t++)e.children[t].visible=i;if(t.annotations)for(const n of t.annotations)this.getWrapper(e,n.id).visible=i;if(t.expandIcon||t.collapseIcon){const n=this.getWrapper(e,"icon_content");if(n){for(let e=0;e<n.children.length;e++)n.children[e].visible=i;n.visible=i}t&&t.visible&&t.outEdges&&this.updateIconVisibility(t,0!==t.outEdges.length)}!1===i&&this.unSelect(this.nameTable[e.id]),(t instanceof Td&&!this.preventNodesUpdate||t instanceof ol&&!this.preventConnectorsUpdate)&&this.diagramActions&&this.updateDiagramObject(this.nameTable[e.id],void 0,!0)}}updateAnnotations(e,t){if(void 0!==e.annotations)for(const i of Object.keys(e.annotations)){const n=Number(i);this.updateAnnotation(e.annotations[i],t.annotations[n],t.wrapper,t)}}updatefixedUserHandle(e,t){if(void 0!==e.fixedUserHandles){let i,n,r;for(const s of Object.keys(e.fixedUserHandles))i=Number(s),n=e.fixedUserHandles[s],r=t.fixedUserHandles[i],this.updateConnectorfixedUserHandle(n,r,t.wrapper,t)}}updateConnectorfixedUserHandle(e,t,i,n,r){let s=!1;const o=this.getWrapper(i,t.id);void 0!==o&&(void 0!==e.width&&(o.width=e.width,s=!0),void 0!==e.height&&(o.height=e.height,s=!0),t instanceof _a&&void 0!==e.offset&&n.updateAnnotation(t,n.intermediatePoints,n.wrapper.bounds,o),t instanceof _a&&e.displacement&&(void 0===e.displacement.x&&void 0===e.displacement.y||(s=!0)),void 0!==e.fill&&(o.style.fill=e.fill),void 0!==e.handleStrokeColor&&(o.style.strokeColor=e.handleStrokeColor),void 0!==e.handleStrokeWidth&&(o.style.strokeWidth=e.handleStrokeWidth),void 0!==e.visibility&&(o.visible=e.visibility),void 0!==e.cornerRadius&&(o.cornerRadius=e.cornerRadius),this.updatefixedUserHandleContent(e,s,o,n,t,i),!0===s&&(o.measure(new bs(o.width,o.height)),o.arrange(o.desiredSize)))}updateAnnotation(e,t,i,n,r){let s=!1;const o=this.getWrapper(i,t.id);if(void 0!==o){if(void 0!==e.width&&void 0!==e.height&&(o.width=e.width,o.height=e.height,s=!0),void 0!==e.rotateAngle&&(o.rotateAngle=e.rotateAngle),!r||o instanceof ka||o.refreshTextElement(),t instanceof Ho&&void 0!==e.segmentAngle&&(o.rotateAngle=t.rotateAngle),t instanceof jo&&void 0!==e.offset){const i=e.offset;s=!0,o.setOffsetWithRespectToBounds(void 0!==i.x?i.x:t.offset.x,void 0!==i.y?i.y:t.offset.y,"Fraction"),o.relativeMode="Point"}else t instanceof Ho&&(void 0!==e.offset||void 0!==e.segmentAngle)&&n.updateAnnotation(t,n.intermediatePoints,n.wrapper.bounds,o);if(t instanceof Ho&&e.displacement&&(void 0===e.displacement.x&&void 0===e.displacement.y||(s=!0)),void 0!==e.margin&&(s=!0,void 0!==e.margin.bottom&&(o.margin.bottom=e.margin.bottom),void 0!==e.margin.top&&(o.margin.top=e.margin.top),void 0!==e.margin.left&&(o.margin.left=e.margin.left),void 0!==e.margin.right&&(o.margin.right=e.margin.right)),(s||r)&&(o.width=t.width||n.width,t.template&&(o.width=o.width||o.actualSize.width,o.height=t.height||n.height||o.actualSize.height)),void 0!==e.horizontalAlignment&&(o.horizontalAlignment=e.horizontalAlignment,s=!0),void 0!==e.verticalAlignment&&(o.verticalAlignment=e.verticalAlignment,s=!0),void 0!==e.visibility&&(o.visible=!(!i.visible||!e.visibility)),void 0!==e.constraints){const t=!1;o.constraints&ro.Select&&!(e.constraints&ro.Select)&&$p(this,n,!1,o),o.constraints=e.constraints,t&&this.clearSelection()}void 0!==e.style&&uc(e.style,o),void 0!==e.hyperlink&&function(e,t,i){const n=t,r=n.hyperlink;for(const s of Object.keys(e))switch(s){case"color":n.style.color=r.color=e.color;break;case"content":n.content=r.content=e.content||r.link;break;case"link":const t=i.style;n.style.color=e.link?r.color:t.color,n.style.textDecoration=e.link?r.textDecoration:i.style.textDecoration,n.content=e.link?r.content||e.link:i.content,r.link=e.link;break;case"textDecoration":n.style.textDecoration=r.textDecoration=e.textDecoration}}(e.hyperlink,o,t),this.updateAnnotationContent(e,s,o,n,t,i),!0===s&&(o.measure(new bs(o.width,o.height)),o.arrange(o.desiredSize)),o instanceof ka||o.refreshTextElement()}}updatefixedUserHandleContent(e,t,i,n,r,s){void 0!==e&&this.updateConnectorfixedUserHandleWrapper(i,n,r,s)}updateConnectorfixedUserHandleWrapper(e,t,i,n){for(const r of this.views)Kd(e.id+"_groupElement",r),Kd(e.id+"_html_element",r);if(t instanceof ol){const i=t.wrapper.children[0],n=new Ds(i.offsetX-i.width/2,i.offsetY-i.height/2,i.width,i.height);e=t.getfixedUserHandle(t.fixedUserHandles[t.fixedUserHandles.length-1],t.intermediatePoints,n)}for(let r=0;r<n.children.length;r++)e.id===n.children[r].id&&n.children.splice(r,1,e)}updateAnnotationContent(e,t,i,n,r,s){void 0!==e.content&&(i&&(i.content="UmlActivity"===n.shape.type&&"StructuredNode"===n.shape.shape?"<<"+e.content+">>":e.content),i instanceof ka&&this.updateAnnotationWrapper(i,n,r,s)),void 0!==e.template&&(i.content=e.template,this.updateAnnotationWrapper(i,n,r,s))}updateAnnotationWrapper(e,t,i,n){for(const r of this.views)Kd(e.id+"_groupElement",r),Kd(e.id+"_html_element",r);if(t instanceof Td)e=t.initAnnotationWrapper(i,this.element.id);else if(t instanceof ol){const i=t.wrapper.children[0],n=new Ds(i.offsetX-i.width/2,i.offsetY-i.height/2,i.width,i.height);e=t.getAnnotationElement(t.annotations[t.annotations.length-1],t.intermediatePoints,n,this.getDescription,this.element.id)}for(let r=0;r<n.children.length;r++)e.id===n.children[r].id&&n.children.splice(r,1,e)}updateNodefixedUserHandle(e,t,i,n){let r=!1;const s=this.getWrapper(i,t.id);if(void 0!==s){if(void 0!==e.width&&(s.actualSize.width=e.width,r=!0),void 0!==e.height&&(s.height=e.height,r=!0),t instanceof Na&&void 0!==e.offset){const i=e.offset;r=!0,s.setOffsetWithRespectToBounds(void 0!==i.x?i.x:t.offset.x,void 0!==i.y?i.y:t.offset.y,"Fraction"),s.relativeMode="Point"}void 0!==e.margin&&(r=!0,void 0!==e.margin.bottom&&(s.margin.bottom=e.margin.bottom),void 0!==e.margin.top&&(s.margin.top=e.margin.top),void 0!==e.margin.left&&(s.margin.left=e.margin.left),void 0!==e.margin.right&&(s.margin.right=e.margin.right)),void 0!==e.visibility&&(s.visible=e.visibility),void 0!==e.fill&&(s.style.fill=e.fill),void 0!==e.handleStrokeColor&&(s.style.strokeColor=e.handleStrokeColor),void 0!==e.handleStrokeWidth&&(s.style.strokeWidth=e.handleStrokeWidth),void 0!==e.cornerRadius&&(s.cornerRadius=e.cornerRadius),this.updatefixedUserHandleWrapper(s,n,t,i),!0===r&&(s.measure(new bs(s.width,s.height)),s.arrange(s.desiredSize))}}updatefixedUserHandleWrapper(e,t,i,n){for(const r of this.views)Kd(e.id+"_groupElement",r),Kd(e.id+"_html_element",r);t instanceof Td&&(e=t.initfixedUserHandles(i));for(let r=0;r<n.children.length;r++)e.id===n.children[r].id&&n.children.splice(r,1,e)}updatePort(e,t,i){let n=!1;const r=this.getWrapper(i,t.id);if(void 0!==r){if(void 0!==e.offset&&(n=!0,r.setOffsetWithRespectToBounds(void 0!==e.offset.x?e.offset.x:t.offset.x,void 0!==e.offset.y?e.offset.y:t.offset.y,"Fraction"),r.relativeMode="Point"),void 0!==e.width&&(n=!0,r.width=e.width),void 0!==e.height&&(n=!0,r.height=e.height),void 0!==e.visibility&&(r.visible=!(!i.visible||!Cc(t,eo.Visible))),void 0!==e.margin&&(n=!0,void 0!==e.margin.bottom&&(r.margin.bottom=e.margin.bottom),void 0!==e.margin.top&&(r.margin.top=e.margin.top),void 0!==e.margin.right&&(r.margin.right=e.margin.right),void 0!==e.margin.left&&(r.margin.left=e.margin.left)),void 0!==e.horizontalAlignment&&(n=!0,r.horizontalAlignment=e.horizontalAlignment),void 0!==e.verticalAlignment&&(n=!0,r.verticalAlignment=e.verticalAlignment),void 0!==e.style&&(void 0!==e.style.fill&&(r.style.fill=e.style.fill),void 0!==e.style.opacity&&(r.style.opacity=e.style.opacity),void 0!==e.style.strokeColor&&(r.style.strokeColor=e.style.strokeColor),void 0!==e.style.strokeWidth&&(r.style.strokeWidth=e.style.strokeWidth),void 0!==e.style.strokeDashArray&&(r.style.strokeDashArray=e.style.strokeDashArray)),void 0!==e.shape&&r){const t=No(e.shape);r.data=t,r.canMeasurePath=!0}void 0!==e.pathData&&(r.data=String(e.pathData),n=!0),!0===n&&(r.measure(new bs(r.width,r.height)),r.arrange(r.desiredSize))}}updateIcon(e){const t=this.getWrapper(e.wrapper,"icon_content"),i=this.diagramActions&go.Render?this.element.id:void 0;if(t){if("SVG"===this.mode){const t=Nd(e.wrapper.id+"_icon_content",i);if(t){const e=Nd(t.id+"_rect",i),n=Nd(t.id+"_shape",i),r=Nd(n.id+"_native_element",i);r&&r.parentNode.removeChild(r),n.parentNode.removeChild(n),e.parentNode.removeChild(e),t.parentNode.removeChild(t)}}const n=e.wrapper.children.indexOf(t);e.wrapper.children.splice(n,1)}const n=this.getPortContainer(e);e.initIcons(this.getDescription,this.layout,n,this.element.id)}getPortContainer(e){if(e.children)for(let t=0;t<e.wrapper.children.length;t++)if(e.wrapper.children[t].id===e.id+"group_container")return e.wrapper.children[t];return e.wrapper}updateTooltip(e,t){void 0!==t.tooltip.content&&(e.tooltip.content=t.tooltip.content),void 0!==t.tooltip.position&&(e.tooltip.position=t.tooltip.position),void 0!==t.tooltip.height&&(e.tooltip.height=t.tooltip.height),void 0!==t.tooltip.width&&(e.tooltip.width=t.tooltip.width),void 0!==t.tooltip.showTipPointer&&(e.tooltip.showTipPointer=t.tooltip.showTipPointer),void 0!==t.tooltip.relativeMode&&(e.tooltip.relativeMode=t.tooltip.relativeMode)}updateQuad(e){this.spatialSearch.updateQuad(e.wrapper)&&!this.preventDiagramUpdate&&this.updatePage()}removeFromAQuad(e){if(e.children){let t;const i=e.children;for(let e=0;e<i.length;e++)t=this.nameTable[i[e]],t&&this.removeFromAQuad(t)}this.spatialSearch.removeFromAQuad(e.wrapper),this.spatialSearch.updateBounds(e.wrapper)&&!this.preventDiagramUpdate&&this.updatePage()}updateGroupSize(e){let t;e.parentId&&(t=this.nameTable[e.parentId],t&&(t.parentId?this.updateGroupSize(t):(t.wrapper.measure(new bs),t.wrapper.arrange(t.wrapper.desiredSize),this.updateGroupOffset(t),this.updateDiagramObject(t))))}updatePage(){if(this.diagramActions&go.Render&&!(this.diagramActions&go.DragUsingMouse)){this.scroller.updateScrollOffsets(),this.scroller.setSize();for(const t of this.views){const i=this.views[t];i instanceof e||i.updateView(i)}}this.diagramActions&go.DragUsingMouse&&this.renderPageBreaks()}protectPropertyChange(e){this.isProtectedOnChange=e}getProtectPropertyChangeValue(){return this.isProtectedOnChange}enableServerDataBinding(e){}updateShadow(e,t){void 0!==t.angle&&(e.angle=t.angle),void 0!==t.color&&(e.color=t.color),void 0!==t.distance&&(e.distance=t.distance),void 0!==t.opacity&&(e.opacity=t.opacity)}updateMargin(e,t){void 0!==t.margin.top&&(e.margin.top=t.margin.top),void 0!==t.margin.bottom&&(e.margin.bottom=t.margin.bottom),void 0!==t.margin.left&&(e.margin.left=t.margin.left),void 0!==t.margin.right&&(e.margin.right=t.margin.right)}removePreviewChildren(e){if(e.children&&e.children.length&&e.shape&&"SwimLane"===e.shape.type){for(let i=0;i<e.children.length;i++){const t=e.children[i],n=this.nodes.indexOf(this.nameTable[t]);n>=0&&this.nodes.splice(n,1),delete this.nameTable[t]}const t=this.nodes.indexOf(this.nameTable[this.currentSymbol.id]);t>=0&&this.nodes.splice(t,1)}}initDroppables(){let e,t,i={},n={};this.droppable=new $t(this.element),this.droppable.over=r=>{if(this.currentSymbol)r.event.touches&&r.event.touches.length&&this.eventHandler.mouseMove(r.event,r.event.touches);else{let s=null;if(!r.dragData&&"drag"===r.name){const e=document.getElementsByClassName("e-dragclone")[0];e&&(s=e)}if(r.dragData||s){let o,a;document.getElementById(this.element.id+"content").focus();const l=this.eventHandler.getMousePosition(r.event);let h;const c=s||r.dragData.helper,d=c.getAttribute("paletteId");let p,u,g,m;if(d){const s=document.getElementById(d).ej2_instances[0];this.droppable.sourceElement=s;const f="selectedSymbols",y="childTable";if(s){const d=s[f];this.allowServerDataBinding=!1,h=dp(s[f]),i=s[y];const b=d.wrapper.children[0].children[0];if(m=function(e,t,i){const n=Uc(e,t,i,"width"),r=Uc(e,t,i,"height");return new bs(n,r)}(s,h,b),s[f]instanceof Td){"TextAnnotation"===d.shape.shape?(h.offsetX=l.x+11+m.width*h.pivot.x,h.offsetY=l.y+11+m.height*h.pivot.y):(h.offsetX=l.x+5+m.width*h.pivot.x,h.offsetY=l.y+m.height*h.pivot.y);let r=new Td(this,"nodes",h,!0);"Bpmn"===r.shape.type&&r.shape.activity.subProcess.processes&&r.shape.activity.subProcess.processes.length&&(r.shape.activity.subProcess.processes=[]),p=r.dragSize,u=r.previewSize,g=s.symbolDragSize;const c=s.symbolPreview;if(r.width=p.width||g.width||u.width||c.width||r.width,r.height=p.height||g.height||u.height||c.height||r.height,"SwimLane"===r.shape.type){if(this.diagramActions|=go.PreventHistory,r.shape.isLane){r.children=[],e={id:"header"+op()},"Horizontal"===r.shape.orientation?(e.width=r.shape.lanes[0].header.width,e.height=r.shape.lanes[0].height):(e.width=r.shape.lanes[0].width,e.height=r.shape.lanes[0].header.height),e.style=r.shape.lanes[0].header.style,e.offsetX=l.x+5+e.width/2,e.offsetY=l.y+e.height/2,this.diagramActions|=go.PreventCollectionChangeOnDragOver,e=this.add(e),t={id:"body"+op()},"Horizontal"===r.shape.orientation?(t.width=r.shape.lanes[0].width-e.width,t.height=r.shape.lanes[0].height,t.offsetX=l.x+5+(r.shape.lanes[0].header.width+t.width/2),t.offsetY=l.y+t.height/2):(t.width=r.shape.lanes[0].width,t.height=r.shape.lanes[0].height-e.height,t.offsetX=l.x+5+t.width/2,t.offsetY=l.y+(r.shape.lanes[0].header.height+t.height/2)),t.style=r.shape.lanes[0].style,t=this.add(t);const i={id:"group"+op(),children:[e.id,t.id]};i.shape=r.shape,i.width=r.shape.lanes[0].width,i.height=r.shape.lanes[0].height,i.previewSize=r.previewSize,i.dragSize=r.dragSize,i.addInfo=r.addInfo,r=this.add(i),this.diagramActions&=~go.PreventCollectionChangeOnDragOver}this.diagramActions&=~go.PreventHistory}if(r.shape.isPhase&&(a="Horizontal"===r.shape.orientation,a?(r.offsetX=l.x+5+(r.width||b.actualSize.width)/2,r.offsetY=l.y,r.shape.data="M20,"+r.height/2+" L"+(r.width-20)+","+r.height/2+"z",r.height=1):(r.offsetX=l.x+5,r.offsetY=l.y+(r.height||b.actualSize.height)/2,r.shape.data="M"+r.width/2+",20 L"+r.width/2+","+(r.height-20)+"z",r.width=1)),o=r,h.children){const e=h;n=this.getChildren(e,{},i),Ac(e,-e.offsetX,-e.offsetY,n,!0,this)}}else if(s[f]instanceof ol){o=new ol(this,"connectors",h,!0);const e=Ds.toBounds([o.sourcePoint,o.targetPoint]),t=l.x-e.left,i=l.y-e.top;o.sourcePoint.x+=t,o.sourcePoint.y+=i,o.targetPoint.x+=t,o.targetPoint.y+=i}o.shape.isLane||(o.id+=op());let v={source:s,element:o,cancel:!1,diagram:this};if(this.enterObject=o,this.enterTable=n,this.triggerEvent(vo.dragEnter,v),o instanceof Td&&"SwimLane"===o.shape.type&&o.shape.isLane){const i=v.element,n=i.shape.lanes[0];a="Horizontal"===i.shape.orientation;const r=this.nameTable[o.children[0]],h=this.nameTable[o.children[1]];p=o.dragSize,u=o.previewSize,g=s.symbolDragSize,n.width=p.width||g.width||u.width||n.width,n.height=p.height||g.height||u.height||n.height,a?(e.width=n.header.width,e.height=n.height,t.width=n.width-e.width,t.height=n.height,t.offsetX=l.x+5+(n.header.width+h.width/2),t.offsetY=l.y+h.height/2):(e.width=n.width,e.height=n.header.height,t.width=n.width,t.height=n.height-e.height,t.offsetX=l.x+5+h.width/2,t.offsetY=l.y+(n.header.height+h.height/2)),e.offsetX=l.x+5+r.width/2,e.offsetY=l.y+r.height/2,o.width=n.width,o.height=n.height}o instanceof Td&&o.shape.isPhase&&(a?o.height=1:o.width=1),this.activeLayer.lock||v.cancel||(this.preventDiagramUpdate=!0,o.children&&this.findChild(o,n),this.preventDiagramUpdate=!0,-1!==o.zIndex&&(o.zIndex=-1),this.initObject(o,void 0,void 0,!0),this.currentSymbol=o,"SVG"!==this.mode&&this.refreshDiagramLayer(),this.commandHandler.oldSelectedObjects=jc(this),this.commandHandler.select(o),this.commandHandler.updateBlazorSelector(),this.eventHandler.mouseDown(r.event),this.eventHandler.mouseMove(r.event,r),this.preventDiagramUpdate=!1,this.updatePage(),c.style.opacity="0"),delete this.enterObject,delete this.enterTable}this.droppable[f]=c,this.allowServerDataBinding=!0}}}},this.droppable.drop=e=>zu(this,void 0,void 0,function*(){this.allowServerDataBinding=!1;const t="sourceElement";let i;if(this.currentSymbol){let n,r=!1;const s=this.currentSymbol instanceof ol;let o;e.event.touches&&this.eventHandler.mouseUp(e.event),o={source:this.droppable[t],element:this.currentSymbol,target:this.eventHandler.hoverNode||this.eventHandler.lastObjectUnderMouse||this,cancel:!1,position:{x:this.currentSymbol.wrapper.offsetX,y:this.currentSymbol.wrapper.offsetY}},this.triggerEvent(vo.drop,o);const a="id",l=dp(this.currentSymbol);if(l.hasTarget=this.currentSymbol.hasTarget,this.removeFromAQuad(this.currentSymbol),this.removeObjectsFromLayer(this.nameTable[this.currentSymbol.id]),this.removeElements(this.currentSymbol),(this.currentSymbol.shape.isLane||this.currentSymbol.shape.isPhase)&&this.removeChildInNodes(this.currentSymbol),o.cancel&&hc(this.currentSymbol,this),this.currentSymbol.shape.isPhase&&(r=!0,n=this.currentSymbol.shape.orientation),this.removePreviewChildren(this.currentSymbol),delete this.nameTable[this.currentSymbol.id],this.currentSymbol=null,this.protectPropertyChange(!0),o.cancel)this.clearSelectorLayer();else{if(this.startGroupAction(),l&&(l.shape.isLane||r)&&(r&&(l.shape.isPhase=r,l.shape.orientation=n),this.eventHandler.addSwimLaneObject(l)),"Bpmn"===l.shape.type&&l.shape.annotation&&l.hasTarget){const e=l.shape.annotation.nodeId;l.shape.annotation.id=l.id,this.addTextAnnotation(l.shape.annotation,this.nameTable[e]),l.nodeId=""}l.shape.isLane||r||(l.children&&this.addChildNodes(l),o.target&&o.target instanceof Td&&!s&&ah(this,o.target)&&Il(o.target)?ch(this,o.target,l):i=this.add(l,!0),(l||i)&&Rl(this)&&this.select([this.nameTable[l[a]]]))}this.protectPropertyChange(!1);const h=this.nameTable[l[a]];l.hasTarget&&(l.nodeId=l.hasTarget,this.remove(l)),this.bpmnModule&&h instanceof Td&&l.processId&&(h.processId=l.processId,this.bpmnModule.dropBPMNchild(this.nameTable[h.processId],h,this)),o.cancel||this.endGroupAction(),"SVG"!==this.mode&&this.refreshDiagramLayer(),delete this.droppable[t]}else{this.triggerEvent(vo.drop,{source:e.droppedElement,element:void 0,target:this.eventHandler.hoverNode||this.eventHandler.lastObjectUnderMouse||this,cancel:!1,position:void 0})}if(this.droppable.selectedSymbols&&this.droppable.selectedSymbols.parentNode)Qe(this.droppable.selectedSymbols);else{const e=document.getElementsByClassName("e-dragclone");for(let t=0;t<e.length;t++)e[t].remove()}this.allowServerDataBinding=!0}),this.droppable.out=e=>{if(this.currentSymbol&&!this.eventHandler.focus){this.unSelect(this.currentSymbol),this.removeFromAQuad(this.currentSymbol),"SVG"!==this.mode&&"Native"===this.currentSymbol.shape.type&&this.removeElements(this.currentSymbol),this.removeObjectsFromLayer(this.nameTable[this.currentSymbol.id]),this.removePreviewChildren(this.currentSymbol),delete this.nameTable[this.currentSymbol.id],this.triggerEvent(vo.dragLeave,{element:this.currentSymbol,diagram:this}),"SVG"!==this.mode?this.refreshDiagramLayer():this.removeElements(this.currentSymbol),this.currentSymbol=null,this.droppable.selectedSymbols.style.opacity="1",delete this.droppable.sourceElement,this.diagramRenderer.rendererActions=this.removeConstraints(this.diagramRenderer.rendererActions,mo.DrawSelectorBorder),this.previousSelectedObject&&this.select(this.previousSelectedObject,this.previousSelectedObject.length>1),this.previousSelectedObject=null}}}getBlazorDragLeaveEventArgs(e){return{diagramId:this.element.id,element:Lc(e.element)===ol?{connector:e.element}:{node:e.element}}}getDropEventArgs(e){if(this.eventHandler.lastObjectUnderMouse||this.eventHandler.hoverNode){const t=this.eventHandler.lastObjectUnderMouse||this.eventHandler.hoverNode;e.target=Lc(t)===ol?{connector:t}:{node:t}}else e.target.diagramId=this.element.id}removeChildInNodes(e){if(e){if(e.children)for(let i=0;i<e.children.length;i++)this.removeChildInNodes(this.nameTable[e.children[i]]);const t=this.nodes.indexOf(e);-1!==t&&this.nodes.splice(t,1)}}getBlazorDragEventArgs(e){return{source:e.source,element:Lc(e.element)===ol?{connector:e.element}:{node:e.element},cancel:e.cancel,diagramId:this.element.id}}findChild(e,t){let i,n;for(let r=0;r<e.children.length;r++)i=t[e.children[r]],i&&(i.children&&this.findChild(i,t),i.id=i.id+op(),t[i.id]=i,e.children[r]=i.id,n=new Td(this,"nodes",i,!0),this.initObject(n,void 0,void 0,!0))}getChildren(e,t,i){let n;for(let r=0;r<e.children.length;r++)n=i[e.children[r]],n&&(n.children&&(t=this.getChildren(n,t,i)),t[n.id]=dp(n));return t}addChildNodes(e){let t;for(let i=0;i<e.children.length;i++)t=this.nameTable[e.children[i]],t&&(t.children&&this.addChildNodes(t),this.add(t,!0))}moveNode(e){const t=this.commandHandler.getObjectLayer(e.id),i=t.zIndex,n=t.objects.length;let r;for(let s=0;s<this.layers.length;s++)i===this.layers[s].zIndex&&(r=this.layers[s+1]);if(n>1)this.commandHandler.moveSvgNode(e.id,t.objects[n-2]),this.commandHandler.moveSvgNode(t.objects[n-2],e.id);else if(r){const i=this.commandHandler.getLayer(this.layerZIndexTable[r.zIndex]).objects[0];i?(this.commandHandler.moveSvgNode(e.id,i),this.commandHandler.updateNativeNodeIndex(e.id,i)):this.moveObjectsUp(e,t)}else this.moveObjectsUp(e,t)}moveObjectsUp(e,t){let i;for(let n=this.layers.length-1;n>=0;n--)if(i=this.layers[n],t.id!==i.id){const t=this.commandHandler.getLayer(this.layerZIndexTable[i.zIndex]).objects[i.objects.length-1];if(t){this.commandHandler.moveSvgNode(e.id,t),this.commandHandler.moveSvgNode(t,e.id);break}}}insertData(e){return this.crudOperation(e,"create",this.getNewUpdateNodes("New"))}updateData(e){return this.crudOperation(e,"update",this.getNewUpdateNodes("Update"))}removeData(e){return this.crudOperation(e,"destroy",this.getDeletedNodes())}crudOperation(e,t,i){if(e){const i=this.parameterMap(e,!(e instanceof ol));if(i){const n=e instanceof ol?this.dataSourceSettings.connectionDataSource.crudAction[t]:this.dataSourceSettings.crudAction[t];this.raiseAjaxPost(JSON.stringify(i),n)}return i}{const e=i;return this.processCrudCollection(e,this.dataSourceSettings.crudAction[t],this.dataSourceSettings.connectionDataSource.crudAction[t]),e}}processCrudCollection(e,t,i){if(e.nodes){const i=[];let n;for(n=0;n<e.nodes.length;n++)i.push(this.parameterMap(e.nodes[n],!0));i&&i.length>0&&this.raiseAjaxPost(JSON.stringify(i),t)}if(e.connectors){const t=[];let n;for(n=0;n<e.connectors.length;n++)t.push(this.parameterMap(e.connectors[n],!1));t&&t.length>0&&this.raiseAjaxPost(JSON.stringify(t),i)}}parameterMap(e,t){const i={};let n;const r=t?this.dataSourceSettings:this.dataSourceSettings.connectionDataSource;if(r.id&&(i[r.id]=e.id),r.sourcePointX&&r.sourcePointY&&(i[r.sourcePointX]=e.sourcePoint.x,i[r.sourcePointY]=e.sourcePoint.y),r.targetPointX&&r.targetPointY&&(i[r.targetPointX]=e.targetPoint.x,i[r.targetPointY]=e.targetPoint.y),r.sourceID&&(i[r.sourceID]=e.sourceID),r.targetID&&(i[r.targetID]=e.targetID),r.crudAction&&r.crudAction.customFields&&r.crudAction.customFields.length>0)for(n=0;n<r.crudAction.customFields.length;n++)i[r.crudAction.customFields[n]]=e[r.crudAction.customFields[n]];return i}getNewUpdateNodes(e){const t=[],i=[];for(const n in this.nameTable){const r=this.nameTable[n];r.status===e&&(r&&r instanceof ol?(r.status="None",i.push(r)):(r.status="None",t.push(r)))}return{nodes:t,connectors:i}}getDeletedNodes(){const e=[],t=[];let i;for(i=0;i<this.crudDeleteNodes.length;i++){const n=this.crudDeleteNodes[i];n&&n.segments?t.push(n):n&&e.push(n)}return this.crudDeleteNodes=[],{nodes:e,connectors:t}}raiseAjaxPost(e,t){const i=new _(t,"POST",!0,"application/json"),n=JSON.stringify(JSON.parse(e));i.send(n).then(),i.onSuccess=e=>{}}getHiddenItems(e){if(this.contextMenuModule){this.contextMenuModule.hiddenItems=[];for(const t of e.items)if(this.contextMenuModule.ensureItems(t,e.event),t.items&&t.items.length)for(const i of t.items)this.contextMenuModule.ensureItems(i,e.event);return this.contextMenuModule.hiddenItems}return[]}}return Lu([xt("100%")],e.prototype,"width",void 0),Lu([xt("SVG")],e.prototype,"mode",void 0),Lu([xt("100%")],e.prototype,"height",void 0),Lu([St({},Jl)],e.prototype,"contextMenuSettings",void 0),Lu([xt(lo.Default)],e.prototype,"constraints",void 0),Lu([xt(ho.Default)],e.prototype,"tool",void 0),Lu([xt("Top")],e.prototype,"bridgeDirection",void 0),Lu([xt("transparent")],e.prototype,"backgroundColor",void 0),Lu([St({},kp)],e.prototype,"snapSettings",void 0),Lu([St({},Np)],e.prototype,"rulerSettings",void 0),Lu([St({},Dp)],e.prototype,"pageSettings",void 0),Lu([St({},Au)],e.prototype,"serializationSettings",void 0),Lu([Pt([],Td)],e.prototype,"nodes",void 0),Lu([xt()],e.prototype,"drawingObject",void 0),Lu([Pt([],ol)],e.prototype,"connectors",void 0),Lu([xt([])],e.prototype,"basicElements",void 0),Lu([St({},Oa)],e.prototype,"tooltip",void 0),Lu([St({},Vp)],e.prototype,"dataSourceSettings",void 0),Lu([xt()],e.prototype,"addInfo",void 0),Lu([xt()],e.prototype,"historyManager",void 0),Lu([xt()],e.prototype,"nodeTemplate",void 0),Lu([xt()],e.prototype,"annotationTemplate",void 0),Lu([xt()],e.prototype,"userHandleTemplate",void 0),Lu([xt()],e.prototype,"getNodeDefaults",void 0),Lu([xt()],e.prototype,"nodeDefaults",void 0),Lu([xt()],e.prototype,"getConnectorDefaults",void 0),Lu([xt()],e.prototype,"connectorDefaults",void 0),Lu([xt()],e.prototype,"setNodeTemplate",void 0),Lu([xt()],e.prototype,"getDescription",void 0),Lu([xt()],e.prototype,"getCustomProperty",void 0),Lu([xt()],e.prototype,"getCustomTool",void 0),Lu([xt()],e.prototype,"getCustomCursor",void 0),Lu([Pt([],Du)],e.prototype,"customCursor",void 0),Lu([xt()],e.prototype,"updateSelection",void 0),Lu([St({},Ru)],e.prototype,"diagramSettings",void 0),Lu([St({},Ld)],e.prototype,"selectedItems",void 0),Lu([St({},Rp)],e.prototype,"scrollSettings",void 0),Lu([St({},Yp)],e.prototype,"layout",void 0),Lu([St({},Ql)],e.prototype,"commandManager",void 0),Lu([Ot()],e.prototype,"dataLoaded",void 0),Lu([Ot()],e.prototype,"dragEnter",void 0),Lu([Ot()],e.prototype,"dragLeave",void 0),Lu([Ot()],e.prototype,"dragOver",void 0),Lu([Ot()],e.prototype,"click",void 0),Lu([Ot()],e.prototype,"historyChange",void 0),Lu([Ot()],e.prototype,"historyStateChange",void 0),Lu([Ot()],e.prototype,"doubleClick",void 0),Lu([Ot()],e.prototype,"textEdit",void 0),Lu([Ot()],e.prototype,"scrollChange",void 0),Lu([Ot()],e.prototype,"selectionChange",void 0),Lu([Ot()],e.prototype,"sizeChange",void 0),Lu([Ot()],e.prototype,"connectionChange",void 0),Lu([Ot()],e.prototype,"sourcePointChange",void 0),Lu([Ot()],e.prototype,"targetPointChange",void 0),Lu([Ot()],e.prototype,"propertyChange",void 0),Lu([Ot()],e.prototype,"positionChange",void 0),Lu([Ot()],e.prototype,"keyUp",void 0),Lu([Ot()],e.prototype,"keyDown",void 0),Lu([Ot()],e.prototype,"animationComplete",void 0),Lu([Ot()],e.prototype,"rotateChange",void 0),Lu([Ot()],e.prototype,"collectionChange",void 0),Lu([Ot()],e.prototype,"fixedUserHandleClick",void 0),Lu([Ot()],e.prototype,"onUserHandleMouseDown",void 0),Lu([Ot()],e.prototype,"onUserHandleMouseUp",void 0),Lu([Ot()],e.prototype,"onUserHandleMouseEnter",void 0),Lu([Ot()],e.prototype,"onUserHandleMouseLeave",void 0),Lu([Ot()],e.prototype,"segmentCollectionChange",void 0),Lu([Ot()],e.prototype,"onImageLoad",void 0),Lu([Ot()],e.prototype,"expandStateChange",void 0),Lu([Ot()],e.prototype,"created",void 0),Lu([Ot()],e.prototype,"mouseEnter",void 0),Lu([Ot()],e.prototype,"mouseLeave",void 0),Lu([Ot()],e.prototype,"mouseOver",void 0),Lu([Ot()],e.prototype,"contextMenuOpen",void 0),Lu([Ot()],e.prototype,"contextMenuBeforeItemRender",void 0),Lu([Ot()],e.prototype,"contextMenuClick",void 0),Lu([Ot()],e.prototype,"commandExecute",void 0),Lu([Pt([],Su)],e.prototype,"layers",void 0),Lu([Ot()],e.prototype,"drop",void 0),e})();var ku=i("SVse");const ju=["annotationTemplate"],Hu=["nodeTemplate"],Nu=["userHandleTemplate"];let _u=["addInfo","id","lock","objects","visible","zIndex"],Bu=[],Wu=(()=>{class e extends ci{constructor(e){super(),this.viewContainerRef=e,li("currentInstance",this,this.viewContainerRef),this.registerEvents(Bu),this.directivePropList=_u}}return e.\u0275fac=function(t){return new(t||e)(n.Jb(n.R))},e.\u0275dir=n.Eb({type:e,selectors:[["e-layer"]],inputs:{addInfo:"addInfo",id:"id",lock:"lock",objects:"objects",visible:"visible",zIndex:"zIndex"},features:[n.wb]}),e})(),Uu=(()=>{class e extends di{constructor(){super("layers")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=n.Eb({type:e,selectors:[["e-layers"]],contentQueries:function(e,t,i){if(1&e&&n.Cb(i,Wu,0),2&e){let e;n.Xb(e=n.Tb())&&(t.children=e)}},features:[n.wb]}),e})(),Fu=["action","cursor"],Vu=[],Xu=(()=>{class e extends ci{constructor(e){super(),this.viewContainerRef=e,li("currentInstance",this,this.viewContainerRef),this.registerEvents(Vu),this.directivePropList=Fu}}return e.\u0275fac=function(t){return new(t||e)(n.Jb(n.R))},e.\u0275dir=n.Eb({type:e,selectors:[["e-cursormap"]],inputs:{action:"action",cursor:"cursor"},features:[n.wb]}),e})(),Yu=(()=>{class e extends di{constructor(){super("customcursor")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=n.Eb({type:e,selectors:[["e-cursormaps"]],contentQueries:function(e,t,i){if(1&e&&n.Cb(i,Xu,0),2&e){let e;n.Xb(e=n.Tb())&&(t.children=e)}},features:[n.wb]}),e})(),Gu=["alignment","cornerRadius","displacement","fill","handleStrokeColor","handleStrokeWidth","height","iconStrokeColor","iconStrokeWidth","id","offset","padding","pathData","visibility","width"],qu=[],Zu=(()=>{class e extends ci{constructor(e){super(),this.viewContainerRef=e,li("currentInstance",this,this.viewContainerRef),this.registerEvents(qu),this.directivePropList=Gu}}return e.\u0275fac=function(t){return new(t||e)(n.Jb(n.R))},e.\u0275dir=n.Eb({type:e,selectors:[["e-connector-fixeduserhandle"]],inputs:{alignment:"alignment",cornerRadius:"cornerRadius",displacement:"displacement",fill:"fill",handleStrokeColor:"handleStrokeColor",handleStrokeWidth:"handleStrokeWidth",height:"height",iconStrokeColor:"iconStrokeColor",iconStrokeWidth:"iconStrokeWidth",id:"id",offset:"offset",padding:"padding",pathData:"pathData",visibility:"visibility",width:"width"},features:[n.wb]}),e})(),$u=(()=>{class e extends di{constructor(){super("fixeduserhandles")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=n.Eb({type:e,selectors:[["e-connector-fixeduserhandles"]],contentQueries:function(e,t,i){if(1&e&&n.Cb(i,Zu,0),2&e){let e;n.Xb(e=n.Tb())&&(t.children=e)}},features:[n.wb]}),e})(),Qu=["addInfo","alignment","annotationType","constraints","content","displacement","dragLimit","height","horizontalAlignment","hyperlink","id","margin","offset","rotateAngle","segmentAngle","style","template","type","verticalAlignment","visibility","width"],Ju=[],Ku=(()=>{class e extends ci{constructor(e){super(),this.viewContainerRef=e,li("currentInstance",this,this.viewContainerRef),this.registerEvents(Ju),this.directivePropList=Qu}}return e.\u0275fac=function(t){return new(t||e)(n.Jb(n.R))},e.\u0275dir=n.Eb({type:e,selectors:[["e-connector-annotation"]],inputs:{addInfo:"addInfo",alignment:"alignment",annotationType:"annotationType",constraints:"constraints",content:"content",displacement:"displacement",dragLimit:"dragLimit",height:"height",horizontalAlignment:"horizontalAlignment",hyperlink:"hyperlink",id:"id",margin:"margin",offset:"offset",rotateAngle:"rotateAngle",segmentAngle:"segmentAngle",style:"style",template:"template",type:"type",verticalAlignment:"verticalAlignment",visibility:"visibility",width:"width"},features:[n.wb]}),e})(),eg=(()=>{class e extends di{constructor(){super("annotations")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=n.Eb({type:e,selectors:[["e-connector-annotations"]],contentQueries:function(e,t,i){if(1&e&&n.Cb(i,Ku,0),2&e){let e;n.Xb(e=n.Tb())&&(t.children=e)}},features:[n.wb]}),e})(),tg=["addInfo","annotations","bridgeSpace","connectionPadding","constraints","cornerRadius","dragSize","excludeFromLayout","fixedUserHandles","flip","hitPadding","id","margin","previewSize","segments","shape","sourceDecorator","sourceID","sourcePadding","sourcePoint","sourcePortID","style","symbolInfo","targetDecorator","targetID","targetPadding","targetPoint","targetPortID","tooltip","type","visible","wrapper","zIndex"],ig=[],ng=(()=>{class e extends ci{constructor(e){super(),this.viewContainerRef=e,this.tags=["fixedUserHandles","annotations"],li("currentInstance",this,this.viewContainerRef),this.registerEvents(ig),this.directivePropList=tg}}return e.\u0275fac=function(t){return new(t||e)(n.Jb(n.R))},e.\u0275dir=n.Eb({type:e,selectors:[["e-connector"]],contentQueries:function(e,t,i){if(1&e&&(n.Cb(i,$u,1),n.Cb(i,eg,1)),2&e){let e;n.Xb(e=n.Tb())&&(t.childFixedUserHandles=e.first),n.Xb(e=n.Tb())&&(t.childAnnotations=e.first)}},inputs:{addInfo:"addInfo",annotations:"annotations",bridgeSpace:"bridgeSpace",connectionPadding:"connectionPadding",constraints:"constraints",cornerRadius:"cornerRadius",dragSize:"dragSize",excludeFromLayout:"excludeFromLayout",fixedUserHandles:"fixedUserHandles",flip:"flip",hitPadding:"hitPadding",id:"id",margin:"margin",previewSize:"previewSize",segments:"segments",shape:"shape",sourceDecorator:"sourceDecorator",sourceID:"sourceID",sourcePadding:"sourcePadding",sourcePoint:"sourcePoint",sourcePortID:"sourcePortID",style:"style",symbolInfo:"symbolInfo",targetDecorator:"targetDecorator",targetID:"targetID",targetPadding:"targetPadding",targetPoint:"targetPoint",targetPortID:"targetPortID",tooltip:"tooltip",type:"type",visible:"visible",wrapper:"wrapper",zIndex:"zIndex"},features:[n.wb]}),e})(),rg=(()=>{class e extends di{constructor(){super("connectors")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=n.Eb({type:e,selectors:[["e-connectors"]],contentQueries:function(e,t,i){if(1&e&&n.Cb(i,ng,0),2&e){let e;n.Xb(e=n.Tb())&&(t.children=e)}},features:[n.wb]}),e})(),sg=["cornerRadius","fill","handleStrokeColor","handleStrokeWidth","height","iconStrokeColor","iconStrokeWidth","id","margin","offset","padding","pathData","visibility","width"],og=[],ag=(()=>{class e extends ci{constructor(e){super(),this.viewContainerRef=e,li("currentInstance",this,this.viewContainerRef),this.registerEvents(og),this.directivePropList=sg}}return e.\u0275fac=function(t){return new(t||e)(n.Jb(n.R))},e.\u0275dir=n.Eb({type:e,selectors:[["e-node-fixeduserhandle"]],inputs:{cornerRadius:"cornerRadius",fill:"fill",handleStrokeColor:"handleStrokeColor",handleStrokeWidth:"handleStrokeWidth",height:"height",iconStrokeColor:"iconStrokeColor",iconStrokeWidth:"iconStrokeWidth",id:"id",margin:"margin",offset:"offset",padding:"padding",pathData:"pathData",visibility:"visibility",width:"width"},features:[n.wb]}),e})(),lg=(()=>{class e extends di{constructor(){super("fixeduserhandles")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=n.Eb({type:e,selectors:[["e-node-fixeduserhandles"]],contentQueries:function(e,t,i){if(1&e&&n.Cb(i,ag,0),2&e){let e;n.Xb(e=n.Tb())&&(t.children=e)}},features:[n.wb]}),e})(),hg=["addInfo","annotationType","constraints","content","dragLimit","height","horizontalAlignment","hyperlink","id","margin","offset","rotateAngle","style","template","type","verticalAlignment","visibility","width"],cg=[],dg=(()=>{class e extends ci{constructor(e){super(),this.viewContainerRef=e,li("currentInstance",this,this.viewContainerRef),this.registerEvents(cg),this.directivePropList=hg}}return e.\u0275fac=function(t){return new(t||e)(n.Jb(n.R))},e.\u0275dir=n.Eb({type:e,selectors:[["e-node-annotation"]],inputs:{addInfo:"addInfo",annotationType:"annotationType",constraints:"constraints",content:"content",dragLimit:"dragLimit",height:"height",horizontalAlignment:"horizontalAlignment",hyperlink:"hyperlink",id:"id",margin:"margin",offset:"offset",rotateAngle:"rotateAngle",style:"style",template:"template",type:"type",verticalAlignment:"verticalAlignment",visibility:"visibility",width:"width"},features:[n.wb]}),e})(),pg=(()=>{class e extends di{constructor(){super("annotations")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=n.Eb({type:e,selectors:[["e-node-annotations"]],contentQueries:function(e,t,i){if(1&e&&n.Cb(i,dg,0),2&e){let e;n.Xb(e=n.Tb())&&(t.children=e)}},features:[n.wb]}),e})(),ug=["addInfo","constraints","height","horizontalAlignment","id","inEdges","margin","offset","outEdges","pathData","shape","style","verticalAlignment","visibility","width"],gg=[],mg=(()=>{class e extends ci{constructor(e){super(),this.viewContainerRef=e,li("currentInstance",this,this.viewContainerRef),this.registerEvents(gg),this.directivePropList=ug}}return e.\u0275fac=function(t){return new(t||e)(n.Jb(n.R))},e.\u0275dir=n.Eb({type:e,selectors:[["e-node-port"]],inputs:{addInfo:"addInfo",constraints:"constraints",height:"height",horizontalAlignment:"horizontalAlignment",id:"id",inEdges:"inEdges",margin:"margin",offset:"offset",outEdges:"outEdges",pathData:"pathData",shape:"shape",style:"style",verticalAlignment:"verticalAlignment",visibility:"visibility",width:"width"},features:[n.wb]}),e})(),fg=(()=>{class e extends di{constructor(){super("ports")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=n.Eb({type:e,selectors:[["e-node-ports"]],contentQueries:function(e,t,i){if(1&e&&n.Cb(i,mg,0),2&e){let e;n.Xb(e=n.Tb())&&(t.children=e)}},features:[n.wb]}),e})(),yg=["addInfo","annotations","backgroundColor","borderColor","borderWidth","branch","children","collapseIcon","columnIndex","columnSpan","columns","constraints","container","data","dragSize","excludeFromLayout","expandIcon","fixedUserHandles","flip","height","horizontalAlignment","id","isExpanded","layoutInfo","margin","maxHeight","maxWidth","minHeight","minWidth","offsetX","offsetY","pivot","ports","previewSize","rotateAngle","rowIndex","rowSpan","rows","shadow","shape","style","symbolInfo","tooltip","verticalAlignment","visible","width","wrapper","zIndex"],bg=[],vg=(()=>{class e extends ci{constructor(e){super(),this.viewContainerRef=e,this.tags=["fixedUserHandles","annotations","ports"],li("currentInstance",this,this.viewContainerRef),this.registerEvents(bg),this.directivePropList=yg}}return e.\u0275fac=function(t){return new(t||e)(n.Jb(n.R))},e.\u0275dir=n.Eb({type:e,selectors:[["e-node"]],contentQueries:function(e,t,i){if(1&e&&(n.Cb(i,lg,1),n.Cb(i,pg,1),n.Cb(i,fg,1)),2&e){let e;n.Xb(e=n.Tb())&&(t.childFixedUserHandles=e.first),n.Xb(e=n.Tb())&&(t.childAnnotations=e.first),n.Xb(e=n.Tb())&&(t.childPorts=e.first)}},inputs:{addInfo:"addInfo",annotations:"annotations",backgroundColor:"backgroundColor",borderColor:"borderColor",borderWidth:"borderWidth",branch:"branch",children:"children",collapseIcon:"collapseIcon",columnIndex:"columnIndex",columnSpan:"columnSpan",columns:"columns",constraints:"constraints",container:"container",data:"data",dragSize:"dragSize",excludeFromLayout:"excludeFromLayout",expandIcon:"expandIcon",fixedUserHandles:"fixedUserHandles",flip:"flip",height:"height",horizontalAlignment:"horizontalAlignment",id:"id",isExpanded:"isExpanded",layoutInfo:"layoutInfo",margin:"margin",maxHeight:"maxHeight",maxWidth:"maxWidth",minHeight:"minHeight",minWidth:"minWidth",offsetX:"offsetX",offsetY:"offsetY",pivot:"pivot",ports:"ports",previewSize:"previewSize",rotateAngle:"rotateAngle",rowIndex:"rowIndex",rowSpan:"rowSpan",rows:"rows",shadow:"shadow",shape:"shape",style:"style",symbolInfo:"symbolInfo",tooltip:"tooltip",verticalAlignment:"verticalAlignment",visible:"visible",width:"width",wrapper:"wrapper",zIndex:"zIndex"},features:[n.wb]}),e})(),wg=(()=>{class e extends di{constructor(){super("nodes")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=n.Eb({type:e,selectors:[["e-nodes"]],contentQueries:function(e,t,i){if(1&e&&n.Cb(i,vg,0),2&e){let e;n.Xb(e=n.Tb())&&(t.children=e)}},features:[n.wb]}),e})();var xg=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},Sg=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const Cg=["animationComplete","click","collectionChange","commandExecute","connectionChange","contextMenuBeforeItemRender","contextMenuClick","contextMenuOpen","created","dataLoaded","doubleClick","dragEnter","dragLeave","dragOver","drop","expandStateChange","fixedUserHandleClick","historyChange","historyStateChange","keyDown","keyUp","mouseEnter","mouseLeave","mouseOver","onImageLoad","onUserHandleMouseDown","onUserHandleMouseEnter","onUserHandleMouseLeave","onUserHandleMouseUp","positionChange","propertyChange","rotateChange","scrollChange","segmentCollectionChange","selectionChange","sizeChange","sourcePointChange","targetPointChange","textEdit"],Pg=[""];let Og=(()=>{let e=class extends Mu{constructor(e,t,i,n){super(),this.ngEle=e,this.srenderer=t,this.viewContainerRef=i,this.injector=n,this.tags=["layers","customCursor","connectors","nodes"],this.element=this.ngEle.nativeElement,this.injectedModules=this.injectedModules||[];try{let e=this.injector.get("DiagramsHierarchicalTree");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(r){}try{let e=this.injector.get("DiagramsMindMap");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(s){}try{let e=this.injector.get("DiagramsRadialTree");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(o){}try{let e=this.injector.get("DiagramsComplexHierarchicalTree");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(a){}try{let e=this.injector.get("DiagramsDataBinding");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(l){}try{let e=this.injector.get("DiagramsSnapping");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(h){}try{let e=this.injector.get("DiagramsPrintAndExport");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(c){}try{let e=this.injector.get("DiagramsBpmnDiagrams");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(d){}try{let e=this.injector.get("DiagramsSymmetricLayout");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(p){}try{let e=this.injector.get("DiagramsConnectorBridging");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(u){}try{let e=this.injector.get("DiagramsUndoRedo");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(g){}try{let e=this.injector.get("DiagramsLayoutAnimation");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(m){}try{let e=this.injector.get("DiagramsDiagramContextMenu");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(f){}try{let e=this.injector.get("DiagramsLineRouting");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(y){}try{let e=this.injector.get("DiagramsConnectorEditing");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(b){}try{let e=this.injector.get("DiagramsBlazorTooltip");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(v){}try{let e=this.injector.get("DiagramsLineDistribution");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(w){}this.registerEvents(Cg),this.addTwoWay.call(this,Pg),li("currentInstance",this,this.viewContainerRef),this.context=new pi}ngOnInit(){this.context.ngOnInit(this)}ngAfterViewInit(){this.context.ngAfterViewInit(this)}ngOnDestroy(){this.context.ngOnDestroy(this)}ngAfterContentChecked(){this.tagObjects[0].instance=this.childLayers,this.childCustomCursor&&(this.tagObjects[1].instance=this.childCustomCursor),this.childConnectors&&(this.tagObjects[2].instance=this.childConnectors),this.childNodes&&(this.tagObjects[3].instance=this.childNodes),this.context.ngAfterContentChecked(this)}};return e.\u0275fac=function(t){return new(t||e)(n.Jb(n.l),n.Jb(n.F),n.Jb(n.R),n.Jb(n.t))},e.\u0275cmp=n.Db({type:e,selectors:[["ejs-diagram"]],contentQueries:function(e,t,i){if(1&e&&(n.Cb(i,ju,1),n.Cb(i,Hu,1),n.Cb(i,Nu,1),n.Cb(i,Uu,1),n.Cb(i,Yu,1),n.Cb(i,rg,1),n.Cb(i,wg,1)),2&e){let e;n.Xb(e=n.Tb())&&(t.annotationTemplate=e.first),n.Xb(e=n.Tb())&&(t.nodeTemplate=e.first),n.Xb(e=n.Tb())&&(t.userHandleTemplate=e.first),n.Xb(e=n.Tb())&&(t.childLayers=e.first),n.Xb(e=n.Tb())&&(t.childCustomCursor=e.first),n.Xb(e=n.Tb())&&(t.childConnectors=e.first),n.Xb(e=n.Tb())&&(t.childNodes=e.first)}},inputs:{addInfo:"addInfo",annotationTemplate:"annotationTemplate",backgroundColor:"backgroundColor",bridgeDirection:"bridgeDirection",commandManager:"commandManager",connectorDefaults:"connectorDefaults",connectors:"connectors",constraints:"constraints",contextMenuSettings:"contextMenuSettings",customCursor:"customCursor",dataSourceSettings:"dataSourceSettings",diagramSettings:"diagramSettings",drawingObject:"drawingObject",enablePersistence:"enablePersistence",enableRtl:"enableRtl",getConnectorDefaults:"getConnectorDefaults",getCustomCursor:"getCustomCursor",getCustomProperty:"getCustomProperty",getCustomTool:"getCustomTool",getDescription:"getDescription",getNodeDefaults:"getNodeDefaults",height:"height",historyManager:"historyManager",layers:"layers",layout:"layout",locale:"locale",mode:"mode",nodeDefaults:"nodeDefaults",nodeTemplate:"nodeTemplate",nodes:"nodes",pageSettings:"pageSettings",rulerSettings:"rulerSettings",scrollSettings:"scrollSettings",selectedItems:"selectedItems",serializationSettings:"serializationSettings",setNodeTemplate:"setNodeTemplate",snapSettings:"snapSettings",tool:"tool",tooltip:"tooltip",updateSelection:"updateSelection",userHandleTemplate:"userHandleTemplate",width:"width"},outputs:{animationComplete:"animationComplete",click:"click",collectionChange:"collectionChange",commandExecute:"commandExecute",connectionChange:"connectionChange",contextMenuBeforeItemRender:"contextMenuBeforeItemRender",contextMenuClick:"contextMenuClick",contextMenuOpen:"contextMenuOpen",created:"created",dataLoaded:"dataLoaded",doubleClick:"doubleClick",dragEnter:"dragEnter",dragLeave:"dragLeave",dragOver:"dragOver",drop:"drop",expandStateChange:"expandStateChange",fixedUserHandleClick:"fixedUserHandleClick",historyChange:"historyChange",historyStateChange:"historyStateChange",keyDown:"keyDown",keyUp:"keyUp",mouseEnter:"mouseEnter",mouseLeave:"mouseLeave",mouseOver:"mouseOver",onImageLoad:"onImageLoad",onUserHandleMouseDown:"onUserHandleMouseDown",onUserHandleMouseEnter:"onUserHandleMouseEnter",onUserHandleMouseLeave:"onUserHandleMouseLeave",onUserHandleMouseUp:"onUserHandleMouseUp",positionChange:"positionChange",propertyChange:"propertyChange",rotateChange:"rotateChange",scrollChange:"scrollChange",segmentCollectionChange:"segmentCollectionChange",selectionChange:"selectionChange",sizeChange:"sizeChange",sourcePointChange:"sourcePointChange",targetPointChange:"targetPointChange",textEdit:"textEdit"},features:[n.wb],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0}),xg([gi(),Sg("design:type",Object)],e.prototype,"annotationTemplate",void 0),xg([gi(),Sg("design:type",Object)],e.prototype,"nodeTemplate",void 0),xg([gi(),Sg("design:type",Object)],e.prototype,"userHandleTemplate",void 0),e=xg([(t=[pi],function(e){!function(e,t){t.forEach(function(t){Object.getOwnPropertyNames(t.prototype).forEach(function(i){e.prototype.hasOwnProperty(i)&&!t.isFormBase||(e.prototype[i]=t.prototype[i])})})}(e,t)}),Sg("design:paramtypes",[n.l,n.F,n.R,n.t])],e),e;var t})(),Tg=(()=>{class e{}return e.\u0275mod=n.Hb({type:e}),e.\u0275inj=n.Gb({factory:function(t){return new(t||e)},imports:[[ku.b]]}),e})()},0:function(e,t,i){e.exports=i("zUnb")},"2QA8":function(e,t,i){"use strict";i.d(t,"a",function(){return n});const n=(()=>"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random())()},"2fFW":function(e,t,i){"use strict";i.d(t,"a",function(){return r});let n=!1;const r={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){const e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else n&&console.log("RxJS: Back to a better error behavior. Thank you. <3");n=e},get useDeprecatedSynchronousErrorHandling(){return n}}},"5+tZ":function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i("lJxs"),r=i("Cfvw"),s=i("zx2A");function o(e,t,i=Number.POSITIVE_INFINITY){return"function"==typeof t?s=>s.pipe(o((i,s)=>Object(r.a)(e(i,s)).pipe(Object(n.a)((e,n)=>t(i,e,s,n))),i)):("number"==typeof t&&(i=t),t=>t.lift(new a(e,i)))}class a{constructor(e,t=Number.POSITIVE_INFINITY){this.project=e,this.concurrent=t}call(e,t){return t.subscribe(new l(e,this.project,this.concurrent))}}class l extends s.b{constructor(e,t,i=Number.POSITIVE_INFINITY){super(e),this.project=t,this.concurrent=i,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}_tryNext(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(n){return void this.destination.error(n)}this.active++,this._innerSub(t)}_innerSub(e){const t=new s.a(this),i=this.destination;i.add(t);const n=Object(s.c)(e,t);n!==t&&i.add(n)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyComplete(){const e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}},"7o/Q":function(e,t,i){"use strict";i.d(t,"a",function(){return h});var n=i("n6bG"),r=i("gRHU"),s=i("quSY"),o=i("2QA8"),a=i("2fFW"),l=i("NJ4a");class h extends s.a{constructor(e,t,i){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=r.a;break;case 1:if(!e){this.destination=r.a;break}if("object"==typeof e){e instanceof h?(this.syncErrorThrowable=e.syncErrorThrowable,this.destination=e,e.add(this)):(this.syncErrorThrowable=!0,this.destination=new c(this,e));break}default:this.syncErrorThrowable=!0,this.destination=new c(this,e,t,i)}}[o.a](){return this}static create(e,t,i){const n=new h(e,t,i);return n.syncErrorThrowable=!1,n}next(e){this.isStopped||this._next(e)}error(e){this.isStopped||(this.isStopped=!0,this._error(e))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(e){this.destination.next(e)}_error(e){this.destination.error(e),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:e}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}class c extends h{constructor(e,t,i,s){let o;super(),this._parentSubscriber=e;let a=this;Object(n.a)(t)?o=t:t&&(o=t.next,i=t.error,s=t.complete,t!==r.a&&(a=Object.create(t),Object(n.a)(a.unsubscribe)&&this.add(a.unsubscribe.bind(a)),a.unsubscribe=this.unsubscribe.bind(this))),this._context=a,this._next=o,this._error=i,this._complete=s}next(e){if(!this.isStopped&&this._next){const{_parentSubscriber:t}=this;a.a.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}error(e){if(!this.isStopped){const{_parentSubscriber:t}=this,{useDeprecatedSynchronousErrorHandling:i}=a.a;if(this._error)i&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)i?(t.syncErrorValue=e,t.syncErrorThrown=!0):Object(l.a)(e),this.unsubscribe();else{if(this.unsubscribe(),i)throw e;Object(l.a)(e)}}}complete(){if(!this.isStopped){const{_parentSubscriber:e}=this;if(this._complete){const t=()=>this._complete.call(this._context);a.a.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,t),this.unsubscribe()):(this.__tryOrUnsub(t),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(e,t){try{e.call(this._context,t)}catch(i){if(this.unsubscribe(),a.a.useDeprecatedSynchronousErrorHandling)throw i;Object(l.a)(i)}}__tryOrSetError(e,t,i){if(!a.a.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,i)}catch(n){return a.a.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=n,e.syncErrorThrown=!0,!0):(Object(l.a)(n),!0)}return!1}_unsubscribe(){const{_parentSubscriber:e}=this;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}},"8Y7J":function(e,t,i){"use strict";i.d(t,"a",function(){return li}),i.d(t,"b",function(){return pl}),i.d(t,"c",function(){return al}),i.d(t,"d",function(){return sl}),i.d(t,"e",function(){return ol}),i.d(t,"f",function(){return sh}),i.d(t,"g",function(){return Zl}),i.d(t,"h",function(){return da}),i.d(t,"i",function(){return Cl}),i.d(t,"j",function(){return ko}),i.d(t,"k",function(){return ml}),i.d(t,"l",function(){return _o}),i.d(t,"m",function(){return Cn}),i.d(t,"n",function(){return _a}),i.d(t,"o",function(){return Ri}),i.d(t,"p",function(){return ls}),i.d(t,"q",function(){return Ai}),i.d(t,"r",function(){return M}),i.d(t,"s",function(){return ai}),i.d(t,"t",function(){return Ps}),i.d(t,"u",function(){return ra}),i.d(t,"v",function(){return oa}),i.d(t,"w",function(){return gl}),i.d(t,"x",function(){return Sa}),i.d(t,"y",function(){return Ql}),i.d(t,"z",function(){return xa}),i.d(t,"A",function(){return Vl}),i.d(t,"B",function(){return Tl}),i.d(t,"C",function(){return Ii}),i.d(t,"D",function(){return dl}),i.d(t,"E",function(){return cl}),i.d(t,"F",function(){return Uo}),i.d(t,"G",function(){return Wo}),i.d(t,"H",function(){return En}),i.d(t,"I",function(){return Vo}),i.d(t,"J",function(){return bn}),i.d(t,"K",function(){return Di}),i.d(t,"L",function(){return eh}),i.d(t,"M",function(){return ya}),i.d(t,"N",function(){return zl}),i.d(t,"O",function(){return hi}),i.d(t,"P",function(){return Yo}),i.d(t,"Q",function(){return Xo}),i.d(t,"R",function(){return Pa}),i.d(t,"S",function(){return B}),i.d(t,"T",function(){return Xl}),i.d(t,"U",function(){return Ul}),i.d(t,"V",function(){return nh}),i.d(t,"W",function(){return jl}),i.d(t,"X",function(){return ul}),i.d(t,"Y",function(){return cs}),i.d(t,"Z",function(){return xo}),i.d(t,"ab",function(){return fn}),i.d(t,"bb",function(){return Ji}),i.d(t,"cb",function(){return Wi}),i.d(t,"db",function(){return Fi}),i.d(t,"eb",function(){return Gi}),i.d(t,"fb",function(){return Xi}),i.d(t,"gb",function(){return Vi}),i.d(t,"hb",function(){return Yi}),i.d(t,"ib",function(){return yo}),i.d(t,"jb",function(){return ih}),i.d(t,"kb",function(){return bo}),i.d(t,"lb",function(){return vo}),i.d(t,"mb",function(){return Ui}),i.d(t,"nb",function(){return X}),i.d(t,"ob",function(){return zs}),i.d(t,"pb",function(){return Ys}),i.d(t,"qb",function(){return Vs}),i.d(t,"rb",function(){return Xs}),i.d(t,"sb",function(){return fo}),i.d(t,"tb",function(){return ze}),i.d(t,"ub",function(){return v}),i.d(t,"vb",function(){return Bi}),i.d(t,"wb",function(){return Ts}),i.d(t,"xb",function(){return Ee}),i.d(t,"yb",function(){return Lo}),i.d(t,"zb",function(){return ur}),i.d(t,"Ab",function(){return js}),i.d(t,"Bb",function(){return io}),i.d(t,"Cb",function(){return Ka}),i.d(t,"Db",function(){return ie}),i.d(t,"Eb",function(){return he}),i.d(t,"Fb",function(){return O}),i.d(t,"Gb",function(){return T}),i.d(t,"Hb",function(){return oe}),i.d(t,"Ib",function(){return ce}),i.d(t,"Jb",function(){return Ns}),i.d(t,"Kb",function(){return Fs}),i.d(t,"Lb",function(){return Us}),i.d(t,"Mb",function(){return Ws}),i.d(t,"Nb",function(){return ni}),i.d(t,"Ob",function(){return po}),i.d(t,"Pb",function(){return Oi}),i.d(t,"Qb",function(){return ri}),i.d(t,"Rb",function(){return rl}),i.d(t,"Sb",function(){return Gs}),i.d(t,"Tb",function(){return el}),i.d(t,"Ub",function(){return Js}),i.d(t,"Vb",function(){return Qs}),i.d(t,"Wb",function(){return _s}),i.d(t,"Xb",function(){return Qa}),i.d(t,"Yb",function(){return vn}),i.d(t,"Zb",function(){return ae}),i.d(t,"ac",function(){return Hs}),i.d(t,"bc",function(){return ao}),i.d(t,"cc",function(){return lo}),i.d(t,"dc",function(){return co}),i.d(t,"ec",function(){return Ja});var n=i("XNiG"),r=i("quSY"),s=i("HDdC"),o=i("z+Ro"),a=i("bHdf"),l=i("yCtX"),h=i("7o/Q");function c(){return function(e){return e.lift(new d(e))}}class d{constructor(e){this.connectable=e}call(e,t){const{connectable:i}=this;i._refCount++;const n=new p(e,i),r=t.subscribe(n);return n.closed||(n.connection=i.connect()),r}}class p extends h.a{constructor(e,t){super(e),this.connectable=t}_unsubscribe(){const{connectable:e}=this;if(!e)return void(this.connection=null);this.connectable=null;const t=e._refCount;if(t<=0)return void(this.connection=null);if(e._refCount=t-1,t>1)return void(this.connection=null);const{connection:i}=this,n=e._connection;this.connection=null,!n||i&&n!==i||n.unsubscribe()}}class u extends s.a{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._refCount=0,this._isComplete=!1}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let e=this._connection;return e||(this._isComplete=!1,e=this._connection=new r.a,e.add(this.source.subscribe(new m(this.getSubject(),this))),e.closed&&(this._connection=null,e=r.a.EMPTY)),e}refCount(){return c()(this)}}const g=(()=>{const e=u.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:e._subscribe},_isComplete:{value:e._isComplete,writable:!0},getSubject:{value:e.getSubject},connect:{value:e.connect},refCount:{value:e.refCount}}})();class m extends n.b{constructor(e,t){super(e),this.connectable=t}_error(e){this._unsubscribe(),super._error(e)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const e=this.connectable;if(e){this.connectable=null;const t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}function f(){return new n.a}function y(e){for(let t in e)if(e[t]===y)return t;throw Error("Could not find renamed property on target object.")}function b(e,t){for(const i in t)t.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(e[i]=t[i])}function v(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(v).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const t=e.toString();if(null==t)return""+t;const i=t.indexOf("\n");return-1===i?t:t.substring(0,i)}function w(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}const x=y({__forward_ref__:y});function S(e){return e.__forward_ref__=S,e.toString=function(){return v(this())},e}function C(e){return P(e)?e():e}function P(e){return"function"==typeof e&&e.hasOwnProperty(x)&&e.__forward_ref__===S}function O(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function T(e){return{factory:e.factory,providers:e.providers||[],imports:e.imports||[]}}function E(e){return A(e,D)||A(e,L)}function A(e,t){return e.hasOwnProperty(t)?e[t]:null}function I(e){return e&&(e.hasOwnProperty(R)||e.hasOwnProperty(z))?e[R]:null}const D=y({"\u0275prov":y}),R=y({"\u0275inj":y}),L=y({ngInjectableDef:y}),z=y({ngInjectorDef:y});var M=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}({});let k;function j(e){const t=k;return k=e,t}function H(e,t,i){const n=E(e);if(n&&"root"==n.providedIn)return void 0===n.value?n.value=n.factory():n.value;if(i&M.Optional)return null;if(void 0!==t)return t;throw new Error(`Injector: NOT_FOUND [${v(e)}]`)}function N(e){return{toString:e}.toString()}var _=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}({}),B=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}({});const W="undefined"!=typeof globalThis&&globalThis,U="undefined"!=typeof window&&window,F="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,V="undefined"!=typeof global&&global,X=W||V||U||F,Y={},G=[],q=y({"\u0275cmp":y}),Z=y({"\u0275dir":y}),$=y({"\u0275pipe":y}),Q=y({"\u0275mod":y}),J=y({"\u0275loc":y}),K=y({"\u0275fac":y}),ee=y({__NG_ELEMENT_ID__:y});let te=0;function ie(e){return N(()=>{const t={},i={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===_.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||G,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||B.Emulated,id:"c",styles:e.styles||G,_:null,setInput:null,schemas:e.schemas||null,tView:null},n=e.directives,r=e.features,s=e.pipes;return i.id+=te++,i.inputs=le(e.inputs,t),i.outputs=le(e.outputs),r&&r.forEach(e=>e(i)),i.directiveDefs=n?()=>("function"==typeof n?n():n).map(ne):null,i.pipeDefs=s?()=>("function"==typeof s?s():s).map(re):null,i})}function ne(e){return de(e)||function(e){return e[Z]||null}(e)}function re(e){return function(e){return e[$]||null}(e)}const se={};function oe(e){const t={type:e.type,bootstrap:e.bootstrap||G,declarations:e.declarations||G,imports:e.imports||G,exports:e.exports||G,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&N(()=>{se[e.id]=e.type}),t}function ae(e,t){return N(()=>{const i=pe(e,!0);i.declarations=t.declarations||G,i.imports=t.imports||G,i.exports=t.exports||G})}function le(e,t){if(null==e)return Y;const i={};for(const n in e)if(e.hasOwnProperty(n)){let r=e[n],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),i[r]=n,t&&(t[r]=s)}return i}const he=ie;function ce(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,onDestroy:e.type.prototype.ngOnDestroy||null}}function de(e){return e[q]||null}function pe(e,t){const i=e[Q]||null;if(!i&&!0===t)throw new Error(`Type ${v(e)} does not have '\u0275mod' property.`);return i}const ue=20,ge=10;function me(e){return Array.isArray(e)&&"object"==typeof e[1]}function fe(e){return Array.isArray(e)&&!0===e[1]}function ye(e){return 0!=(8&e.flags)}function be(e){return 2==(2&e.flags)}function ve(e){return 1==(1&e.flags)}function we(e){return null!==e.template}function xe(e,t){return e.hasOwnProperty(K)?e[K]:null}class Se extends Error{constructor(e,t){super(function(e,t){return`${e?`NG0${e}: `:""}${t}`}(e,t)),this.code=e}}function Ce(e){return"string"==typeof e?e:null==e?"":String(e)}function Pe(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():Ce(e)}function Oe(e,t){const i=t?` in ${t}`:"";throw new Se("201",`No provider for ${Pe(e)} found${i}`)}class Te{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function Ee(){return Ae}function Ae(e){return e.type.prototype.ngOnChanges&&(e.setInput=De),Ie}function Ie(){const e=Re(this),t=null==e?void 0:e.current;if(t){const i=e.previous;if(i===Y)e.previous=t;else for(let e in t)i[e]=t[e];e.current=null,this.ngOnChanges(t)}}function De(e,t,i,n){const r=Re(e)||function(e,t){return e.__ngSimpleChanges__=t}(e,{previous:Y,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[i],l=o[a];s[a]=new Te(l&&l.currentValue,t,o===Y),e[n]=t}function Re(e){return e.__ngSimpleChanges__||null}let Le;function ze(e){Le=e}function Me(e){return!!e.listen}Ee.ngInherit=!0;const ke={createRenderer:(e,t)=>void 0!==Le?Le:"undefined"!=typeof document?document:void 0};function je(e){for(;Array.isArray(e);)e=e[0];return e}function He(e,t){return je(t[e])}function Ne(e,t){return je(t[e.index])}function _e(e,t){return e.data[t]}function Be(e,t){const i=t[e];return me(i)?i:i[0]}function We(e){const t=function(e){return e.__ngContext__||null}(e);return t?Array.isArray(t)?t:t.lView:null}function Ue(e){return 4==(4&e[2])}function Fe(e){return 128==(128&e[2])}function Ve(e,t){return null==t?null:e[t]}function Xe(e){e[18]=0}function Ye(e,t){e[5]+=t;let i=e,n=e[3];for(;null!==n&&(1===t&&1===i[5]||-1===t&&0===i[5]);)n[5]+=t,i=n,n=n[3]}const Ge={lFrame:gt(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function qe(){return Ge.bindingsEnabled}function Ze(){return Ge.lFrame.lView}function $e(){return Ge.lFrame.tView}function Qe(){let e=Je();for(;null!==e&&64===e.type;)e=e.parent;return e}function Je(){return Ge.lFrame.currentTNode}function Ke(e,t){const i=Ge.lFrame;i.currentTNode=e,i.isParent=t}function et(){return Ge.lFrame.isParent}function tt(){Ge.lFrame.isParent=!1}function it(){return Ge.isInCheckNoChangesMode}function nt(e){Ge.isInCheckNoChangesMode=e}function rt(){return Ge.lFrame.bindingIndex++}function st(e){const t=Ge.lFrame,i=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,i}function ot(e,t){const i=Ge.lFrame;i.bindingIndex=i.bindingRootIndex=e,at(t)}function at(e){Ge.lFrame.currentDirectiveIndex=e}function lt(){return Ge.lFrame.currentQueryIndex}function ht(e){Ge.lFrame.currentQueryIndex=e}function ct(e){const t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function dt(e,t,i){if(i&M.SkipSelf){let n=t,r=e;for(;n=n.parent,!(null!==n||i&M.Host||(n=ct(r),null===n)||(r=r[15],10&n.type)););if(null===n)return!1;t=n,e=r}const n=Ge.lFrame=ut();return n.currentTNode=t,n.lView=e,!0}function pt(e){const t=ut(),i=e[1];Ge.lFrame=t,t.currentTNode=i.firstChild,t.lView=e,t.tView=i,t.contextLView=e,t.bindingIndex=i.bindingStartIndex,t.inI18n=!1}function ut(){const e=Ge.lFrame,t=null===e?null:e.child;return null===t?gt(e):t}function gt(e){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function mt(){const e=Ge.lFrame;return Ge.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const ft=mt;function yt(){const e=mt();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function bt(){return Ge.lFrame.selectedIndex}function vt(e){Ge.lFrame.selectedIndex=e}function wt(){const e=Ge.lFrame;return _e(e.tView,e.selectedIndex)}function xt(e,t){for(let i=t.directiveStart,n=t.directiveEnd;i<n;i++){const t=e.data[i].type.prototype,{ngAfterContentInit:n,ngAfterContentChecked:r,ngAfterViewInit:s,ngAfterViewChecked:o,ngOnDestroy:a}=t;n&&(e.contentHooks||(e.contentHooks=[])).push(-i,n),r&&((e.contentHooks||(e.contentHooks=[])).push(i,r),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(i,r)),s&&(e.viewHooks||(e.viewHooks=[])).push(-i,s),o&&((e.viewHooks||(e.viewHooks=[])).push(i,o),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(i,o)),null!=a&&(e.destroyHooks||(e.destroyHooks=[])).push(i,a)}}function St(e,t,i){Ot(e,t,3,i)}function Ct(e,t,i,n){(3&e[2])===i&&Ot(e,t,i,n)}function Pt(e,t){let i=e[2];(3&i)===t&&(i&=2047,i+=1,e[2]=i)}function Ot(e,t,i,n){const r=null!=n?n:-1,s=t.length-1;let o=0;for(let a=void 0!==n?65535&e[18]:0;a<s;a++)if("number"==typeof t[a+1]){if(o=t[a],null!=n&&o>=n)break}else t[a]<0&&(e[18]+=65536),(o<r||-1==r)&&(Tt(e,i,t,a),e[18]=(4294901760&e[18])+a+2),a++}function Tt(e,t,i,n){const r=i[n]<0,s=i[n+1],o=e[r?-i[n]:i[n]];r?e[2]>>11<e[18]>>16&&(3&e[2])===t&&(e[2]+=2048,s.call(o)):s.call(o)}const Et=-1;class At{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function It(e,t,i){const n=Me(e);let r=0;for(;r<i.length;){const s=i[r];if("number"==typeof s){if(0!==s)break;r++;const o=i[r++],a=i[r++],l=i[r++];n?e.setAttribute(t,a,l,o):t.setAttributeNS(o,a,l)}else{const o=s,a=i[++r];Rt(o)?n&&e.setProperty(t,o,a):n?e.setAttribute(t,o,a):t.setAttribute(o,a),r++}}return r}function Dt(e){return 3===e||4===e||6===e}function Rt(e){return 64===e.charCodeAt(0)}function Lt(e,t){if(null===t||0===t.length);else if(null===e||0===e.length)e=t.slice();else{let i=-1;for(let n=0;n<t.length;n++){const r=t[n];"number"==typeof r?i=r:0===i||zt(e,i,r,null,-1===i||2===i?t[++n]:null)}}return e}function zt(e,t,i,n,r){let s=0,o=e.length;if(-1===t)o=-1;else for(;s<e.length;){const i=e[s++];if("number"==typeof i){if(i===t){o=-1;break}if(i>t){o=s-1;break}}}for(;s<e.length;){const t=e[s];if("number"==typeof t)break;if(t===i){if(null===n)return void(null!==r&&(e[s+1]=r));if(n===e[s+1])return void(e[s+2]=r)}s++,null!==n&&s++,null!==r&&s++}-1!==o&&(e.splice(o,0,t),s=o+1),e.splice(s++,0,i),null!==n&&e.splice(s++,0,n),null!==r&&e.splice(s++,0,r)}function Mt(e){return e!==Et}function kt(e){return 32767&e}function jt(e,t){let i=e>>16,n=t;for(;i>0;)n=n[15],i--;return n}let Ht=!0;function Nt(e){const t=Ht;return Ht=e,t}let _t=0;function Bt(e,t){const i=Ut(e,t);if(-1!==i)return i;const n=t[1];n.firstCreatePass&&(e.injectorIndex=t.length,Wt(n.data,e),Wt(t,null),Wt(n.blueprint,null));const r=Ft(e,t),s=e.injectorIndex;if(Mt(r)){const e=kt(r),i=jt(r,t),n=i[1].data;for(let r=0;r<8;r++)t[s+r]=i[e+r]|n[e+r]}return t[s+8]=r,s}function Wt(e,t){e.push(0,0,0,0,0,0,0,0,t)}function Ut(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function Ft(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let i=0,n=null,r=t;for(;null!==r;){const e=r[1],t=e.type;if(n=2===t?e.declTNode:1===t?r[6]:null,null===n)return Et;if(i++,r=r[15],-1!==n.injectorIndex)return n.injectorIndex|i<<16}return Et}function Vt(e,t,i){!function(e,t,i){let n;"string"==typeof i?n=i.charCodeAt(0)||0:i.hasOwnProperty(ee)&&(n=i[ee]),null==n&&(n=i[ee]=_t++);const r=255&n;t.data[e+(r>>5)]|=1<<r}(e,t,i)}function Xt(e,t,i){if(i&M.Optional)return e;Oe(t,"NodeInjector")}function Yt(e,t,i,n){if(i&M.Optional&&void 0===n&&(n=null),0==(i&(M.Self|M.Host))){const r=e[9],s=j(void 0);try{return r?r.get(t,n,i&M.Optional):H(t,n,i&M.Optional)}finally{j(s)}}return Xt(n,t,i)}function Gt(e,t,i,n=M.Default,r){if(null!==e){const s=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;const t=e.hasOwnProperty(ee)?e[ee]:void 0;return"number"==typeof t?t>=0?255&t:Zt:t}(i);if("function"==typeof s){if(!dt(t,e,n))return n&M.Host?Xt(r,i,n):Yt(t,i,n,r);try{const e=s();if(null!=e||n&M.Optional)return e;Oe(i)}finally{ft()}}else if("number"==typeof s){let r=null,o=Ut(e,t),a=Et,l=n&M.Host?t[16][6]:null;for((-1===o||n&M.SkipSelf)&&(a=-1===o?Ft(e,t):t[o+8],a!==Et&&ei(n,!1)?(r=t[1],o=kt(a),t=jt(a,t)):o=-1);-1!==o;){const e=t[1];if(Kt(s,o,e.data)){const e=$t(o,t,i,r,n,l);if(e!==qt)return e}a=t[o+8],a!==Et&&ei(n,t[1].data[o+8]===l)&&Kt(s,o,t)?(r=e,o=kt(a),t=jt(a,t)):o=-1}}}return Yt(t,i,n,r)}const qt={};function Zt(){return new ti(Qe(),Ze())}function $t(e,t,i,n,r,s){const o=t[1],a=o.data[e+8],l=Qt(a,o,i,null==n?be(a)&&Ht:n!=o&&0!=(3&a.type),r&M.Host&&s===a);return null!==l?Jt(t,o,l,a):qt}function Qt(e,t,i,n,r){const s=e.providerIndexes,o=t.data,a=1048575&s,l=e.directiveStart,h=s>>20,c=r?a+h:e.directiveEnd;for(let d=n?a:a+h;d<c;d++){const e=o[d];if(d<l&&i===e||d>=l&&e.type===i)return d}if(r){const e=o[l];if(e&&we(e)&&e.type===i)return l}return null}function Jt(e,t,i,n){let r=e[i];const s=t.data;if(r instanceof At){const o=r;o.resolving&&function(e,t){throw new Se("200",`Circular dependency in DI detected for ${e}`)}(Pe(s[i]));const a=Nt(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?j(o.injectImpl):null;dt(e,n,M.Default);try{r=e[i]=o.factory(void 0,s,e,n),t.firstCreatePass&&i>=n.directiveStart&&function(e,t,i){const{ngOnChanges:n,ngOnInit:r,ngDoCheck:s}=t.type.prototype;if(n){const n=Ae(t);(i.preOrderHooks||(i.preOrderHooks=[])).push(e,n),(i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(e,n)}r&&(i.preOrderHooks||(i.preOrderHooks=[])).push(0-e,r),s&&((i.preOrderHooks||(i.preOrderHooks=[])).push(e,s),(i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(e,s))}(i,s[i],t)}finally{null!==l&&j(l),Nt(a),o.resolving=!1,ft()}}return r}function Kt(e,t,i){return!!(i[t+(e>>5)]&1<<e)}function ei(e,t){return!(e&M.Self||e&M.Host&&t)}class ti{constructor(e,t){this._tNode=e,this._lView=t}get(e,t){return Gt(this._tNode,this._lView,e,void 0,t)}}function ii(e){const t=e;if(P(e))return()=>{const e=ii(C(t));return e?e():null};let i=xe(t);if(null===i){const e=I(t);i=e&&e.factory}return i||null}function ni(e){return N(()=>{const t=e.prototype.constructor,i=t[K]||ii(t),n=Object.prototype;let r=Object.getPrototypeOf(e.prototype).constructor;for(;r&&r!==n;){const e=r[K]||ii(r);if(e&&e!==i)return e;r=Object.getPrototypeOf(r)}return e=>new e})}function ri(e){return function(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;const i=e.attrs;if(i){const e=i.length;let n=0;for(;n<e;){const r=i[n];if(Dt(r))break;if(0===r)n+=2;else if("number"==typeof r)for(n++;n<e&&"string"==typeof i[n];)n++;else{if(r===t)return i[n+1];n+=2}}}return null}(Qe(),e)}const si="__parameters__";function oi(e,t,i){return N(()=>{const n=function(e){return function(...t){if(e){const i=e(...t);for(const e in i)this[e]=i[e]}}}(t);function r(...e){if(this instanceof r)return n.apply(this,e),this;const t=new r(...e);return i.annotation=t,i;function i(e,i,n){const r=e.hasOwnProperty(si)?e[si]:Object.defineProperty(e,si,{value:[]})[si];for(;r.length<=n;)r.push(null);return(r[n]=r[n]||[]).push(t),e}}return i&&(r.prototype=Object.create(i.prototype)),r.prototype.ngMetadataName=e,r.annotationCls=r,r})}class ai{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=O({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}const li=new ai("AnalyzeForEntryComponents"),hi=Function;function ci(e,t){void 0===t&&(t=e);for(let i=0;i<e.length;i++){let n=e[i];Array.isArray(n)?(t===e&&(t=e.slice(0,i)),ci(n,t)):t!==e&&t.push(n)}return t}function di(e,t){e.forEach(e=>Array.isArray(e)?di(e,t):t(e))}function pi(e,t,i){t>=e.length?e.push(i):e.splice(t,0,i)}function ui(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function gi(e,t){const i=[];for(let n=0;n<e;n++)i.push(t);return i}function mi(e,t,i){let n=yi(e,t);return n>=0?e[1|n]=i:(n=~n,function(e,t,i,n){let r=e.length;if(r==t)e.push(i,n);else if(1===r)e.push(n,e[0]),e[0]=i;else{for(r--,e.push(e[r-1],e[r]);r>t;)e[r]=e[r-2],r--;e[t]=i,e[t+1]=n}}(e,n,t,i)),n}function fi(e,t){const i=yi(e,t);if(i>=0)return e[1|i]}function yi(e,t){return function(e,t,i){let n=0,r=e.length>>1;for(;r!==n;){const i=n+(r-n>>1),s=e[i<<1];if(t===s)return i<<1;s>t?r=i:n=i+1}return~(r<<1)}(e,t)}const bi={},vi=/\n/gm,wi="__source",xi=y({provide:String,useValue:y});let Si;function Ci(e){const t=Si;return Si=e,t}function Pi(e,t=M.Default){if(void 0===Si)throw new Error("inject() must be called from an injection context");return null===Si?H(e,void 0,t):Si.get(e,t&M.Optional?null:void 0,t)}function Oi(e,t=M.Default){return(k||Pi)(C(e),t)}function Ti(e){const t=[];for(let i=0;i<e.length;i++){const n=C(e[i]);if(Array.isArray(n)){if(0===n.length)throw new Error("Arguments array must have arguments.");let e,i=M.Default;for(let t=0;t<n.length;t++){const r=n[t],s=r.__NG_DI_FLAG__;"number"==typeof s?-1===s?e=r.token:i|=s:e=r}t.push(Oi(e,i))}else t.push(Oi(n))}return t}function Ei(e,t){return e.__NG_DI_FLAG__=t,e.prototype.__NG_DI_FLAG__=t,e}const Ai=Ei(oi("Inject",e=>({token:e})),-1),Ii=Ei(oi("Optional"),8),Di=Ei(oi("SkipSelf"),4),Ri=Ei(oi("Host"),1);let Li;function zi(e){var t;return(null===(t=function(){if(void 0===Li&&(Li=null,X.trustedTypes))try{Li=X.trustedTypes.createPolicy("angular",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch(t){}return Li}())||void 0===t?void 0:t.createHTML(e))||e}class Mi{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class ki extends Mi{getTypeName(){return"HTML"}}class ji extends Mi{getTypeName(){return"Style"}}class Hi extends Mi{getTypeName(){return"Script"}}class Ni extends Mi{getTypeName(){return"URL"}}class _i extends Mi{getTypeName(){return"ResourceURL"}}function Bi(e){return e instanceof Mi?e.changingThisBreaksApplicationSecurity:e}function Wi(e,t){const i=Ui(e);if(null!=i&&i!==t){if("ResourceURL"===i&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${i} (see https://g.co/ng/security#xss)`)}return i===t}function Ui(e){return e instanceof Mi&&e.getTypeName()||null}function Fi(e){return new ki(e)}function Vi(e){return new ji(e)}function Xi(e){return new Hi(e)}function Yi(e){return new Ni(e)}function Gi(e){return new _i(e)}class qi{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(zi(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch(t){return null}}}class Zi{constructor(e){if(this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const t=this.inertDocument.createElement("body");e.appendChild(t)}}getInertBodyElement(e){const t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=zi(e),t;const i=this.inertDocument.createElement("body");return i.innerHTML=zi(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(i),i}stripCustomNsAttrs(e){const t=e.attributes;for(let n=t.length-1;0<n;n--){const i=t.item(n).name;"xmlns:ns1"!==i&&0!==i.indexOf("ns1:")||e.removeAttribute(i)}let i=e.firstChild;for(;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}const $i=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Qi=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Ji(e){return(e=String(e)).match($i)||e.match(Qi)?e:"unsafe:"+e}function Ki(e){const t={};for(const i of e.split(","))t[i]=!0;return t}function en(...e){const t={};for(const i of e)for(const e in i)i.hasOwnProperty(e)&&(t[e]=!0);return t}const tn=Ki("area,br,col,hr,img,wbr"),nn=Ki("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),rn=Ki("rp,rt"),sn=en(rn,nn),on=en(tn,en(nn,Ki("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),en(rn,Ki("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),sn),an=Ki("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),ln=Ki("srcset"),hn=en(an,ln,Ki("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Ki("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),cn=Ki("script,style,template");class dn{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,i=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?i=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,i&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let e=this.checkClobberedElement(t,t.nextSibling);if(e){t=e;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!on.hasOwnProperty(t))return this.sanitizedSomething=!0,!cn.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const i=e.attributes;for(let r=0;r<i.length;r++){const e=i.item(r),t=e.name,s=t.toLowerCase();if(!hn.hasOwnProperty(s)){this.sanitizedSomething=!0;continue}let o=e.value;an[s]&&(o=Ji(o)),ln[s]&&(n=o,o=(n=String(n)).split(",").map(e=>Ji(e.trim())).join(", ")),this.buf.push(" ",t,'="',gn(o),'"')}var n;return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();on.hasOwnProperty(t)&&!tn.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(gn(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const pn=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,un=/([^\#-~ |!])/g;function gn(e){return e.replace(/&/g,"&amp;").replace(pn,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(un,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let mn;function fn(e,t){let i=null;try{mn=mn||function(e){const t=new Zi(e);return function(){try{return!!(new window.DOMParser).parseFromString(zi(""),"text/html")}catch(e){return!1}}()?new qi(t):t}(e);let n=t?String(t):"";i=mn.getInertBodyElement(n);let r=5,s=n;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,n=s,s=i.innerHTML,i=mn.getInertBodyElement(n)}while(n!==s);return zi((new dn).sanitizeChildren(yn(i)||i))}finally{if(i){const e=yn(i)||i;for(;e.firstChild;)e.removeChild(e.firstChild)}}}function yn(e){return"content"in e&&function(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var bn=function(e){return e[e.NONE=0]="NONE",e[e.HTML=1]="HTML",e[e.STYLE=2]="STYLE",e[e.SCRIPT=3]="SCRIPT",e[e.URL=4]="URL",e[e.RESOURCE_URL=5]="RESOURCE_URL",e}({});function vn(e){const t=function(){const e=Ze();return e&&e[12]}();return t?t.sanitize(bn.URL,e)||"":Wi(e,"URL")?Bi(e):Ji(Ce(e))}function wn(e){return e.ngDebugContext}function xn(e){return e.ngOriginalError}function Sn(e,...t){e.error(...t)}class Cn{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),i=this._findContext(e),n=function(e){return e.ngErrorLogger||Sn}(e);n(this._console,"ERROR",e),t&&n(this._console,"ORIGINAL ERROR",t),i&&n(this._console,"ERROR CONTEXT",i)}_findContext(e){return e?wn(e)?wn(e):this._findContext(xn(e)):null}_findOriginalError(e){let t=xn(e);for(;t&&xn(t);)t=xn(t);return t}}function Pn(e,t){e.__ngContext__=t}const On=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(X))();function Tn(e){return e instanceof Function?e():e}var En=function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e}({});function An(e,t){return(void 0)(e,t)}function In(e){const t=e[3];return fe(t)?t[3]:t}function Dn(e){return Ln(e[13])}function Rn(e){return Ln(e[4])}function Ln(e){for(;null!==e&&!fe(e);)e=e[4];return e}function zn(e,t,i,n,r){if(null!=n){let s,o=!1;fe(n)?s=n:me(n)&&(o=!0,n=n[0]);const a=je(n);0===e&&null!==i?null==r?Wn(t,i,a):Bn(t,i,a,r||null,!0):1===e&&null!==i?Bn(t,i,a,r||null,!0):2===e?function(e,t,i){const n=Fn(e,t);n&&function(e,t,i,n){Me(e)?e.removeChild(t,i,n):t.removeChild(i)}(e,n,t,i)}(t,a,o):3===e&&t.destroyNode(a),null!=s&&function(e,t,i,n,r){const s=i[7];s!==je(i)&&zn(t,e,n,s,r);for(let o=ge;o<i.length;o++){const r=i[o];$n(r[1],r,e,t,n,s)}}(t,e,s,i,r)}}function Mn(e,t,i){return Me(e)?e.createElement(t,i):null===i?e.createElement(t):e.createElementNS(i,t)}function kn(e,t){const i=e[9],n=i.indexOf(t),r=t[3];1024&t[2]&&(t[2]&=-1025,Ye(r,-1)),i.splice(n,1)}function jn(e,t){if(e.length<=ge)return;const i=ge+t,n=e[i];if(n){const s=n[17];null!==s&&s!==e&&kn(s,n),t>0&&(e[i-1][4]=n[4]);const o=ui(e,ge+t);$n(n[1],r=n,r[11],2,null,null),r[0]=null,r[6]=null;const a=o[19];null!==a&&a.detachView(o[1]),n[3]=null,n[4]=null,n[2]&=-129}var r;return n}function Hn(e,t){if(!(256&t[2])){const i=t[11];Me(i)&&i.destroyNode&&$n(e,t,i,3,null,null),function(e){let t=e[13];if(!t)return Nn(e[1],e);for(;t;){let i=null;if(me(t))i=t[13];else{const e=t[10];e&&(i=e)}if(!i){for(;t&&!t[4]&&t!==e;)me(t)&&Nn(t[1],t),t=t[3];null===t&&(t=e),me(t)&&Nn(t[1],t),i=t&&t[4]}t=i}}(t)}}function Nn(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){let i;if(null!=e&&null!=(i=e.destroyHooks))for(let n=0;n<i.length;n+=2){const e=t[i[n]];if(!(e instanceof At)){const t=i[n+1];if(Array.isArray(t))for(let i=0;i<t.length;i+=2)t[i+1].call(e[t[i]]);else t.call(e)}}}(e,t),function(e,t){const i=e.cleanup,n=t[7];let r=-1;if(null!==i)for(let s=0;s<i.length-1;s+=2)if("string"==typeof i[s]){const e=i[s+1],o="function"==typeof e?e(t):je(t[e]),a=n[r=i[s+2]],l=i[s+3];"boolean"==typeof l?o.removeEventListener(i[s],a,l):l>=0?n[r=l]():n[r=-l].unsubscribe(),s+=2}else{const e=n[r=i[s+1]];i[s].call(e)}if(null!==n){for(let e=r+1;e<n.length;e++)(0,n[e])();t[7]=null}}(e,t),1===t[1].type&&Me(t[11])&&t[11].destroy();const i=t[17];if(null!==i&&fe(t[3])){i!==t[3]&&kn(i,t);const n=t[19];null!==n&&n.detachView(e)}}}function _n(e,t,i){return function(e,t,i){let n=t;for(;null!==n&&40&n.type;)n=(t=n).parent;if(null===n)return i[0];if(2&n.flags){const t=e.data[n.directiveStart].encapsulation;if(t===B.None||t===B.Emulated)return null}return Ne(n,i)}(e,t.parent,i)}function Bn(e,t,i,n,r){Me(e)?e.insertBefore(t,i,n,r):t.insertBefore(i,n,r)}function Wn(e,t,i){Me(e)?e.appendChild(t,i):t.appendChild(i)}function Un(e,t,i,n,r){null!==n?Bn(e,t,i,n,r):Wn(e,t,i)}function Fn(e,t){return Me(e)?e.parentNode(t):t.parentNode}function Vn(e,t,i){return Xn(e,t,i)}let Xn=function(e,t,i){return 40&e.type?Ne(e,i):null};function Yn(e,t,i,n){const r=_n(e,n,t),s=t[11],o=Vn(n.parent||t[6],n,t);if(null!=r)if(Array.isArray(i))for(let a=0;a<i.length;a++)Un(s,r,i[a],o,!1);else Un(s,r,i,o,!1)}function Gn(e,t){if(null!==t){const i=t.type;if(3&i)return Ne(t,e);if(4&i)return qn(-1,e[t.index]);if(8&i){const i=t.child;if(null!==i)return Gn(e,i);{const i=e[t.index];return fe(i)?qn(-1,i):je(i)}}if(32&i)return An(t,e)()||je(e[t.index]);{const i=e[16],n=i[6],r=In(i),s=n.projection[t.projection];return null!=s?Gn(r,s):Gn(e,t.next)}}return null}function qn(e,t){const i=ge+e+1;if(i<t.length){const e=t[i],n=e[1].firstChild;if(null!==n)return Gn(e,n)}return t[7]}function Zn(e,t,i,n,r,s,o){for(;null!=i;){const a=n[i.index],l=i.type;if(o&&0===t&&(a&&Pn(je(a),n),i.flags|=4),64!=(64&i.flags))if(8&l)Zn(e,t,i.child,n,r,s,!1),zn(t,e,r,a,s);else if(32&l){const o=An(i,n);let l;for(;l=o();)zn(t,e,r,l,s);zn(t,e,r,a,s)}else 16&l?Qn(e,t,n,i,r,s):zn(t,e,r,a,s);i=o?i.projectionNext:i.next}}function $n(e,t,i,n,r,s){Zn(i,n,e.firstChild,t,r,s,!1)}function Qn(e,t,i,n,r,s){const o=i[16],a=o[6].projection[n.projection];if(Array.isArray(a))for(let l=0;l<a.length;l++)zn(t,e,r,a[l],s);else Zn(e,t,a,o[3],r,s,!0)}function Jn(e,t,i){Me(e)?e.setAttribute(t,"style",i):t.style.cssText=i}function Kn(e,t,i){Me(e)?""===i?e.removeAttribute(t,"class"):e.setAttribute(t,"class",i):t.className=i}function er(e,t,i){let n=e.length;for(;;){const r=e.indexOf(t,i);if(-1===r)return r;if(0===r||e.charCodeAt(r-1)<=32){const i=t.length;if(r+i===n||e.charCodeAt(r+i)<=32)return r}i=r+1}}const tr="ng-template";function ir(e,t,i){let n=0;for(;n<e.length;){let r=e[n++];if(i&&"class"===r){if(r=e[n],-1!==er(r.toLowerCase(),t,0))return!0}else if(1===r){for(;n<e.length&&"string"==typeof(r=e[n++]);)if(r.toLowerCase()===t)return!0;return!1}}return!1}function nr(e){return 4===e.type&&e.value!==tr}function rr(e,t,i){return t===(4!==e.type||i?e.value:tr)}function sr(e,t,i){let n=4;const r=e.attrs||[],s=function(e){for(let t=0;t<e.length;t++)if(Dt(e[t]))return t;return e.length}(r);let o=!1;for(let a=0;a<t.length;a++){const l=t[a];if("number"!=typeof l){if(!o)if(4&n){if(n=2|1&n,""!==l&&!rr(e,l,i)||""===l&&1===t.length){if(or(n))return!1;o=!0}}else{const h=8&n?l:t[++a];if(8&n&&null!==e.attrs){if(!ir(e.attrs,h,i)){if(or(n))return!1;o=!0}continue}const c=ar(8&n?"class":l,r,nr(e),i);if(-1===c){if(or(n))return!1;o=!0;continue}if(""!==h){let e;e=c>s?"":r[c+1].toLowerCase();const t=8&n?e:null;if(t&&-1!==er(t,h,0)||2&n&&h!==e){if(or(n))return!1;o=!0}}}}else{if(!o&&!or(n)&&!or(l))return!1;if(o&&or(l))continue;o=!1,n=l|1&n}}return or(n)||o}function or(e){return 0==(1&e)}function ar(e,t,i,n){if(null===t)return-1;let r=0;if(n||!i){let i=!1;for(;r<t.length;){const n=t[r];if(n===e)return r;if(3===n||6===n)i=!0;else{if(1===n||2===n){let e=t[++r];for(;"string"==typeof e;)e=t[++r];continue}if(4===n)break;if(0===n){r+=4;continue}}r+=i?1:2}return-1}return function(e,t){let i=e.indexOf(4);if(i>-1)for(i++;i<e.length;){const n=e[i];if("number"==typeof n)return-1;if(n===t)return i;i++}return-1}(t,e)}function lr(e,t,i=!1){for(let n=0;n<t.length;n++)if(sr(e,t[n],i))return!0;return!1}function hr(e,t){e:for(let i=0;i<t.length;i++){const n=t[i];if(e.length===n.length){for(let t=0;t<e.length;t++)if(e[t]!==n[t])continue e;return!0}}return!1}function cr(e,t){return e?":not("+t.trim()+")":t}function dr(e){let t=e[0],i=1,n=2,r="",s=!1;for(;i<e.length;){let o=e[i];if("string"==typeof o)if(2&n){const t=e[++i];r+="["+o+(t.length>0?'="'+t+'"':"")+"]"}else 8&n?r+="."+o:4&n&&(r+=" "+o);else""===r||or(o)||(t+=cr(s,r),r=""),n=o,s=s||!or(n);i++}return""!==r&&(t+=cr(s,r)),t}const pr={};function ur(e){gr($e(),Ze(),bt()+e,it())}function gr(e,t,i,n){if(!n)if(3==(3&t[2])){const n=e.preOrderCheckHooks;null!==n&&St(t,n,i)}else{const n=e.preOrderHooks;null!==n&&Ct(t,n,0,i)}vt(i)}function mr(e,t){return e<<17|t<<2}function fr(e){return e>>17&32767}function yr(e){return 2|e}function br(e){return(131068&e)>>2}function vr(e,t){return-131069&e|t<<2}function wr(e){return 1|e}function xr(e,t){const i=e.contentQueries;if(null!==i)for(let n=0;n<i.length;n+=2){const r=i[n],s=i[n+1];if(-1!==s){const i=e.data[s];ht(r),i.contentQueries(2,t[s],s)}}}function Sr(e,t,i,n,r,s,o,a,l,h){const c=t.blueprint.slice();return c[0]=r,c[2]=140|n,Xe(c),c[3]=c[15]=e,c[8]=i,c[10]=o||e&&e[10],c[11]=a||e&&e[11],c[12]=l||e&&e[12]||null,c[9]=h||e&&e[9]||null,c[6]=s,c[16]=2==t.type?e[16]:c,c}function Cr(e,t,i,n,r){let s=e.data[t];if(null===s)s=function(e,t,i,n,r){const s=Je(),o=et(),a=e.data[t]=function(e,t,i,n,r,s){return{type:i,index:n,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,i,t,n,r);return null===e.firstChild&&(e.firstChild=a),null!==s&&(o?null==s.child&&null!==a.parent&&(s.child=a):null===s.next&&(s.next=a)),a}(e,t,i,n,r),Ge.lFrame.inI18n&&(s.flags|=64);else if(64&s.type){s.type=i,s.value=n,s.attrs=r;const e=function(){const e=Ge.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}();s.injectorIndex=null===e?-1:e.injectorIndex}return Ke(s,!0),s}function Pr(e,t,i,n){if(0===i)return-1;const r=t.length;for(let s=0;s<i;s++)t.push(n),e.blueprint.push(n),e.data.push(null);return r}function Or(e,t,i){pt(t);try{const n=e.viewQuery;null!==n&&es(1,n,i);const r=e.template;null!==r&&Ar(e,t,r,1,i),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&xr(e,t),e.staticViewQueries&&es(2,e.viewQuery,i);const s=e.components;null!==s&&function(e,t){for(let i=0;i<t.length;i++)Zr(e,t[i])}(t,s)}catch(n){throw e.firstCreatePass&&(e.incompleteFirstPass=!0),n}finally{t[2]&=-5,yt()}}function Tr(e,t,i,n){const r=t[2];if(256==(256&r))return;pt(t);const s=it();try{Xe(t),Ge.lFrame.bindingIndex=e.bindingStartIndex,null!==i&&Ar(e,t,i,2,n);const o=3==(3&r);if(!s)if(o){const i=e.preOrderCheckHooks;null!==i&&St(t,i,null)}else{const i=e.preOrderHooks;null!==i&&Ct(t,i,0,null),Pt(t,0)}if(function(e){for(let t=Dn(e);null!==t;t=Rn(t)){if(!t[2])continue;const e=t[9];for(let t=0;t<e.length;t++){const i=e[t],n=i[3];0==(1024&i[2])&&Ye(n,1),i[2]|=1024}}}(t),function(e){for(let t=Dn(e);null!==t;t=Rn(t))for(let e=ge;e<t.length;e++){const i=t[e],n=i[1];Fe(i)&&Tr(n,i,n.template,i[8])}}(t),null!==e.contentQueries&&xr(e,t),!s)if(o){const i=e.contentCheckHooks;null!==i&&St(t,i)}else{const i=e.contentHooks;null!==i&&Ct(t,i,1),Pt(t,1)}!function(e,t){const i=e.hostBindingOpCodes;if(null!==i)try{for(let e=0;e<i.length;e++){const n=i[e];if(n<0)vt(~n);else{const r=n,s=i[++e],o=i[++e];ot(s,r),o(2,t[r])}}}finally{vt(-1)}}(e,t);const a=e.components;null!==a&&function(e,t){for(let i=0;i<t.length;i++)Gr(e,t[i])}(t,a);const l=e.viewQuery;if(null!==l&&es(2,l,n),!s)if(o){const i=e.viewCheckHooks;null!==i&&St(t,i)}else{const i=e.viewHooks;null!==i&&Ct(t,i,2),Pt(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),s||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,Ye(t[3],-1))}finally{yt()}}function Er(e,t,i,n){const r=t[10],s=!it(),o=Ue(t);try{s&&!o&&r.begin&&r.begin(),o&&Or(e,t,n),Tr(e,t,i,n)}finally{s&&!o&&r.end&&r.end()}}function Ar(e,t,i,n,r){const s=bt();try{vt(-1),2&n&&t.length>ue&&gr(e,t,ue,it()),i(n,r)}finally{vt(s)}}function Ir(e,t,i){qe()&&(function(e,t,i,n){const r=i.directiveStart,s=i.directiveEnd;e.firstCreatePass||Bt(i,t),Pn(n,t);const o=i.initialInputs;for(let a=r;a<s;a++){const n=e.data[a],s=we(n);s&&Fr(t,i,n);const l=Jt(t,e,a,i);Pn(l,t),null!==o&&Vr(0,a-r,l,n,0,o),s&&(Be(i.index,t)[8]=l)}}(e,t,i,Ne(i,t)),128==(128&i.flags)&&function(e,t,i){const n=i.directiveStart,r=i.directiveEnd,s=i.index,o=Ge.lFrame.currentDirectiveIndex;try{vt(s);for(let i=n;i<r;i++){const n=e.data[i],r=t[i];at(i),null===n.hostBindings&&0===n.hostVars&&null===n.hostAttrs||Nr(n,r)}}finally{vt(-1),at(o)}}(e,t,i))}function Dr(e,t,i=Ne){const n=t.localNames;if(null!==n){let r=t.index+1;for(let s=0;s<n.length;s+=2){const o=n[s+1],a=-1===o?i(t,e):e[o];e[r++]=a}}}function Rr(e){const t=e.tView;return null===t||t.incompleteFirstPass?e.tView=Lr(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function Lr(e,t,i,n,r,s,o,a,l,h){const c=ue+n,d=c+r,p=function(e,t){const i=[];for(let n=0;n<t;n++)i.push(n<e?null:pr);return i}(c,d),u="function"==typeof h?h():h;return p[1]={type:e,blueprint:p,template:i,queries:null,viewQuery:a,declTNode:t,data:p.slice().fill(null,c),bindingStartIndex:c,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:u,incompleteFirstPass:!1}}function zr(e,t,i,n){const r=is(t);null===i?r.push(n):(r.push(i),e.firstCreatePass&&ns(e).push(n,r.length-1))}function Mr(e,t,i){for(let n in e)if(e.hasOwnProperty(n)){const r=e[n];(i=null===i?{}:i).hasOwnProperty(n)?i[n].push(t,r):i[n]=[t,r]}return i}function kr(e,t,i,n,r,s,o,a){const l=Ne(t,i);let h,c=t.inputs;var d;!a&&null!=c&&(h=c[n])?(ss(e,i,h,n,r),be(t)&&function(e,t){const i=Be(t,e);16&i[2]||(i[2]|=64)}(i,t.index)):3&t.type&&(n="class"===(d=n)?"className":"for"===d?"htmlFor":"formaction"===d?"formAction":"innerHtml"===d?"innerHTML":"readonly"===d?"readOnly":"tabindex"===d?"tabIndex":d,r=null!=o?o(r,t.value||"",n):r,Me(s)?s.setProperty(l,n,r):Rt(n)||(l.setProperty?l.setProperty(n,r):l[n]=r))}function jr(e,t,i,n){let r=!1;if(qe()){const s=function(e,t,i){const n=e.directiveRegistry;let r=null;if(n)for(let s=0;s<n.length;s++){const o=n[s];lr(i,o.selectors,!1)&&(r||(r=[]),Vt(Bt(i,t),e,o.type),we(o)?(_r(e,i),r.unshift(o)):r.push(o))}return r}(e,t,i),o=null===n?null:{"":-1};if(null!==s){r=!0,Wr(i,e.data.length,s.length);for(let e=0;e<s.length;e++){const t=s[e];t.providersResolver&&t.providersResolver(t)}let n=!1,a=!1,l=Pr(e,t,s.length,null);for(let r=0;r<s.length;r++){const h=s[r];i.mergedAttrs=Lt(i.mergedAttrs,h.hostAttrs),Ur(e,i,t,l,h),Br(l,h,o),null!==h.contentQueries&&(i.flags|=8),null===h.hostBindings&&null===h.hostAttrs&&0===h.hostVars||(i.flags|=128);const c=h.type.prototype;!n&&(c.ngOnChanges||c.ngOnInit||c.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(i.index),n=!0),a||!c.ngOnChanges&&!c.ngDoCheck||((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(i.index),a=!0),l++}!function(e,t){const i=t.directiveEnd,n=e.data,r=t.attrs,s=[];let o=null,a=null;for(let l=t.directiveStart;l<i;l++){const e=n[l],i=e.inputs,h=null===r||nr(t)?null:Xr(i,r);s.push(h),o=Mr(i,l,o),a=Mr(e.outputs,l,a)}null!==o&&(o.hasOwnProperty("class")&&(t.flags|=16),o.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=s,t.inputs=o,t.outputs=a}(e,i)}o&&function(e,t,i){if(t){const n=e.localNames=[];for(let e=0;e<t.length;e+=2){const r=i[t[e+1]];if(null==r)throw new Se("301",`Export of name '${t[e+1]}' not found!`);n.push(t[e],r)}}}(i,n,o)}return i.mergedAttrs=Lt(i.mergedAttrs,i.attrs),r}function Hr(e,t,i,n,r,s){const o=s.hostBindings;if(o){let i=e.hostBindingOpCodes;null===i&&(i=e.hostBindingOpCodes=[]);const s=~t.index;(function(e){let t=e.length;for(;t>0;){const i=e[--t];if("number"==typeof i&&i<0)return i}return 0})(i)!=s&&i.push(s),i.push(n,r,o)}}function Nr(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function _r(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function Br(e,t,i){if(i){if(t.exportAs)for(let n=0;n<t.exportAs.length;n++)i[t.exportAs[n]]=e;we(t)&&(i[""]=e)}}function Wr(e,t,i){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+i,e.providerIndexes=t}function Ur(e,t,i,n,r){e.data[n]=r;const s=r.factory||(r.factory=xe(r.type)),o=new At(s,we(r),null);e.blueprint[n]=o,i[n]=o,Hr(e,t,0,n,Pr(e,i,r.hostVars,pr),r)}function Fr(e,t,i){const n=Ne(t,e),r=Rr(i),s=e[10],o=$r(e,Sr(e,r,null,i.onPush?64:16,n,t,s,s.createRenderer(n,i),null,null));e[t.index]=o}function Vr(e,t,i,n,r,s){const o=s[t];if(null!==o){const e=n.setInput;for(let t=0;t<o.length;){const r=o[t++],s=o[t++],a=o[t++];null!==e?n.setInput(i,a,r,s):i[s]=a}}}function Xr(e,t){let i=null,n=0;for(;n<t.length;){const r=t[n];if(0!==r)if(5!==r){if("number"==typeof r)break;e.hasOwnProperty(r)&&(null===i&&(i=[]),i.push(r,e[r],t[n+1])),n+=2}else n+=2;else n+=4}return i}function Yr(e,t,i,n){return new Array(e,!0,!1,t,null,0,n,i,null,null)}function Gr(e,t){const i=Be(t,e);if(Fe(i)){const e=i[1];80&i[2]?Tr(e,i,e.template,i[8]):i[5]>0&&qr(i)}}function qr(e){for(let i=Dn(e);null!==i;i=Rn(i))for(let e=ge;e<i.length;e++){const t=i[e];if(1024&t[2]){const e=t[1];Tr(e,t,e.template,t[8])}else t[5]>0&&qr(t)}const t=e[1].components;if(null!==t)for(let i=0;i<t.length;i++){const n=Be(t[i],e);Fe(n)&&n[5]>0&&qr(n)}}function Zr(e,t){const i=Be(t,e),n=i[1];!function(e,t){for(let i=t.length;i<e.blueprint.length;i++)t.push(e.blueprint[i])}(n,i),Or(n,i,i[8])}function $r(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function Qr(e){for(;e;){e[2]|=64;const t=In(e);if(0!=(512&e[2])&&!t)return e;e=t}return null}function Jr(e,t,i){const n=t[10];n.begin&&n.begin();try{Tr(e,t,e.template,i)}catch(r){throw rs(t,r),r}finally{n.end&&n.end()}}function Kr(e){!function(e){for(let t=0;t<e.components.length;t++){const i=e.components[t],n=We(i),r=n[1];Er(r,n,r.template,i)}}(e[8])}function es(e,t,i){ht(0),t(e,i)}const ts=(()=>Promise.resolve(null))();function is(e){return e[7]||(e[7]=[])}function ns(e){return e.cleanup||(e.cleanup=[])}function rs(e,t){const i=e[9],n=i?i.get(Cn,null):null;n&&n.handleError(t)}function ss(e,t,i,n,r){for(let s=0;s<i.length;){const o=i[s++],a=i[s++],l=t[o],h=e.data[o];null!==h.setInput?h.setInput(l,r,n,a):l[a]=r}}function os(e,t,i){const n=He(t,e);!function(e,t,i){Me(e)?e.setValue(t,i):t.textContent=i}(e[11],n,i)}function as(e,t,i){let n=i?e.styles:null,r=i?e.classes:null,s=0;if(null!==t)for(let o=0;o<t.length;o++){const e=t[o];"number"==typeof e?s=e:1==s?r=w(r,e):2==s&&(n=w(n,e+": "+t[++o]+";"))}i?e.styles=n:e.stylesWithoutHost=n,i?e.classes=r:e.classesWithoutHost=r}const ls=new ai("INJECTOR",-1);class hs{get(e,t=bi){if(t===bi){const t=new Error(`NullInjectorError: No provider for ${v(e)}!`);throw t.name="NullInjectorError",t}return t}}const cs=new ai("Set Injector scope."),ds={},ps={},us=[];let gs;function ms(){return void 0===gs&&(gs=new hs),gs}function fs(e,t=null,i=null,n){return new ys(e,i,t||ms(),n)}class ys{constructor(e,t,i,n=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const r=[];t&&di(t,i=>this.processProvider(i,e,t)),di([e],e=>this.processInjectorType(e,[],r)),this.records.set(ls,ws(void 0,this));const s=this.records.get(cs);this.scope=null!=s?s.value:null,this.source=n||("object"==typeof e?null:v(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=bi,i=M.Default){this.assertNotDestroyed();const n=Ci(this);try{if(!(i&M.SkipSelf)){let t=this.records.get(e);if(void 0===t){const i=("function"==typeof(r=e)||"object"==typeof r&&r instanceof ai)&&E(e);t=i&&this.injectableDefInScope(i)?ws(bs(e),ds):null,this.records.set(e,t)}if(null!=t)return this.hydrate(e,t)}return(i&M.Self?ms():this.parent).get(e,t=i&M.Optional&&t===bi?null:t)}catch(s){if("NullInjectorError"===s.name){if((s.ngTempTokenPath=s.ngTempTokenPath||[]).unshift(v(e)),n)throw s;return function(e,t,i,n){const r=e.ngTempTokenPath;throw t[wi]&&r.unshift(t[wi]),e.message=function(e,t,i,n=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;let r=v(t);if(Array.isArray(t))r=t.map(v).join(" -> ");else if("object"==typeof t){let e=[];for(let i in t)if(t.hasOwnProperty(i)){let n=t[i];e.push(i+":"+("string"==typeof n?JSON.stringify(n):v(n)))}r=`{${e.join(", ")}}`}return`${i}${n?"("+n+")":""}[${r}]: ${e.replace(vi,"\n  ")}`}("\n"+e.message,r,i,n),e.ngTokenPath=r,e.ngTempTokenPath=null,e}(s,e,"R3InjectorError",this.source)}throw s}finally{Ci(n)}var r}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((t,i)=>e.push(v(i))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(e,t,i){if(!(e=C(e)))return!1;let n=I(e);const r=null==n&&e.ngModule||void 0,s=void 0===r?e:r,o=-1!==i.indexOf(s);if(void 0!==r&&(n=I(r)),null==n)return!1;if(null!=n.imports&&!o){let e;i.push(s);try{di(n.imports,n=>{this.processInjectorType(n,t,i)&&(void 0===e&&(e=[]),e.push(n))})}finally{}if(void 0!==e)for(let t=0;t<e.length;t++){const{ngModule:i,providers:n}=e[t];di(n,e=>this.processProvider(e,i,n||us))}}this.injectorDefTypes.add(s),this.records.set(s,ws(n.factory,ds));const a=n.providers;if(null!=a&&!o){const t=e;di(a,e=>this.processProvider(e,t,a))}return void 0!==r&&void 0!==e.providers}processProvider(e,t,i){let n=Ss(e=C(e))?e:C(e&&e.provide);const r=function(e,t,i){return xs(e)?ws(void 0,e.useValue):ws(vs(e),ds)}(e);if(Ss(e)||!0!==e.multi)this.records.get(n);else{let t=this.records.get(n);t||(t=ws(void 0,ds,!0),t.factory=()=>Ti(t.multi),this.records.set(n,t)),n=e,t.multi.push(e)}this.records.set(n,r)}hydrate(e,t){var i;return t.value===ds&&(t.value=ps,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(i=t.value)&&"object"==typeof i&&"function"==typeof i.ngOnDestroy&&this.onDestroy.add(t.value),t.value}injectableDefInScope(e){return!!e.providedIn&&("string"==typeof e.providedIn?"any"===e.providedIn||e.providedIn===this.scope:this.injectorDefTypes.has(e.providedIn))}}function bs(e){const t=E(e),i=null!==t?t.factory:xe(e);if(null!==i)return i;const n=I(e);if(null!==n)return n.factory;if(e instanceof ai)throw new Error(`Token ${v(e)} is missing a \u0275prov definition.`);if(e instanceof Function)return function(e){const t=e.length;if(t>0){const i=gi(t,"?");throw new Error(`Can't resolve all parameters for ${v(e)}: (${i.join(", ")}).`)}const i=function(e){const t=e&&(e[D]||e[L]);if(t){const i=function(e){if(e.hasOwnProperty("name"))return e.name;const t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn(`DEPRECATED: DI is instantiating a token "${i}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${i}" class.`),t}return null}(e);return null!==i?()=>i.factory(e):()=>new e}(e);throw new Error("unreachable")}function vs(e,t,i){let n;if(Ss(e)){const t=C(e);return xe(t)||bs(t)}if(xs(e))n=()=>C(e.useValue);else if((r=e)&&r.useFactory)n=()=>e.useFactory(...Ti(e.deps||[]));else if(function(e){return!(!e||!e.useExisting)}(e))n=()=>Oi(C(e.useExisting));else{const t=C(e&&(e.useClass||e.provide));if(!function(e){return!!e.deps}(e))return xe(t)||bs(t);n=()=>new t(...Ti(e.deps))}var r;return n}function ws(e,t,i=!1){return{factory:e,value:t,multi:i?[]:void 0}}function xs(e){return null!==e&&"object"==typeof e&&xi in e}function Ss(e){return"function"==typeof e}const Cs=function(e,t,i){return function(e,t=null,i=null,n){const r=fs(e,t,i,n);return r._resolveInjectorDefTypes(),r}({name:i},t,e,i)};let Ps=(()=>{class e{static create(e,t){return Array.isArray(e)?Cs(e,t,""):Cs(e.providers,e.parent,e.name||"")}}return e.THROW_IF_NOT_FOUND=bi,e.NULL=new hs,e.\u0275prov=O({token:e,providedIn:"any",factory:()=>Oi(ls)}),e.__NG_ELEMENT_ID__=-1,e})();function Os(e,t){xt(We(e)[1],Qe())}function Ts(e){let t=Object.getPrototypeOf(e.type.prototype).constructor,i=!0;const n=[e];for(;t;){let r;if(we(e))r=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");r=t.\u0275dir}if(r){if(i){n.push(r);const t=e;t.inputs=Es(e.inputs),t.declaredInputs=Es(e.declaredInputs),t.outputs=Es(e.outputs);const i=r.hostBindings;i&&Ds(e,i);const s=r.viewQuery,o=r.contentQueries;if(s&&As(e,s),o&&Is(e,o),b(e.inputs,r.inputs),b(e.declaredInputs,r.declaredInputs),b(e.outputs,r.outputs),we(r)&&r.data.animation){const t=e.data;t.animation=(t.animation||[]).concat(r.data.animation)}}const t=r.features;if(t)for(let n=0;n<t.length;n++){const r=t[n];r&&r.ngInherit&&r(e),r===Ts&&(i=!1)}}t=Object.getPrototypeOf(t)}!function(e){let t=0,i=null;for(let n=e.length-1;n>=0;n--){const r=e[n];r.hostVars=t+=r.hostVars,r.hostAttrs=Lt(r.hostAttrs,i=Lt(i,r.hostAttrs))}}(n)}function Es(e){return e===Y?{}:e===G?[]:e}function As(e,t){const i=e.viewQuery;e.viewQuery=i?(e,n)=>{t(e,n),i(e,n)}:t}function Is(e,t){const i=e.contentQueries;e.contentQueries=i?(e,n,r)=>{t(e,n,r),i(e,n,r)}:t}function Ds(e,t){const i=e.hostBindings;e.hostBindings=i?(e,n)=>{t(e,n),i(e,n)}:t}let Rs=null;function Ls(){if(!Rs){const e=X.Symbol;if(e&&e.iterator)Rs=e.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const i=e[t];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(Rs=i)}}}return Rs}function zs(e){return!!Ms(e)&&(Array.isArray(e)||!(e instanceof Map)&&Ls()in e)}function Ms(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function ks(e,t,i){return!Object.is(e[t],i)&&(e[t]=i,!0)}function js(e,t,i,n){const r=Ze();return ks(r,rt(),t)&&($e(),function(e,t,i,n,r,s){const o=Ne(e,t);!function(e,t,i,n,r,s,o){if(null==s)Me(e)?e.removeAttribute(t,r,i):t.removeAttribute(r);else{const a=null==o?Ce(s):o(s,n||"",r);Me(e)?e.setAttribute(t,r,a,i):i?t.setAttributeNS(i,r,a):t.setAttribute(r,a)}}(t[11],o,s,e.value,i,n,r)}(wt(),r,e,t,i,n)),js}function Hs(e,t,i,n,r,s,o,a){const l=Ze(),h=$e(),c=e+ue,d=h.firstCreatePass?function(e,t,i,n,r,s,o,a,l){const h=t.consts,c=Cr(t,e,4,o||null,Ve(h,a));jr(t,i,c,Ve(h,l)),xt(t,c);const d=c.tViews=Lr(2,c,n,r,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,h);return null!==t.queries&&(t.queries.template(t,c),d.queries=t.queries.embeddedTView(c)),c}(c,h,l,t,i,n,r,s,o):h.data[c];Ke(d,!1);const p=l[11].createComment("");Yn(h,l,p,d),Pn(p,l),$r(l,l[c]=Yr(p,l,p,d)),ve(d)&&Ir(h,l,d),null!=o&&Dr(l,d,a)}function Ns(e,t=M.Default){const i=Ze();return null===i?Oi(e,t):Gt(Qe(),i,C(e),t)}function _s(e,t,i){const n=Ze();return ks(n,rt(),t)&&kr($e(),wt(),n,e,t,n[11],i,!1),_s}function Bs(e,t,i,n,r){const s=r?"class":"style";ss(e,i,t.inputs[s],s,n)}function Ws(e,t,i,n){const r=Ze(),s=$e(),o=ue+e,a=r[11],l=r[o]=Mn(a,t,Ge.lFrame.currentNamespace),h=s.firstCreatePass?function(e,t,i,n,r,s,o){const a=t.consts,l=Cr(t,e,2,r,Ve(a,s));return jr(t,i,l,Ve(a,o)),null!==l.attrs&&as(l,l.attrs,!1),null!==l.mergedAttrs&&as(l,l.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,l),l}(o,s,r,0,t,i,n):s.data[o];Ke(h,!0);const c=h.mergedAttrs;null!==c&&It(a,l,c);const d=h.classes;null!==d&&Kn(a,l,d);const p=h.styles;null!==p&&Jn(a,l,p),64!=(64&h.flags)&&Yn(s,r,l,h),0===Ge.lFrame.elementDepthCount&&Pn(l,r),Ge.lFrame.elementDepthCount++,ve(h)&&(Ir(s,r,h),function(e,t,i){if(ye(t)){const n=t.directiveEnd;for(let r=t.directiveStart;r<n;r++){const t=e.data[r];t.contentQueries&&t.contentQueries(1,i[r],r)}}}(s,h,r)),null!==n&&Dr(r,h)}function Us(){let e=Qe();et()?tt():(e=e.parent,Ke(e,!1));const t=e;Ge.lFrame.elementDepthCount--;const i=$e();i.firstCreatePass&&(xt(i,e),ye(e)&&i.queries.elementEnd(e)),null!=t.classesWithoutHost&&function(e){return 0!=(16&e.flags)}(t)&&Bs(i,t,Ze(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(e){return 0!=(32&e.flags)}(t)&&Bs(i,t,Ze(),t.stylesWithoutHost,!1)}function Fs(e,t,i,n){Ws(e,t,i,n),Us()}function Vs(e){return!!e&&"function"==typeof e.then}function Xs(e){return!!e&&"function"==typeof e.subscribe}const Ys=Xs;function Gs(e,t,i=!1,n){const r=Ze(),s=$e(),o=Qe();return function(e,t,i,n,r,s,o=!1,a){const l=ve(n),h=e.firstCreatePass&&ns(e),c=is(t);let d=!0;if(3&n.type){const p=Ne(n,t),u=a?a(p):Y,g=u.target||p,m=c.length,f=a?e=>a(je(e[n.index])).target:n.index;if(Me(i)){let o=null;if(!a&&l&&(o=function(e,t,i,n){const r=e.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const e=r[s];if(e===i&&r[s+1]===n){const e=t[7],i=r[s+2];return e.length>i?e[i]:null}"string"==typeof e&&(s+=2)}return null}(e,t,r,n.index)),null!==o)(o.__ngLastListenerFn__||o).__ngNextListenerFn__=s,o.__ngLastListenerFn__=s,d=!1;else{s=Zs(n,t,s,!1);const e=i.listen(u.name||g,r,s);c.push(s,e),h&&h.push(r,f,m,m+1)}}else s=Zs(n,t,s,!0),g.addEventListener(r,s,o),c.push(s),h&&h.push(r,f,m,o)}else s=Zs(n,t,s,!1);const p=n.outputs;let u;if(d&&null!==p&&(u=p[r])){const e=u.length;if(e)for(let i=0;i<e;i+=2){const e=t[u[i]][u[i+1]].subscribe(s),o=c.length;c.push(s,e),h&&h.push(r,n.index,o,-(o+1))}}}(s,r,r[11],o,e,t,i,n),Gs}function qs(e,t,i){try{return!1!==t(i)}catch(n){return rs(e,n),!1}}function Zs(e,t,i,n){return function r(s){if(s===Function)return i;const o=2&e.flags?Be(e.index,t):t;0==(32&t[2])&&Qr(o);let a=qs(t,i,s),l=r.__ngNextListenerFn__;for(;l;)a=qs(t,l,s)&&a,l=l.__ngNextListenerFn__;return n&&!1===a&&(s.preventDefault(),s.returnValue=!1),a}}function $s(e,t){let i=null;const n=function(e){const t=e.attrs;if(null!=t){const e=t.indexOf(5);if(0==(1&e))return t[e+1]}return null}(e);for(let r=0;r<t.length;r++){const s=t[r];if("*"!==s){if(null===n?lr(e,s,!0):hr(n,s))return r}else i=r}return i}function Qs(e){const t=Ze()[16][6];if(!t.projection){const i=t.projection=gi(e?e.length:1,null),n=i.slice();let r=t.child;for(;null!==r;){const t=e?$s(r,e):0;null!==t&&(n[t]?n[t].projectionNext=r:i[t]=r,n[t]=r),r=r.next}}}function Js(e,t=0,i){const n=Ze(),r=$e(),s=Cr(r,ue+e,16,null,i||null);null===s.projection&&(s.projection=t),tt(),64!=(64&s.flags)&&function(e,t,i){Qn(t[11],0,t,i,_n(e,i,t),Vn(i.parent||t[6],i,t))}(r,n,s)}const Ks=[];function eo(e,t,i,n,r){const s=e[i+1],o=null===t;let a=n?fr(s):br(s),l=!1;for(;0!==a&&(!1===l||o);){const i=e[a+1];to(e[a],t)&&(l=!0,e[a+1]=n?wr(i):yr(i)),a=n?fr(i):br(i)}l&&(e[i+1]=n?yr(s):wr(s))}function to(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&yi(e,t)>=0}function io(e,t){return function(e,t,i,n){const r=Ze(),s=$e(),o=st(2);s.firstUpdatePass&&function(e,t,i,n){const r=e.data;if(null===r[i+1]){const s=r[bt()],o=function(e,t){return t>=e.expandoStartIndex}(e,i);(function(e,t){return 0!=(16&e.flags)})(s)&&null===t&&!o&&(t=!1),t=function(e,t,i,n){const r=function(e){const t=Ge.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e);let s=t.residualClasses;if(null===r)0===t.classBindings&&(i=ro(i=no(null,e,t,i,n),t.attrs,n),s=null);else{const o=t.directiveStylingLast;if(-1===o||e[o]!==r)if(i=no(r,e,t,i,n),null===s){let i=function(e,t,i){const n=t.classBindings;if(0!==br(n))return e[fr(n)]}(e,t);void 0!==i&&Array.isArray(i)&&(i=no(null,e,t,i[1],n),i=ro(i,t.attrs,n),function(e,t,i,n){e[fr(t.classBindings)]=n}(e,t,0,i))}else s=function(e,t,i){let n;const r=t.directiveEnd;for(let s=1+t.directiveStylingLast;s<r;s++)n=ro(n,e[s].hostAttrs,true);return ro(n,t.attrs,true)}(e,t)}return void 0!==s&&(t.residualClasses=s),i}(r,s,t,n),function(e,t,i,n,r,s){let o=t.classBindings,a=fr(o),l=br(o);e[n]=i;let h,c=!1;if(Array.isArray(i)){const e=i;h=e[1],(null===h||yi(e,h)>0)&&(c=!0)}else h=i;if(r)if(0!==l){const t=fr(e[a+1]);e[n+1]=mr(t,a),0!==t&&(e[t+1]=vr(e[t+1],n)),e[a+1]=131071&e[a+1]|n<<17}else e[n+1]=mr(a,0),0!==a&&(e[a+1]=vr(e[a+1],n)),a=n;else e[n+1]=mr(l,0),0===a?a=n:e[l+1]=vr(e[l+1],n),l=n;c&&(e[n+1]=yr(e[n+1])),eo(e,h,n,!0),eo(e,h,n,!1),function(e,t,i,n,r){const s=e.residualClasses;null!=s&&"string"==typeof t&&yi(s,t)>=0&&(i[n+1]=wr(i[n+1]))}(t,h,e,n),o=mr(a,l),t.classBindings=o}(r,s,t,i,o)}}(s,e,o,true),t!==pr&&ks(r,o,t)&&function(e,t,i,n,r,s,o,a){if(!(3&t.type))return;const l=e.data,h=l[a+1];oo(1==(1&h)?so(l,t,i,r,br(h),o):void 0)||(oo(s)||function(e){return 2==(2&e)}(h)&&(s=so(l,null,i,r,a,o)),function(e,t,i,n,r){const s=Me(e);r?s?e.addClass(i,n):i.classList.add(n):s?e.removeClass(i,n):i.classList.remove(n)}(n,0,He(bt(),i),r,s))}(s,s.data[bt()],r,r[11],e,r[o+1]=function(e,t){return null==e||"object"==typeof e&&(e=v(Bi(e))),e}(t),true,o)}(e,t),io}function no(e,t,i,n,r){let s=null;const o=i.directiveEnd;let a=i.directiveStylingLast;for(-1===a?a=i.directiveStart:a++;a<o&&(s=t[a],n=ro(n,s.hostAttrs,r),s!==e);)a++;return null!==e&&(i.directiveStylingLast=a),n}function ro(e,t,i){const n=i?1:2;let r=-1;if(null!==t)for(let s=0;s<t.length;s++){const o=t[s];"number"==typeof o?r=o:r===n&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),mi(e,o,!!i||t[++s]))}return void 0===e?null:e}function so(e,t,i,n,r,s){const o=null===t;let a;for(;r>0;){const t=e[r],s=Array.isArray(t),l=s?t[1]:t,h=null===l;let c=i[r+1];c===pr&&(c=h?Ks:void 0);let d=h?fi(c,n):l===n?c:void 0;if(s&&!oo(d)&&(d=fi(t,n)),oo(d)&&(a=d,o))return a;const p=e[r+1];r=o?fr(p):br(p)}if(null!==t){let e=s?t.residualClasses:t.residualStyles;null!=e&&(a=fi(e,n))}return a}function oo(e){return void 0!==e}function ao(e,t=""){const i=Ze(),n=$e(),r=e+ue,s=n.firstCreatePass?Cr(n,r,1,t,null):n.data[r],o=i[r]=function(e,t){return Me(e)?e.createText(t):e.createTextNode(t)}(i[11],t);Yn(n,i,o,s),Ke(s,!1)}function lo(e){return ho("",e,""),lo}function ho(e,t,i){const n=Ze(),r=function(e,t,i,n){return ks(e,rt(),i)?t+Ce(i)+n:pr}(n,e,t,i);return r!==pr&&os(n,bt(),r),ho}function co(e,t,i,n,r){const s=Ze(),o=function(e,t,i,n,r,s){const o=function(e,t,i,n){const r=ks(e,t,i);return ks(e,t+1,n)||r}(e,Ge.lFrame.bindingIndex,i,r);return st(2),o?t+Ce(i)+n+Ce(r)+s:pr}(s,e,t,i,n,r);return o!==pr&&os(s,bt(),o),co}function po(e,t,i){const n=Ze();return ks(n,rt(),t)&&kr($e(),wt(),n,e,t,n[11],i,!0),po}const uo=void 0;var go=["en",[["a","p"],["AM","PM"],uo],[["AM","PM"],uo,uo],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],uo,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],uo,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",uo,"{1} 'at' {0}",uo],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(e){let t=Math.floor(Math.abs(e)),i=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===i?1:5}];let mo={};function fo(e,t,i){"string"!=typeof t&&(i=t,t=e[xo.LocaleId]),t=t.toLowerCase().replace(/_/g,"-"),mo[t]=e,i&&(mo[t][xo.ExtraData]=i)}function yo(e){const t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e);let i=wo(t);if(i)return i;const n=t.split("-")[0];if(i=wo(n),i)return i;if("en"===n)return go;throw new Error(`Missing locale data for the locale "${e}".`)}function bo(e){return yo(e)[xo.CurrencyCode]||null}function vo(e){return yo(e)[xo.PluralCase]}function wo(e){return e in mo||(mo[e]=X.ng&&X.ng.common&&X.ng.common.locales&&X.ng.common.locales[e]),mo[e]}var xo=function(e){return e[e.LocaleId=0]="LocaleId",e[e.DayPeriodsFormat=1]="DayPeriodsFormat",e[e.DayPeriodsStandalone=2]="DayPeriodsStandalone",e[e.DaysFormat=3]="DaysFormat",e[e.DaysStandalone=4]="DaysStandalone",e[e.MonthsFormat=5]="MonthsFormat",e[e.MonthsStandalone=6]="MonthsStandalone",e[e.Eras=7]="Eras",e[e.FirstDayOfWeek=8]="FirstDayOfWeek",e[e.WeekendRange=9]="WeekendRange",e[e.DateFormat=10]="DateFormat",e[e.TimeFormat=11]="TimeFormat",e[e.DateTimeFormat=12]="DateTimeFormat",e[e.NumberSymbols=13]="NumberSymbols",e[e.NumberFormats=14]="NumberFormats",e[e.CurrencyCode=15]="CurrencyCode",e[e.CurrencySymbol=16]="CurrencySymbol",e[e.CurrencyName=17]="CurrencyName",e[e.Currencies=18]="Currencies",e[e.Directionality=19]="Directionality",e[e.PluralCase=20]="PluralCase",e[e.ExtraData=21]="ExtraData",e}({});const So="en-US";let Co=So;function Po(e){var t,i;i="Expected localeId to be defined",null==(t=e)&&function(e,t,i,n){throw new Error(`ASSERTION ERROR: ${e} [Expected=> null != ${t} <=Actual]`)}(i,t),"string"==typeof e&&(Co=e.toLowerCase().replace(/_/g,"-"))}function Oo(e,t,i,n,r){if(e=C(e),Array.isArray(e))for(let s=0;s<e.length;s++)Oo(e[s],t,i,n,r);else{const s=$e(),o=Ze();let a=Ss(e)?e:C(e.provide),l=vs(e);const h=Qe(),c=1048575&h.providerIndexes,d=h.directiveStart,p=h.providerIndexes>>20;if(Ss(e)||!e.multi){const n=new At(l,r,Ns),u=Ao(a,t,r?c:c+p,d);-1===u?(Vt(Bt(h,o),s,a),To(s,e,t.length),t.push(a),h.directiveStart++,h.directiveEnd++,r&&(h.providerIndexes+=1048576),i.push(n),o.push(n)):(i[u]=n,o[u]=n)}else{const u=Ao(a,t,c+p,d),g=Ao(a,t,c,c+p),m=u>=0&&i[u],f=g>=0&&i[g];if(r&&!f||!r&&!m){Vt(Bt(h,o),s,a);const c=function(e,t,i,n,r){const s=new At(e,i,Ns);return s.multi=[],s.index=t,s.componentProviders=0,Eo(s,r,n&&!i),s}(r?Do:Io,i.length,r,n,l);!r&&f&&(i[g].providerFactory=c),To(s,e,t.length,0),t.push(a),h.directiveStart++,h.directiveEnd++,r&&(h.providerIndexes+=1048576),i.push(c),o.push(c)}else To(s,e,u>-1?u:g,Eo(i[r?g:u],l,!r&&n));!r&&n&&f&&i[g].componentProviders++}}}function To(e,t,i,n){const r=Ss(t);if(r||t.useClass){const s=(t.useClass||t).prototype.ngOnDestroy;if(s){const o=e.destroyHooks||(e.destroyHooks=[]);if(!r&&t.multi){const e=o.indexOf(i);-1===e?o.push(i,[n,s]):o[e+1].push(n,s)}else o.push(i,s)}}}function Eo(e,t,i){return i&&e.componentProviders++,e.multi.push(t)-1}function Ao(e,t,i,n){for(let r=i;r<n;r++)if(t[r]===e)return r;return-1}function Io(e,t,i,n){return Ro(this.multi,[])}function Do(e,t,i,n){const r=this.multi;let s;if(this.providerFactory){const e=this.providerFactory.componentProviders,t=Jt(i,i[1],this.providerFactory.index,n);s=t.slice(0,e),Ro(r,s);for(let i=e;i<t.length;i++)s.push(t[i])}else s=[],Ro(r,s);return s}function Ro(e,t){for(let i=0;i<e.length;i++)t.push((0,e[i])());return t}function Lo(e,t=[]){return i=>{i.providersResolver=(i,n)=>function(e,t,i){const n=$e();if(n.firstCreatePass){const r=we(e);Oo(i,n.data,n.blueprint,r,!0),Oo(t,n.data,n.blueprint,r,!1)}}(i,n?n(e):e,t)}}class zo{}class Mo{resolveComponentFactory(e){throw function(e){const t=Error(`No component factory found for ${v(e)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=e,t}(e)}}let ko=(()=>{class e{}return e.NULL=new Mo,e})();function jo(...e){}function Ho(e,t){return new _o(Ne(e,t))}const No=function(){return Ho(Qe(),Ze())};let _o=(()=>{class e{constructor(e){this.nativeElement=e}}return e.__NG_ELEMENT_ID__=No,e})();function Bo(e){return e instanceof _o?e.nativeElement:e}class Wo{}let Uo=(()=>{class e{}return e.__NG_ELEMENT_ID__=()=>Fo(),e})();const Fo=function(){const e=Ze(),t=Be(Qe().index,e);return function(e){return e[11]}(me(t)?t:e)};let Vo=(()=>{class e{}return e.\u0275prov=O({token:e,providedIn:"root",factory:()=>null}),e})();class Xo{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const Yo=new Xo("11.1.2");class Go{constructor(){}supports(e){return zs(e)}create(e){return new Zo(e)}}const qo=(e,t)=>t;class Zo{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||qo}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,n=0,r=null;for(;t||i;){const s=!i||t&&t.currentIndex<Ko(i,n,r)?t:i,o=Ko(s,n,r),a=s.currentIndex;if(s===i)n--,i=i._nextRemoved;else if(t=t._next,null==s.previousIndex)n++;else{r||(r=[]);const e=o-n,t=a-n;if(e!=t){for(let i=0;i<e;i++){const n=i<r.length?r[i]:r[i]=0,s=n+i;t<=s&&s<e&&(r[i]=n+1)}r[s.previousIndex]=t-e}}o!==a&&e(s,o,a)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!zs(e))throw new Error(`Error trying to diff '${v(e)}'. Only arrays and iterables are allowed`);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t,i,n,r=this._itHead,s=!1;if(Array.isArray(e)){this.length=e.length;for(let t=0;t<this.length;t++)i=e[t],n=this._trackByFn(t,i),null!==r&&Object.is(r.trackById,n)?(s&&(r=this._verifyReinsertion(r,i,n,t)),Object.is(r.item,i)||this._addIdentityChange(r,i)):(r=this._mismatch(r,i,n,t),s=!0),r=r._next}else t=0,function(e,t){if(Array.isArray(e))for(let i=0;i<e.length;i++)t(e[i]);else{const i=e[Ls()]();let n;for(;!(n=i.next()).done;)t(n.value)}}(e,e=>{n=this._trackByFn(t,e),null!==r&&Object.is(r.trackById,n)?(s&&(r=this._verifyReinsertion(r,e,n,t)),Object.is(r.item,e)||this._addIdentityChange(r,e)):(r=this._mismatch(r,e,n,t),s=!0),r=r._next,t++}),this.length=t;return this._truncate(r),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,n){let r;return null===e?r=this._itTail:(r=e._prev,this._remove(e)),null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,n))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,r,n)):null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,r,n)):e=this._addAfter(new $o(t,i),r,n),e}_verifyReinsertion(e,t,i,n){let r=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==r?e=this._reinsertAfter(r,e._prev,n):e.currentIndex!=n&&(e.currentIndex=n,this._addToMoves(e,n)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const n=e._prevRemoved,r=e._nextRemoved;return null===n?this._removalsHead=r:n._nextRemoved=r,null===r?this._removalsTail=n:r._prevRemoved=n,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const n=null===t?this._itHead:t._next;return e._next=n,e._prev=t,null===n?this._itTail=e:n._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new Jo),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Jo),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class $o{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Qo{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class Jo{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new Qo,this.map.set(t,i)),i.add(e)}get(e,t){const i=this.map.get(e);return i?i.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Ko(e,t,i){const n=e.previousIndex;if(null===n)return n;let r=0;return i&&n<i.length&&(r=i[n]),n+t+r}class ea{constructor(){}supports(e){return e instanceof Map||Ms(e)}create(){return new ta}}class ta{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||Ms(e)))throw new Error(`Error trying to diff '${v(e)}'. Only maps and objects are allowed`)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(e,i)=>{if(t&&t.key===i)this._maybeAddToChanges(t,e),this._appendAfter=t,t=t._next;else{const n=this._getOrCreateRecordForKey(i,e);t=this._insertBeforeOrAppend(t,n)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let e=t;null!==e;e=e._nextRemoved)e===this._mapHead&&(this._mapHead=null),this._records.delete(e.key),e._nextRemoved=e._next,e.previousValue=e.currentValue,e.currentValue=null,e._prev=null,e._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const i=this._records.get(e);this._maybeAddToChanges(i,t);const n=i._prev,r=i._next;return n&&(n._next=r),r&&(r._prev=n),i._next=null,i._prev=null,i}const i=new ia(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class ia{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function na(){return new ra([new Go])}let ra=(()=>{class e{constructor(e){this.factories=e}static create(t,i){if(null!=i){const e=i.factories.slice();t=t.concat(e)}return new e(t)}static extend(t){return{provide:e,useFactory:i=>e.create(t,i||na()),deps:[[e,new Di,new Ii]]}}find(e){const t=this.factories.find(t=>t.supports(e));if(null!=t)return t;throw new Error(`Cannot find a differ supporting object '${e}' of type '${i=e,i.name||typeof i}'`);var i}}return e.\u0275prov=O({token:e,providedIn:"root",factory:na}),e})();function sa(){return new oa([new ea])}let oa=(()=>{class e{constructor(e){this.factories=e}static create(t,i){if(i){const e=i.factories.slice();t=t.concat(e)}return new e(t)}static extend(t){return{provide:e,useFactory:i=>e.create(t,i||sa()),deps:[[e,new Di,new Ii]]}}find(e){const t=this.factories.find(t=>t.supports(e));if(t)return t;throw new Error(`Cannot find a differ supporting object '${e}'`)}}return e.\u0275prov=O({token:e,providedIn:"root",factory:sa}),e})();function aa(e,t,i,n,r=!1){for(;null!==i;){const s=t[i.index];if(null!==s&&n.push(je(s)),fe(s))for(let e=ge;e<s.length;e++){const t=s[e],i=t[1].firstChild;null!==i&&aa(t[1],t,i,n)}const o=i.type;if(8&o)aa(e,t,i.child,n);else if(32&o){const e=An(i,t);let r;for(;r=e();)n.push(r)}else if(16&o){const e=t[16],r=e[6].projection[i.projection];if(Array.isArray(r))n.push(...r);else{const t=In(e);aa(t[1],t,r,n,!0)}}i=r?i.projectionNext:i.next}return n}class la{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return aa(t,e,t.firstChild,[])}get context(){return this._lView[8]}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(fe(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(jn(e,i),ui(t,i))}this._attachedToViewContainer=!1}Hn(this._lView[1],this._lView)}onDestroy(e){zr(this._lView[1],this._lView,null,e)}markForCheck(){Qr(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){Jr(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(e,t,i){nt(!0);try{Jr(e,t,i)}finally{nt(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){var e;this._appRef=null,$n(this._lView[1],e=this._lView,e[11],2,null,null)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}class ha extends la{constructor(e){super(e),this._view=e}detectChanges(){Kr(this._view)}checkNoChanges(){!function(e){nt(!0);try{Kr(e)}finally{nt(!1)}}(this._view)}get context(){return null}}const ca=pa;let da=(()=>{class e{}return e.__NG_ELEMENT_ID__=ca,e.__ChangeDetectorRef__=!0,e})();function pa(e=!1){return function(e,t,i){if(!i&&be(e)){const i=Be(e.index,t);return new la(i,i)}return 47&e.type?new la(t[16],t):null}(Qe(),Ze(),e)}const ua=[new ea],ga=new ra([new Go]),ma=new oa(ua),fa=function(){return wa(Qe(),Ze())};let ya=(()=>{class e{}return e.__NG_ELEMENT_ID__=fa,e})();const ba=ya,va=class extends ba{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}createEmbeddedView(e){const t=this._declarationTContainer.tViews,i=Sr(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const n=this._declarationLView[19];return null!==n&&(i[19]=n.createEmbeddedView(t)),Or(t,i,e),new la(i)}};function wa(e,t){return 4&e.type?new va(t,e,Ho(e,t)):null}class xa{}class Sa{}const Ca=function(){return Ia(Qe(),Ze())};let Pa=(()=>{class e{}return e.__NG_ELEMENT_ID__=Ca,e})();const Oa=Pa,Ta=class extends Oa{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return Ho(this._hostTNode,this._hostLView)}get injector(){return new ti(this._hostTNode,this._hostLView)}get parentInjector(){const e=Ft(this._hostTNode,this._hostLView);if(Mt(e)){const t=jt(e,this._hostLView),i=kt(e);return new ti(t[1].data[i+8],t)}return new ti(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=Ea(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-ge}createEmbeddedView(e,t,i){const n=e.createEmbeddedView(t||{});return this.insert(n,i),n}createComponent(e,t,i,n,r){const s=i||this.parentInjector;if(!r&&null==e.ngModule&&s){const e=s.get(xa,null);e&&(r=e)}const o=e.create(s,n,void 0,r);return this.insert(o.hostView,t),o}insert(e,t){const i=e._lView,n=i[1];if(fe(i[3])){const t=this.indexOf(e);if(-1!==t)this.detach(t);else{const t=i[3],n=new Ta(t,t[6],t[3]);n.detach(n.indexOf(e))}}const r=this._adjustIndex(t),s=this._lContainer;!function(e,t,i,n){const r=ge+n,s=i.length;n>0&&(i[r-1][4]=t),n<s-ge?(t[4]=i[r],pi(i,ge+n,t)):(i.push(t),t[4]=null),t[3]=i;const o=t[17];null!==o&&i!==o&&function(e,t){const i=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===i?e[9]=[t]:i.push(t)}(o,t);const a=t[19];null!==a&&a.insertView(e),t[2]|=128}(n,i,s,r);const o=qn(r,s),a=i[11],l=Fn(a,s[7]);return null!==l&&function(e,t,i,n,r,s){n[0]=r,n[6]=t,$n(e,n,i,1,r,s)}(n,s[6],a,i,l,o),e.attachToViewContainerRef(),pi(Aa(s),r,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=Ea(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=jn(this._lContainer,t);i&&(ui(Aa(this._lContainer),t),Hn(i[1],i))}detach(e){const t=this._adjustIndex(e,-1),i=jn(this._lContainer,t);return i&&null!=ui(Aa(this._lContainer),t)?new la(i):null}_adjustIndex(e,t=0){return null==e?this.length+t:e}};function Ea(e){return e[8]}function Aa(e){return e[8]||(e[8]=[])}function Ia(e,t){let i;const n=t[e.index];if(fe(n))i=n;else{let r;if(8&e.type)r=je(n);else{const i=t[11];r=i.createComment("");const n=Ne(e,t);Bn(i,Fn(i,n),r,function(e,t){return Me(e)?e.nextSibling(t):t.nextSibling}(i,n),!1)}t[e.index]=i=Yr(n,t,r,e),$r(t,i)}return new Ta(i,e,t)}const Da={};class Ra extends ko{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=de(e);return new Ma(t,this.ngModule)}}function La(e){const t=[];for(let i in e)e.hasOwnProperty(i)&&t.push({propName:e[i],templateName:i});return t}const za=new ai("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>On});class Ma extends zo{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=e.selectors.map(dr).join(","),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return La(this.componentDef.inputs)}get outputs(){return La(this.componentDef.outputs)}create(e,t,i,n){const r=(n=n||this.ngModule)?function(e,t){return{get:(i,n,r)=>{const s=e.get(i,Da,r);return s!==Da||n===Da?s:t.get(i,n,r)}}}(e,n.injector):e,s=r.get(Wo,ke),o=r.get(Vo,null),a=s.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",h=i?function(e,t,i){if(Me(e))return e.selectRootElement(t,i===B.ShadowDom);let n="string"==typeof t?e.querySelector(t):t;return n.textContent="",n}(a,i,this.componentDef.encapsulation):Mn(s.createRenderer(null,this.componentDef),l,function(e){const t=e.toLowerCase();return"svg"===t?"http://www.w3.org/2000/svg":"math"===t?"http://www.w3.org/1998/MathML/":null}(l)),c=this.componentDef.onPush?576:528,d={components:[],scheduler:On,clean:ts,playerHandler:null,flags:0},p=Lr(0,null,null,1,0,null,null,null,null,null),u=Sr(null,p,d,c,null,null,s,a,o,r);let g,m;pt(u);try{const e=function(e,t,i,n,r,s){const o=i[1];i[20]=e;const a=Cr(o,20,2,"#host",null),l=a.mergedAttrs=t.hostAttrs;null!==l&&(as(a,l,!0),null!==e&&(It(r,e,l),null!==a.classes&&Kn(r,e,a.classes),null!==a.styles&&Jn(r,e,a.styles)));const h=n.createRenderer(e,t),c=Sr(i,Rr(t),null,t.onPush?64:16,i[20],a,n,h,null,null);return o.firstCreatePass&&(Vt(Bt(a,i),o,t.type),_r(o,a),Wr(a,i.length,1)),$r(i,c),i[20]=c}(h,this.componentDef,u,s,a);if(h)if(i)It(a,h,["ng-version",Yo.full]);else{const{attrs:e,classes:t}=function(e){const t=[],i=[];let n=1,r=2;for(;n<e.length;){let s=e[n];if("string"==typeof s)2===r?""!==s&&t.push(s,e[++n]):8===r&&i.push(s);else{if(!or(r))break;r=s}n++}return{attrs:t,classes:i}}(this.componentDef.selectors[0]);e&&It(a,h,e),t&&t.length>0&&Kn(a,h,t.join(" "))}if(m=_e(p,ue),void 0!==t){const e=m.projection=[];for(let i=0;i<this.ngContentSelectors.length;i++){const n=t[i];e.push(null!=n?Array.from(n):null)}}g=function(e,t,i,n,r){const s=i[1],o=function(e,t,i){const n=Qe();e.firstCreatePass&&(i.providersResolver&&i.providersResolver(i),Ur(e,n,t,Pr(e,t,1,null),i));const r=Jt(t,e,n.directiveStart,n);Pn(r,t);const s=Ne(n,t);return s&&Pn(s,t),r}(s,i,t);if(n.components.push(o),e[8]=o,r&&r.forEach(e=>e(o,t)),t.contentQueries){const e=Qe();t.contentQueries(1,o,e.directiveStart)}const a=Qe();return!s.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(vt(a.index),Hr(i[1],a,0,a.directiveStart,a.directiveEnd,t),Nr(t,o)),o}(e,this.componentDef,u,d,[Os]),Or(p,u,null)}finally{yt()}return new ka(this.componentType,g,Ho(m,u),u,m)}}class ka extends class{}{constructor(e,t,i,n,r){super(),this.location=i,this._rootLView=n,this._tNode=r,this.instance=t,this.hostView=this.changeDetectorRef=new ha(n),this.componentType=e}get injector(){return new ti(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}const ja=new Map;class Ha extends xa{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new Ra(this);const i=pe(e),n=e[J]||null;n&&Po(n),this._bootstrapComponents=Tn(i.bootstrap),this._r3Injector=fs(e,t,[{provide:xa,useValue:this},{provide:ko,useValue:this.componentFactoryResolver}],v(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=Ps.THROW_IF_NOT_FOUND,i=M.Default){return e===Ps||e===xa||e===ls?this:this._r3Injector.get(e,t,i)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class Na extends Sa{constructor(e){super(),this.moduleType=e,null!==pe(e)&&function(e){const t=new Set;!function e(i){const n=pe(i,!0),r=n.id;null!==r&&(function(e,t,i){if(t&&t!==i)throw new Error(`Duplicate module registered for ${e} - ${v(t)} vs ${v(t.name)}`)}(r,ja.get(r),i),ja.set(r,i));const s=Tn(n.imports);for(const o of s)t.has(o)||(t.add(o),e(o))}(e)}(e)}create(e){return new Ha(this.moduleType,e)}}const _a=class extends n.a{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){let n,s=e=>null,o=()=>null;e&&"object"==typeof e?(n=this.__isAsync?t=>{setTimeout(()=>e.next(t))}:t=>{e.next(t)},e.error&&(s=this.__isAsync?t=>{setTimeout(()=>e.error(t))}:t=>{e.error(t)}),e.complete&&(o=this.__isAsync?()=>{setTimeout(()=>e.complete())}:()=>{e.complete()})):(n=this.__isAsync?t=>{setTimeout(()=>e(t))}:t=>{e(t)},t&&(s=this.__isAsync?e=>{setTimeout(()=>t(e))}:e=>{t(e)}),i&&(o=this.__isAsync?()=>{setTimeout(()=>i())}:()=>{i()}));const a=super.subscribe(n,s,o);return e instanceof r.a&&e.add(a),a}};function Ba(){return this._results[Ls()]()}class Wa{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Ls(),i=Wa.prototype;i[t]||(i[t]=Ba)}get changes(){return this._changes||(this._changes=new _a)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const n=ci(e);(this._changesDetected=!function(e,t,i){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++){let r=e[n],s=t[n];if(i&&(r=i(r),s=i(s)),s!==r)return!1}return!0}(i._results,n,t))&&(i._results=n,i.length=n.length,i.last=n[this.length-1],i.first=n[0])}notifyOnChanges(){!this._changes||!this._changesDetected&&this._emitDistinctChangesOnly||this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}class Ua{constructor(e){this.queryList=e,this.matches=null}clone(){return new Ua(this.queryList)}setDirty(){this.queryList.setDirty()}}class Fa{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,n=[];for(let e=0;e<i;e++){const i=t.getByIndex(e);n.push(this.queries[i.indexInDeclarationView].clone())}return new Fa(n)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==nl(e,t).matches&&this.queries[t].setDirty()}}class Va{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class Xa{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const n=null!==t?t.length:0,r=this.getByIndex(i).embeddedTView(e,n);r&&(r.indexInDeclarationView=i,null!==t?t.push(r):t=[r])}return null!==t?new Xa(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class Ya{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new Ya(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let n=0;n<i.length;n++){const r=i[n];this.matchTNodeWithReadOption(e,t,Ga(t,r)),this.matchTNodeWithReadOption(e,t,Qt(t,e,r,!1,!1))}else i===ya?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Qt(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const n=this.metadata.read;if(null!==n)if(n===_o||n===Pa||n===ya&&4&t.type)this.addMatch(t.index,-2);else{const i=Qt(t,e,n,!1,!1);null!==i&&this.addMatch(t.index,i)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function Ga(e,t){const i=e.localNames;if(null!==i)for(let n=0;n<i.length;n+=2)if(i[n]===t)return i[n+1];return null}function qa(e,t,i,n){return-1===i?function(e,t){return 11&e.type?Ho(e,t):4&e.type?wa(e,t):null}(t,e):-2===i?function(e,t,i){return i===_o?Ho(t,e):i===ya?wa(t,e):i===Pa?Ia(t,e):void 0}(e,t,n):Jt(e,e[1],i,t)}function Za(e,t,i,n){const r=t[19].queries[n];if(null===r.matches){const n=e.data,s=i.matches,o=[];for(let e=0;e<s.length;e+=2){const r=s[e];o.push(r<0?null:qa(t,n[r],s[e+1],i.metadata.read))}r.matches=o}return r.matches}function $a(e,t,i,n){const r=e.queries.getByIndex(i),s=r.matches;if(null!==s){const o=Za(e,t,r,i);for(let e=0;e<s.length;e+=2){const i=s[e];if(i>0)n.push(o[e/2]);else{const r=s[e+1],o=t[-i];for(let e=ge;e<o.length;e++){const t=o[e];t[17]===t[3]&&$a(t[1],t,r,n)}if(null!==o[9]){const e=o[9];for(let t=0;t<e.length;t++){const i=e[t];$a(i[1],i,r,n)}}}}}return n}function Qa(e){const t=Ze(),i=$e(),n=lt();ht(n+1);const r=nl(i,n);if(e.dirty&&Ue(t)===(2==(2&r.metadata.flags))){if(null===r.matches)e.reset([]);else{const s=r.crossesNgTemplate?$a(i,t,n,[]):Za(i,t,r,n);e.reset(s,Bo),e.notifyOnChanges()}return!0}return!1}function Ja(e,t,i){const n=$e();n.firstCreatePass&&(il(n,new Va(e,t,i),-1),2==(2&t)&&(n.staticViewQueries=!0)),tl(n,Ze(),t)}function Ka(e,t,i,n){const r=$e();if(r.firstCreatePass){const s=Qe();il(r,new Va(t,i,n),s.index),function(e,t){const i=e.contentQueries||(e.contentQueries=[]);t!==(i.length?i[i.length-1]:-1)&&i.push(e.queries.length-1,t)}(r,e),2==(2&i)&&(r.staticContentQueries=!0)}tl(r,Ze(),i)}function el(){return e=Ze(),t=lt(),e[19].queries[t].queryList;var e,t}function tl(e,t,i){const n=new Wa(4==(4&i));zr(e,t,n,n.destroy),null===t[19]&&(t[19]=new Fa),t[19].queries.push(new Ua(n))}function il(e,t,i){null===e.queries&&(e.queries=new Xa),e.queries.track(new Ya(t,i))}function nl(e,t){return e.queries.getByIndex(t)}function rl(e=M.Default){const t=pa(!0);if(null!=t||e&M.Optional)return t;Oe("ChangeDetectorRef")}const sl=new ai("Application Initializer");let ol=(()=>{class e{constructor(e){this.appInits=e,this.resolve=jo,this.reject=jo,this.initialized=!1,this.done=!1,this.donePromise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}runInitializers(){if(this.initialized)return;const e=[],t=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let i=0;i<this.appInits.length;i++){const t=this.appInits[i]();Vs(t)&&e.push(t)}Promise.all(e).then(()=>{t()}).catch(e=>{this.reject(e)}),0===e.length&&t(),this.initialized=!0}}return e.\u0275fac=function(t){return new(t||e)(Oi(sl,8))},e.\u0275prov=O({token:e,factory:e.\u0275fac}),e})();const al=new ai("AppId"),ll={provide:al,useFactory:function(){return`${hl()}${hl()}${hl()}`},deps:[]};function hl(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const cl=new ai("Platform Initializer"),dl=new ai("Platform ID"),pl=new ai("appBootstrapListener");let ul=(()=>{class e{log(e){console.log(e)}warn(e){console.warn(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=O({token:e,factory:e.\u0275fac}),e})();const gl=new ai("LocaleId"),ml=new ai("DefaultCurrencyCode");class fl{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}const yl=function(e){return new Na(e)},bl=yl,vl=function(e){return Promise.resolve(yl(e))},wl=function(e){const t=yl(e),i=Tn(pe(e).declarations).reduce((e,t)=>{const i=de(t);return i&&e.push(new Ma(i)),e},[]);return new fl(t,i)},xl=wl,Sl=function(e){return Promise.resolve(wl(e))};let Cl=(()=>{class e{constructor(){this.compileModuleSync=bl,this.compileModuleAsync=vl,this.compileModuleAndAllComponentsSync=xl,this.compileModuleAndAllComponentsAsync=Sl}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=O({token:e,factory:e.\u0275fac}),e})();const Pl=(()=>Promise.resolve(0))();function Ol(e){"undefined"==typeof Zone?Pl.then(()=>{e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}class Tl{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new _a(!1),this.onMicrotaskEmpty=new _a(!1),this.onStable=new _a(!1),this.onError=new _a(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const n=this;n._nesting=0,n._outer=n._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(n._inner=n._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(n._inner=n._inner.fork(Zone.longStackTraceZoneSpec)),n.shouldCoalesceEventChangeDetection=!i&&t,n.shouldCoalesceRunChangeDetection=i,n.lastRequestAnimationFrameId=-1,n.nativeRequestAnimationFrame=function(){let e=X.requestAnimationFrame,t=X.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i);const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function(e){const t=()=>{!function(e){-1===e.lastRequestAnimationFrameId&&(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(X,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,Il(e),Al(e)},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),Il(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(i,n,r,s,o,a)=>{try{return Dl(e),i.invokeTask(r,s,o,a)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||e.shouldCoalesceRunChangeDetection)&&t(),Rl(e)}},onInvoke:(i,n,r,s,o,a,l)=>{try{return Dl(e),i.invoke(r,s,o,a,l)}finally{e.shouldCoalesceRunChangeDetection&&t(),Rl(e)}},onHasTask:(t,i,n,r)=>{t.hasTask(n,r),i===n&&("microTask"==r.change?(e._hasPendingMicrotasks=r.microTask,Il(e),Al(e)):"macroTask"==r.change&&(e.hasPendingMacrotasks=r.macroTask))},onHandleError:(t,i,n,r)=>(t.handleError(n,r),e.runOutsideAngular(()=>e.onError.emit(r)),!1)})}(n)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Tl.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Tl.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,n){const r=this._inner,s=r.scheduleEventTask("NgZoneEvent: "+n,e,El,jo,jo);try{return r.runTask(s,t,i)}finally{r.cancelTask(s)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const El={};function Al(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function Il(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function Dl(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function Rl(e){e._nesting--,Al(e)}class Ll{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new _a,this.onMicrotaskEmpty=new _a,this.onStable=new _a,this.onError=new _a}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,n){return e.apply(t,i)}}let zl=(()=>{class e{constructor(e){this._ngZone=e,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Tl.assertNotInAngularZone(),Ol(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Ol(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(t=>!t.updateCb||!t.updateCb(e)||(clearTimeout(t.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,t,i){let n=-1;t&&t>0&&(n=setTimeout(()=>{this._callbacks=this._callbacks.filter(e=>e.timeoutId!==n),e(this._didWork,this.getPendingTasks())},t)),this._callbacks.push({doneCb:e,timeoutId:n,updateCb:i})}whenStable(e,t,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(e,t,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(e,t,i){return[]}}return e.\u0275fac=function(t){return new(t||e)(Oi(Tl))},e.\u0275prov=O({token:e,factory:e.\u0275fac}),e})(),Ml=(()=>{class e{constructor(){this._applications=new Map,Nl.addToWindow(this)}registerApplication(e,t){this._applications.set(e,t)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,t=!0){return Nl.findTestabilityInTree(this,e,t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=O({token:e,factory:e.\u0275fac}),e})();class kl{addToWindow(e){}findTestabilityInTree(e,t,i){return null}}function jl(e){Nl=e}let Hl,Nl=new kl,_l=!0,Bl=!1;function Wl(){return Bl=!0,_l}function Ul(){if(Bl)throw new Error("Cannot enable prod mode after platform setup.");_l=!1}const Fl=new ai("AllowMultipleToken");class Vl{constructor(e,t){this.name=e,this.token=t}}function Xl(e,t,i=[]){const n=`Platform: ${t}`,r=new ai(n);return(t=[])=>{let s=Yl();if(!s||s.injector.get(Fl,!1))if(e)e(i.concat(t).concat({provide:r,useValue:!0}));else{const e=i.concat(t).concat({provide:r,useValue:!0},{provide:cs,useValue:"platform"});!function(e){if(Hl&&!Hl.destroyed&&!Hl.injector.get(Fl,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Hl=e.get(Gl);const t=e.get(cl,null);t&&t.forEach(e=>e())}(Ps.create({providers:e,name:n}))}return function(e){const t=Yl();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(r)}}function Yl(){return Hl&&!Hl.destroyed?Hl:null}let Gl=(()=>{class e{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,t){const i=function(e,t){let i;return i="noop"===e?new Ll:("zone.js"===e?void 0:e)||new Tl({enableLongStackTrace:Wl(),shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)}),i}(t?t.ngZone:void 0,{ngZoneEventCoalescing:t&&t.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:t&&t.ngZoneRunCoalescing||!1}),n=[{provide:Tl,useValue:i}];return i.run(()=>{const t=Ps.create({providers:n,parent:this.injector,name:e.moduleType.name}),r=e.create(t),s=r.injector.get(Cn,null);if(!s)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return i.runOutsideAngular(()=>{const e=i.onError.subscribe({next:e=>{s.handleError(e)}});r.onDestroy(()=>{$l(this._modules,r),e.unsubscribe()})}),function(e,t,i){try{const n=i();return Vs(n)?n.catch(i=>{throw t.runOutsideAngular(()=>e.handleError(i)),i}):n}catch(n){throw t.runOutsideAngular(()=>e.handleError(n)),n}}(s,i,()=>{const e=r.injector.get(ol);return e.runInitializers(),e.donePromise.then(()=>(Po(r.injector.get(gl,So)||So),this._moduleDoBootstrap(r),r))})})}bootstrapModule(e,t=[]){const i=ql({},t);return function(e,t,i){const n=new Na(i);return Promise.resolve(n)}(0,0,e).then(e=>this.bootstrapModuleFactory(e,i))}_moduleDoBootstrap(e){const t=e.injector.get(Zl);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(e=>t.bootstrap(e));else{if(!e.instance.ngDoBootstrap)throw new Error(`The module ${v(e.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);e.instance.ngDoBootstrap(t)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(e=>e.destroy()),this._destroyListeners.forEach(e=>e()),this._destroyed=!0}get destroyed(){return this._destroyed}}return e.\u0275fac=function(t){return new(t||e)(Oi(Ps))},e.\u0275prov=O({token:e,factory:e.\u0275fac}),e})();function ql(e,t){return Array.isArray(t)?t.reduce(ql,e):Object.assign(Object.assign({},e),t)}let Zl=(()=>{class e{constructor(e,t,i,n,r,h){this._zone=e,this._console=t,this._injector=i,this._exceptionHandler=n,this._componentFactoryResolver=r,this._initStatus=h,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const d=new s.a(e=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{e.next(this._stable),e.complete()})}),p=new s.a(e=>{let t;this._zone.runOutsideAngular(()=>{t=this._zone.onStable.subscribe(()=>{Tl.assertNotInAngularZone(),Ol(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,e.next(!0))})})});const i=this._zone.onUnstable.subscribe(()=>{Tl.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{e.next(!1)}))});return()=>{t.unsubscribe(),i.unsubscribe()}});this.isStable=function(...e){let t=Number.POSITIVE_INFINITY,i=null,n=e[e.length-1];return Object(o.a)(n)?(i=e.pop(),e.length>1&&"number"==typeof e[e.length-1]&&(t=e.pop())):"number"==typeof n&&(t=e.pop()),null===i&&1===e.length&&e[0]instanceof s.a?e[0]:Object(a.a)(t)(Object(l.a)(e,i))}(d,p.pipe(e=>{return c()((t=f,function(e){let i;i="function"==typeof t?t:function(){return t};const n=Object.create(e,g);return n.source=e,n.subjectFactory=i,n})(e));var t}))}bootstrap(e,t){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let i;i=e instanceof zo?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(i.componentType);const n=i.isBoundToModule?void 0:this._injector.get(xa),r=i.create(Ps.NULL,[],t||i.selector,n),s=r.location.nativeElement,o=r.injector.get(zl,null),a=o&&r.injector.get(Ml);return o&&a&&a.registerApplication(s,o),r.onDestroy(()=>{this.detachView(r.hostView),$l(this.components,r),a&&a.unregisterApplication(s)}),this._loadComponent(r),Wl()&&this._console.log("Angular is running in development mode. Call enableProdMode() to enable production mode."),r}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const t=e;this._views.push(t),t.attachToAppRef(this)}detachView(e){const t=e;$l(this._views,t),t.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(pl,[]).concat(this._bootstrapListeners).forEach(t=>t(e))}ngOnDestroy(){this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return e.\u0275fac=function(t){return new(t||e)(Oi(Tl),Oi(ul),Oi(Ps),Oi(Cn),Oi(ko),Oi(ol))},e.\u0275prov=O({token:e,factory:e.\u0275fac}),e})();function $l(e,t){const i=e.indexOf(t);i>-1&&e.splice(i,1)}class Ql{}class Jl{}const Kl={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};let eh=(()=>{class e{constructor(e,t){this._compiler=e,this._config=t||Kl}load(e){return this.loadAndCompile(e)}loadAndCompile(e){let[t,n]=e.split("#");return void 0===n&&(n="default"),i("zn8P")(t).then(e=>e[n]).then(e=>th(e,t,n)).then(e=>this._compiler.compileModuleAsync(e))}loadFactory(e){let[t,n]=e.split("#"),r="NgFactory";return void 0===n&&(n="default",r=""),i("zn8P")(this._config.factoryPathPrefix+t+this._config.factoryPathSuffix).then(e=>e[n+r]).then(e=>th(e,t,n))}}return e.\u0275fac=function(t){return new(t||e)(Oi(Cl),Oi(Jl,8))},e.\u0275prov=O({token:e,factory:e.\u0275fac}),e})();function th(e,t,i){if(!e)throw new Error(`Cannot find '${i}' in '${t}'`);return e}const ih=function(e){return null},nh=Xl(null,"core",[{provide:dl,useValue:"unknown"},{provide:Gl,deps:[Ps]},{provide:Ml,deps:[]},{provide:ul,deps:[]}]),rh=[{provide:Zl,useClass:Zl,deps:[Tl,ul,Ps,Cn,ko,ol]},{provide:za,deps:[Tl],useFactory:function(e){let t=[];return e.onStable.subscribe(()=>{for(;t.length;)t.pop()()}),function(e){t.push(e)}}},{provide:ol,useClass:ol,deps:[[new Ii,sl]]},{provide:Cl,useClass:Cl,deps:[]},ll,{provide:ra,useFactory:function(){return ga},deps:[]},{provide:oa,useFactory:function(){return ma},deps:[]},{provide:gl,useFactory:function(e){return Po(e=e||"undefined"!=typeof $localize&&$localize.locale||So),e},deps:[[new Ai(gl),new Ii,new Di]]},{provide:ml,useValue:"USD"}];let sh=(()=>{class e{constructor(e){}}return e.\u0275mod=oe({type:e}),e.\u0275inj=T({factory:function(t){return new(t||e)(Oi(Zl))},providers:rh}),e})()},"9ppp":function(e,t,i){"use strict";i.d(t,"a",function(){return n});const n=(()=>{function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e})()},AytR:function(e,t,i){"use strict";i.d(t,"a",function(){return n});const n={production:!0,urlStates:""}},Cfvw:function(e,t,i){"use strict";i.d(t,"a",function(){return d});var n=i("HDdC"),r=i("SeVD"),s=i("quSY"),o=i("kJWO"),a=i("jZKg"),l=i("Lhse"),h=i("c2HN"),c=i("I55L");function d(e,t){return t?function(e,t){if(null!=e){if(function(e){return e&&"function"==typeof e[o.a]}(e))return function(e,t){return new n.a(i=>{const n=new s.a;return n.add(t.schedule(()=>{const r=e[o.a]();n.add(r.subscribe({next(e){n.add(t.schedule(()=>i.next(e)))},error(e){n.add(t.schedule(()=>i.error(e)))},complete(){n.add(t.schedule(()=>i.complete()))}}))})),n})}(e,t);if(Object(h.a)(e))return function(e,t){return new n.a(i=>{const n=new s.a;return n.add(t.schedule(()=>e.then(e=>{n.add(t.schedule(()=>{i.next(e),n.add(t.schedule(()=>i.complete()))}))},e=>{n.add(t.schedule(()=>i.error(e)))}))),n})}(e,t);if(Object(c.a)(e))return Object(a.a)(e,t);if(function(e){return e&&"function"==typeof e[l.a]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new n.a(i=>{const n=new s.a;let r;return n.add(()=>{r&&"function"==typeof r.return&&r.return()}),n.add(t.schedule(()=>{r=e[l.a](),n.add(t.schedule(function(){if(i.closed)return;let e,t;try{const i=r.next();e=i.value,t=i.done}catch(n){return void i.error(n)}t?i.complete():(i.next(e),this.schedule())}))})),n})}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}(e,t):e instanceof n.a?e:new n.a(Object(r.a)(e))}},DH7j:function(e,t,i){"use strict";i.d(t,"a",function(){return n});const n=(()=>Array.isArray||(e=>e&&"number"==typeof e.length))()},HDdC:function(e,t,i){"use strict";i.d(t,"a",function(){return h});var n=i("7o/Q"),r=i("2QA8"),s=i("gRHU"),o=i("kJWO"),a=i("SpAZ"),l=i("2fFW");let h=(()=>{class e{constructor(e){this._isScalar=!1,e&&(this._subscribe=e)}lift(t){const i=new e;return i.source=this,i.operator=t,i}subscribe(e,t,i){const{operator:o}=this,a=function(e,t,i){if(e){if(e instanceof n.a)return e;if(e[r.a])return e[r.a]()}return e||t||i?new n.a(e,t,i):new n.a(s.a)}(e,t,i);if(a.add(o?o.call(a,this.source):this.source||l.a.useDeprecatedSynchronousErrorHandling&&!a.syncErrorThrowable?this._subscribe(a):this._trySubscribe(a)),l.a.useDeprecatedSynchronousErrorHandling&&a.syncErrorThrowable&&(a.syncErrorThrowable=!1,a.syncErrorThrown))throw a.syncErrorValue;return a}_trySubscribe(e){try{return this._subscribe(e)}catch(t){l.a.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){const{closed:t,destination:i,isStopped:r}=e;if(t||r)return!1;e=i&&i instanceof n.a?i:null}return!0}(e)?e.error(t):console.warn(t)}}forEach(e,t){return new(t=c(t))((t,i)=>{let n;n=this.subscribe(t=>{try{e(t)}catch(r){i(r),n&&n.unsubscribe()}},i,t)})}_subscribe(e){const{source:t}=this;return t&&t.subscribe(e)}[o.a](){return this}pipe(...e){return 0===e.length?this:(0===(t=e).length?a.a:1===t.length?t[0]:function(e){return t.reduce((e,t)=>t(e),e)})(this);var t}toPromise(e){return new(e=c(e))((e,t)=>{let i;this.subscribe(e=>i=e,e=>t(e),()=>e(i))})}}return e.create=t=>new e(t),e})();function c(e){if(e||(e=l.a.Promise||Promise),!e)throw new Error("no Promise impl found");return e}},I55L:function(e,t,i){"use strict";i.d(t,"a",function(){return n});const n=e=>e&&"number"==typeof e.length&&"function"!=typeof e},IheW:function(e,t,i){"use strict";i.d(t,"a",function(){return T}),i.d(t,"b",function(){return W}),i.d(t,"c",function(){return R});var n=i("8Y7J"),r=i("LRne"),s=i("HDdC"),o=i("bOdf"),a=i("pLZG"),l=i("lJxs"),h=i("SVse");class c{}class d{}class p{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(e=>{const t=e.indexOf(":");if(t>0){const i=e.slice(0,t),n=i.toLowerCase(),r=e.slice(t+1).trim();this.maybeSetNormalizedName(i,n),this.headers.has(n)?this.headers.get(n).push(r):this.headers.set(n,[r])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let i=e[t];const n=t.toLowerCase();"string"==typeof i&&(i=[i]),i.length>0&&(this.headers.set(n,i),this.maybeSetNormalizedName(t,n))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof p?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new p;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof p?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const n=("a"===e.op?this.headers.get(t):void 0)||[];n.push(...i),this.headers.set(t,n);break;case"d":const r=e.value;if(r){let e=this.headers.get(t);if(!e)return;e=e.filter(e=>-1===r.indexOf(e)),0===e.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,e)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class u{encodeKey(e){return g(e)}encodeValue(e){return g(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}function g(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}class m{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new u,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(e,t){const i=new Map;return e.length>0&&e.split("&").forEach(e=>{const n=e.indexOf("="),[r,s]=-1==n?[t.decodeKey(e),""]:[t.decodeKey(e.slice(0,n)),t.decodeValue(e.slice(n+1))],o=i.get(r)||[];o.push(s),i.set(r,o)}),i}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t];this.map.set(t,Array.isArray(i)?i:[i])})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(e=>t+"="+this.encoder.encodeValue(e)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new m({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat([e]),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(e.value),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let t=this.map.get(e.param)||[];const i=t.indexOf(e.value);-1!==i&&t.splice(i,1),t.length>0?this.map.set(e.param,t):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}function f(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function y(e){return"undefined"!=typeof Blob&&e instanceof Blob}function b(e){return"undefined"!=typeof FormData&&e instanceof FormData}class v{constructor(e,t,i,n){let r;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||n?(this.body=void 0!==i?i:null,r=n):r=i,r&&(this.reportProgress=!!r.reportProgress,this.withCredentials=!!r.withCredentials,r.responseType&&(this.responseType=r.responseType),r.headers&&(this.headers=r.headers),r.params&&(this.params=r.params)),this.headers||(this.headers=new p),this.params){const e=this.params.toString();if(0===e.length)this.urlWithParams=t;else{const i=t.indexOf("?");this.urlWithParams=t+(-1===i?"?":i<t.length-1?"&":"")+e}}else this.params=new m,this.urlWithParams=t}serializeBody(){return null===this.body?null:f(this.body)||y(this.body)||b(this.body)||"string"==typeof this.body?this.body:this.body instanceof m?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||b(this.body)?null:y(this.body)?this.body.type||null:f(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof m?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||Array.isArray(this.body)?"application/json":null}clone(e={}){const t=e.method||this.method,i=e.url||this.url,n=e.responseType||this.responseType,r=void 0!==e.body?e.body:this.body,s=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,o=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let a=e.headers||this.headers,l=e.params||this.params;return void 0!==e.setHeaders&&(a=Object.keys(e.setHeaders).reduce((t,i)=>t.set(i,e.setHeaders[i]),a)),e.setParams&&(l=Object.keys(e.setParams).reduce((t,i)=>t.set(i,e.setParams[i]),l)),new v(t,i,r,{params:l,headers:a,reportProgress:o,responseType:n,withCredentials:s})}}var w=function(e){return e[e.Sent=0]="Sent",e[e.UploadProgress=1]="UploadProgress",e[e.ResponseHeader=2]="ResponseHeader",e[e.DownloadProgress=3]="DownloadProgress",e[e.Response=4]="Response",e[e.User=5]="User",e}({});class x{constructor(e,t=200,i="OK"){this.headers=e.headers||new p,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class S extends x{constructor(e={}){super(e),this.type=w.ResponseHeader}clone(e={}){return new S({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class C extends x{constructor(e={}){super(e),this.type=w.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new C({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class P extends x{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function O(e,t){return{body:t,headers:e.headers,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}let T=(()=>{class e{constructor(e){this.handler=e}request(e,t,i={}){let n;if(e instanceof v)n=e;else{let r,s;r=i.headers instanceof p?i.headers:new p(i.headers),i.params&&(s=i.params instanceof m?i.params:new m({fromObject:i.params})),n=new v(e,t,void 0!==i.body?i.body:null,{headers:r,params:s,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials})}const s=Object(r.a)(n).pipe(Object(o.a)(e=>this.handler.handle(e)));if(e instanceof v||"events"===i.observe)return s;const h=s.pipe(Object(a.a)(e=>e instanceof C));switch(i.observe||"body"){case"body":switch(n.responseType){case"arraybuffer":return h.pipe(Object(l.a)(e=>{if(null!==e.body&&!(e.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return e.body}));case"blob":return h.pipe(Object(l.a)(e=>{if(null!==e.body&&!(e.body instanceof Blob))throw new Error("Response is not a Blob.");return e.body}));case"text":return h.pipe(Object(l.a)(e=>{if(null!==e.body&&"string"!=typeof e.body)throw new Error("Response is not a string.");return e.body}));case"json":default:return h.pipe(Object(l.a)(e=>e.body))}case"response":return h;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(e,t={}){return this.request("DELETE",e,t)}get(e,t={}){return this.request("GET",e,t)}head(e,t={}){return this.request("HEAD",e,t)}jsonp(e,t){return this.request("JSONP",e,{params:(new m).append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,t={}){return this.request("OPTIONS",e,t)}patch(e,t,i={}){return this.request("PATCH",e,O(i,t))}post(e,t,i={}){return this.request("POST",e,O(i,t))}put(e,t,i={}){return this.request("PUT",e,O(i,t))}}return e.\u0275fac=function(t){return new(t||e)(n.Pb(c))},e.\u0275prov=n.Fb({token:e,factory:e.\u0275fac}),e})();class E{constructor(e,t){this.next=e,this.interceptor=t}handle(e){return this.interceptor.intercept(e,this.next)}}const A=new n.s("HTTP_INTERCEPTORS");let I=(()=>{class e{intercept(e,t){return t.handle(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=n.Fb({token:e,factory:e.\u0275fac}),e})();const D=/^\)\]\}',?\n/;class R{}let L=(()=>{class e{constructor(){}build(){return new XMLHttpRequest}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=n.Fb({token:e,factory:e.\u0275fac}),e})(),z=(()=>{class e{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new s.a(t=>{const i=this.xhrFactory.build();if(i.open(e.method,e.urlWithParams),e.withCredentials&&(i.withCredentials=!0),e.headers.forEach((e,t)=>i.setRequestHeader(e,t.join(","))),e.headers.has("Accept")||i.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const t=e.detectContentTypeHeader();null!==t&&i.setRequestHeader("Content-Type",t)}if(e.responseType){const t=e.responseType.toLowerCase();i.responseType="json"!==t?t:"text"}const n=e.serializeBody();let r=null;const s=()=>{if(null!==r)return r;const t=1223===i.status?204:i.status,n=i.statusText||"OK",s=new p(i.getAllResponseHeaders()),o=function(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(i)||e.url;return r=new S({headers:s,status:t,statusText:n,url:o}),r},o=()=>{let{headers:n,status:r,statusText:o,url:a}=s(),l=null;204!==r&&(l=void 0===i.response?i.responseText:i.response),0===r&&(r=l?200:0);let h=r>=200&&r<300;if("json"===e.responseType&&"string"==typeof l){const e=l;l=l.replace(D,"");try{l=""!==l?JSON.parse(l):null}catch(c){l=e,h&&(h=!1,l={error:c,text:l})}}h?(t.next(new C({body:l,headers:n,status:r,statusText:o,url:a||void 0})),t.complete()):t.error(new P({error:l,headers:n,status:r,statusText:o,url:a||void 0}))},a=e=>{const{url:n}=s(),r=new P({error:e,status:i.status||0,statusText:i.statusText||"Unknown Error",url:n||void 0});t.error(r)};let l=!1;const h=n=>{l||(t.next(s()),l=!0);let r={type:w.DownloadProgress,loaded:n.loaded};n.lengthComputable&&(r.total=n.total),"text"===e.responseType&&i.responseText&&(r.partialText=i.responseText),t.next(r)},c=e=>{let i={type:w.UploadProgress,loaded:e.loaded};e.lengthComputable&&(i.total=e.total),t.next(i)};return i.addEventListener("load",o),i.addEventListener("error",a),e.reportProgress&&(i.addEventListener("progress",h),null!==n&&i.upload&&i.upload.addEventListener("progress",c)),i.send(n),t.next({type:w.Sent}),()=>{i.removeEventListener("error",a),i.removeEventListener("load",o),e.reportProgress&&(i.removeEventListener("progress",h),null!==n&&i.upload&&i.upload.removeEventListener("progress",c)),i.readyState!==i.DONE&&i.abort()}})}}return e.\u0275fac=function(t){return new(t||e)(n.Pb(R))},e.\u0275prov=n.Fb({token:e,factory:e.\u0275fac}),e})();const M=new n.s("XSRF_COOKIE_NAME"),k=new n.s("XSRF_HEADER_NAME");class j{}let H=(()=>{class e{constructor(e,t,i){this.doc=e,this.platform=t,this.cookieName=i,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=Object(h.s)(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return e.\u0275fac=function(t){return new(t||e)(n.Pb(h.c),n.Pb(n.D),n.Pb(M))},e.\u0275prov=n.Fb({token:e,factory:e.\u0275fac}),e})(),N=(()=>{class e{constructor(e,t){this.tokenService=e,this.headerName=t}intercept(e,t){const i=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||i.startsWith("http://")||i.startsWith("https://"))return t.handle(e);const n=this.tokenService.getToken();return null===n||e.headers.has(this.headerName)||(e=e.clone({headers:e.headers.set(this.headerName,n)})),t.handle(e)}}return e.\u0275fac=function(t){return new(t||e)(n.Pb(j),n.Pb(k))},e.\u0275prov=n.Fb({token:e,factory:e.\u0275fac}),e})(),_=(()=>{class e{constructor(e,t){this.backend=e,this.injector=t,this.chain=null}handle(e){if(null===this.chain){const e=this.injector.get(A,[]);this.chain=e.reduceRight((e,t)=>new E(e,t),this.backend)}return this.chain.handle(e)}}return e.\u0275fac=function(t){return new(t||e)(n.Pb(d),n.Pb(n.t))},e.\u0275prov=n.Fb({token:e,factory:e.\u0275fac}),e})(),B=(()=>{class e{static disable(){return{ngModule:e,providers:[{provide:N,useClass:I}]}}static withOptions(t={}){return{ngModule:e,providers:[t.cookieName?{provide:M,useValue:t.cookieName}:[],t.headerName?{provide:k,useValue:t.headerName}:[]]}}}return e.\u0275mod=n.Hb({type:e}),e.\u0275inj=n.Gb({factory:function(t){return new(t||e)},providers:[N,{provide:A,useExisting:N,multi:!0},{provide:j,useClass:H},{provide:M,useValue:"XSRF-TOKEN"},{provide:k,useValue:"X-XSRF-TOKEN"}]}),e})(),W=(()=>{class e{}return e.\u0275mod=n.Hb({type:e}),e.\u0275inj=n.Gb({factory:function(t){return new(t||e)},providers:[T,{provide:c,useClass:_},z,{provide:d,useExisting:z},L,{provide:R,useExisting:L}],imports:[[B.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),e})()},LRne:function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i("z+Ro"),r=i("yCtX"),s=i("jZKg");function o(...e){let t=e[e.length-1];return Object(n.a)(t)?(e.pop(),Object(s.a)(e,t)):Object(r.a)(e)}},Lhse:function(e,t,i){"use strict";function n(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}i.d(t,"a",function(){return r});const r=n()},NJ4a:function(e,t,i){"use strict";function n(e){setTimeout(()=>{throw e},0)}i.d(t,"a",function(){return n})},SVse:function(e,t,i){"use strict";i.d(t,"a",function(){return w}),i.d(t,"b",function(){return N}),i.d(t,"c",function(){return l}),i.d(t,"d",function(){return S}),i.d(t,"e",function(){return d}),i.d(t,"f",function(){return C}),i.d(t,"g",function(){return b}),i.d(t,"h",function(){return L}),i.d(t,"i",function(){return k}),i.d(t,"j",function(){return j}),i.d(t,"k",function(){return H}),i.d(t,"l",function(){return x}),i.d(t,"m",function(){return h}),i.d(t,"n",function(){return W}),i.d(t,"o",function(){return B}),i.d(t,"p",function(){return a}),i.d(t,"q",function(){return _}),i.d(t,"r",function(){return s}),i.d(t,"s",function(){return D}),i.d(t,"t",function(){return o});var n=i("8Y7J");let r=null;function s(){return r}function o(e){r||(r=e)}class a{}const l=new n.s("DocumentToken");let h=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Object(n.Fb)({factory:c,token:e,providedIn:"platform"}),e})();function c(){return Object(n.Pb)(p)}const d=new n.s("Location Initialized");let p=(()=>{class e extends h{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=s().getLocation(),this._history=s().getHistory()}getBaseHrefFromDOM(){return s().getBaseHref(this._doc)}onPopState(e){s().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",e,!1)}onHashChange(e){s().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",e,!1)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,t,i){u()?this._history.pushState(e,t,i):this.location.hash=i}replaceState(e,t,i){u()?this._history.replaceState(e,t,i):this.location.hash=i}forward(){this._history.forward()}back(){this._history.back()}getState(){return this._history.state}}return e.\u0275fac=function(t){return new(t||e)(n.Pb(l))},e.\u0275prov=Object(n.Fb)({factory:g,token:e,providedIn:"platform"}),e})();function u(){return!!window.history.pushState}function g(){return new p(Object(n.Pb)(l))}function m(e,t){if(0==e.length)return t;if(0==t.length)return e;let i=0;return e.endsWith("/")&&i++,t.startsWith("/")&&i++,2==i?e+t.substring(1):1==i?e+t:e+"/"+t}function f(e){const t=e.match(/#|\?|$/),i=t&&t.index||e.length;return e.slice(0,i-("/"===e[i-1]?1:0))+e.slice(i)}function y(e){return e&&"?"!==e[0]?"?"+e:e}let b=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Object(n.Fb)({factory:v,token:e,providedIn:"root"}),e})();function v(e){const t=Object(n.Pb)(l).location;return new x(Object(n.Pb)(h),t&&t.origin||"")}const w=new n.s("appBaseHref");let x=(()=>{class e extends b{constructor(e,t){if(super(),this._platformLocation=e,null==t&&(t=this._platformLocation.getBaseHrefFromDOM()),null==t)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=t}onPopState(e){this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e)}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return m(this._baseHref,e)}path(e=!1){const t=this._platformLocation.pathname+y(this._platformLocation.search),i=this._platformLocation.hash;return i&&e?`${t}${i}`:t}pushState(e,t,i,n){const r=this.prepareExternalUrl(i+y(n));this._platformLocation.pushState(e,t,r)}replaceState(e,t,i,n){const r=this.prepareExternalUrl(i+y(n));this._platformLocation.replaceState(e,t,r)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return e.\u0275fac=function(t){return new(t||e)(n.Pb(h),n.Pb(w,8))},e.\u0275prov=n.Fb({token:e,factory:e.\u0275fac}),e})(),S=(()=>{class e extends b{constructor(e,t){super(),this._platformLocation=e,this._baseHref="",null!=t&&(this._baseHref=t)}onPopState(e){this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e)}getBaseHref(){return this._baseHref}path(e=!1){let t=this._platformLocation.hash;return null==t&&(t="#"),t.length>0?t.substring(1):t}prepareExternalUrl(e){const t=m(this._baseHref,e);return t.length>0?"#"+t:t}pushState(e,t,i,n){let r=this.prepareExternalUrl(i+y(n));0==r.length&&(r=this._platformLocation.pathname),this._platformLocation.pushState(e,t,r)}replaceState(e,t,i,n){let r=this.prepareExternalUrl(i+y(n));0==r.length&&(r=this._platformLocation.pathname),this._platformLocation.replaceState(e,t,r)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return e.\u0275fac=function(t){return new(t||e)(n.Pb(h),n.Pb(w,8))},e.\u0275prov=n.Fb({token:e,factory:e.\u0275fac}),e})(),C=(()=>{class e{constructor(e,t){this._subject=new n.n,this._urlChangeListeners=[],this._platformStrategy=e;const i=this._platformStrategy.getBaseHref();this._platformLocation=t,this._baseHref=f(O(i)),this._platformStrategy.onPopState(e=>{this._subject.emit({url:this.path(!0),pop:!0,state:e.state,type:e.type})})}path(e=!1){return this.normalize(this._platformStrategy.path(e))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(e,t=""){return this.path()==this.normalize(e+y(t))}normalize(t){return e.stripTrailingSlash(function(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,O(t)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}go(e,t="",i=null){this._platformStrategy.pushState(i,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+y(t)),i)}replaceState(e,t="",i=null){this._platformStrategy.replaceState(i,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+y(t)),i)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}onUrlChange(e){this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(e=>{this._notifyUrlChangeListeners(e.url,e.state)}))}_notifyUrlChangeListeners(e="",t){this._urlChangeListeners.forEach(i=>i(e,t))}subscribe(e,t,i){return this._subject.subscribe({next:e,error:t,complete:i})}}return e.\u0275fac=function(t){return new(t||e)(n.Pb(b),n.Pb(h))},e.normalizeQueryParams=y,e.joinWithSlash=m,e.stripTrailingSlash=f,e.\u0275prov=Object(n.Fb)({factory:P,token:e,providedIn:"root"}),e})();function P(){return new C(Object(n.Pb)(b),Object(n.Pb)(h))}function O(e){return e.replace(/\/index.html$/,"")}var T=function(e){return e[e.Zero=0]="Zero",e[e.One=1]="One",e[e.Two=2]="Two",e[e.Few=3]="Few",e[e.Many=4]="Many",e[e.Other=5]="Other",e}({});const E=n.lb;class A{}let I=(()=>{class e extends A{constructor(e){super(),this.locale=e}getPluralCategory(e,t){switch(E(t||this.locale)(e)){case T.Zero:return"zero";case T.One:return"one";case T.Two:return"two";case T.Few:return"few";case T.Many:return"many";default:return"other"}}}return e.\u0275fac=function(t){return new(t||e)(n.Pb(n.w))},e.\u0275prov=n.Fb({token:e,factory:e.\u0275fac}),e})();function D(e,t){t=encodeURIComponent(t);for(const i of e.split(";")){const e=i.indexOf("="),[n,r]=-1==e?[i,""]:[i.slice(0,e),i.slice(e+1)];if(n.trim()===t)return decodeURIComponent(r)}return null}class R{constructor(e,t,i,n){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=n}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let L=(()=>{class e{constructor(e,t,i){this._viewContainer=e,this._template=t,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const i=this._ngForOf;if(!this._differ&&i)try{this._differ=this._differs.find(i).create(this.ngForTrackBy)}catch(t){throw new Error(`Cannot find a differ supporting object '${i}' of type '${e=i,e.name||typeof e}'. NgFor only supports binding to Iterables such as Arrays.`)}}var e;if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const t=[];e.forEachOperation((e,i,n)=>{if(null==e.previousIndex){const i=this._viewContainer.createEmbeddedView(this._template,new R(null,this._ngForOf,-1,-1),null===n?void 0:n),r=new z(e,i);t.push(r)}else if(null==n)this._viewContainer.remove(null===i?void 0:i);else if(null!==i){const r=this._viewContainer.get(i);this._viewContainer.move(r,n);const s=new z(e,r);t.push(s)}});for(let i=0;i<t.length;i++)this._perViewChange(t[i].view,t[i].record);for(let i=0,n=this._viewContainer.length;i<n;i++){const e=this._viewContainer.get(i);e.context.index=i,e.context.count=n,e.context.ngForOf=this._ngForOf}e.forEachIdentityChange(e=>{this._viewContainer.get(e.currentIndex).context.$implicit=e.item})}_perViewChange(e,t){e.context.$implicit=t.item}static ngTemplateContextGuard(e,t){return!0}}return e.\u0275fac=function(t){return new(t||e)(n.Jb(n.R),n.Jb(n.M),n.Jb(n.u))},e.\u0275dir=n.Eb({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),e})();class z{constructor(e,t){this.record=e,this.view=t}}class M{constructor(e,t){this._viewContainerRef=e,this._templateRef=t,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(e){e&&!this._created?this.create():!e&&this._created&&this.destroy()}}let k=(()=>{class e{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(e)}_matchCase(e){const t=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||t,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),t}_updateDefaultCases(e){if(this._defaultViews&&e!==this._defaultUsed){this._defaultUsed=e;for(let t=0;t<this._defaultViews.length;t++)this._defaultViews[t].enforceState(e)}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=n.Eb({type:e,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),e})(),j=(()=>{class e{constructor(e,t,i){this.ngSwitch=i,i._addCase(),this._view=new M(e,t)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return e.\u0275fac=function(t){return new(t||e)(n.Jb(n.R),n.Jb(n.M),n.Jb(k,1))},e.\u0275dir=n.Eb({type:e,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),e})(),H=(()=>{class e{constructor(e,t,i){i._addDefault(new M(e,t))}}return e.\u0275fac=function(t){return new(t||e)(n.Jb(n.R),n.Jb(n.M),n.Jb(k,1))},e.\u0275dir=n.Eb({type:e,selectors:[["","ngSwitchDefault",""]]}),e})(),N=(()=>{class e{}return e.\u0275mod=n.Hb({type:e}),e.\u0275inj=n.Gb({factory:function(t){return new(t||e)},providers:[{provide:A,useClass:I}]}),e})();const _="browser";function B(e){return"server"===e}let W=(()=>{class e{}return e.\u0275prov=Object(n.Fb)({token:e,providedIn:"root",factory:()=>new U(Object(n.Pb)(l),window)}),e})();class U{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){var t;if(!this.supportsScrolling())return;const i=null!==(t=this.document.getElementById(e))&&void 0!==t?t:this.document.getElementsByName(e)[0];void 0!==i&&(this.scrollToElement(i),this.attemptFocus(i))}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,n=t.top+this.window.pageYOffset,r=this.offset();this.window.scrollTo(i-r[0],n-r[1])}attemptFocus(e){return e.focus(),this.document.activeElement===e}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=F(this.window.history)||F(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(e){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}function F(e){return Object.getOwnPropertyDescriptor(e,"scrollRestoration")}},SeVD:function(e,t,i){"use strict";i.d(t,"a",function(){return c});var n=i("ngJS"),r=i("NJ4a"),s=i("Lhse"),o=i("kJWO"),a=i("I55L"),l=i("c2HN"),h=i("XoHu");const c=e=>{if(e&&"function"==typeof e[o.a])return c=e,e=>{const t=c[o.a]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if(Object(a.a)(e))return Object(n.a)(e);if(Object(l.a)(e))return i=e,e=>(i.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,r.a),e);if(e&&"function"==typeof e[s.a])return t=e,e=>{const i=t[s.a]();for(;;){let t;try{t=i.next()}catch(n){return e.error(n),e}if(t.done){e.complete();break}if(e.next(t.value),e.closed)break}return"function"==typeof i.return&&e.add(()=>{i.return&&i.return()}),e};{const t=Object(h.a)(e)?"an invalid object":`'${e}'`;throw new TypeError(`You provided ${t} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`)}var t,i,c}},SpAZ:function(e,t,i){"use strict";function n(e){return e}i.d(t,"a",function(){return n})},XNiG:function(e,t,i){"use strict";i.d(t,"b",function(){return h}),i.d(t,"a",function(){return c});var n=i("HDdC"),r=i("7o/Q"),s=i("quSY"),o=i("9ppp");class a extends s.a{constructor(e,t){super(),this.subject=e,this.subscriber=t,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const e=this.subject,t=e.observers;if(this.subject=null,!t||0===t.length||e.isStopped||e.closed)return;const i=t.indexOf(this.subscriber);-1!==i&&t.splice(i,1)}}var l=i("2QA8");class h extends r.a{constructor(e){super(e),this.destination=e}}let c=(()=>{class e extends n.a{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[l.a](){return new h(this)}lift(e){const t=new d(this,this);return t.operator=e,t}next(e){if(this.closed)throw new o.a;if(!this.isStopped){const{observers:t}=this,i=t.length,n=t.slice();for(let r=0;r<i;r++)n[r].next(e)}}error(e){if(this.closed)throw new o.a;this.hasError=!0,this.thrownError=e,this.isStopped=!0;const{observers:t}=this,i=t.length,n=t.slice();for(let r=0;r<i;r++)n[r].error(e);this.observers.length=0}complete(){if(this.closed)throw new o.a;this.isStopped=!0;const{observers:e}=this,t=e.length,i=e.slice();for(let n=0;n<t;n++)i[n].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(e){if(this.closed)throw new o.a;return super._trySubscribe(e)}_subscribe(e){if(this.closed)throw new o.a;return this.hasError?(e.error(this.thrownError),s.a.EMPTY):this.isStopped?(e.complete(),s.a.EMPTY):(this.observers.push(e),new a(this,e))}asObservable(){const e=new n.a;return e.source=this,e}}return e.create=(e,t)=>new d(e,t),e})();class d extends c{constructor(e,t){super(),this.destination=e,this.source=t}next(e){const{destination:t}=this;t&&t.next&&t.next(e)}error(e){const{destination:t}=this;t&&t.error&&this.destination.error(e)}complete(){const{destination:e}=this;e&&e.complete&&this.destination.complete()}_subscribe(e){const{source:t}=this;return t?this.source.subscribe(e):s.a.EMPTY}}},XoHu:function(e,t,i){"use strict";function n(e){return null!==e&&"object"==typeof e}i.d(t,"a",function(){return n})},bHdf:function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i("5+tZ"),r=i("SpAZ");function s(e=Number.POSITIVE_INFINITY){return Object(n.a)(r.a,e)}},bOdf:function(e,t,i){"use strict";i.d(t,"a",function(){return r});var n=i("5+tZ");function r(e,t){return Object(n.a)(e,t,1)}},c2HN:function(e,t,i){"use strict";function n(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}i.d(t,"a",function(){return n})},cUpR:function(e,t,i){"use strict";i.d(t,"a",function(){return M}),i.d(t,"b",function(){return N}),i.d(t,"c",function(){return j}),i.d(t,"d",function(){return k}),i.d(t,"e",function(){return L});var n=i("SVse"),r=i("8Y7J");class s extends n.p{constructor(){super()}supportsDOMEvents(){return!0}}class o extends s{static makeCurrent(){Object(n.t)(new o)}getProperty(e,t){return e[t]}log(e){window.console&&window.console.log&&window.console.log(e)}logGroup(e){window.console&&window.console.group&&window.console.group(e)}logGroupEnd(){window.console&&window.console.groupEnd&&window.console.groupEnd()}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){return e.parentNode&&e.parentNode.removeChild(e),e}getValue(e){return e.value}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getHistory(){return window.history}getLocation(){return window.location}getBaseHref(e){const t=l||(l=document.querySelector("base"),l)?l.getAttribute("href"):null;return null==t?null:(i=t,a||(a=document.createElement("a")),a.setAttribute("href",i),"/"===a.pathname.charAt(0)?a.pathname:"/"+a.pathname);var i}resetBaseElement(){l=null}getUserAgent(){return window.navigator.userAgent}performanceNow(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}supportsCookies(){return!0}getCookie(e){return Object(n.s)(document.cookie,e)}}let a,l=null;const h=new r.s("TRANSITION_ID"),c=[{provide:r.d,useFactory:function(e,t,i){return()=>{i.get(r.e).donePromise.then(()=>{const i=Object(n.r)();Array.prototype.slice.apply(t.querySelectorAll("style[ng-transition]")).filter(t=>t.getAttribute("ng-transition")===e).forEach(e=>i.remove(e))})}},deps:[h,n.c,r.t],multi:!0}];class d{static init(){Object(r.W)(new d)}addToWindow(e){r.nb.getAngularTestability=(t,i=!0)=>{const n=e.findTestabilityInTree(t,i);if(null==n)throw new Error("Could not find testability for element.");return n},r.nb.getAllAngularTestabilities=()=>e.getAllTestabilities(),r.nb.getAllAngularRootElements=()=>e.getAllRootElements(),r.nb.frameworkStabilizers||(r.nb.frameworkStabilizers=[]),r.nb.frameworkStabilizers.push(e=>{const t=r.nb.getAllAngularTestabilities();let i=t.length,n=!1;const s=function(t){n=n||t,i--,0==i&&e(n)};t.forEach(function(e){e.whenStable(s)})})}findTestabilityInTree(e,t,i){if(null==t)return null;const r=e.getTestability(t);return null!=r?r:i?Object(n.r)().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}const p=new r.s("EventManagerPlugins");let u=(()=>{class e{constructor(e,t){this._zone=t,this._eventNameToPlugin=new Map,e.forEach(e=>e.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,t,i){return this._findPluginFor(t).addEventListener(e,t,i)}addGlobalEventListener(e,t,i){return this._findPluginFor(t).addGlobalEventListener(e,t,i)}getZone(){return this._zone}_findPluginFor(e){const t=this._eventNameToPlugin.get(e);if(t)return t;const i=this._plugins;for(let n=0;n<i.length;n++){const t=i[n];if(t.supports(e))return this._eventNameToPlugin.set(e,t),t}throw new Error(`No event manager plugin found for event ${e}`)}}return e.\u0275fac=function(t){return new(t||e)(r.Pb(p),r.Pb(r.B))},e.\u0275prov=r.Fb({token:e,factory:e.\u0275fac}),e})();class g{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const r=Object(n.r)().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,i)}}let m=(()=>{class e{constructor(){this._stylesSet=new Set}addStyles(e){const t=new Set;e.forEach(e=>{this._stylesSet.has(e)||(this._stylesSet.add(e),t.add(e))}),this.onStylesAdded(t)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Fb({token:e,factory:e.\u0275fac}),e})(),f=(()=>{class e extends m{constructor(e){super(),this._doc=e,this._hostNodes=new Set,this._styleNodes=new Set,this._hostNodes.add(e.head)}_addStylesToHost(e,t){e.forEach(e=>{const i=this._doc.createElement("style");i.textContent=e,this._styleNodes.add(t.appendChild(i))})}addHost(e){this._addStylesToHost(this._stylesSet,e),this._hostNodes.add(e)}removeHost(e){this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach(t=>this._addStylesToHost(e,t))}ngOnDestroy(){this._styleNodes.forEach(e=>Object(n.r)().remove(e))}}return e.\u0275fac=function(t){return new(t||e)(r.Pb(n.c))},e.\u0275prov=r.Fb({token:e,factory:e.\u0275fac}),e})();const y={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},b=/%COMP%/g;function v(e,t,i){for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)?v(e,r,i):(r=r.replace(b,e),i.push(r))}return i}function w(e){return t=>{if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}let x=(()=>{class e{constructor(e,t,i){this.eventManager=e,this.sharedStylesHost=t,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new S(e)}createRenderer(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case r.S.Emulated:{let i=this.rendererByCompId.get(t.id);return i||(i=new C(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,i)),i.applyToHost(e),i}case 1:case r.S.ShadowDom:return new P(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){const e=v(t.id,t.styles,[]);this.sharedStylesHost.addStyles(e),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return e.\u0275fac=function(t){return new(t||e)(r.Pb(u),r.Pb(f),r.Pb(r.c))},e.\u0275prov=r.Fb({token:e,factory:e.\u0275fac}),e})();class S{constructor(e){this.eventManager=e,this.data=Object.create(null)}destroy(){}createElement(e,t){return t?document.createElementNS(y[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,i){e&&e.insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,n){if(n){t=n+":"+t;const r=y[n];r?e.setAttributeNS(r,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const n=y[i];n?e.removeAttributeNS(n,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,n){n&(r.H.DashCase|r.H.Important)?e.style.setProperty(t,i,n&r.H.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&r.H.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,w(i)):this.eventManager.addEventListener(e,t,w(i))}}class C extends S{constructor(e,t,i,n){super(e),this.component=i;const r=v(n+"-"+i.id,i.styles,[]);t.addStyles(r),this.contentAttr="_ngcontent-%COMP%".replace(b,n+"-"+i.id),this.hostAttr="_nghost-%COMP%".replace(b,n+"-"+i.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}class P extends S{constructor(e,t,i,n){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const r=v(n.id,n.styles,[]);for(let s=0;s<r.length;s++){const e=document.createElement("style");e.textContent=r[s],this.shadowRoot.appendChild(e)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let O=(()=>{class e extends g{constructor(e){super(e)}supports(e){return!0}addEventListener(e,t,i){return e.addEventListener(t,i,!1),()=>this.removeEventListener(e,t,i)}removeEventListener(e,t,i){return e.removeEventListener(t,i)}}return e.\u0275fac=function(t){return new(t||e)(r.Pb(n.c))},e.\u0275prov=r.Fb({token:e,factory:e.\u0275fac}),e})();const T=["alt","control","meta","shift"],E={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},A={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},I={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let D=(()=>{class e extends g{constructor(e){super(e)}supports(t){return null!=e.parseEventName(t)}addEventListener(t,i,r){const s=e.parseEventName(i),o=e.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Object(n.r)().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),n=i.shift();if(0===i.length||"keydown"!==n&&"keyup"!==n)return null;const r=e._normalizeKey(i.pop());let s="";if(T.forEach(e=>{const t=i.indexOf(e);t>-1&&(i.splice(t,1),s+=e+".")}),s+=r,0!=i.length||0===r.length)return null;const o={};return o.domEventName=n,o.fullKey=s,o}static getEventFullKey(e){let t="",i=function(e){let t=e.key;if(null==t){if(t=e.keyIdentifier,null==t)return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&A.hasOwnProperty(t)&&(t=A[t]))}return E[t]||t}(e);return i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),T.forEach(n=>{n!=i&&(0,I[n])(e)&&(t+=n+".")}),t+=i,t}static eventCallback(t,i,n){return r=>{e.getEventFullKey(r)===t&&n.runGuarded(()=>i(r))}}static _normalizeKey(e){switch(e){case"esc":return"escape";default:return e}}}return e.\u0275fac=function(t){return new(t||e)(r.Pb(n.c))},e.\u0275prov=r.Fb({token:e,factory:e.\u0275fac}),e})();const R=[{provide:r.D,useValue:n.q},{provide:r.E,useValue:function(){o.makeCurrent(),d.init()},multi:!0},{provide:n.c,useFactory:function(){return Object(r.tb)(document),document},deps:[]}],L=Object(r.T)(r.V,"browser",R),z=[[],{provide:r.Y,useValue:"root"},{provide:r.m,useFactory:function(){return new r.m},deps:[]},{provide:p,useClass:O,multi:!0,deps:[n.c,r.B,r.D]},{provide:p,useClass:D,multi:!0,deps:[n.c]},[],{provide:x,useClass:x,deps:[u,f,r.c]},{provide:r.G,useExisting:x},{provide:m,useExisting:f},{provide:f,useClass:f,deps:[n.c]},{provide:r.N,useClass:r.N,deps:[r.B]},{provide:u,useClass:u,deps:[p,r.B]},[]];let M=(()=>{class e{constructor(e){if(e)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:e,providers:[{provide:r.c,useValue:t.appId},{provide:h,useExisting:r.c},c]}}}return e.\u0275mod=r.Hb({type:e}),e.\u0275inj=r.Gb({factory:function(t){return new(t||e)(r.Pb(e,12))},providers:z,imports:[n.b,r.f]}),e})();function k(e){return e}"undefined"!=typeof window&&window;let j=(()=>{class e{constructor(){this.store={},this.onSerializeCallbacks={}}static init(t){const i=new e;return i.store=t,i}get(e,t){return void 0!==this.store[e]?this.store[e]:t}set(e,t){this.store[e]=t}remove(e){delete this.store[e]}hasKey(e){return this.store.hasOwnProperty(e)}onSerialize(e,t){this.onSerializeCallbacks[e]=t}toJson(){for(const t in this.onSerializeCallbacks)if(this.onSerializeCallbacks.hasOwnProperty(t))try{this.store[t]=this.onSerializeCallbacks[t]()}catch(e){console.warn("Exception in onSerialize callback: ",e)}return JSON.stringify(this.store)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Fb({token:e,factory:e.\u0275fac}),e})();function H(e,t){const i=e.getElementById(t+"-state");let n={};if(i&&i.textContent)try{n=JSON.parse(function(e){const t={"&a;":"&","&q;":'"',"&s;":"'","&l;":"<","&g;":">"};return e.replace(/&[^;]+;/g,e=>t[e])}(i.textContent))}catch(r){console.warn("Exception while restoring TransferState for app "+t,r)}return j.init(n)}let N=(()=>{class e{}return e.\u0275mod=r.Hb({type:e}),e.\u0275inj=r.Gb({factory:function(t){return new(t||e)},providers:[{provide:j,useFactory:H,deps:[n.c,r.c]}]}),e})()},gRHU:function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i("2fFW"),r=i("NJ4a");const s={closed:!0,next(e){},error(e){if(n.a.useDeprecatedSynchronousErrorHandling)throw e;Object(r.a)(e)},complete(){}}},iInd:function(e,t,i){"use strict";i.d(t,"a",function(){return Gi}),i.d(t,"b",function(){return Hi});var n=i("SVse"),r=i("8Y7J"),s=i("Cfvw"),o=i("LRne"),a=i("XNiG"),l=i("9ppp");class h extends a.a{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return t&&!t.closed&&e.next(this._value),t}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new l.a;return this._value}next(e){super.next(this._value=e)}}var c=i("z+Ro"),d=i("DH7j"),p=i("7o/Q");class u extends p.a{notifyNext(e,t,i,n,r){this.destination.next(t)}notifyError(e,t){this.destination.error(e)}notifyComplete(e){this.destination.complete()}}class g extends p.a{constructor(e,t,i){super(),this.parent=e,this.outerValue=t,this.outerIndex=i,this.index=0}_next(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}_error(e){this.parent.notifyError(e,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}var m=i("SeVD"),f=i("HDdC");function y(e,t,i,n,r=new g(e,i,n)){if(!r.closed)return t instanceof f.a?t.subscribe(r):Object(m.a)(t)(r)}var b=i("yCtX");const v={};class w{constructor(e){this.resultSelector=e}call(e,t){return t.subscribe(new x(e,this.resultSelector))}}class x extends u{constructor(e,t){super(e),this.resultSelector=t,this.active=0,this.values=[],this.observables=[]}_next(e){this.values.push(v),this.observables.push(e)}_complete(){const e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(let i=0;i<t;i++)this.add(y(this,e[i],void 0,i))}}notifyComplete(e){0==(this.active-=1)&&this.destination.complete()}notifyNext(e,t,i){const n=this.values,r=this.toRespond?n[i]===v?--this.toRespond:this.toRespond:0;n[i]=t,0===r&&(this.resultSelector?this._tryResultSelector(n):this.destination.next(n.slice()))}_tryResultSelector(e){let t;try{t=this.resultSelector.apply(this,e)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}const S=(()=>{function e(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return e.prototype=Object.create(Error.prototype),e})();var C=i("bHdf");function P(...e){return Object(C.a)(1)(Object(o.a)(...e))}const O=new f.a(e=>e.complete());function T(e){return e?function(e){return new f.a(t=>e.schedule(()=>t.complete()))}(e):O}function E(e){return new f.a(t=>{let i;try{i=e()}catch(n){return void t.error(n)}return(i?Object(s.a)(i):T()).subscribe(t)})}var A=i("lJxs"),I=i("zx2A");function D(e,t){return"function"==typeof t?i=>i.pipe(D((i,n)=>Object(s.a)(e(i,n)).pipe(Object(A.a)((e,r)=>t(i,e,n,r))))):t=>t.lift(new R(e))}class R{constructor(e){this.project=e}call(e,t){return t.subscribe(new L(e,this.project))}}class L extends I.b{constructor(e,t){super(e),this.project=t,this.index=0}_next(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(n){return void this.destination.error(n)}this._innerSub(t)}_innerSub(e){const t=this.innerSubscription;t&&t.unsubscribe();const i=new I.a(this),n=this.destination;n.add(i),this.innerSubscription=Object(I.c)(e,i),this.innerSubscription!==i&&n.add(this.innerSubscription)}_complete(){const{innerSubscription:e}=this;e&&!e.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(e){this.destination.next(e)}}const z=(()=>{function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e})();function M(e){return t=>0===e?T():t.lift(new k(e))}class k{constructor(e){if(this.total=e,this.total<0)throw new z}call(e,t){return t.subscribe(new j(e,this.total))}}class j extends p.a{constructor(e,t){super(e),this.total=t,this.count=0}_next(e){const t=this.total,i=++this.count;i<=t&&(this.destination.next(e),i===t&&(this.destination.complete(),this.unsubscribe()))}}function H(e,t){let i=!1;return arguments.length>=2&&(i=!0),function(n){return n.lift(new N(e,t,i))}}class N{constructor(e,t,i=!1){this.accumulator=e,this.seed=t,this.hasSeed=i}call(e,t){return t.subscribe(new _(e,this.accumulator,this.seed,this.hasSeed))}}class _ extends p.a{constructor(e,t,i,n){super(e),this.accumulator=t,this._seed=i,this.hasSeed=n,this.index=0}get seed(){return this._seed}set seed(e){this.hasSeed=!0,this._seed=e}_next(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)}_tryNext(e){const t=this.index++;let i;try{i=this.accumulator(this.seed,e,t)}catch(n){this.destination.error(n)}this.seed=i,this.destination.next(i)}}var B=i("pLZG");function W(e){return function(t){const i=new U(e),n=t.lift(i);return i.caught=n}}class U{constructor(e){this.selector=e}call(e,t){return t.subscribe(new F(e,this.selector,this.caught))}}class F extends I.b{constructor(e,t,i){super(e),this.selector=t,this.caught=i}error(e){if(!this.isStopped){let i;try{i=this.selector(e,this.caught)}catch(t){return void super.error(t)}this._unsubscribeAndRecycle();const n=new I.a(this);this.add(n);const r=Object(I.c)(i,n);r!==n&&this.add(r)}}}var V=i("bOdf");function X(e){return function(t){return 0===e?T():t.lift(new Y(e))}}class Y{constructor(e){if(this.total=e,this.total<0)throw new z}call(e,t){return t.subscribe(new G(e,this.total))}}class G extends p.a{constructor(e,t){super(e),this.total=t,this.ring=new Array,this.count=0}_next(e){const t=this.ring,i=this.total,n=this.count++;t.length<i?t.push(e):t[n%i]=e}_complete(){const e=this.destination;let t=this.count;if(t>0){const i=this.count>=this.total?this.total:this.count,n=this.ring;for(let r=0;r<i;r++){const r=t++%i;e.next(n[r])}}e.complete()}}function q(e=Q){return t=>t.lift(new Z(e))}class Z{constructor(e){this.errorFactory=e}call(e,t){return t.subscribe(new $(e,this.errorFactory))}}class $ extends p.a{constructor(e,t){super(e),this.errorFactory=t,this.hasValue=!1}_next(e){this.hasValue=!0,this.destination.next(e)}_complete(){if(this.hasValue)return this.destination.complete();{let t;try{t=this.errorFactory()}catch(e){t=e}this.destination.error(t)}}}function Q(){return new S}function J(e=null){return t=>t.lift(new K(e))}class K{constructor(e){this.defaultValue=e}call(e,t){return t.subscribe(new ee(e,this.defaultValue))}}class ee extends p.a{constructor(e,t){super(e),this.defaultValue=t,this.isEmpty=!0}_next(e){this.isEmpty=!1,this.destination.next(e)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}var te=i("SpAZ");function ie(e,t){const i=arguments.length>=2;return n=>n.pipe(e?Object(B.a)((t,i)=>e(t,i,n)):te.a,M(1),i?J(t):q(()=>new S))}var ne=i("5+tZ");function re(){}var se=i("n6bG");function oe(e,t,i){return function(n){return n.lift(new ae(e,t,i))}}class ae{constructor(e,t,i){this.nextOrObserver=e,this.error=t,this.complete=i}call(e,t){return t.subscribe(new le(e,this.nextOrObserver,this.error,this.complete))}}class le extends p.a{constructor(e,t,i,n){super(e),this._tapNext=re,this._tapError=re,this._tapComplete=re,this._tapError=i||re,this._tapComplete=n||re,Object(se.a)(t)?(this._context=this,this._tapNext=t):t&&(this._context=t,this._tapNext=t.next||re,this._tapError=t.error||re,this._tapComplete=t.complete||re)}_next(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)}_error(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)}_complete(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}var he=i("quSY");class ce{constructor(e){this.callback=e}call(e,t){return t.subscribe(new de(e,this.callback))}}class de extends p.a{constructor(e,t){super(e),this.add(new he.a(t))}}class pe{constructor(e,t){this.id=e,this.url=t}}class ue extends pe{constructor(e,t,i="imperative",n=null){super(e,t),this.navigationTrigger=i,this.restoredState=n}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class ge extends pe{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class me extends pe{constructor(e,t,i){super(e,t),this.reason=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class fe extends pe{constructor(e,t,i){super(e,t),this.error=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class ye extends pe{constructor(e,t,i,n){super(e,t),this.urlAfterRedirects=i,this.state=n}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class be extends pe{constructor(e,t,i,n){super(e,t),this.urlAfterRedirects=i,this.state=n}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ve extends pe{constructor(e,t,i,n,r){super(e,t),this.urlAfterRedirects=i,this.state=n,this.shouldActivate=r}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class we extends pe{constructor(e,t,i,n){super(e,t),this.urlAfterRedirects=i,this.state=n}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class xe extends pe{constructor(e,t,i,n){super(e,t),this.urlAfterRedirects=i,this.state=n}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Se{constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Ce{constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Pe{constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Oe{constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Te{constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ee{constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ae{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const Ie="primary";class De{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function Re(e){return new De(e)}function Le(e){const t=Error("NavigationCancelingError: "+e);return t.ngNavigationCancelingError=!0,t}function ze(e,t,i){const n=i.path.split("/");if(n.length>e.length)return null;if("full"===i.pathMatch&&(t.hasChildren()||n.length<e.length))return null;const r={};for(let s=0;s<n.length;s++){const t=n[s],i=e[s];if(t.startsWith(":"))r[t.substring(1)]=i;else if(t!==i.path)return null}return{consumed:e.slice(0,n.length),posParams:r}}function Me(e,t){const i=e?Object.keys(e):void 0,n=t?Object.keys(t):void 0;if(!i||!n||i.length!=n.length)return!1;let r;for(let s=0;s<i.length;s++)if(r=i[s],!ke(e[r],t[r]))return!1;return!0}function ke(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;const i=[...e].sort(),n=[...t].sort();return i.every((e,t)=>n[t]===e)}return e===t}function je(e){return Array.prototype.concat.apply([],e)}function He(e){return e.length>0?e[e.length-1]:null}function Ne(e,t){for(const i in e)e.hasOwnProperty(i)&&t(e[i],i)}function _e(e){return Object(r.pb)(e)?e:Object(r.qb)(e)?Object(s.a)(Promise.resolve(e)):Object(o.a)(e)}function Be(e,t,i){return i?function(e,t){return Me(e,t)}(e.queryParams,t.queryParams)&&We(e.root,t.root):function(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(i=>ke(e[i],t[i]))}(e.queryParams,t.queryParams)&&Ue(e.root,t.root)}function We(e,t){if(!Ge(e.segments,t.segments))return!1;if(e.numberOfChildren!==t.numberOfChildren)return!1;for(const i in t.children){if(!e.children[i])return!1;if(!We(e.children[i],t.children[i]))return!1}return!0}function Ue(e,t){return Fe(e,t,t.segments)}function Fe(e,t,i){if(e.segments.length>i.length)return!!Ge(e.segments.slice(0,i.length),i)&&!t.hasChildren();if(e.segments.length===i.length){if(!Ge(e.segments,i))return!1;for(const i in t.children){if(!e.children[i])return!1;if(!Ue(e.children[i],t.children[i]))return!1}return!0}{const n=i.slice(0,e.segments.length),r=i.slice(e.segments.length);return!!Ge(e.segments,n)&&!!e.children.primary&&Fe(e.children.primary,t,r)}}class Ve{constructor(e,t,i){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Re(this.queryParams)),this._queryParamMap}toString(){return $e.serialize(this)}}class Xe{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Ne(t,(e,t)=>e.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Qe(this)}}class Ye{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=Re(this.parameters)),this._parameterMap}toString(){return rt(this)}}function Ge(e,t){return e.length===t.length&&e.every((e,i)=>e.path===t[i].path)}class qe{}class Ze{parse(e){const t=new ht(e);return new Ve(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){var t;return`/${Je(e.root,!0)}${function(e){const t=Object.keys(e).map(t=>{const i=e[t];return Array.isArray(i)?i.map(e=>`${et(t)}=${et(e)}`).join("&"):`${et(t)}=${et(i)}`});return t.length?`?${t.join("&")}`:""}(e.queryParams)}${"string"==typeof e.fragment?`#${t=e.fragment,encodeURI(t)}`:""}`}}const $e=new Ze;function Qe(e){return e.segments.map(e=>rt(e)).join("/")}function Je(e,t){if(!e.hasChildren())return Qe(e);if(t){const t=e.children.primary?Je(e.children.primary,!1):"",i=[];return Ne(e.children,(e,t)=>{t!==Ie&&i.push(`${t}:${Je(e,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function(e,t){let i=[];return Ne(e.children,(e,n)=>{n===Ie&&(i=i.concat(t(e,n)))}),Ne(e.children,(e,n)=>{n!==Ie&&(i=i.concat(t(e,n)))}),i}(e,(t,i)=>i===Ie?[Je(e.children.primary,!1)]:[`${i}:${Je(t,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children.primary?`${Qe(e)}/${t[0]}`:`${Qe(e)}/(${t.join("//")})`}}function Ke(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function et(e){return Ke(e).replace(/%3B/gi,";")}function tt(e){return Ke(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function it(e){return decodeURIComponent(e)}function nt(e){return it(e.replace(/\+/g,"%20"))}function rt(e){return`${tt(e.path)}${t=e.parameters,Object.keys(t).map(e=>`;${tt(e)}=${tt(t[e])}`).join("")}`;var t}const st=/^[^\/()?;=#]+/;function ot(e){const t=e.match(st);return t?t[0]:""}const at=/^[^=?&#]+/,lt=/^[^?&#]+/;class ht{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Xe([],{}):new Xe([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i.primary=new Xe(e,t)),i}parseSegment(){const e=ot(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new Ye(it(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=ot(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const e=ot(this.remaining);e&&(i=e,this.capture(i))}e[it(t)]=it(i)}parseQueryParam(e){const t=function(e){const t=e.match(at);return t?t[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const e=function(e){const t=e.match(lt);return t?t[0]:""}(this.remaining);e&&(i=e,this.capture(i))}const n=nt(t),r=nt(i);if(e.hasOwnProperty(n)){let t=e[n];Array.isArray(t)||(t=[t],e[n]=t),t.push(r)}else e[n]=r}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=ot(this.remaining),n=this.remaining[i.length];if("/"!==n&&")"!==n&&";"!==n)throw new Error(`Cannot parse url '${this.url}'`);let r;i.indexOf(":")>-1?(r=i.substr(0,i.indexOf(":")),this.capture(r),this.capture(":")):e&&(r=Ie);const s=this.parseChildren();t[r]=1===Object.keys(s).length?s.primary:new Xe([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class ct{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=dt(e,this._root);return t?t.children.map(e=>e.value):[]}firstChild(e){const t=dt(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=pt(e,this._root);return t.length<2?[]:t[t.length-2].children.map(e=>e.value).filter(t=>t!==e)}pathFromRoot(e){return pt(e,this._root).map(e=>e.value)}}function dt(e,t){if(e===t.value)return t;for(const i of t.children){const t=dt(e,i);if(t)return t}return null}function pt(e,t){if(e===t.value)return[t];for(const i of t.children){const n=pt(e,i);if(n.length)return n.unshift(t),n}return[]}class ut{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function gt(e){const t={};return e&&e.children.forEach(e=>t[e.value.outlet]=e),t}class mt extends ct{constructor(e,t){super(e),this.snapshot=t,xt(this,e)}toString(){return this.snapshot.toString()}}function ft(e,t){const i=function(e,t){const i=new vt([],{},{},"",{},Ie,t,null,e.root,-1,{});return new wt("",new ut(i,[]))}(e,t),n=new h([new Ye("",{})]),r=new h({}),s=new h({}),o=new h({}),a=new h(""),l=new yt(n,r,o,a,s,Ie,t,i.root);return l.snapshot=i.root,new mt(new ut(l,[]),i)}class yt{constructor(e,t,i,n,r,s,o,a){this.url=e,this.params=t,this.queryParams=i,this.fragment=n,this.data=r,this.outlet=s,this.component=o,this._futureSnapshot=a}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Object(A.a)(e=>Re(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Object(A.a)(e=>Re(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function bt(e,t="emptyOnly"){const i=e.pathFromRoot;let n=0;if("always"!==t)for(n=i.length-1;n>=1;){const e=i[n],t=i[n-1];if(e.routeConfig&&""===e.routeConfig.path)n--;else{if(t.component)break;n--}}return function(e){return e.reduce((e,t)=>({params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}),{params:{},data:{},resolve:{}})}(i.slice(n))}class vt{constructor(e,t,i,n,r,s,o,a,l,h,c){this.url=e,this.params=t,this.queryParams=i,this.fragment=n,this.data=r,this.outlet=s,this.component=o,this.routeConfig=a,this._urlSegment=l,this._lastPathIndex=h,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Re(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Re(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(e=>e.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class wt extends ct{constructor(e,t){super(t),this.url=e,xt(this,t)}toString(){return St(this._root)}}function xt(e,t){t.value._routerState=e,t.children.forEach(t=>xt(e,t))}function St(e){const t=e.children.length>0?` { ${e.children.map(St).join(", ")} } `:"";return`${e.value}${t}`}function Ct(e){if(e.snapshot){const t=e.snapshot,i=e._futureSnapshot;e.snapshot=i,Me(t.queryParams,i.queryParams)||e.queryParams.next(i.queryParams),t.fragment!==i.fragment&&e.fragment.next(i.fragment),Me(t.params,i.params)||e.params.next(i.params),function(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(!Me(e[i],t[i]))return!1;return!0}(t.url,i.url)||e.url.next(i.url),Me(t.data,i.data)||e.data.next(i.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function Pt(e,t){var i,n;return Me(e.params,t.params)&&Ge(i=e.url,n=t.url)&&i.every((e,t)=>Me(e.parameters,n[t].parameters))&&!(!e.parent!=!t.parent)&&(!e.parent||Pt(e.parent,t.parent))}function Ot(e,t,i){if(i&&e.shouldReuseRoute(t.value,i.value.snapshot)){const n=i.value;n._futureSnapshot=t.value;const r=function(e,t,i){return t.children.map(t=>{for(const n of i.children)if(e.shouldReuseRoute(t.value,n.value.snapshot))return Ot(e,t,n);return Ot(e,t)})}(e,t,i);return new ut(n,r)}{const i=e.retrieve(t.value);if(i){const e=i.route;return Tt(t,e),e}{const i=new yt(new h((n=t.value).url),new h(n.params),new h(n.queryParams),new h(n.fragment),new h(n.data),n.outlet,n.component,n),r=t.children.map(t=>Ot(e,t));return new ut(i,r)}}var n}function Tt(e,t){if(e.value.routeConfig!==t.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==t.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");t.value._futureSnapshot=e.value;for(let i=0;i<e.children.length;++i)Tt(e.children[i],t.children[i])}function Et(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function At(e){return"object"==typeof e&&null!=e&&e.outlets}function It(e,t,i,n,r){let s={};return n&&Ne(n,(e,t)=>{s[t]=Array.isArray(e)?e.map(e=>`${e}`):`${e}`}),new Ve(i.root===e?t:Dt(i.root,e,t),s,r)}function Dt(e,t,i){const n={};return Ne(e.children,(e,r)=>{n[r]=e===t?i:Dt(e,t,i)}),new Xe(e.segments,n)}class Rt{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Et(i[0]))throw new Error("Root segment cannot have matrix parameters");const n=i.find(At);if(n&&n!==He(i))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Lt{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function zt(e,t,i){if(e||(e=new Xe([],{})),0===e.segments.length&&e.hasChildren())return Mt(e,t,i);const n=function(e,t,i){let n=0,r=t;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<e.segments.length;){if(n>=i.length)return s;const t=e.segments[r],o=i[n];if(At(o))break;const a=`${o}`,l=n<i.length-1?i[n+1]:null;if(r>0&&void 0===a)break;if(a&&l&&"object"==typeof l&&void 0===l.outlets){if(!Nt(a,l,t))return s;n+=2}else{if(!Nt(a,{},t))return s;n++}r++}return{match:!0,pathIndex:r,commandIndex:n}}(e,t,i),r=i.slice(n.commandIndex);if(n.match&&n.pathIndex<e.segments.length){const t=new Xe(e.segments.slice(0,n.pathIndex),{});return t.children.primary=new Xe(e.segments.slice(n.pathIndex),e.children),Mt(t,0,r)}return n.match&&0===r.length?new Xe(e.segments,{}):n.match&&!e.hasChildren()?kt(e,t,i):n.match?Mt(e,0,r):kt(e,t,i)}function Mt(e,t,i){if(0===i.length)return new Xe(e.segments,{});{const n=function(e){return At(e[0])?e[0].outlets:{[Ie]:e}}(i),r={};return Ne(n,(i,n)=>{"string"==typeof i&&(i=[i]),null!==i&&(r[n]=zt(e.children[n],t,i))}),Ne(e.children,(e,t)=>{void 0===n[t]&&(r[t]=e)}),new Xe(e.segments,r)}}function kt(e,t,i){const n=e.segments.slice(0,t);let r=0;for(;r<i.length;){const s=i[r];if(At(s)){const e=jt(s.outlets);return new Xe(n,e)}if(0===r&&Et(i[0])){n.push(new Ye(e.segments[t].path,Ht(i[0]))),r++;continue}const o=At(s)?s.outlets.primary:`${s}`,a=r<i.length-1?i[r+1]:null;o&&a&&Et(a)?(n.push(new Ye(o,Ht(a))),r+=2):(n.push(new Ye(o,{})),r++)}return new Xe(n,{})}function jt(e){const t={};return Ne(e,(e,i)=>{"string"==typeof e&&(e=[e]),null!==e&&(t[i]=kt(new Xe([],{}),0,e))}),t}function Ht(e){const t={};return Ne(e,(e,i)=>t[i]=`${e}`),t}function Nt(e,t,i){return e==i.path&&Me(t,i.parameters)}class _t{constructor(e,t,i,n){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=n}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),Ct(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const n=gt(t);e.children.forEach(e=>{const t=e.value.outlet;this.deactivateRoutes(e,n[t],i),delete n[t]}),Ne(n,(e,t)=>{this.deactivateRouteAndItsChildren(e,i)})}deactivateRoutes(e,t,i){const n=e.value,r=t?t.value:null;if(n===r)if(n.component){const r=i.getContext(n.outlet);r&&this.deactivateChildRoutes(e,t,r.children)}else this.deactivateChildRoutes(e,t,i);else r&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet);if(i&&i.outlet){const t=i.outlet.detach(),n=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:t,route:e,contexts:n})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),n=i&&e.value.component?i.children:t,r=gt(e);for(const s of Object.keys(r))this.deactivateRouteAndItsChildren(r[s],n);i&&i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated())}activateChildRoutes(e,t,i){const n=gt(t);e.children.forEach(e=>{this.activateRoutes(e,n[e.value.outlet],i),this.forwardEvent(new Ee(e.value.snapshot))}),e.children.length&&this.forwardEvent(new Oe(e.value.snapshot))}activateRoutes(e,t,i){const n=e.value,r=t?t.value:null;if(Ct(n),n===r)if(n.component){const r=i.getOrCreateContext(n.outlet);this.activateChildRoutes(e,t,r.children)}else this.activateChildRoutes(e,t,i);else if(n.component){const t=i.getOrCreateContext(n.outlet);if(this.routeReuseStrategy.shouldAttach(n.snapshot)){const e=this.routeReuseStrategy.retrieve(n.snapshot);this.routeReuseStrategy.store(n.snapshot,null),t.children.onOutletReAttached(e.contexts),t.attachRef=e.componentRef,t.route=e.route.value,t.outlet&&t.outlet.attach(e.componentRef,e.route.value),Bt(e.route)}else{const i=function(e){for(let t=e.parent;t;t=t.parent){const e=t.routeConfig;if(e&&e._loadedConfig)return e._loadedConfig;if(e&&e.component)return null}return null}(n.snapshot),r=i?i.module.componentFactoryResolver:null;t.attachRef=null,t.route=n,t.resolver=r,t.outlet&&t.outlet.activateWith(n,r),this.activateChildRoutes(e,null,t.children)}}else this.activateChildRoutes(e,null,i)}}function Bt(e){Ct(e.value),e.children.forEach(Bt)}class Wt{constructor(e,t){this.routes=e,this.module=t}}function Ut(e){return"function"==typeof e}function Ft(e){return e instanceof Ve}const Vt=Symbol("INITIAL_VALUE");function Xt(){return D(e=>function(...e){let t,i;return Object(c.a)(e[e.length-1])&&(i=e.pop()),"function"==typeof e[e.length-1]&&(t=e.pop()),1===e.length&&Object(d.a)(e[0])&&(e=e[0]),Object(b.a)(e,i).lift(new w(t))}(e.map(e=>e.pipe(M(1),function(...e){const t=e[e.length-1];return Object(c.a)(t)?(e.pop(),i=>P(e,i,t)):t=>P(e,t)}(Vt)))).pipe(H((e,t)=>{let i=!1;return t.reduce((e,n,r)=>{if(e!==Vt)return e;if(n===Vt&&(i=!0),!i){if(!1===n)return n;if(r===t.length-1||Ft(n))return n}return e},e)},Vt),Object(B.a)(e=>e!==Vt),Object(A.a)(e=>Ft(e)?e:!0===e),M(1)))}let Yt=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Db({type:e,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,t){1&e&&r.Kb(0,"router-outlet")},directives:function(){return[Hi]},encapsulation:2}),e})();function Gt(e,t=""){for(let i=0;i<e.length;i++){const n=e[i];qt(n,Zt(t,n))}}function qt(e,t){e.children&&Gt(e.children,t)}function Zt(e,t){return t?e||t.path?e&&!t.path?`${e}/`:!e&&t.path?t.path:`${e}/${t.path}`:"":e}function $t(e){const t=e.children&&e.children.map($t),i=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!i.component&&(t||i.loadChildren)&&i.outlet&&i.outlet!==Ie&&(i.component=Yt),i}function Qt(e){return e.outlet||Ie}function Jt(e,t){const i=e.filter(e=>Qt(e)===t);return i.push(...e.filter(e=>Qt(e)!==t)),i}const Kt={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function ei(e,t,i){var n;if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||i.length>0)?Object.assign({},Kt):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const r=(t.matcher||ze)(i,e,t);if(!r)return Object.assign({},Kt);const s={};Ne(r.posParams,(e,t)=>{s[t]=e.path});const o=r.consumed.length>0?Object.assign(Object.assign({},s),r.consumed[r.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:r.consumed,lastChild:r.consumed.length,parameters:o,positionalParamSegments:null!==(n=r.posParams)&&void 0!==n?n:{}}}function ti(e,t,i,n,r="corrected"){if(i.length>0&&function(e,t,i){return i.some(i=>ii(e,t,i)&&Qt(i)!==Ie)}(e,i,n)){const r=new Xe(t,function(e,t,i,n){const r={};r.primary=n,n._sourceSegment=e,n._segmentIndexShift=t.length;for(const s of i)if(""===s.path&&Qt(s)!==Ie){const i=new Xe([],{});i._sourceSegment=e,i._segmentIndexShift=t.length,r[Qt(s)]=i}return r}(e,t,n,new Xe(i,e.children)));return r._sourceSegment=e,r._segmentIndexShift=t.length,{segmentGroup:r,slicedSegments:[]}}if(0===i.length&&function(e,t,i){return i.some(i=>ii(e,t,i))}(e,i,n)){const s=new Xe(e.segments,function(e,t,i,n,r,s){const o={};for(const a of n)if(ii(e,i,a)&&!r[Qt(a)]){const i=new Xe([],{});i._sourceSegment=e,i._segmentIndexShift="legacy"===s?e.segments.length:t.length,o[Qt(a)]=i}return Object.assign(Object.assign({},r),o)}(e,t,i,n,e.children,r));return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:i}}const s=new Xe(e.segments,e.children);return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:i}}function ii(e,t,i){return(!(e.hasChildren()||t.length>0)||"full"!==i.pathMatch)&&""===i.path}function ni(e,t,i,n){return!!(Qt(e)===n||n!==Ie&&ii(t,i,e))&&("**"===e.path||ei(t,e,i).matched)}function ri(e,t,i){return 0===t.length&&!e.children[i]}class si{constructor(e){this.segmentGroup=e||null}}class oi{constructor(e){this.urlTree=e}}function ai(e){return new f.a(t=>t.error(new si(e)))}function li(e){return new f.a(t=>t.error(new oi(e)))}function hi(e){return new f.a(t=>t.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${e}'`)))}class ci{constructor(e,t,i,n,s){this.configLoader=t,this.urlSerializer=i,this.urlTree=n,this.config=s,this.allowRedirects=!0,this.ngModule=e.get(r.z)}apply(){const e=ti(this.urlTree.root,[],[],this.config).segmentGroup,t=new Xe(e.segments,e.children);return this.expandSegmentGroup(this.ngModule,this.config,t,Ie).pipe(Object(A.a)(e=>this.createUrlTree(di(e),this.urlTree.queryParams,this.urlTree.fragment))).pipe(W(e=>{if(e instanceof oi)return this.allowRedirects=!1,this.match(e.urlTree);if(e instanceof si)throw this.noMatchError(e);throw e}))}match(e){return this.expandSegmentGroup(this.ngModule,this.config,e.root,Ie).pipe(Object(A.a)(t=>this.createUrlTree(di(t),e.queryParams,e.fragment))).pipe(W(e=>{if(e instanceof si)throw this.noMatchError(e);throw e}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,t,i){const n=e.segments.length>0?new Xe([],{[Ie]:e}):e;return new Ve(n,t,i)}expandSegmentGroup(e,t,i,n){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(e,t,i).pipe(Object(A.a)(e=>new Xe([],e))):this.expandSegment(e,i,t,i.segments,n,!0)}expandChildren(e,t,i){const n=[];for(const r of Object.keys(i.children))"primary"===r?n.unshift(r):n.push(r);return Object(s.a)(n).pipe(Object(V.a)(n=>{const r=i.children[n],s=Jt(t,n);return this.expandSegmentGroup(e,s,r,n).pipe(Object(A.a)(e=>({segment:e,outlet:n})))}),H((e,t)=>(e[t.outlet]=t.segment,e),{}),function(e,t){const i=arguments.length>=2;return n=>n.pipe(e?Object(B.a)((t,i)=>e(t,i,n)):te.a,X(1),i?J(t):q(()=>new S))}())}expandSegment(e,t,i,n,r,a){return Object(s.a)(i).pipe(Object(V.a)(s=>this.expandSegmentAgainstRoute(e,t,i,s,n,r,a).pipe(W(e=>{if(e instanceof si)return Object(o.a)(null);throw e}))),ie(e=>!!e),W((e,i)=>{if(e instanceof S||"EmptyError"===e.name){if(ri(t,n,r))return Object(o.a)(new Xe([],{}));throw new si(t)}throw e}))}expandSegmentAgainstRoute(e,t,i,n,r,s,o){return ni(n,t,r,s)?void 0===n.redirectTo?this.matchSegmentAgainstRoute(e,t,n,r,s):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,i,n,r,s):ai(t):ai(t)}expandSegmentAgainstRouteUsingRedirect(e,t,i,n,r,s){return"**"===n.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,n,s):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,n,r,s)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,n){const r=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?li(r):this.lineralizeSegments(i,r).pipe(Object(ne.a)(i=>{const r=new Xe(i,{});return this.expandSegment(e,r,t,i,n,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,n,r,s){const{matched:o,consumedSegments:a,lastChild:l,positionalParamSegments:h}=ei(t,n,r);if(!o)return ai(t);const c=this.applyRedirectCommands(a,n.redirectTo,h);return n.redirectTo.startsWith("/")?li(c):this.lineralizeSegments(n,c).pipe(Object(ne.a)(n=>this.expandSegment(e,t,i,n.concat(r.slice(l)),s,!1)))}matchSegmentAgainstRoute(e,t,i,n,r){if("**"===i.path)return i.loadChildren?this.configLoader.load(e.injector,i).pipe(Object(A.a)(e=>(i._loadedConfig=e,new Xe(n,{})))):Object(o.a)(new Xe(n,{}));const{matched:s,consumedSegments:a,lastChild:l}=ei(t,i,n);if(!s)return ai(t);const h=n.slice(l);return this.getChildConfig(e,i,n).pipe(Object(ne.a)(e=>{const n=e.module,s=e.routes,{segmentGroup:l,slicedSegments:c}=ti(t,a,h,s),d=new Xe(l.segments,l.children);if(0===c.length&&d.hasChildren())return this.expandChildren(n,s,d).pipe(Object(A.a)(e=>new Xe(a,e)));if(0===s.length&&0===c.length)return Object(o.a)(new Xe(a,{}));const p=Qt(i)===r;return this.expandSegment(n,d,s,c,p?Ie:r,!0).pipe(Object(A.a)(e=>new Xe(a.concat(e.segments),e.children)))}))}getChildConfig(e,t,i){return t.children?Object(o.a)(new Wt(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?Object(o.a)(t._loadedConfig):this.runCanLoadGuards(e.injector,t,i).pipe(Object(ne.a)(i=>i?this.configLoader.load(e.injector,t).pipe(Object(A.a)(e=>(t._loadedConfig=e,e))):function(e){return new f.a(t=>t.error(Le(`Cannot load children because the guard of the route "path: '${e.path}'" returned false`)))}(t))):Object(o.a)(new Wt([],e))}runCanLoadGuards(e,t,i){const n=t.canLoad;if(!n||0===n.length)return Object(o.a)(!0);const r=n.map(n=>{const r=e.get(n);let s;if(function(e){return e&&Ut(e.canLoad)}(r))s=r.canLoad(t,i);else{if(!Ut(r))throw new Error("Invalid CanLoad guard");s=r(t,i)}return _e(s)});return Object(o.a)(r).pipe(Xt(),oe(e=>{if(!Ft(e))return;const t=Le(`Redirecting to "${this.urlSerializer.serialize(e)}"`);throw t.url=e,t}),Object(A.a)(e=>!0===e))}lineralizeSegments(e,t){let i=[],n=t.root;for(;;){if(i=i.concat(n.segments),0===n.numberOfChildren)return Object(o.a)(i);if(n.numberOfChildren>1||!n.children.primary)return hi(e.redirectTo);n=n.children.primary}}applyRedirectCommands(e,t,i){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreatreUrlTree(e,t,i,n){const r=this.createSegmentGroup(e,t.root,i,n);return new Ve(r,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return Ne(e,(e,n)=>{if("string"==typeof e&&e.startsWith(":")){const r=e.substring(1);i[n]=t[r]}else i[n]=e}),i}createSegmentGroup(e,t,i,n){const r=this.createSegments(e,t.segments,i,n);let s={};return Ne(t.children,(t,r)=>{s[r]=this.createSegmentGroup(e,t,i,n)}),new Xe(r,s)}createSegments(e,t,i,n){return t.map(t=>t.path.startsWith(":")?this.findPosParam(e,t,n):this.findOrReturn(t,i))}findPosParam(e,t,i){const n=i[t.path.substring(1)];if(!n)throw new Error(`Cannot redirect to '${e}'. Cannot find '${t.path}'.`);return n}findOrReturn(e,t){let i=0;for(const n of t){if(n.path===e.path)return t.splice(i),n;i++}return e}}function di(e){const t={};for(const i of Object.keys(e.children)){const n=di(e.children[i]);(n.segments.length>0||n.hasChildren())&&(t[i]=n)}return function(e){if(1===e.numberOfChildren&&e.children.primary){const t=e.children.primary;return new Xe(e.segments.concat(t.segments),t.children)}return e}(new Xe(e.segments,t))}class pi{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class ui{constructor(e,t){this.component=e,this.route=t}}function gi(e,t,i){const n=e._root;return fi(n,t?t._root:null,i,[n.value])}function mi(e,t,i){const n=function(e){if(!e)return null;for(let t=e.parent;t;t=t.parent){const e=t.routeConfig;if(e&&e._loadedConfig)return e._loadedConfig}return null}(t);return(n?n.module.injector:i).get(e)}function fi(e,t,i,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=gt(t);return e.children.forEach(e=>{!function(e,t,i,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=e.value,o=t?t.value:null,a=i?i.getContext(e.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function(e,t,i){if("function"==typeof i)return i(e,t);switch(i){case"pathParamsChange":return!Ge(e.url,t.url);case"pathParamsOrQueryParamsChange":return!Ge(e.url,t.url)||!Me(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Pt(e,t)||!Me(e.queryParams,t.queryParams);case"paramsChange":default:return!Pt(e,t)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new pi(n)):(s.data=o.data,s._resolvedData=o._resolvedData),fi(e,t,s.component?a?a.children:null:i,n,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new ui(a.outlet.component,o))}else o&&yi(t,a,r),r.canActivateChecks.push(new pi(n)),fi(e,null,s.component?a?a.children:null:i,n,r)}(e,s[e.value.outlet],i,n.concat([e.value]),r),delete s[e.value.outlet]}),Ne(s,(e,t)=>yi(e,i.getContext(t),r)),r}function yi(e,t,i){const n=gt(e),r=e.value;Ne(n,(e,n)=>{yi(e,r.component?t?t.children.getContext(n):null:t,i)}),i.canDeactivateChecks.push(new ui(r.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,r))}class bi{}function vi(e){return new f.a(t=>t.error(e))}class wi{constructor(e,t,i,n,r,s){this.rootComponentType=e,this.config=t,this.urlTree=i,this.url=n,this.paramsInheritanceStrategy=r,this.relativeLinkResolution=s}recognize(){const e=ti(this.urlTree.root,[],[],this.config.filter(e=>void 0===e.redirectTo),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,Ie);if(null===t)return null;const i=new vt([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},Ie,this.rootComponentType,null,this.urlTree.root,-1,{}),n=new ut(i,t),r=new wt(this.url,n);return this.inheritParamsAndData(r._root),r}inheritParamsAndData(e){const t=e.value,i=bt(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(e=>this.inheritParamsAndData(e))}processSegmentGroup(e,t,i){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,i)}processChildren(e,t){const i=[];for(const r of Object.keys(t.children)){const n=t.children[r],s=Jt(e,r),o=this.processSegmentGroup(s,n,r);if(null===o)return null;i.push(...o)}const n=function(e){const t=[];for(const i of e){if(!xi(i)){t.push(i);continue}const e=t.find(e=>i.value.routeConfig===e.value.routeConfig);void 0!==e?e.children.push(...i.children):t.push(i)}return t}(i);return n.sort((e,t)=>e.value.outlet===Ie?-1:t.value.outlet===Ie?1:e.value.outlet.localeCompare(t.value.outlet)),n}processSegment(e,t,i,n){for(const r of e){const e=this.processSegmentAgainstRoute(r,t,i,n);if(null!==e)return e}return ri(t,i,n)?[]:null}processSegmentAgainstRoute(e,t,i,n){if(e.redirectTo||!ni(e,t,i,n))return null;let r,s=[],o=[];if("**"===e.path){const n=i.length>0?He(i).parameters:{};r=new vt(i,n,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Pi(e),Qt(e),e.component,e,Si(t),Ci(t)+i.length,Oi(e))}else{const n=ei(t,e,i);if(!n.matched)return null;s=n.consumedSegments,o=i.slice(n.lastChild),r=new vt(s,n.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Pi(e),Qt(e),e.component,e,Si(t),Ci(t)+s.length,Oi(e))}const a=function(e){return e.children?e.children:e.loadChildren?e._loadedConfig.routes:[]}(e),{segmentGroup:l,slicedSegments:h}=ti(t,s,o,a.filter(e=>void 0===e.redirectTo),this.relativeLinkResolution);if(0===h.length&&l.hasChildren()){const e=this.processChildren(a,l);return null===e?null:[new ut(r,e)]}if(0===a.length&&0===h.length)return[new ut(r,[])];const c=Qt(e)===n,d=this.processSegment(a,l,h,c?Ie:n);return null===d?null:[new ut(r,d)]}}function xi(e){const t=e.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function Si(e){let t=e;for(;t._sourceSegment;)t=t._sourceSegment;return t}function Ci(e){let t=e,i=t._segmentIndexShift?t._segmentIndexShift:0;for(;t._sourceSegment;)t=t._sourceSegment,i+=t._segmentIndexShift?t._segmentIndexShift:0;return i-1}function Pi(e){return e.data||{}}function Oi(e){return e.resolve||{}}function Ti(e){return D(t=>{const i=e(t);return i?Object(s.a)(i).pipe(Object(A.a)(()=>t)):Object(o.a)(t)})}class Ei extends class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const Ai=new r.s("ROUTES");class Ii{constructor(e,t,i,n){this.loader=e,this.compiler=t,this.onLoadStartListener=i,this.onLoadEndListener=n}load(e,t){return this.onLoadStartListener&&this.onLoadStartListener(t),this.loadModuleFactory(t.loadChildren).pipe(Object(A.a)(i=>{this.onLoadEndListener&&this.onLoadEndListener(t);const n=i.create(e);return new Wt(je(n.injector.get(Ai,void 0,r.r.Self|r.r.Optional)).map($t),n)}))}loadModuleFactory(e){return"string"==typeof e?Object(s.a)(this.loader.load(e)):_e(e()).pipe(Object(ne.a)(e=>e instanceof r.x?Object(o.a)(e):Object(s.a)(this.compiler.compileModuleAsync(e))))}}class Di{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new Ri,this.attachRef=null}}class Ri{constructor(){this.contexts=new Map}onChildOutletCreated(e,t){const i=this.getOrCreateContext(e);i.outlet=t,this.contexts.set(e,i)}onChildOutletDestroyed(e){const t=this.getContext(e);t&&(t.outlet=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let t=this.getContext(e);return t||(t=new Di,this.contexts.set(e,t)),t}getContext(e){return this.contexts.get(e)||null}}class Li{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function zi(e){throw e}function Mi(e,t,i){return t.parse("/")}function ki(e,t){return Object(o.a)(null)}let ji=(()=>{class e{constructor(e,t,i,n,s,o,l,c){this.rootComponentType=e,this.urlSerializer=t,this.rootContexts=i,this.location=n,this.config=c,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.lastLocationChangeInfo=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new a.a,this.errorHandler=zi,this.malformedUriErrorHandler=Mi,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:ki,afterPreactivation:ki},this.urlHandlingStrategy=new Li,this.routeReuseStrategy=new Ei,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.ngModule=s.get(r.z),this.console=s.get(r.X);const d=s.get(r.B);this.isNgZoneEnabled=d instanceof r.B&&r.B.isInAngularZone(),this.resetConfig(c),this.currentUrlTree=new Ve(new Xe([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new Ii(o,l,e=>this.triggerEvent(new Se(e)),e=>this.triggerEvent(new Ce(e))),this.routerState=ft(this.currentUrlTree,this.rootComponentType),this.transitions=new h({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}setupNavigations(e){const t=this.events;return e.pipe(Object(B.a)(e=>0!==e.id),Object(A.a)(e=>Object.assign(Object.assign({},e),{extractedUrl:this.urlHandlingStrategy.extract(e.rawUrl)})),D(e=>{let i=!1,n=!1;return Object(o.a)(e).pipe(oe(e=>{this.currentNavigation={id:e.id,initialUrl:e.currentRawUrl,extractedUrl:e.extractedUrl,trigger:e.source,extras:e.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),D(e=>{const i=!this.navigated||e.extractedUrl.toString()!==this.browserUrlTree.toString();if(("reload"===this.onSameUrlNavigation||i)&&this.urlHandlingStrategy.shouldProcessUrl(e.rawUrl))return Object(o.a)(e).pipe(D(e=>{const i=this.transitions.getValue();return t.next(new ue(e.id,this.serializeUrl(e.extractedUrl),e.source,e.restoredState)),i!==this.transitions.getValue()?O:Promise.resolve(e)}),(n=this.ngModule.injector,r=this.configLoader,s=this.urlSerializer,a=this.config,D(e=>function(e,t,i,n,r){return new ci(e,t,i,n,r).apply()}(n,r,s,e.extractedUrl,a).pipe(Object(A.a)(t=>Object.assign(Object.assign({},e),{urlAfterRedirects:t}))))),oe(e=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:e.urlAfterRedirects})}),function(e,t,i,n,r){return Object(ne.a)(s=>function(e,t,i,n,r="emptyOnly",s="legacy"){try{const a=new wi(e,t,i,n,r,s).recognize();return null===a?vi(new bi):Object(o.a)(a)}catch(a){return vi(a)}}(e,t,s.urlAfterRedirects,i(s.urlAfterRedirects),n,r).pipe(Object(A.a)(e=>Object.assign(Object.assign({},s),{targetSnapshot:e}))))}(this.rootComponentType,this.config,e=>this.serializeUrl(e),this.paramsInheritanceStrategy,this.relativeLinkResolution),oe(e=>{"eager"===this.urlUpdateStrategy&&(e.extras.skipLocationChange||this.setBrowserUrl(e.urlAfterRedirects,!!e.extras.replaceUrl,e.id,e.extras.state),this.browserUrlTree=e.urlAfterRedirects);const i=new ye(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.next(i)}));var n,r,s,a;if(i&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:i,extractedUrl:n,source:r,restoredState:s,extras:a}=e,l=new ue(i,this.serializeUrl(n),r,s);t.next(l);const h=ft(n,this.rootComponentType).snapshot;return Object(o.a)(Object.assign(Object.assign({},e),{targetSnapshot:h,urlAfterRedirects:n,extras:Object.assign(Object.assign({},a),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=e.rawUrl,this.browserUrlTree=e.urlAfterRedirects,e.resolve(null),O}),Ti(e=>{const{targetSnapshot:t,id:i,extractedUrl:n,rawUrl:r,extras:{skipLocationChange:s,replaceUrl:o}}=e;return this.hooks.beforePreactivation(t,{navigationId:i,appliedUrlTree:n,rawUrlTree:r,skipLocationChange:!!s,replaceUrl:!!o})}),oe(e=>{const t=new be(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);this.triggerEvent(t)}),Object(A.a)(e=>Object.assign(Object.assign({},e),{guards:gi(e.targetSnapshot,e.currentSnapshot,this.rootContexts)})),function(e,t){return Object(ne.a)(i=>{const{targetSnapshot:n,currentSnapshot:r,guards:{canActivateChecks:a,canDeactivateChecks:l}}=i;return 0===l.length&&0===a.length?Object(o.a)(Object.assign(Object.assign({},i),{guardsResult:!0})):function(e,t,i,n){return Object(s.a)(e).pipe(Object(ne.a)(e=>function(e,t,i,n,r){const s=t&&t.routeConfig?t.routeConfig.canDeactivate:null;if(!s||0===s.length)return Object(o.a)(!0);const a=s.map(s=>{const o=mi(s,t,r);let a;if(function(e){return e&&Ut(e.canDeactivate)}(o))a=_e(o.canDeactivate(e,t,i,n));else{if(!Ut(o))throw new Error("Invalid CanDeactivate guard");a=_e(o(e,t,i,n))}return a.pipe(ie())});return Object(o.a)(a).pipe(Xt())}(e.component,e.route,i,t,n)),ie(e=>!0!==e,!0))}(l,n,r,e).pipe(Object(ne.a)(i=>i&&"boolean"==typeof i?function(e,t,i,n){return Object(s.a)(t).pipe(Object(V.a)(t=>P(function(e,t){return null!==e&&t&&t(new Pe(e)),Object(o.a)(!0)}(t.route.parent,n),function(e,t){return null!==e&&t&&t(new Te(e)),Object(o.a)(!0)}(t.route,n),function(e,t,i){const n=t[t.length-1],r=t.slice(0,t.length-1).reverse().map(e=>function(e){const t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(e)).filter(e=>null!==e).map(t=>E(()=>{const r=t.guards.map(r=>{const s=mi(r,t.node,i);let o;if(function(e){return e&&Ut(e.canActivateChild)}(s))o=_e(s.canActivateChild(n,e));else{if(!Ut(s))throw new Error("Invalid CanActivateChild guard");o=_e(s(n,e))}return o.pipe(ie())});return Object(o.a)(r).pipe(Xt())}));return Object(o.a)(r).pipe(Xt())}(e,t.path,i),function(e,t,i){const n=t.routeConfig?t.routeConfig.canActivate:null;if(!n||0===n.length)return Object(o.a)(!0);const r=n.map(n=>E(()=>{const r=mi(n,t,i);let s;if(function(e){return e&&Ut(e.canActivate)}(r))s=_e(r.canActivate(t,e));else{if(!Ut(r))throw new Error("Invalid CanActivate guard");s=_e(r(t,e))}return s.pipe(ie())}));return Object(o.a)(r).pipe(Xt())}(e,t.route,i))),ie(e=>!0!==e,!0))}(n,a,e,t):Object(o.a)(i)),Object(A.a)(e=>Object.assign(Object.assign({},i),{guardsResult:e})))})}(this.ngModule.injector,e=>this.triggerEvent(e)),oe(e=>{if(Ft(e.guardsResult)){const t=Le(`Redirecting to "${this.serializeUrl(e.guardsResult)}"`);throw t.url=e.guardsResult,t}const t=new ve(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot,!!e.guardsResult);this.triggerEvent(t)}),Object(B.a)(e=>{if(!e.guardsResult){this.resetUrlToCurrentUrlTree();const i=new me(e.id,this.serializeUrl(e.extractedUrl),"");return t.next(i),e.resolve(!1),!1}return!0}),Ti(e=>{if(e.guards.canActivateChecks.length)return Object(o.a)(e).pipe(oe(e=>{const t=new we(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);this.triggerEvent(t)}),D(e=>{let i=!1;return Object(o.a)(e).pipe((n=this.paramsInheritanceStrategy,r=this.ngModule.injector,Object(ne.a)(e=>{const{targetSnapshot:t,guards:{canActivateChecks:i}}=e;if(!i.length)return Object(o.a)(e);let a=0;return Object(s.a)(i).pipe(Object(V.a)(e=>function(e,t,i,n){return function(e,t,i,n){const r=Object.keys(e);if(0===r.length)return Object(o.a)({});const a={};return Object(s.a)(r).pipe(Object(ne.a)(r=>function(e,t,i,n){const r=mi(e,t,n);return _e(r.resolve?r.resolve(t,i):r(t,i))}(e[r],t,i,n).pipe(oe(e=>{a[r]=e}))),X(1),Object(ne.a)(()=>Object.keys(a).length===r.length?Object(o.a)(a):O))}(e._resolve,e,t,n).pipe(Object(A.a)(t=>(e._resolvedData=t,e.data=Object.assign(Object.assign({},e.data),bt(e,i).resolve),null)))}(e.route,t,n,r)),oe(()=>a++),X(1),Object(ne.a)(t=>a===i.length?Object(o.a)(e):O))})),oe({next:()=>i=!0,complete:()=>{if(!i){const i=new me(e.id,this.serializeUrl(e.extractedUrl),"At least one route resolver didn't emit any value.");t.next(i),e.resolve(!1)}}}));var n,r}),oe(e=>{const t=new xe(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);this.triggerEvent(t)}))}),Ti(e=>{const{targetSnapshot:t,id:i,extractedUrl:n,rawUrl:r,extras:{skipLocationChange:s,replaceUrl:o}}=e;return this.hooks.afterPreactivation(t,{navigationId:i,appliedUrlTree:n,rawUrlTree:r,skipLocationChange:!!s,replaceUrl:!!o})}),Object(A.a)(e=>{const t=function(e,t,i){const n=Ot(e,t._root,i?i._root:void 0);return new mt(n,t)}(this.routeReuseStrategy,e.targetSnapshot,e.currentRouterState);return Object.assign(Object.assign({},e),{targetRouterState:t})}),oe(e=>{this.currentUrlTree=e.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl),this.routerState=e.targetRouterState,"deferred"===this.urlUpdateStrategy&&(e.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,!!e.extras.replaceUrl,e.id,e.extras.state),this.browserUrlTree=e.urlAfterRedirects)}),(a=this.rootContexts,l=this.routeReuseStrategy,h=e=>this.triggerEvent(e),Object(A.a)(e=>(new _t(l,e.targetRouterState,e.currentRouterState,h).activate(a),e))),oe({next(){i=!0},complete(){i=!0}}),(r=()=>{if(!i&&!n){this.resetUrlToCurrentUrlTree();const i=new me(e.id,this.serializeUrl(e.extractedUrl),`Navigation ID ${e.id} is not equal to the current navigation id ${this.navigationId}`);t.next(i),e.resolve(!1)}this.currentNavigation=null},e=>e.lift(new ce(r))),W(i=>{if(n=!0,(r=i)&&r.ngNavigationCancelingError){const n=Ft(i.url);n||(this.navigated=!0,this.resetStateAndUrl(e.currentRouterState,e.currentUrlTree,e.rawUrl));const r=new me(e.id,this.serializeUrl(e.extractedUrl),i.message);t.next(r),n?setTimeout(()=>{const t=this.urlHandlingStrategy.merge(i.url,this.rawUrlTree);this.scheduleNavigation(t,"imperative",null,{skipLocationChange:e.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy},{resolve:e.resolve,reject:e.reject,promise:e.promise})},0):e.resolve(!1)}else{this.resetStateAndUrl(e.currentRouterState,e.currentUrlTree,e.rawUrl);const n=new fe(e.id,this.serializeUrl(e.extractedUrl),i);t.next(n);try{e.resolve(this.errorHandler(i))}catch(s){e.reject(s)}}var r;return O}));var r,a,l,h}))}resetRootComponentType(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}getTransition(){const e=this.transitions.value;return e.urlAfterRedirects=this.browserUrlTree,e}setTransition(e){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),e))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const t=this.extractLocationChangeInfoFromEvent(e);this.shouldScheduleNavigation(this.lastLocationChangeInfo,t)&&setTimeout(()=>{const{source:e,state:i,urlTree:n}=t,r={replaceUrl:!0};if(i){const e=Object.assign({},i);delete e.navigationId,0!==Object.keys(e).length&&(r.state=e)}this.scheduleNavigation(n,e,i,r)},0),this.lastLocationChangeInfo=t}))}extractLocationChangeInfoFromEvent(e){var t;return{source:"popstate"===e.type?"popstate":"hashchange",urlTree:this.parseUrl(e.url),state:(null===(t=e.state)||void 0===t?void 0:t.navigationId)?e.state:null,transitionId:this.getTransition().id}}shouldScheduleNavigation(e,t){if(!e)return!0;const i=t.urlTree.toString()===e.urlTree.toString();return!(t.transitionId===e.transitionId&&i&&("hashchange"===t.source&&"popstate"===e.source||"popstate"===t.source&&"hashchange"===e.source))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(e){this.events.next(e)}resetConfig(e){Gt(e),this.config=e.map($t),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0)}createUrlTree(e,t={}){const{relativeTo:i,queryParams:n,fragment:r,queryParamsHandling:s,preserveFragment:o}=t,a=i||this.routerState.root,l=o?this.currentUrlTree.fragment:r;let h=null;switch(s){case"merge":h=Object.assign(Object.assign({},this.currentUrlTree.queryParams),n);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=n||null}return null!==h&&(h=this.removeEmptyProps(h)),function(e,t,i,n,r){if(0===i.length)return It(t.root,t.root,t,n,r);const s=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new Rt(!0,0,e);let t=0,i=!1;const n=e.reduce((e,n,r)=>{if("object"==typeof n&&null!=n){if(n.outlets){const t={};return Ne(n.outlets,(e,i)=>{t[i]="string"==typeof e?e.split("/"):e}),[...e,{outlets:t}]}if(n.segmentPath)return[...e,n.segmentPath]}return"string"!=typeof n?[...e,n]:0===r?(n.split("/").forEach((n,r)=>{0==r&&"."===n||(0==r&&""===n?i=!0:".."===n?t++:""!=n&&e.push(n))}),e):[...e,n]},[]);return new Rt(i,t,n)}(i);if(s.toRoot())return It(t.root,new Xe([],{}),t,n,r);const o=function(e,t,i){if(e.isAbsolute)return new Lt(t.root,!0,0);if(-1===i.snapshot._lastPathIndex){const e=i.snapshot._urlSegment;return new Lt(e,e===t.root,0)}const n=Et(e.commands[0])?0:1;return function(e,t,i){let n=e,r=t,s=i;for(;s>r;){if(s-=r,n=n.parent,!n)throw new Error("Invalid number of '../'");r=n.segments.length}return new Lt(n,!1,r-s)}(i.snapshot._urlSegment,i.snapshot._lastPathIndex+n,e.numberOfDoubleDots)}(s,t,e),a=o.processChildren?Mt(o.segmentGroup,o.index,s.commands):zt(o.segmentGroup,o.index,s.commands);return It(o.segmentGroup,a,t,n,r)}(a,this.currentUrlTree,e,h,l)}navigateByUrl(e,t={skipLocationChange:!1}){const i=Ft(e)?e:this.parseUrl(e),n=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(n,"imperative",null,t)}navigate(e,t={skipLocationChange:!1}){return function(e){for(let t=0;t<e.length;t++){const i=e[t];if(null==i)throw new Error(`The requested path contains ${i} segment at index ${t}`)}}(e),this.navigateByUrl(this.createUrlTree(e,t),t)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let t;try{t=this.urlSerializer.parse(e)}catch(i){t=this.malformedUriErrorHandler(i,this.urlSerializer,e)}return t}isActive(e,t){if(Ft(e))return Be(this.currentUrlTree,e,t);const i=this.parseUrl(e);return Be(this.currentUrlTree,i,t)}removeEmptyProps(e){return Object.keys(e).reduce((t,i)=>{const n=e[i];return null!=n&&(t[i]=n),t},{})}processNavigations(){this.navigations.subscribe(e=>{this.navigated=!0,this.lastSuccessfulId=e.id,this.events.next(new ge(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.currentNavigation=null,e.resolve(!0)},e=>{this.console.warn("Unhandled Navigation Error: ")})}scheduleNavigation(e,t,i,n,r){const s=this.getTransition(),o="imperative"!==t&&"imperative"===(null==s?void 0:s.source),a=(this.lastSuccessfulId===s.id||this.currentNavigation?s.rawUrl:s.urlAfterRedirects).toString()===e.toString();if(o&&a)return Promise.resolve(!0);let l,h,c;r?(l=r.resolve,h=r.reject,c=r.promise):c=new Promise((e,t)=>{l=e,h=t});const d=++this.navigationId;return this.setTransition({id:d,source:t,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:n,resolve:l,reject:h,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(e=>Promise.reject(e))}setBrowserUrl(e,t,i,n){const r=this.urlSerializer.serialize(e);n=n||{},this.location.isCurrentPathEqualTo(r)||t?this.location.replaceState(r,"",Object.assign(Object.assign({},n),{navigationId:i})):this.location.go(r,"",Object.assign(Object.assign({},n),{navigationId:i}))}resetStateAndUrl(e,t,i){this.routerState=e,this.currentUrlTree=t,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,i),this.resetUrlToCurrentUrlTree()}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}}return e.\u0275fac=function(t){return new(t||e)(r.Pb(r.O),r.Pb(qe),r.Pb(Ri),r.Pb(n.f),r.Pb(r.t),r.Pb(r.y),r.Pb(r.i),r.Pb(void 0))},e.\u0275prov=r.Fb({token:e,factory:e.\u0275fac}),e})(),Hi=(()=>{class e{constructor(e,t,i,n,s){this.parentContexts=e,this.location=t,this.resolver=i,this.changeDetector=s,this.activated=null,this._activatedRoute=null,this.activateEvents=new r.n,this.deactivateEvents=new r.n,this.name=n||Ie,e.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,e}attach(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,t){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;const i=(t=t||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),n=this.parentContexts.getOrCreateContext(this.name).children,r=new Ni(e,n,this.location.injector);this.activated=this.location.createComponent(i,this.location.length,r),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return e.\u0275fac=function(t){return new(t||e)(r.Jb(Ri),r.Jb(r.R),r.Jb(r.j),r.Qb("name"),r.Jb(r.h))},e.\u0275dir=r.Eb({type:e,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),e})();class Ni{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===yt?this.route:e===Ri?this.childContexts:this.parent.get(e,t)}}class _i{}class Bi{preload(e,t){return Object(o.a)(null)}}let Wi=(()=>{class e{constructor(e,t,i,n,r){this.router=e,this.injector=n,this.preloadingStrategy=r,this.loader=new Ii(t,i,t=>e.triggerEvent(new Se(t)),t=>e.triggerEvent(new Ce(t)))}setUpPreloading(){this.subscription=this.router.events.pipe(Object(B.a)(e=>e instanceof ge),Object(V.a)(()=>this.preload())).subscribe(()=>{})}preload(){const e=this.injector.get(r.z);return this.processRoutes(e,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,t){const i=[];for(const n of t)if(n.loadChildren&&!n.canLoad&&n._loadedConfig){const e=n._loadedConfig;i.push(this.processRoutes(e.module,e.routes))}else n.loadChildren&&!n.canLoad?i.push(this.preloadConfig(e,n)):n.children&&i.push(this.processRoutes(e,n.children));return Object(s.a)(i).pipe(Object(C.a)(),Object(A.a)(e=>{}))}preloadConfig(e,t){return this.preloadingStrategy.preload(t,()=>this.loader.load(e.injector,t).pipe(Object(ne.a)(e=>(t._loadedConfig=e,this.processRoutes(e.module,e.routes)))))}}return e.\u0275fac=function(t){return new(t||e)(r.Pb(ji),r.Pb(r.y),r.Pb(r.i),r.Pb(r.t),r.Pb(_i))},e.\u0275prov=r.Fb({token:e,factory:e.\u0275fac}),e})(),Ui=(()=>{class e{constructor(e,t,i={}){this.router=e,this.viewportScroller=t,this.options=i,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},i.scrollPositionRestoration=i.scrollPositionRestoration||"disabled",i.anchorScrolling=i.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof ue?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof ge&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof Ae&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,t){this.router.triggerEvent(new Ae(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,t))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(r.Pb(ji),r.Pb(n.n),r.Pb(void 0))},e.\u0275prov=r.Fb({token:e,factory:e.\u0275fac}),e})();const Fi=new r.s("ROUTER_CONFIGURATION"),Vi=new r.s("ROUTER_FORROOT_GUARD"),Xi=[n.f,{provide:qe,useClass:Ze},{provide:ji,useFactory:function(e,t,i,r,s,o,a,l={},h,c){const d=new ji(null,e,t,i,r,s,o,je(a));if(h&&(d.urlHandlingStrategy=h),c&&(d.routeReuseStrategy=c),function(e,t){e.errorHandler&&(t.errorHandler=e.errorHandler),e.malformedUriErrorHandler&&(t.malformedUriErrorHandler=e.malformedUriErrorHandler),e.onSameUrlNavigation&&(t.onSameUrlNavigation=e.onSameUrlNavigation),e.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=e.paramsInheritanceStrategy),e.relativeLinkResolution&&(t.relativeLinkResolution=e.relativeLinkResolution),e.urlUpdateStrategy&&(t.urlUpdateStrategy=e.urlUpdateStrategy)}(l,d),l.enableTracing){const e=Object(n.r)();d.events.subscribe(t=>{e.logGroup(`Router Event: ${t.constructor.name}`),e.log(t.toString()),e.log(t),e.logGroupEnd()})}return d},deps:[qe,Ri,n.f,r.t,r.y,r.i,Ai,Fi,[class{},new r.C],[class{},new r.C]]},Ri,{provide:yt,useFactory:function(e){return e.routerState.root},deps:[ji]},{provide:r.y,useClass:r.L},Wi,Bi,class{preload(e,t){return t().pipe(W(()=>Object(o.a)(null)))}},{provide:Fi,useValue:{enableTracing:!1}}];function Yi(){return new r.A("Router",ji)}let Gi=(()=>{class e{constructor(e,t){}static forRoot(t,i){return{ngModule:e,providers:[Xi,Qi(t),{provide:Vi,useFactory:$i,deps:[[ji,new r.C,new r.K]]},{provide:Fi,useValue:i||{}},{provide:n.g,useFactory:Zi,deps:[n.m,[new r.q(n.a),new r.C],Fi]},{provide:Ui,useFactory:qi,deps:[ji,n.n,Fi]},{provide:_i,useExisting:i&&i.preloadingStrategy?i.preloadingStrategy:Bi},{provide:r.A,multi:!0,useFactory:Yi},[Ji,{provide:r.d,multi:!0,useFactory:Ki,deps:[Ji]},{provide:tn,useFactory:en,deps:[Ji]},{provide:r.b,multi:!0,useExisting:tn}]]}}static forChild(t){return{ngModule:e,providers:[Qi(t)]}}}return e.\u0275mod=r.Hb({type:e}),e.\u0275inj=r.Gb({factory:function(t){return new(t||e)(r.Pb(Vi,8),r.Pb(ji,8))}}),e})();function qi(e,t,i){return i.scrollOffset&&t.setOffset(i.scrollOffset),new Ui(e,t,i)}function Zi(e,t,i={}){return i.useHash?new n.d(e,t):new n.l(e,t)}function $i(e){return"guarded"}function Qi(e){return[{provide:r.a,multi:!0,useValue:e},{provide:Ai,multi:!0,useValue:e}]}let Ji=(()=>{class e{constructor(e){this.injector=e,this.initNavigation=!1,this.resultOfPreactivationDone=new a.a}appInitializer(){return this.injector.get(n.e,Promise.resolve(null)).then(()=>{let e=null;const t=new Promise(t=>e=t),i=this.injector.get(ji),n=this.injector.get(Fi);return"disabled"===n.initialNavigation?(i.setUpLocationChangeListener(),e(!0)):"enabled"===n.initialNavigation||"enabledBlocking"===n.initialNavigation?(i.hooks.afterPreactivation=()=>this.initNavigation?Object(o.a)(null):(this.initNavigation=!0,e(!0),this.resultOfPreactivationDone),i.initialNavigation()):e(!0),t})}bootstrapListener(e){const t=this.injector.get(Fi),i=this.injector.get(Wi),n=this.injector.get(Ui),s=this.injector.get(ji),o=this.injector.get(r.g);e===o.components[0]&&("enabledNonBlocking"!==t.initialNavigation&&void 0!==t.initialNavigation||s.initialNavigation(),i.setUpPreloading(),n.init(),s.resetRootComponentType(o.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}}return e.\u0275fac=function(t){return new(t||e)(r.Pb(r.t))},e.\u0275prov=r.Fb({token:e,factory:e.\u0275fac}),e})();function Ki(e){return e.appInitializer.bind(e)}function en(e){return e.bootstrapListener.bind(e)}const tn=new r.s("Router Initializer")},jZKg:function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i("HDdC"),r=i("quSY");function s(e,t){return new n.a(i=>{const n=new r.a;let s=0;return n.add(t.schedule(function(){s!==e.length?(i.next(e[s++]),i.closed||n.add(this.schedule())):i.complete()})),n})}},kJWO:function(e,t,i){"use strict";i.d(t,"a",function(){return n});const n=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")()},lJxs:function(e,t,i){"use strict";i.d(t,"a",function(){return r});var n=i("7o/Q");function r(e,t){return function(i){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return i.lift(new s(e,t))}}class s{constructor(e,t){this.project=e,this.thisArg=t}call(e,t){return t.subscribe(new o(e,this.project,this.thisArg))}}class o extends n.a{constructor(e,t,i){super(e),this.project=t,this.count=0,this.thisArg=i||this}_next(e){let t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}},n6bG:function(e,t,i){"use strict";function n(e){return"function"==typeof e}i.d(t,"a",function(){return n})},ngJS:function(e,t,i){"use strict";i.d(t,"a",function(){return n});const n=e=>t=>{for(let i=0,n=e.length;i<n&&!t.closed;i++)t.next(e[i]);t.complete()}},pLZG:function(e,t,i){"use strict";i.d(t,"a",function(){return r});var n=i("7o/Q");function r(e,t){return function(i){return i.lift(new s(e,t))}}class s{constructor(e,t){this.predicate=e,this.thisArg=t}call(e,t){return t.subscribe(new o(e,this.predicate,this.thisArg))}}class o extends n.a{constructor(e,t,i){super(e),this.predicate=t,this.thisArg=i,this.count=0}_next(e){let t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}t&&this.destination.next(e)}}},quSY:function(e,t,i){"use strict";i.d(t,"a",function(){return a});var n=i("DH7j"),r=i("XoHu"),s=i("n6bG");const o=(()=>{function e(e){return Error.call(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((e,t)=>`${t+1}) ${e.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e})();let a=(()=>{class e{constructor(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}unsubscribe(){let t;if(this.closed)return;let{_parentOrParents:i,_ctorUnsubscribe:a,_unsubscribe:h,_subscriptions:c}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,i instanceof e)i.remove(this);else if(null!==i)for(let e=0;e<i.length;++e)i[e].remove(this);if(Object(s.a)(h)){a&&(this._unsubscribe=void 0);try{h.call(this)}catch(d){t=d instanceof o?l(d.errors):[d]}}if(Object(n.a)(c)){let e=-1,i=c.length;for(;++e<i;){const i=c[e];if(Object(r.a)(i))try{i.unsubscribe()}catch(d){t=t||[],d instanceof o?t=t.concat(l(d.errors)):t.push(d)}}}if(t)throw new o(t)}add(t){let i=t;if(!t)return e.EMPTY;switch(typeof t){case"function":i=new e(t);case"object":if(i===this||i.closed||"function"!=typeof i.unsubscribe)return i;if(this.closed)return i.unsubscribe(),i;if(!(i instanceof e)){const t=i;i=new e,i._subscriptions=[t]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}let{_parentOrParents:n}=i;if(null===n)i._parentOrParents=this;else if(n instanceof e){if(n===this)return i;i._parentOrParents=[n,this]}else{if(-1!==n.indexOf(this))return i;n.push(this)}const r=this._subscriptions;return null===r?this._subscriptions=[i]:r.push(i),i}remove(e){const t=this._subscriptions;if(t){const i=t.indexOf(e);-1!==i&&t.splice(i,1)}}}var t;return e.EMPTY=((t=new e).closed=!0,t),e})();function l(e){return e.reduce((e,t)=>e.concat(t instanceof o?t.errors:t),[])}},yCtX:function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i("HDdC"),r=i("ngJS"),s=i("jZKg");function o(e,t){return t?Object(s.a)(e,t):new n.a(Object(r.a)(e))}},"z+Ro":function(e,t,i){"use strict";function n(e){return e&&"function"==typeof e.schedule}i.d(t,"a",function(){return n})},zUnb:function(e,t,i){"use strict";i.r(t);var n=i("cUpR"),r=i("8Y7J"),s=i("IheW"),o=i("iInd");const a=[{path:"",loadChildren:()=>Promise.all([i.e(1),i.e(3),i.e(4),i.e(2),i.e(8)]).then(i.bind(null,"99Un")).then(e=>e.HomeModule)},{path:"",redirectTo:"/",pathMatch:"full"},{path:"data-grid",loadChildren:()=>Promise.all([i.e(1),i.e(3)]).then(i.bind(null,"TDbv")).then(e=>e.DataGridComponent)},{path:"charts",loadChildren:()=>Promise.all([i.e(1),i.e(4)]).then(i.bind(null,"cBWn")).then(e=>e.ChartsComponent)},{path:"diagram",loadChildren:()=>i.e(2).then(i.bind(null,"fUye")).then(e=>e.DiagramComponent)}];let l=(()=>{class e{}return e.\u0275mod=r.Hb({type:e}),e.\u0275inj=r.Gb({factory:function(t){return new(t||e)},imports:[[o.a.forRoot(a)],o.a]}),e})(),h=(()=>{class e{constructor(){this.title="Desafio_angular_RafaelNevesDeOliveira_v2"}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=r.Db({type:e,selectors:[["app-root"]],decls:1,vars:0,template:function(e,t){1&e&&r.Kb(0,"router-outlet")},directives:[o.b],styles:[""]}),e})();var c=i("/BFg");let d=(()=>{class e{}return e.\u0275mod=r.Hb({type:e,bootstrap:[h]}),e.\u0275inj=r.Gb({factory:function(t){return new(t||e)},providers:[],imports:[[n.a,l,s.b,c.f]]}),e})();i("AytR").a.production&&Object(r.U)(),n.e().bootstrapModule(d).catch(e=>console.error(e))},zn8P:function(e,t){function i(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}i.keys=function(){return[]},i.resolve=i,e.exports=i,i.id="zn8P"},zx2A:function(e,t,i){"use strict";i.d(t,"a",function(){return o}),i.d(t,"b",function(){return a}),i.d(t,"c",function(){return l});var n=i("7o/Q"),r=i("HDdC"),s=i("SeVD");class o extends n.a{constructor(e){super(),this.parent=e}_next(e){this.parent.notifyNext(e)}_error(e){this.parent.notifyError(e),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class a extends n.a{notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.destination.complete()}}function l(e,t){if(t.closed)return;if(e instanceof r.a)return e.subscribe(t);let i;try{i=Object(s.a)(e)(t)}catch(n){t.error(n)}return i}}},[[0,0]]]);